import{n as pe,r as d,e as $e,q as B,s as P,b3 as Fs,j as e,F as Ps,O as g,S as re,z as ie,A as ne,D as le,G as H,B as l,k as _,K as Q,g as ps,w as E,x as D,L as I,N as z,b4 as Es,b5 as Me,aL as ge,P as Ke,y as S,o as Z,v as js,m as Ds,T as ke,af as us,aX as y,aQ as we,ab as Fe,M as he,ac as Pe,ad as Ee,aY as Se,d as qs,u as Os,h as Ls,a5 as Ms,a6 as Rs,a7 as oe,l as rs,b6 as De,a8 as de,aR as qe,aS as L,aT as M,aU as R,aV as U,aW as K,X as Us,ag as be,ah as fe,b as is,c as ns,t as Ks,H as _s,a as Is}from"./index-CcGJX3_v-1757311298761.js";import{D as ee,f as Ce,a as se,b as ae,c as te,d as Re,e as zs}from"./dialog-BXKzIR9f-1757311298761.js";import{T as Vs,a as Qs,b as ls,c as xe,d as Hs,e as me}from"./table-Bdc5Mc2k-1757311298761.js";import{A as _e,a as Ie,b as ze,c as Ve,d as Qe,e as He,h as gs,f as ys,g as vs}from"./alert-dialog-Fke7h8Up-1757311298761.js";import{T as Bs}from"./triangle-alert-s88K6IKZ-1757311298761.js";import{U as ve}from"./users-CV7iFwTF-1757311298761.js";import{T as Ue}from"./textarea-F33x4Z_S-1757311298761.js";import{S as ye}from"./square-pen-C2w5czex-1757311298761.js";import{D as Js}from"./dollar-sign-TMA2gljO-1757311298761.js";import{S as Ns}from"./save-Bp-ymjLU-1757311298761.js";import{R as Oe,a as Ws}from"./role-display-Cjli3XcZ-1757311298761.js";import{L as Gs}from"./list-D7SNgR3o-1757311298761.js";import{G as Xs}from"./grid-3x3-BsxcXUaL-1757311298761.js";import{S as Ys}from"./search-Dkpfx4a3-1757311298761.js";import{P as cs}from"./phone-PENMgct_-1757311298761.js";import{C as os}from"./calendar-CFhkEnQ2-1757311298761.js";import{H as Zs}from"./hash-_gA_bQ-4-1757311298761.js";import"./index-DXCjcDFG-1757311298761.js";import"./use-ui-terms-QuzcPUtm-1757311298761.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=pe("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=pe("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=pe("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=pe("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=pe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=pe("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);function xs({user:x,isOpen:C,onClose:N,onSuccess:h}){const[b,f]=d.useState("checking"),[a,p]=d.useState(""),{toast:j}=$e(),{data:o,isLoading:A}=B({queryKey:[`/api/users/${x.id}/references`],enabled:C,retry:!1}),{data:k}=B({queryKey:["/api/users"],enabled:b==="reassign"}),v=P({mutationFn:async c=>await _("POST",`/api/users/${x.id}/reassign`,{toUserId:c}),onSuccess:()=>{f("confirm"),j({title:"í˜„ìž¥ ìž¬ë°°ì • ì™„ë£Œ",description:"í˜„ìž¥ ë‹´ë‹¹ìžê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:c=>{j({title:"ìž¬ë°°ì • ì‹¤íŒ¨",description:c.message||"í˜„ìž¥ ìž¬ë°°ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),O=P({mutationFn:async()=>await _("DELETE",`/api/users/${x.id}`),onSuccess:()=>{Q.invalidateQueries({queryKey:["/api/users"]}),h(),N(),j({title:"ì‚¬ìš©ìž ì‚­ì œ ì™„ë£Œ",description:"ì‚¬ìš©ìžê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:c=>{j({title:"ì‚­ì œ ì‹¤íŒ¨",description:c.message||"ì‚¬ìš©ìž ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});Fs.useEffect(()=>{o&&!A&&(o.canDelete?f("confirm"):(o.references.orders.length>0,f("warning")))},[o,A]);const T=()=>{if(!a){j({title:"ë‹´ë‹¹ìž ì„ íƒ í•„ìš”",description:"ìƒˆë¡œìš´ ë‹´ë‹¹ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}v.mutate(a)},u=()=>{O.mutate()},q=k?.filter(c=>c.id!==x.id&&c.isActive)||[];return e.jsx(_e,{open:C,onOpenChange:N,children:e.jsxs(Ie,{className:"max-w-2xl",children:[e.jsxs(ze,{children:[e.jsxs(Ve,{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"h-5 w-5 text-amber-500"}),"ì‚¬ìš©ìž ì‚­ì œ"]}),e.jsx(Qe,{asChild:!0,children:e.jsxs("div",{className:"space-y-4",children:[b==="checking"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"ì‚¬ìš©ìž ì°¸ì¡° ê´€ê³„ë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]}),b==="warning"&&o&&e.jsx("div",{className:"space-y-4",children:o.references.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[x.name||x.email," ì‚¬ìš©ìžëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ps,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"font-medium text-red-800",children:["ìƒì„±í•œ ë°œì£¼ì„œ (",o.references.orders.length,"ê°œ)"]})]}),e.jsx("p",{className:"text-sm text-red-700 mb-2",children:"ë°œì£¼ì„œ ê¸°ë¡ì€ íšŒê³„ ë° ê°ì‚¬ë¥¼ ìœ„í•´ ìƒì„±ìž ì •ë³´ë¥¼ ë³´ì¡´í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsxs("div",{className:"bg-red-100 p-2 rounded text-xs text-red-800",children:[e.jsx("strong",{children:"ëŒ€ì•ˆ:"})," ì‚¬ìš©ìž ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì—­í• ì„ ë³€ê²½í•˜ì—¬ ì‹œìŠ¤í…œ ì ‘ê·¼ì„ ì œí•œí•˜ì„¸ìš”."]})]}),o.references.projects.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ve,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["ì—°ê²°ëœ í˜„ìž¥ (",o.references.projects.length,"ê°œ)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:o.references.projects.map(c=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:c.name}),e.jsx("span",{className:"text-blue-500",children:c.type==="project_manager"?"í˜„ìž¥ ê´€ë¦¬ìž":"í˜„ìž¥ ë©¤ë²„"})]},c.id))})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-amber-600 font-medium",children:[x.name||x.email," ì‚¬ìš©ìžëŠ” ë‹¤ìŒ í˜„ìž¥ê³¼ ì—°ê²°ë˜ì–´ ìžˆì–´ ë°”ë¡œ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:"]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ve,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["ì—°ê²°ëœ í˜„ìž¥ (",o.references.projects.length,"ê°œ)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:o.references.projects.map(c=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:c.name}),e.jsx("span",{className:"text-blue-500",children:c.type==="project_manager"?"í˜„ìž¥ ê´€ë¦¬ìž":"í˜„ìž¥ ë©¤ë²„"})]},c.id))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê³„ì† ì§„í–‰í•˜ë ¤ë©´ ë¨¼ì € í˜„ìž¥ ë‹´ë‹¹ìžë¥¼ ë‹¤ë¥¸ ì‚¬ìš©ìžì—ê²Œ ìž¬ë°°ì •í•´ì•¼ í•©ë‹ˆë‹¤."})]})}),b==="reassign"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"í˜„ìž¥ ë‹´ë‹¹ìžë¥¼ ìž¬ë°°ì •í•  ìƒˆë¡œìš´ ì‚¬ìš©ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"replacement-user",children:"ìƒˆë¡œìš´ ë‹´ë‹¹ìž"}),e.jsxs(re,{value:a,onValueChange:p,children:[e.jsx(ie,{children:e.jsx(ne,{placeholder:"ë‹´ë‹¹ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"})}),e.jsx(le,{children:q.map(c=>e.jsxs(H,{value:c.id,children:[c.name," (",c.email,") - ",c.role==="admin"?"ê´€ë¦¬ìž":c.role==="order_manager"?"ë°œì£¼ ë‹´ë‹¹ìž":"ì‚¬ìš©ìž"]},c.id))})]})]})]}),b==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[x.name||x.email," ì‚¬ìš©ìžë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‚¬ìš©ìžì˜ ëª¨ë“  ì •ë³´ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤."})]})]})})]}),e.jsxs(He,{children:[b==="warning"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:N,children:"ì·¨ì†Œ"}),o&&o.references.orders.length===0&&e.jsx(l,{onClick:()=>f("reassign"),children:"ìž¬ë°°ì • ì§„í–‰"})]}),b==="reassign"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:N,children:"ì·¨ì†Œ"}),e.jsx(l,{onClick:T,disabled:!a||v.isPending,children:v.isPending?"ìž¬ë°°ì • ì¤‘...":"ìž¬ë°°ì • í›„ ì‚­ì œ"})]}),b==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:N,children:"ì·¨ì†Œ"}),e.jsx(l,{variant:"destructive",onClick:u,disabled:O.isPending,children:O.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})})}const ia={admin:"ê´€ë¦¬ìž",executive:"ìž„ì›",hq_management:"ë³¸ì‚¬ ê´€ë¦¬ìž",project_manager:"í˜„ìž¥ ê´€ë¦¬ìž",field_worker:"í˜„ìž¥ ìž‘ì—…ìž"},ms=[{value:"admin",label:"ê´€ë¦¬ìž"},{value:"executive",label:"ìž„ì›"},{value:"hq_management",label:"ë³¸ì‚¬ ê´€ë¦¬ìž"},{value:"project_manager",label:"í˜„ìž¥ ê´€ë¦¬ìž"},{value:"field_worker",label:"í˜„ìž¥ ìž‘ì—…ìž"}];function na(){const{toast:x}=$e(),C=ps(),[N]=d.useState(1),[h,b]=d.useState(!1),[f,a]=d.useState(null),[p,j]=d.useState([]),[o,A]=d.useState({approvalMode:"direct",directApprovalRoles:[],skipLowerStages:!1}),[k,v]=d.useState({templateName:"",stepOrder:"",requiredRole:"",minAmount:"",maxAmount:"",canSkip:!1,isOptional:!1,description:""}),{data:O,isLoading:T}=B({queryKey:["workflow-settings",N],queryFn:async()=>{const t=await fetch(`/api/approval-settings/workflow-settings/${N}`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch workflow settings");return(await t.json()).data}}),{data:u=[],isLoading:q}=B({queryKey:["step-templates",N],queryFn:async()=>{const t=await fetch(`/api/approval-settings/step-templates/${N}`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch step templates");return(await t.json()).data}}),c=P({mutationFn:async t=>{const i=await fetch("/api/approval-settings/workflow-settings",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!i.ok){const m=await i.json();throw new Error(m.error||"Failed to update workflow settings")}return i.json()},onSuccess:()=>{C.invalidateQueries({queryKey:["workflow-settings"]}),x({title:"ì„±ê³µ",description:"ì›Œí¬í”Œë¡œ ì„¤ì •ì´ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:t=>{x({title:"ì˜¤ë¥˜",description:t.message,variant:"destructive"})}}),r=P({mutationFn:async t=>{const i=t.id?`/api/approval-settings/step-templates/${t.id}`:"/api/approval-settings/step-templates",m=t.id?"PUT":"POST",ue=await fetch(i,{method:m,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,stepOrder:parseInt(t.stepOrder),minAmount:t.minAmount,maxAmount:t.maxAmount||null})});if(!ue.ok){const ce=await ue.json();throw new Error(ce.error||"Failed to save template")}return ue.json()},onSuccess:()=>{C.invalidateQueries({queryKey:["step-templates"]}),b(!1),a(null),w(),x({title:"ì„±ê³µ",description:f?"í…œí”Œë¦¿ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"í…œí”Œë¦¿ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:t=>{x({title:"ì˜¤ë¥˜",description:t.message,variant:"destructive"})}}),n=P({mutationFn:async t=>{const i=await fetch(`/api/approval-settings/step-templates/${t}`,{method:"DELETE",credentials:"include"});if(!i.ok){const m=await i.json();throw new Error(m.error||"Failed to delete template")}return i.json()},onSuccess:()=>{C.invalidateQueries({queryKey:["step-templates"]}),x({title:"ì„±ê³µ",description:"í…œí”Œë¦¿ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:t=>{x({title:"ì˜¤ë¥˜",description:t.message,variant:"destructive"})}}),w=()=>{v({templateName:"",stepOrder:"",requiredRole:"",minAmount:"",maxAmount:"",canSkip:!1,isOptional:!1,description:""})},je=t=>{a(t),v({templateName:t.templateName,stepOrder:t.stepOrder.toString(),requiredRole:t.requiredRole,minAmount:t.minAmount,maxAmount:t.maxAmount||"",canSkip:t.canSkip,isOptional:t.isOptional,description:t.description||""}),b(!0)},Ne=t=>{A(i=>({...i,directApprovalRoles:i.directApprovalRoles.includes(t)?i.directApprovalRoles.filter(m=>m!==t):[...i.directApprovalRoles,t]}))},G=t=>{j(i=>i.includes(t)?i.filter(m=>m!==t):[...i,t])},J=u.reduce((t,i)=>(t[i.templateName]||(t[i.templateName]=[]),t[i.templateName].push(i),t),{});return Object.keys(J).forEach(t=>{J[t].sort((i,m)=>i.stepOrder-m.stepOrder)}),T||q?e.jsx(E,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(E,{className:"bg-blue-50 border-blue-200",children:[e.jsx(I,{children:e.jsxs(z,{className:"flex items-center space-x-2 text-blue-800",children:[e.jsx(ds,{className:"w-5 h-5"}),e.jsx("span",{children:"ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°ëž€?"})]})}),e.jsxs(D,{className:"text-sm text-blue-700 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"â€¢ ìŠ¹ì¸ ë°©ì‹ ì„ íƒ:"})}),e.jsxs("ul",{className:"ml-4 space-y-1",children:[e.jsxs("li",{children:["- ",e.jsx("strong",{children:"ì§ì ‘ ìŠ¹ì¸:"})," ë°œì£¼ì„œ ìƒì„± ì‹œ ìŠ¹ì¸ì ˆì°¨ ì—†ì´ ë°”ë¡œ ë°œì£¼ì„œê°€ ìƒì„±ë˜ëŠ” ë°©ì‹"]}),e.jsxs("li",{children:["- ",e.jsx("strong",{children:"ë‹¨ê³„ë³„ ìŠ¹ì¸:"})," í˜„ìž¥ ìž‘ì—…ìž â†’ í˜„ìž¥ ê´€ë¦¬ìž â†’ ìž„ì› ë“± ìˆœì°¨ì ìœ¼ë¡œ ìŠ¹ì¸í•˜ëŠ” ë°©ì‹"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"â€¢ ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿:"})}),e.jsxs("ul",{className:"ml-4 space-y-1",children:[e.jsx("li",{children:"- ë°œì£¼ ê¸ˆì•¡ì— ë”°ë¼ ë‹¤ë¥¸ ìŠ¹ì¸ ê²½ë¡œë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"}),e.jsx("li",{children:"- ì˜ˆ: 100ë§Œì› ë¯¸ë§Œì€ í˜„ìž¥ ê´€ë¦¬ìž ìŠ¹ì¸, 100ë§Œì› ì´ìƒì€ ìž„ì› ìŠ¹ì¸"}),e.jsx("li",{children:"- ê° ë‹¨ê³„ë³„ë¡œ ê±´ë„ˆë›°ê¸° í—ˆìš© ì—¬ë¶€, ì„ íƒì  ë‹¨ê³„ ì—¬ë¶€ë¥¼ ì„¤ì • ê°€ëŠ¥"})]})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsxs("p",{children:[e.jsx("strong",{children:"ðŸ’¡ ì‚¬ìš© íŒ:"})," ë¨¼ì € ê¸°ë³¸ ì›Œí¬í”Œë¡œ ì„¤ì •ì„ ì„ íƒí•˜ê³ , í•„ìš”ì— ë”°ë¼ ìƒì„¸í•œ ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿ì„ ì¶”ê°€í•˜ì„¸ìš”. í…œí”Œë¦¿ì€ ë°œì£¼ì„œ ìž‘ì„± ì‹œ ìžë™ìœ¼ë¡œ ì ìš©ë˜ì–´ ì ì ˆí•œ ìŠ¹ì¸ìžì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤."]})})]})]}),e.jsxs(E,{children:[e.jsxs(I,{children:[e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Es,{className:"w-5 h-5"}),e.jsx("span",{children:"ê¸°ë³¸ ì›Œí¬í”Œë¡œìš° ì„¤ì •"})]}),e.jsx(Me,{children:"íšŒì‚¬ì˜ ê¸°ë³¸ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° ë°©ì‹ì„ ì„¤ì •í•©ë‹ˆë‹¤."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"text-base font-semibold",children:"ìŠ¹ì¸ ëª¨ë“œ"}),e.jsxs(re,{value:o.approvalMode,onValueChange:t=>A(i=>({...i,approvalMode:t})),children:[e.jsx(ie,{children:e.jsx(ne,{})}),e.jsxs(le,{children:[e.jsx(H,{value:"direct",children:"ì§ì ‘ ìŠ¹ì¸"}),e.jsx(H,{value:"staged",children:"ë‹¨ê³„ë³„ ìŠ¹ì¸"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:o.approvalMode==="direct"?"ì§ì ‘ìŠ¹ì¸ ëª¨ë“œëŠ” ë°œì£¼ì„œ ìƒì„± ì‹œ, ìŠ¹ì¸ì ˆì°¨ ì—†ì´ ë°”ë¡œ ë°œì£¼ì„œê°€ ìƒì„±ì´ ë©ë‹ˆë‹¤.":"ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì³ ìˆœì°¨ì ìœ¼ë¡œ ìŠ¹ì¸í•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤."})]}),o.approvalMode==="direct"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"text-base font-semibold",children:"ì§ì ‘ ìŠ¹ì¸ ê°€ëŠ¥ ì—­í• "}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:ms.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:t.value,checked:o.directApprovalRoles.includes(t.value),onChange:()=>Ne(t.value),className:"rounded border-gray-300"}),e.jsx(g,{htmlFor:t.value,className:"text-sm",children:t.label})]},t.value))})]}),o.approvalMode==="staged"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-base font-semibold",children:"í•˜ìœ„ ë‹¨ê³„ ê±´ë„ˆë›°ê¸° í—ˆìš©"}),e.jsx(ge,{checked:o.skipLowerStages,onCheckedChange:t=>A(i=>({...i,skipLowerStages:t}))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ìƒìœ„ ê¶Œí•œìžê°€ í•˜ìœ„ ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›¸ ìˆ˜ ìžˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤."})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(l,{onClick:()=>c.mutate({...o,companyId:N}),disabled:c.isPending,children:c.isPending?"ì €ìž¥ ì¤‘...":"ì„¤ì • ì €ìž¥"})})]})]}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(z,{children:"ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿"}),e.jsx(Me,{children:"ë‹¨ê³„ë³„ ìŠ¹ì¸ì„ ìœ„í•œ í…œí”Œë¦¿ì„ ê´€ë¦¬í•©ë‹ˆë‹¤."})]}),e.jsxs(ee,{open:h,onOpenChange:b,children:[e.jsx(Ce,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>{w(),a(null)},children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"ìƒˆ í…œí”Œë¦¿ ë‹¨ê³„ ì¶”ê°€"]})}),e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(ae,{children:[e.jsx(te,{children:f?"ìŠ¹ì¸ ë‹¨ê³„ ìˆ˜ì •":"ìƒˆ ìŠ¹ì¸ ë‹¨ê³„ ì¶”ê°€"}),e.jsx(Re,{children:"ìŠ¹ì¸ ë‹¨ê³„ì˜ ìƒì„¸ ì •ë³´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤."})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),r.mutate({...k,companyId:N,id:f?.id})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"templateName",children:"í…œí”Œë¦¿ ì´ë¦„"}),e.jsx(S,{id:"templateName",value:k.templateName,onChange:t=>v(i=>({...i,templateName:t.target.value})),placeholder:"ì˜ˆ: ì¼ë°˜ë°œì£¼, ê³ ì•¡ë°œì£¼"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"stepOrder",children:"ë‹¨ê³„ ìˆœì„œ"}),e.jsx(S,{id:"stepOrder",type:"number",value:k.stepOrder,onChange:t=>v(i=>({...i,stepOrder:t.target.value})),placeholder:"1, 2, 3..."})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"requiredRole",children:"í•„ìš” ì—­í• "}),e.jsxs(re,{value:k.requiredRole,onValueChange:t=>v(i=>({...i,requiredRole:t})),children:[e.jsx(ie,{children:e.jsx(ne,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(le,{children:ms.map(t=>e.jsx(H,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"minAmount",children:"ìµœì†Œ ê¸ˆì•¡ (ì›)"}),e.jsx(S,{id:"minAmount",type:"number",value:k.minAmount,onChange:t=>v(i=>({...i,minAmount:t.target.value})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"maxAmount",children:"ìµœëŒ€ ê¸ˆì•¡ (ì›, ì„ íƒì‚¬í•­)"}),e.jsx(S,{id:"maxAmount",type:"number",value:k.maxAmount,onChange:t=>v(i=>({...i,maxAmount:t.target.value})),placeholder:"ì œí•œ ì—†ìŒ"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{checked:k.canSkip,onCheckedChange:t=>v(i=>({...i,canSkip:t}))}),e.jsx(g,{children:"ê±´ë„ˆë›°ê¸° í—ˆìš©"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{checked:k.isOptional,onCheckedChange:t=>v(i=>({...i,isOptional:t}))}),e.jsx(g,{children:"ì„ íƒì  ë‹¨ê³„"})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"description",children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(Ue,{id:"description",value:k.description,onChange:t=>v(i=>({...i,description:t.target.value})),placeholder:"ì´ ìŠ¹ì¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>b(!1),children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:r.isPending,children:r.isPending?f?"ìˆ˜ì • ì¤‘...":"ìƒì„± ì¤‘...":f?"ìˆ˜ì •":"ìƒì„±"})]})]})]})]})]})}),e.jsx(D,{children:Object.keys(J).length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"ì„¤ì •ëœ ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ í…œí”Œë¦¿ì„ ì¶”ê°€í•´ë³´ì„¸ìš”."}):e.jsx("div",{className:"space-y-4",children:Object.entries(J).map(([t,i])=>e.jsxs(E,{children:[e.jsx(I,{className:"cursor-pointer pb-3",onClick:()=>G(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center space-x-2 text-base",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx("span",{children:t}),e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[i.length,"ë‹¨ê³„"]})]}),p.includes(t)?e.jsx(js,{className:"w-4 h-4"}):e.jsx(Ds,{className:"w-4 h-4"})]})}),p.includes(t)&&e.jsx(D,{className:"pt-0",children:e.jsx("div",{className:"space-y-3",children:i.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(Z,{variant:"outline",className:"text-xs",children:["ë‹¨ê³„ ",m.stepOrder]}),e.jsx("span",{className:"font-medium text-sm",children:ia[m.requiredRole]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[parseFloat(m.minAmount).toLocaleString(),"ì›",m.maxAmount&&` ~ ${parseFloat(m.maxAmount).toLocaleString()}ì›`]}),m.canSkip&&e.jsx(Z,{variant:"secondary",className:"text-xs",children:"ê±´ë„ˆë›°ê¸° ê°€ëŠ¥"}),m.isOptional&&e.jsx(Z,{variant:"secondary",className:"text-xs",children:"ì„ íƒì "})]}),m.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:m.description})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>je(m),children:e.jsx(ye,{className:"w-3 h-3"})}),e.jsxs(_e,{children:[e.jsx(gs,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(ke,{className:"w-3 h-3"})})}),e.jsxs(Ie,{children:[e.jsxs(ze,{children:[e.jsx(Ve,{children:"í…œí”Œë¦¿ ë‹¨ê³„ ì‚­ì œ"}),e.jsx(Qe,{children:"ì´ ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs(He,{children:[e.jsx(ys,{children:"ì·¨ì†Œ"}),e.jsx(vs,{onClick:()=>n.mutate(m.id),disabled:n.isPending,className:"bg-red-600 hover:bg-red-700",children:n.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})]})]},m.id))})})]},t))})})]})]})}const Le={admin:"ê´€ë¦¬ìž",executive:"ìž„ì›",hq_management:"ë³¸ì‚¬ ê´€ë¦¬ìž",project_manager:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €",field_worker:"í˜„ìž¥ ìž‘ì—…ìž"},hs=[{value:"admin",label:"ê´€ë¦¬ìž"},{value:"executive",label:"ìž„ì›"},{value:"hq_management",label:"ë³¸ì‚¬ ê´€ë¦¬ìž"},{value:"project_manager",label:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €"},{value:"field_worker",label:"í˜„ìž¥ ìž‘ì—…ìž"}];function la({companyId:x}){const{toast:C}=$e(),N=ps(),[h,b]=d.useState(!1),[f,a]=d.useState(null),[p,j]=d.useState({role:"",maxAmount:"",description:""}),{data:o=[],isLoading:A,error:k}=B({queryKey:["approval-authorities"],queryFn:async()=>{const r=await fetch("/api/approval-authorities",{credentials:"include"});if(!r.ok)throw new Error("Failed to fetch approval authorities");return r.json()}}),v=P({mutationFn:async r=>{const n=await fetch("/api/approval-authorities",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({role:r.role,maxAmount:r.maxAmount,description:r.description,isActive:!0})});if(!n.ok){const w=await n.json();throw new Error(w.message||"Failed to create approval authority")}return n.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["approval-authorities"]}),b(!1),u(),C({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{C({title:"ì˜¤ë¥˜",description:r.message,variant:"destructive"})}}),O=P({mutationFn:async r=>{const n=await fetch(`/api/approval-authorities/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({role:r.role,maxAmount:r.maxAmount,description:r.description,isActive:!0})});if(!n.ok){const w=await n.json();throw new Error(w.message||"Failed to update approval authority")}return n.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["approval-authorities"]}),a(null),u(),C({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{C({title:"ì˜¤ë¥˜",description:r.message,variant:"destructive"})}}),T=P({mutationFn:async r=>{const n=await fetch(`/api/approval-authorities/${r}`,{method:"DELETE",credentials:"include"});if(!n.ok){const w=await n.json();throw new Error(w.message||"Failed to delete approval authority")}return n.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["approval-authorities"]}),C({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{C({title:"ì˜¤ë¥˜",description:r.message,variant:"destructive"})}}),u=()=>{j({role:"",maxAmount:"",description:""})},q=r=>{a(r),j({role:r.role,maxAmount:r.maxAmount.toString(),description:r.description||""})},c=r=>{if(r.preventDefault(),!p.role||!p.maxAmount){C({title:"ì˜¤ë¥˜",description:"ì—­í• ê³¼ ìŠ¹ì¸ í•œë„ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}f?O.mutate({id:f.id,...p}):v.mutate(p)};return A?e.jsx(E,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})}):k?e.jsx(E,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"text-center text-red-600",children:"ìŠ¹ì¸ ê¶Œí•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ìŠ¹ì¸ ê¶Œí•œ ê´€ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì‚¬ìš©ìž ì—­í• ë³„ ìŠ¹ì¸ ê¶Œí•œê³¼ í•œë„ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤"})]}),e.jsxs(ee,{open:h,onOpenChange:b,children:[e.jsx(Ce,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>{u(),a(null)},children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"ìƒˆ ê¶Œí•œ ì¶”ê°€"]})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"ìŠ¹ì¸ ê¶Œí•œ ì¶”ê°€"}),e.jsx(Re,{children:"ìƒˆë¡œìš´ ì—­í• ì˜ ìŠ¹ì¸ ê¶Œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤."})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"role",children:"ì—­í• "}),e.jsxs(re,{value:p.role,onValueChange:r=>j(n=>({...n,role:r})),children:[e.jsx(ie,{children:e.jsx(ne,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(le,{children:hs.map(r=>e.jsx(H,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"maxAmount",children:"ìŠ¹ì¸ í•œë„ (ì›)"}),e.jsx(S,{id:"maxAmount",type:"number",value:p.maxAmount,onChange:r=>j(n=>({...n,maxAmount:r.target.value})),placeholder:"ìŠ¹ì¸ ê°€ëŠ¥í•œ ìµœëŒ€ ê¸ˆì•¡"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"description",children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(Ue,{id:"description",value:p.description,onChange:r=>j(n=>({...n,description:r.target.value})),placeholder:"ìŠ¹ì¸ ê¶Œí•œì— ëŒ€í•œ ì„¤ëª…",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>b(!1),children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:v.isPending,children:v.isPending?"ìƒì„± ì¤‘...":"ìƒì„±"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"ì´ ê¶Œí•œ ìˆ˜"}),e.jsx(us,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.length})})]}),e.jsxs(E,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"í™œì„± ê¶Œí•œ"}),e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.filter(r=>r.isActive).length})})]}),e.jsxs(E,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"ìµœê³  í•œë„"}),e.jsx(Js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.length>0?`${Math.max(...o.map(r=>r.maxAmount)).toLocaleString()}ì›`:"0ì›"})})]})]}),e.jsxs(E,{children:[e.jsxs(I,{children:[e.jsx(z,{className:"text-base",children:"ìŠ¹ì¸ ê¶Œí•œ ëª©ë¡"}),e.jsx(Me,{className:"text-sm",children:"ê° ì—­í• ë³„ë¡œ ì„¤ì •ëœ ìŠ¹ì¸ ê¶Œí•œê³¼ í•œë„ë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsx(D,{children:o.length>0?e.jsx("div",{className:"space-y-3",children:o.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Z,{variant:r.isActive?"default":"secondary",children:Le[r.role]||r.role}),e.jsxs("div",{className:"font-semibold",children:[r.maxAmount.toLocaleString(),"ì›"]}),!r.isActive&&e.jsx(Z,{variant:"outline",children:"ë¹„í™œì„±"})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ìƒì„±ì¼: ",new Date(r.createdAt).toLocaleDateString("ko-KR")]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(ee,{children:[e.jsx(Ce,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",onClick:()=>q(r),children:e.jsx(ye,{className:"w-4 h-4"})})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"ìŠ¹ì¸ ê¶Œí•œ ìˆ˜ì •"}),e.jsxs(Re,{children:[Le[r.role]," ì—­í• ì˜ ìŠ¹ì¸ ê¶Œí•œì„ ìˆ˜ì •í•©ë‹ˆë‹¤."]})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"edit-role",children:"ì—­í• "}),e.jsxs(re,{value:p.role,onValueChange:n=>j(w=>({...w,role:n})),children:[e.jsx(ie,{children:e.jsx(ne,{})}),e.jsx(le,{children:hs.map(n=>e.jsx(H,{value:n.value,children:n.label},n.value))})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"edit-maxAmount",children:"ìŠ¹ì¸ í•œë„ (ì›)"}),e.jsx(S,{id:"edit-maxAmount",type:"number",value:p.maxAmount,onChange:n=>j(w=>({...w,maxAmount:n.target.value}))})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"edit-description",children:"ì„¤ëª…"}),e.jsx(Ue,{id:"edit-description",value:p.description,onChange:n=>j(w=>({...w,description:n.target.value})),rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(Ce,{asChild:!0,children:e.jsx(l,{type:"button",variant:"outline",children:"ì·¨ì†Œ"})}),e.jsx(l,{type:"submit",disabled:O.isPending,children:O.isPending?"ìˆ˜ì • ì¤‘...":"ìˆ˜ì •"})]})]})]})]}),e.jsxs(_e,{children:[e.jsx(gs,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(ke,{className:"w-4 h-4"})})}),e.jsxs(Ie,{children:[e.jsxs(ze,{children:[e.jsx(Ve,{children:"ìŠ¹ì¸ ê¶Œí•œ ì‚­ì œ"}),e.jsxs(Qe,{children:[Le[r.role]," ì—­í• ì˜ ìŠ¹ì¸ ê¶Œí•œì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs(He,{children:[e.jsx(ys,{children:"ì·¨ì†Œ"}),e.jsx(vs,{onClick:()=>T.mutate(r.id),disabled:T.isPending,className:"bg-red-600 hover:bg-red-700",children:T.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})]})]},r.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"ì„¤ì •ëœ ìŠ¹ì¸ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ê¶Œí•œì„ ì¶”ê°€í•´ë³´ì„¸ìš”."})})]})]})}const ca=y.object({smtpHost:y.string().min(1,"SMTP í˜¸ìŠ¤íŠ¸ëŠ” í•„ìˆ˜ìž…ë‹ˆë‹¤"),smtpPort:y.string().regex(/^\d+$/,"í¬íŠ¸ëŠ” ìˆ«ìžì—¬ì•¼ í•©ë‹ˆë‹¤"),smtpUser:y.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤"),smtpPass:y.string().min(1,"ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ìž…ë‹ˆë‹¤")});function oa(){const[x,C]=d.useState(!1),[N,h]=d.useState(""),[b,f]=d.useState(""),[a,p]=d.useState(""),{register:j,handleSubmit:o,formState:{errors:A},reset:k}=we({resolver:Se(ca)}),{data:v,isLoading:O}=B({queryKey:["emailSettings"],queryFn:async()=>{const r=await fetch("/api/email-settings",{credentials:"include"});if(!r.ok)throw new Error("ì„¤ì •ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤");return(await r.json()).data}}),T=P({mutationFn:async r=>{const n=await fetch("/api/email-settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});if(!n.ok){const w=await n.json();throw new Error(w.message||"ì„¤ì • ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}return n.json()},onSuccess:r=>{f(r.message||"ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤"),p(""),setTimeout(()=>f(""),5e3)},onError:r=>{p(r.message),f("")}}),u=P({mutationFn:async r=>{const n=await fetch("/api/email-settings/test",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({testEmail:r})});if(!n.ok){const w=await n.json();throw new Error(w.message||"í…ŒìŠ¤íŠ¸ ì´ë©”ì¼ ë°œì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}return n.json()},onSuccess:()=>{C(!1),f("í…ŒìŠ¤íŠ¸ ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"),h(""),setTimeout(()=>f(""),5e3)},onError:r=>{p(r.message)}});d.useEffect(()=>{v&&k(v)},[v,k]);const q=r=>{T.mutate(r)},c=()=>{if(!N||!y.string().email().safeParse(N).success){p("ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”");return}u.mutate(N)};return O?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Fe,{className:"h-8 w-8 animate-spin"})}):e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"ì´ë©”ì¼ ë°œì†¡ ì„¤ì •"]})}),e.jsxs(D,{children:[e.jsxs("form",{onSubmit:o(q),className:"space-y-4",children:[b&&e.jsx(Pe,{className:"bg-green-50 border-green-200",children:e.jsx(Ee,{className:"text-green-800",children:b})}),a&&e.jsx(Pe,{className:"bg-red-50 border-red-200",children:e.jsx(Ee,{className:"text-red-800",children:a})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{htmlFor:"smtpHost",children:[e.jsx(sa,{className:"inline h-4 w-4 mr-1"}),"SMTP ì„œë²„"]}),e.jsx(S,{id:"smtpHost",...j("smtpHost"),placeholder:"smtp.naver.com"}),A.smtpHost&&e.jsx("span",{className:"text-red-500 text-sm",children:A.smtpHost.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"smtpPort",children:"í¬íŠ¸"}),e.jsx(S,{id:"smtpPort",...j("smtpPort"),placeholder:"587"}),A.smtpPort&&e.jsx("span",{className:"text-red-500 text-sm",children:A.smtpPort.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{htmlFor:"smtpUser",children:[e.jsx(he,{className:"inline h-4 w-4 mr-1"}),"ë°œì†¡ìž ì´ë©”ì¼"]}),e.jsx(S,{id:"smtpUser",type:"email",...j("smtpUser"),placeholder:"example@naver.com"}),A.smtpUser&&e.jsx("span",{className:"text-red-500 text-sm",children:A.smtpUser.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{htmlFor:"smtpPass",children:[e.jsx(ea,{className:"inline h-4 w-4 mr-1"}),"ì•± ë¹„ë°€ë²ˆí˜¸"]}),e.jsx(S,{id:"smtpPass",type:"password",...j("smtpPass"),placeholder:"ì•± ë¹„ë°€ë²ˆí˜¸ ìž…ë ¥"}),A.smtpPass&&e.jsx("span",{className:"text-red-500 text-sm",children:A.smtpPass.message})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"ì„¤ì • ì•ˆë‚´"}),e.jsxs("ul",{className:"space-y-1 text-sm text-blue-800",children:[e.jsx("li",{children:"â€¢ Naver ë©”ì¼: smtp.naver.com (í¬íŠ¸ 587)"}),e.jsx("li",{children:"â€¢ Gmail: smtp.gmail.com (í¬íŠ¸ 587)"}),e.jsx("li",{children:"â€¢ ì•± ë¹„ë°€ë²ˆí˜¸ëŠ” 2ë‹¨ê³„ ì¸ì¦ í›„ ìƒì„± í•„ìš”"}),e.jsx("li",{children:"â€¢ Naver: ë©”ì¼ ì„¤ì •ì—ì„œ POP3/SMTP ì‚¬ìš© í™œì„±í™” í•„ìš”"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(l,{type:"button",variant:"outline",onClick:()=>C(!0),disabled:T.isPending,children:[e.jsx(ta,{className:"h-4 w-4 mr-2"}),"í…ŒìŠ¤íŠ¸"]}),e.jsxs(l,{type:"submit",disabled:T.isPending,children:[T.isPending?e.jsx(Fe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"ì €ìž¥"]})]})]}),e.jsx(ee,{open:x,onOpenChange:C,children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsx(te,{children:"ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"testEmail",children:"í…ŒìŠ¤íŠ¸ ìˆ˜ì‹  ì´ë©”ì¼"}),e.jsx(S,{id:"testEmail",type:"email",value:N,onChange:r=>h(r.target.value),placeholder:"test@example.com"})]}),a&&e.jsx(Pe,{className:"bg-red-50 border-red-200",children:e.jsx(Ee,{className:"text-red-800",children:a})})]}),e.jsxs(zs,{children:[e.jsx(l,{variant:"outline",onClick:()=>C(!1),disabled:u.isPending,children:"ì·¨ì†Œ"}),e.jsxs(l,{onClick:c,disabled:u.isPending,children:[u.isPending?e.jsx(Fe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(he,{className:"h-4 w-4 mr-2"}),"ë°œì†¡"]})]})]})})]})]})}const da=y.object({companyName:y.string().min(1,"íšŒì‚¬ëª…ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”"),businessNumber:y.string().min(1,"ì‚¬ì—…ìžë“±ë¡ë²ˆí˜¸ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),address:y.string().min(1,"ì£¼ì†Œë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),phone:y.string().min(1,"ì „í™”ë²ˆí˜¸ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),fax:y.string().optional(),email:y.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”").optional().or(y.literal("")),website:y.string().optional(),representative:y.string().min(1,"ëŒ€í‘œìžëª…ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”")}),xa=y.object({name:y.string().min(1,"ì´ë¦„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”"),email:y.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”"),phoneNumber:y.string().min(1,"ì „í™”ë²ˆí˜¸ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),role:y.enum(["field_worker","project_manager","hq_management","executive","admin"])}),ma=y.object({role:y.enum(["field_worker","project_manager","hq_management","executive"]),maxAmount:y.number().min(0,"ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤"),description:y.string().optional()});function Da(){const{user:x,isAuthenticated:C,isLoading:N}=qs(),{toast:h}=$e(),[,b]=Os(),{theme:f}=Ls(),a=f==="dark",[p,j]=d.useState(!1);d.useState(null);const[o,A]=d.useState("company"),[k,v]=d.useState(""),[O,T]=d.useState(!1),[u,q]=d.useState(null),[c,r]=d.useState(!1),[n,w]=d.useState(null);d.useState(null);const[je,Ne]=d.useState("list"),[G,J]=d.useState(null),[t,i]=d.useState(""),[m,ue]=d.useState(null),[ce,Be]=d.useState("asc"),{data:Je=[],isLoading:bs}=B({queryKey:["/api/users"],enabled:!!x&&x.role==="admin"}),{data:fs=[],isLoading:ha}=B({queryKey:["/api/companies"],enabled:!!x&&x.role==="admin"});B({queryKey:["/api/approval-authorities"],enabled:!!x&&x.role==="admin"});const{data:Ae=[],isLoading:ws}=B({queryKey:["/api/admin/pending-registrations"],enabled:!!x&&x.role==="admin"}),$=fs[0],W=we({resolver:Se(da),defaultValues:{companyName:"",businessNumber:"",address:"",phone:"",fax:"",email:"",website:"",representative:""}}),V=we({resolver:Se(xa),defaultValues:{name:"",email:"",phoneNumber:"",role:"field_worker"}}),X=we({resolver:Se(ma),defaultValues:{role:"field_worker",maxAmount:0,description:""}});if(d.useEffect(()=>{$&&!p&&(console.log("ðŸ”„ Resetting company form with data:",$),W.reset({companyName:$.companyName||"",businessNumber:$.businessNumber||"",address:$.address||"",phone:$.phone||"",fax:$.fax||"",email:$.email||"",website:$.website||"",representative:$.representative||""}))},[$,W,p]),d.useEffect(()=>{u&&V.reset({name:u.name||"",email:u.email||"",phoneNumber:u.phoneNumber||"",role:u.role||"field_worker"})},[u,V]),N)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:"ë¡œë”© ì¤‘..."});if(!C||!x||x.role!=="admin")return b("/login"),null;const We=Je.filter(s=>(s.name?.toLowerCase()||"").includes(k.toLowerCase())||(s.email?.toLowerCase()||"").includes(k.toLowerCase())||(s.phoneNumber?.toLowerCase()||"").includes(k.toLowerCase())).sort((s,F)=>{if(!m)return 0;const Y=s[m]??"",ts=F[m]??"";return ce==="asc"?String(Y).localeCompare(String(ts)):String(ts).localeCompare(String(Y))}),Ge=P({mutationFn:s=>(console.log("ðŸš€ Saving company data:",s),$?(console.log("ðŸ“ Updating existing company ID:",$.id),_("PUT",`/api/companies/${$.id}`,s)):(console.log("âž• Creating new company"),_("POST","/api/companies",s))),onSuccess:s=>{console.log("âœ… Company save successful:",s),h({title:"ì„±ê³µ",description:"íšŒì‚¬ ì •ë³´ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤."}),j(!1),setTimeout(()=>{Q.invalidateQueries({queryKey:["/api/companies"]})},100)},onError:s=>{console.error("âŒ Company save failed:",s),h({title:"ì˜¤ë¥˜",description:"íšŒì‚¬ ì •ë³´ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Xe=P({mutationFn:s=>u?_("PUT",`/api/users/${u.id}`,s):_("POST","/api/users",s),onSuccess:()=>{h({title:"ì„±ê³µ",description:u?"ì‚¬ìš©ìžê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"ì‚¬ìš©ìžê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."}),Q.invalidateQueries({queryKey:["/api/users"]}),T(!1),q(null),V.reset()},onError:()=>{h({title:"ì˜¤ë¥˜",description:"ì‚¬ìš©ìž ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Ye=P({mutationFn:({userId:s,isActive:F})=>_("PATCH",`/api/users/${s}/toggle-active`,{isActive:F}),onSuccess:()=>{h({title:"ì„±ê³µ",description:"ì‚¬ìš©ìž ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."}),Q.invalidateQueries({queryKey:["/api/users"]})},onError:()=>{h({title:"ì˜¤ë¥˜",description:"ì‚¬ìš©ìž ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Ze=P({mutationFn:s=>s.id?_("PUT",`/api/approval-authorities/${s.id}`,s):_("POST","/api/approval-authorities",s),onSuccess:()=>{h({title:"ì„±ê³µ",description:n?"ìŠ¹ì¸ ê¶Œí•œì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"ìŠ¹ì¸ ê¶Œí•œì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."}),Q.invalidateQueries({queryKey:["/api/approval-authorities"]}),r(!1),w(null),X.reset()},onError:()=>{h({title:"ì˜¤ë¥˜",description:"ìŠ¹ì¸ ê¶Œí•œ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});P({mutationFn:s=>_("DELETE",`/api/approval-authorities/${s}`),onSuccess:()=>{h({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),Q.invalidateQueries({queryKey:["/api/approval-authorities"]})},onError:()=>{h({title:"ì˜¤ë¥˜",description:"ìŠ¹ì¸ ê¶Œí•œ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});const es=P({mutationFn:s=>_("POST",`/api/admin/approve-registration/${s}`),onSuccess:()=>{h({title:"ì„±ê³µ",description:"ê°€ìž… ì‹ ì²­ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),Q.invalidateQueries({queryKey:["/api/admin/pending-registrations"]}),Q.invalidateQueries({queryKey:["/api/users"]})},onError:()=>{h({title:"ì˜¤ë¥˜",description:"ê°€ìž… ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Te=P({mutationFn:({id:s,reason:F})=>_("POST",`/api/admin/reject-registration/${s}`,{reason:F}),onSuccess:()=>{h({title:"ì„±ê³µ",description:"ê°€ìž… ì‹ ì²­ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤."}),Q.invalidateQueries({queryKey:["/api/admin/pending-registrations"]}),J(null),i("")},onError:()=>{h({title:"ì˜¤ë¥˜",description:"ê°€ìž… ê±°ë¶€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Ss=s=>{Ge.mutate(s)},Cs=s=>{Xe.mutate(s)},ks=s=>{const F=n?{...s,id:n.id}:s;Ze.mutate(F)},ss=s=>{m===s?Be(ce==="asc"?"desc":"asc"):(ue(s),Be("asc"))},as=(s,F,Y)=>F!==s?null:Y==="asc"?e.jsx(Ks,{className:"h-3 w-3"}):e.jsx(js,{className:"h-3 w-3"}),$s=s=>{switch(s){case"pending":return e.jsx(Is,{className:"h-4 w-4 text-yellow-600"});case"approved":return e.jsx(is,{className:"h-4 w-4 text-green-600"});case"rejected":return e.jsx(ns,{className:"h-4 w-4 text-red-600"});default:return e.jsx(_s,{className:"h-4 w-4 text-gray-600"})}},As=s=>{switch(s){case"pending":return"ëŒ€ê¸° ì¤‘";case"approved":return"ìŠ¹ì¸ë¨";case"rejected":return"ê±°ë¶€ë¨";default:return"ì•Œ ìˆ˜ ì—†ìŒ"}},Ts=s=>{switch(s){case"pending":return"default";case"approved":return"secondary";case"rejected":return"destructive";default:return"default"}};return e.jsx("div",{className:"min-h-screen",style:{backgroundColor:a?"#111827":"#f9fafb"},children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${a?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(us,{className:`h-6 w-6 transition-colors ${a?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${a?"text-white":"text-gray-900"}`,children:"ì‹œìŠ¤í…œ ê´€ë¦¬"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì‚¬ìš©ìž ë° ì‹œìŠ¤í…œ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”"})]})]})})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs(Ms,{value:o,onValueChange:A,className:"w-full",children:[e.jsxs(Rs,{className:`grid w-full grid-cols-7 transition-colors ${a?"bg-gray-700":"bg-gray-100"}`,children:[e.jsxs(oe,{value:"company",className:"flex items-center gap-2 text-sm",children:[e.jsx(rs,{className:"h-4 w-4"}),"íšŒì‚¬ ì •ë³´"]}),e.jsxs(oe,{value:"users",className:"flex items-center gap-2 text-sm",children:[e.jsx(ve,{className:"h-4 w-4"}),"ì‚¬ìš©ìž ê´€ë¦¬"]}),e.jsxs(oe,{value:"registrations",className:"flex items-center gap-2 text-sm",children:[e.jsx(De,{className:"h-4 w-4"}),"ê°€ìž… ì‹ ì²­"]}),e.jsxs(oe,{value:"approval",className:"flex items-center gap-2 text-sm",children:[e.jsx(ra,{className:"h-4 w-4"}),"ìŠ¹ì¸ ê¶Œí•œ"]}),e.jsxs(oe,{value:"workflow",className:"flex items-center gap-2 text-sm",children:[e.jsx(aa,{className:"h-4 w-4"}),"ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°"]}),e.jsxs(oe,{value:"email",className:"flex items-center gap-2 text-sm",children:[e.jsx(he,{className:"h-4 w-4"}),"ì´ë©”ì¼ ì„¤ì •"]})]}),e.jsx(de,{value:"company",className:"mt-2",children:e.jsxs(E,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(I,{className:"pb-1",children:e.jsxs(z,{className:`flex items-center justify-between text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(rs,{className:`h-4 w-4 transition-colors ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"íšŒì‚¬ ì •ë³´"})]}),!p&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{console.log("âœï¸ Starting company edit mode"),j(!0)},className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(ye,{className:"h-3 w-3"}),"ìˆ˜ì •"]})]})}),e.jsx(D,{className:"pt-1",children:p?e.jsx(qe,{...W,children:e.jsxs("form",{onSubmit:W.handleSubmit(Ss),className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(L,{control:W.control,name:"companyName",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"íšŒì‚¬ëª…"}),e.jsx(U,{children:e.jsx(S,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:W.control,name:"businessNumber",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì‚¬ì—…ìžë“±ë¡ë²ˆí˜¸"}),e.jsx(U,{children:e.jsx(S,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:W.control,name:"representative",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ëŒ€í‘œìž"}),e.jsx(U,{children:e.jsx(S,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:W.control,name:"phone",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì „í™”ë²ˆí˜¸"}),e.jsx(U,{children:e.jsx(S,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:W.control,name:"address",render:({field:s})=>e.jsxs(M,{className:"col-span-2",children:[e.jsx(R,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì£¼ì†Œ"}),e.jsx(U,{children:e.jsx(S,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(l,{type:"submit",size:"sm",disabled:Ge.isPending,className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(Ns,{className:"h-3 w-3"}),"ì €ìž¥"]}),e.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:()=>j(!1),className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(Us,{className:"h-3 w-3"}),"ì·¨ì†Œ"]})]})]})}):e.jsx("div",{className:"space-y-3",children:$?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"íšŒì‚¬ëª…:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:$.companyName})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[80px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:$.businessNumber})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ëŒ€í‘œìž:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:$.representative})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ì „í™”ë²ˆí˜¸:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:$.phone})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded col-span-2 transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[40px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ì£¼ì†Œ:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:$.address})]})]}):e.jsx("div",{className:`text-xs text-center py-4 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"íšŒì‚¬ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì¶”ê°€í•´ì£¼ì„¸ìš”."})})})]})}),e.jsx(de,{value:"users",className:"mt-2",children:e.jsxs(E,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(I,{className:"pb-1",children:e.jsxs(z,{className:`flex items-center justify-between text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:`h-4 w-4 transition-colors ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"ì‚¬ìš©ìž ê´€ë¦¬"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center rounded p-1 transition-colors ${a?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx(l,{variant:je==="list"?"default":"ghost",size:"sm",onClick:()=>Ne("list"),className:"h-8 w-8 p-0",title:"ë¦¬ìŠ¤íŠ¸ ë³´ê¸°",children:e.jsx(Gs,{className:"h-4 w-4"})}),e.jsx(l,{variant:je==="card"?"default":"ghost",size:"sm",onClick:()=>Ne("card"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(Xs,{className:"h-4 w-4"})})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>T(!0),className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(Ke,{className:"h-3 w-3"}),"ì‚¬ìš©ìž ì¶”ê°€"]})]})]})}),e.jsx(D,{className:"pt-1",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ys,{className:`absolute left-2 top-1/2 transform -translate-y-1/2 h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx(S,{placeholder:"ì‚¬ìš©ìž ê²€ìƒ‰...",value:k,onChange:s=>v(s.target.value),className:`h-7 text-xs pl-7 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})]})}),bs?e.jsx("div",{className:`text-xs text-center py-4 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì‚¬ìš©ìž ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."}):je==="list"?e.jsxs(Vs,{children:[e.jsx(Qs,{children:e.jsxs(ls,{children:[e.jsx(xe,{className:`px-3 py-3 text-xs cursor-pointer transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>ss("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ì´ë¦„",as("name",m,ce)]})}),e.jsx(xe,{className:`px-3 py-3 text-xs cursor-pointer transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>ss("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ì´ë©”ì¼",as("email",m,ce)]})}),e.jsx(xe,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì—­í• "}),e.jsx(xe,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì—°ë½ì²˜"}),e.jsx(xe,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ìƒíƒœ"}),e.jsx(xe,{className:`px-3 py-3 text-xs text-center transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ìž‘ì—…"})]})}),e.jsx(Hs,{children:We.map(s=>e.jsxs(ls,{className:`transition-colors ${a?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsx(me,{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-6 w-6",children:e.jsx(fe,{className:"text-xs",children:s.name?.[0]||"U"})}),e.jsx("div",{className:`font-medium text-xs transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:s.name})]})}),e.jsx(me,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-300":"text-gray-900"}`,children:s.email}),e.jsx(me,{className:"px-3 py-3",children:e.jsx(Oe,{role:s.role})}),e.jsx(me,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-300":"text-gray-900"}`,children:s.phoneNumber}),e.jsx(me,{className:"px-3 py-3",children:e.jsx(ge,{checked:s.isActive??!0,onCheckedChange:F=>Ye.mutate({userId:s.id,isActive:F}),className:"h-4 w-7"})}),e.jsx(me,{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>q(s),className:`h-6 w-6 p-0 transition-colors ${a?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,title:"ìˆ˜ì •",children:e.jsx(ye,{className:"h-3 w-3"})}),e.jsx(xs,{user:s,onDeleteSuccess:()=>{Q.invalidateQueries({queryKey:["/api/users"]}),h({title:"ì„±ê³µ",description:"ì‚¬ìš©ìžê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},trigger:e.jsx(l,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 transition-colors ${a?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"ì‚­ì œ",children:e.jsx(ke,{className:"h-3 w-3"})})})]})})]},s.id))})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:We.map(s=>e.jsxs(E,{className:`p-3 shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(be,{className:"h-8 w-8",children:e.jsx(fe,{className:"text-sm",children:s.name?.[0]||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:s.name}),e.jsx(Oe,{role:s.role})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.phoneNumber})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:new Date(s.createdAt).toLocaleDateString("ko-KR")})]})]}),e.jsxs("div",{className:`flex items-center justify-between mt-3 pt-3 border-t transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[e.jsx(ge,{checked:s.isActive??!0,onCheckedChange:F=>Ye.mutate({userId:s.id,isActive:F}),className:"h-4 w-7"}),e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>q(s),className:`h-8 w-8 p-0 transition-colors ${a?"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:"ìˆ˜ì •",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(xs,{user:s,onDeleteSuccess:()=>{Q.invalidateQueries({queryKey:["/api/users"]}),h({title:"ì„±ê³µ",description:"ì‚¬ìš©ìžê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},trigger:e.jsx(l,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 transition-colors ${a?"hover:bg-red-900/20":"hover:bg-red-50"}`,title:"ì‚­ì œ",children:e.jsx(ke,{className:`h-4 w-4 transition-colors ${a?"text-red-400":"text-red-600"}`})})})]})]})]},s.id))}),e.jsxs("div",{className:`text-xs pt-1 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:["ì´ ",Je.length,"ëª…ì˜ ì‚¬ìš©ìžê°€ ë“±ë¡ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."]})]})})]})}),e.jsx(de,{value:"registrations",className:"mt-2",children:e.jsxs(E,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(I,{className:"pb-1",children:e.jsxs(z,{className:`flex items-center justify-between text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{className:`h-4 w-4 transition-colors ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"ê°€ìž… ì‹ ì²­ ê´€ë¦¬"})]}),e.jsxs(Z,{variant:"outline",className:"text-xs",children:[Ae.filter(s=>s.status==="pending").length,"ê°œ ëŒ€ê¸° ì¤‘"]})]})}),e.jsx(D,{className:"pt-1",children:ws?e.jsx("div",{className:`text-xs text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ê°€ìž… ì‹ ì²­ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."}):Ae.length===0?e.jsxs("div",{className:`text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[e.jsx(De,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"ê°€ìž… ì‹ ì²­ì´ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-xs mt-1",children:"ìƒˆë¡œìš´ ì‚¬ìš©ìž ê°€ìž… ì‹ ì²­ì´ ìžˆìœ¼ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."})]}):e.jsx("div",{className:"space-y-3",children:Ae.map(s=>e.jsx(E,{className:`p-4 border transition-colors ${a?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(be,{className:"h-10 w-10",children:e.jsx(fe,{className:"text-sm",children:s.name[0]})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-medium text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:s.name}),e.jsx(Oe,{role:s.role})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.phoneNumber})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zs,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsxs("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:["ID: ",s.userId]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:new Date(s.submittedAt).toLocaleString("ko-KR")})]})]}),s.rejectionReason&&e.jsxs("div",{className:`mt-2 p-2 rounded text-xs transition-colors ${a?"bg-red-900/20 border border-red-800 text-red-200":"bg-red-50 border border-red-200 text-red-700"}`,children:[e.jsx("strong",{children:"ê±°ë¶€ ì‚¬ìœ :"})," ",s.rejectionReason]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(Z,{variant:Ts(s.status),className:"text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",children:[$s(s.status),As(s.status)]})}),s.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(l,{size:"sm",onClick:()=>es.mutate(s.id),disabled:es.isPending,className:"h-7 px-2 text-xs gap-1",children:[e.jsx(is,{className:"h-3 w-3"}),"ìŠ¹ì¸"]}),e.jsxs(l,{variant:"destructive",size:"sm",onClick:()=>J(s),className:"h-7 px-2 text-xs gap-1",children:[e.jsx(ns,{className:"h-3 w-3"}),"ê±°ë¶€"]})]})]})]})},s.id))})})]})}),e.jsx(de,{value:"approval",className:"mt-2",children:e.jsx(la,{companyId:1})}),e.jsx(de,{value:"workflow",className:"mt-2",children:e.jsx(na,{})}),e.jsx(de,{value:"email",className:"mt-2",children:e.jsx(oa,{})})]})}),(O||u)&&e.jsx(ee,{open:!0,onOpenChange:()=>{T(!1),q(null),V.reset()},children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsx(te,{children:u?"ì‚¬ìš©ìž ìˆ˜ì •":"ì‚¬ìš©ìž ì¶”ê°€"})}),e.jsx(qe,{...V,children:e.jsxs("form",{onSubmit:V.handleSubmit(Cs),className:"space-y-4",children:[e.jsx(L,{control:V.control,name:"name",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ì´ë¦„"}),e.jsx(U,{children:e.jsx(S,{...s})}),e.jsx(K,{})]})}),e.jsx(L,{control:V.control,name:"email",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ì´ë©”ì¼"}),e.jsx(U,{children:e.jsx(S,{...s,type:"email"})}),e.jsx(K,{})]})}),e.jsx(L,{control:V.control,name:"phoneNumber",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ì „í™”ë²ˆí˜¸"}),e.jsx(U,{children:e.jsx(S,{...s})}),e.jsx(K,{})]})}),e.jsx(L,{control:V.control,name:"role",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ì—­í• "}),e.jsxs(re,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(U,{children:e.jsx(ie,{children:e.jsx(ne,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsx(le,{children:e.jsx(Ws,{children:F=>F.map(Y=>e.jsx(H,{value:Y.value,children:Y.label},Y.value))})})]}),e.jsx(K,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{T(!1),q(null),V.reset()},children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:Xe.isPending,children:u?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})}),(c||n)&&e.jsx(ee,{open:!0,onOpenChange:()=>{r(!1),w(null),X.reset()},children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsx(te,{children:n?"ìŠ¹ì¸ ê¶Œí•œ ìˆ˜ì •":"ìŠ¹ì¸ ê¶Œí•œ ì¶”ê°€"})}),e.jsx(qe,{...X,children:e.jsxs("form",{onSubmit:X.handleSubmit(ks),className:"space-y-4",children:[e.jsx(L,{control:X.control,name:"role",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ì—­í• "}),e.jsxs(re,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(U,{children:e.jsx(ie,{children:e.jsx(ne,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsxs(le,{children:[e.jsx(H,{value:"field_worker",children:"í˜„ìž¥ ì‹¤ë¬´ìž"}),e.jsx(H,{value:"project_manager",children:"í˜„ìž¥ ê´€ë¦¬ìž"}),e.jsx(H,{value:"hq_management",children:"ë³¸ì‚¬ ê´€ë¦¬ë¶€"}),e.jsx(H,{value:"executive",children:"ìž„ì›/ëŒ€í‘œ"})]})]}),e.jsx(K,{})]})}),e.jsx(L,{control:X.control,name:"maxAmount",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ìµœëŒ€ ìŠ¹ì¸ í•œë„ (ì›)"}),e.jsx(U,{children:e.jsx(S,{...s,type:"number",placeholder:"0",onChange:F=>s.onChange(parseInt(F.target.value)||0)})}),e.jsx(K,{})]})}),e.jsx(L,{control:X.control,name:"description",render:({field:s})=>e.jsxs(M,{children:[e.jsx(R,{children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(U,{children:e.jsx(S,{...s,placeholder:"ê¶Œí•œì— ëŒ€í•œ ì„¤ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(K,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{r(!1),w(null),X.reset()},children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:Ze.isPending,children:n?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})}),G&&e.jsx(ee,{open:!0,onOpenChange:()=>{J(null),i("")},children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsx(te,{children:"ê°€ìž… ì‹ ì²­ ê±°ë¶€"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded border transition-colors ${a?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(be,{className:"h-8 w-8",children:e.jsx(fe,{className:"text-sm",children:G.name[0]})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-medium text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:G.name}),e.jsx("p",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:G.email})]})]})}),e.jsxs("div",{children:[e.jsx(g,{className:`text-sm transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ê±°ë¶€ ì‚¬ìœ  *"}),e.jsx("textarea",{value:t,onChange:s=>i(s.target.value),placeholder:"ê°€ìž… ì‹ ì²­ì„ ê±°ë¶€í•˜ëŠ” ì´ìœ ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”...",className:`w-full mt-1 p-2 text-sm rounded border transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300 placeholder:text-gray-500"}`,rows:4})]}),e.jsx("div",{className:`p-3 rounded border transition-colors ${a?"bg-yellow-900/20 border-yellow-800":"bg-yellow-50 border-yellow-200"}`,children:e.jsxs("p",{className:`text-xs transition-colors ${a?"text-yellow-200":"text-yellow-800"}`,children:[e.jsx("strong",{children:"ì£¼ì˜:"})," ê±°ë¶€ëœ ê°€ìž… ì‹ ì²­ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©°, ì‹ ì²­ìžì—ê²Œ ê±°ë¶€ ì‚¬ìœ ê°€ í¬í•¨ëœ ì´ë©”ì¼ì´ ë°œì†¡ë©ë‹ˆë‹¤."]})})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(l,{variant:"outline",onClick:()=>{J(null),i("")},children:"ì·¨ì†Œ"}),e.jsx(l,{variant:"destructive",onClick:()=>{G&&t.trim()&&Te.mutate({id:G.id,reason:t.trim()})},disabled:!t.trim()||Te.isPending,children:Te.isPending?"ì²˜ë¦¬ ì¤‘...":"ê±°ë¶€"})]})]})})]})})}export{Da as default};
