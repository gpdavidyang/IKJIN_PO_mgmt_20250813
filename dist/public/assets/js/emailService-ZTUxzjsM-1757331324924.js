import{k as c}from"./index-DXJvUTRh-1757331324924.js";const i=class i{static async sendPurchaseOrderEmailOriginalFormat(e,t){try{return{success:!0,messageId:(await c("POST",`${this.BASE_URL}/send-email-original-format`,{filePath:e,...t})).data?.messageId}}catch(s){return console.error("ì›ë³¸ í˜•ì‹ ìœ ì§€ ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",s),{success:!1,error:s instanceof Error?s.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static async sendPurchaseOrderEmail(e,t){if(e.filePath){const s={to:t.to,cc:t.cc,subject:t.subject,additionalMessage:t.message,poData:{orderNumber:e.orderNumber,orderDate:e.orderDate,siteName:e.siteName,vendorName:e.vendorName,totalAmount:e.totalAmount}};s.attachments=[],e.attachmentUrls&&e.attachmentUrls.length>0&&(s.attachments=e.attachmentUrls.map((r,o)=>({path:r,filename:`ì²¨ë¶€íŒŒì¼_${e.orderNumber}_${o+1}`})));try{return await c("POST",`${this.BASE_URL}/send-email`,s)}catch(r){throw console.error("Email send error:",r),new Error("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}try{if(t.customFiles&&t.customFiles.length>0){console.log("ğŸ“ ì‚¬ìš©ì ì—…ë¡œë“œ íŒŒì¼ í¬í•¨:",t.customFiles.length);const s=new FormData;s.append("orderData",JSON.stringify({orderId:e.orderId,orderNumber:e.orderNumber,vendorName:e.vendorName,orderDate:e.orderDate,totalAmount:e.totalAmount,siteName:e.siteName})),s.append("to",JSON.stringify(t.to)),t.cc&&t.cc.length>0&&s.append("cc",JSON.stringify(t.cc)),s.append("subject",t.subject),t.message&&s.append("message",t.message),s.append("selectedAttachmentIds",JSON.stringify(t.selectedAttachmentIds)),e.attachmentUrls&&e.attachmentUrls.length>0&&(s.append("attachmentUrls",JSON.stringify(e.attachmentUrls)),console.log("ğŸ“ ì²¨ë¶€íŒŒì¼ URL ì¶”ê°€:",e.attachmentUrls)),t.customFiles.forEach((n,a)=>{s.append("customFiles",n),console.log(`ğŸ“ ì‚¬ìš©ì íŒŒì¼ ì¶”ê°€: ${n.name} (${n.size} bytes)`)});const r=await fetch("/api/orders/send-email-with-files",{method:"POST",body:s,credentials:"include"});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.error||`HTTP ${r.status}: ${r.statusText}`)}return{success:!0,messageId:(await r.json()).messageId}}else{const s={orderData:{orderId:e.orderId,orderNumber:e.orderNumber,vendorName:e.vendorName,orderDate:e.orderDate,totalAmount:e.totalAmount,siteName:e.siteName},to:t.to,cc:t.cc,subject:t.subject,message:t.message,selectedAttachmentIds:t.selectedAttachmentIds,attachmentUrls:e.attachmentUrls,emailSettings:{subject:t.subject,message:t.message,cc:t.cc}};return e.attachmentUrls&&e.attachmentUrls.length>0&&console.log("ğŸ“ ì²¨ë¶€íŒŒì¼ URL ì¶”ê°€:",e.attachmentUrls),console.log("ğŸ“§ ì´ë©”ì¼ API ìš”ì²­ ë°ì´í„° (JSON):",s),{success:!0,messageId:(await c("POST","/api/orders/send-email",s)).messageId}}}catch(s){throw console.error("Email send error:",s),new Error("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async testEmailConnection(){try{return await c("GET",`${this.BASE_URL}/test-email`)}catch(e){return console.error("Email connection test error:",e),{success:!1,message:"ì´ë©”ì¼ ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"}}}static async extractSheets(e,t=["ê°‘ì§€","ì„ì§€"]){try{return await c("POST",`${this.BASE_URL}/extract-sheets`,{filePath:e,sheets:t})}catch(s){throw console.error("Sheet extraction error:",s),new Error("ì‹œíŠ¸ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async convertToPDF(e,t){try{return await c("POST",`${this.BASE_URL}/convert-to-pdf`,{excelPath:e,sheets:t})}catch(s){throw console.error("PDF conversion error:",s),new Error("PDF ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async processComplete(e,t){const s=new FormData;s.append("file",e),Object.entries(t).forEach(([r,o])=>{o!==void 0&&(Array.isArray(o)?s.append(r,o.join(",")):s.append(r,o.toString()))});try{return await c("POST",`${this.BASE_URL}/process-complete`,s)}catch(r){throw console.error("Complete process error:",r),new Error("í†µí•© ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}};i.BASE_URL="/api/po-template";let m=i;export{m as E};
