import{c as i,p as b,k as M,j as s,v as x,a as k,U as H,M as r,E,O as C,B as D,n as T,Q as m}from"./index-C9dLx8QI-1757221594452.js";import{D as S,a as A,b as B,c as L,d as O}from"./dialog-rX2sQmq6-1757221594452.js";import{T as q,a as z,b as h,c as P}from"./tabs-DkfyEPCD-1757221594452.js";import{S as $}from"./separator-D5K3h6A7-1757221594452.js";import{R as o}from"./refresh-cw-Dz1lj3sP-1757221594452.js";import{f as n}from"./format-Z5mY0P0Q-1757221594452.js";import{C as p}from"./circle-x-B3FxaMDr-1757221594452.js";import{S as R}from"./send-DVTGvqL_-1757221594452.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=i("MailOpen",[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=i("MailX",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h9",key:"1j9vog"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m17 17 4 4",key:"1b3523"}],["path",{d:"m21 17-4 4",key:"uinynz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=i("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=i("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);function Q(l){return b({queryKey:["/api/orders",l,"email-history"],queryFn:()=>M("GET",`/api/orders/${l}/email-history`),enabled:!!l,staleTime:30*1e3})}function Y({orderId:l,orderNumber:N,isOpen:y,onClose:g,onResend:d}){const{data:a,isLoading:u}=Q(l),f=e=>{switch(e){case"sent":return s.jsx(R,{className:"h-4 w-4"});case"opened":return s.jsx(V,{className:"h-4 w-4"});case"clicked":return s.jsx(j,{className:"h-4 w-4"});case"failed":return s.jsx(X,{className:"h-4 w-4"});case"bounced":return s.jsx(p,{className:"h-4 w-4"});default:return s.jsx(r,{className:"h-4 w-4"})}},v=e=>{const t={sent:{variant:"default",label:"발송됨"},opened:{variant:"success",label:"열람됨"},clicked:{variant:"secondary",label:"클릭됨"},failed:{variant:"destructive",label:"실패"},bounced:{variant:"warning",label:"반송됨"}},c=t[e]||t.sent;return s.jsxs(T,{variant:c.variant,children:[f(e),s.jsx("span",{className:"ml-1",children:c.label})]})};return s.jsx(S,{open:y,onOpenChange:g,children:s.jsxs(A,{className:"max-w-4xl max-h-[90vh]",children:[s.jsxs(B,{children:[s.jsx(L,{children:"이메일 발송 이력"}),s.jsxs(O,{children:["발주서 ",N,"의 이메일 발송 내역입니다."]})]}),u?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(o,{className:"h-6 w-6 animate-spin text-gray-400"})}):a&&a.length>0?s.jsxs(q,{defaultValue:"0",className:"w-full",children:[s.jsxs(z,{className:"grid w-full",style:{gridTemplateColumns:`repeat(${Math.min(a.length,5)}, 1fr)`},children:[a.slice(0,5).map((e,t)=>s.jsx(h,{value:t.toString(),children:n(new Date(e.sentAt),"MM/dd HH:mm")},e.id)),a.length>5&&s.jsxs(h,{value:"more",disabled:!0,children:["+",a.length-5," more"]})]}),a.map((e,t)=>s.jsxs(P,{value:t.toString(),className:"space-y-4",children:[s.jsxs(x,{className:"p-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(k,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"발송 시간:"}),s.jsx("span",{className:"font-medium",children:n(new Date(e.sentAt),"yyyy년 MM월 dd일 HH:mm:ss",{locale:m})})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(H,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"발송자:"}),s.jsxs("span",{className:"font-medium",children:[e.sentByName," (",e.sentByEmail,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(r,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"수신자:"}),s.jsx("span",{className:"font-medium",children:e.recipientName?`${e.recipientName} <${e.recipientEmail}>`:e.recipientEmail})]}),e.ccEmails&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(r,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"참조:"}),s.jsx("span",{className:"font-medium",children:e.ccEmails})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"상태:"}),v(e.status)]}),e.openedAt&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(E,{className:"h-4 w-4 text-green-500"}),s.jsx("span",{className:"text-gray-600",children:"열람 시간:"}),s.jsx("span",{className:"font-medium",children:n(new Date(e.openedAt),"yyyy년 MM월 dd일 HH:mm:ss",{locale:m})})]}),e.clickedAt&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(j,{className:"h-4 w-4 text-purple-500"}),s.jsx("span",{className:"text-gray-600",children:"클릭 시간:"}),s.jsx("span",{className:"font-medium",children:n(new Date(e.clickedAt),"yyyy년 MM월 dd일 HH:mm:ss",{locale:m})})]}),e.errorMessage&&s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsx(p,{className:"h-4 w-4 text-red-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"오류 메시지:"}),s.jsx("p",{className:"text-red-600 text-xs mt-1",children:e.errorMessage})]})]})]})]}),e.attachments&&e.attachments.length>0&&s.jsxs("div",{className:"mt-4 pt-4 border-t",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[s.jsx(F,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"첨부 파일:"})]}),s.jsx("div",{className:"space-y-1",children:e.attachments.map((c,w)=>s.jsxs("div",{className:"text-sm text-gray-700",children:[c.filename," (",(c.size/1024/1024).toFixed(2)," MB)"]},w))})]})]}),s.jsxs(x,{className:"p-4",children:[s.jsx("h4",{className:"font-medium mb-2",children:"제목"}),s.jsx("p",{className:"text-sm text-gray-700 mb-4",children:e.subject}),s.jsx($,{}),s.jsx("h4",{className:"font-medium mt-4 mb-2",children:"내용"}),s.jsx(C,{className:"h-[300px] w-full rounded-md border p-4",children:s.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.body}})})]}),d&&e.status==="failed"&&s.jsx("div",{className:"flex justify-end",children:s.jsxs(D,{variant:"outline",size:"sm",onClick:()=>d(e.id),children:[s.jsx(o,{className:"h-4 w-4 mr-2"}),"재발송"]})})]},e.id))]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(r,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"이메일 발송 이력이 없습니다."})]})]})})}export{Y as E};
