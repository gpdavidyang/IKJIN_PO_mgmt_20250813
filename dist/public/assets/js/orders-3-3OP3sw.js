import{m as je,j as e,S as R,e as Ae,R as K,n as L,I as W,B as N,o as Ke,F as Te,U as Re,p as Ve,h as Ne,q as xe,u as Oe,b as Pe,r as A,f as He,T as Z,s as ee,t as re,E as _e,v as te,c as Qe,w as Ye,x as We,y as Ge,z as Xe,A as de,l as Y,D as pe,G as ce}from"./index-C1FD_2aC.js";import{S as ae,a as se,b as oe,c as le,d as I}from"./select-B3Iid4z8.js";import{M as we,b as Ce,u as Je,E as Ze,a as er}from"./email-history-modal-DnMukkn8.js";import{i as ge}from"./authUtils-CcDzk6i0.js";import{E as rr}from"./email-send-dialog-XfIvLstG.js";import{S as fe}from"./search-lVw0mCJD.js";import{C as tr}from"./chevrons-up-down-CLhXSOLT.js";import{C as Me}from"./chevron-up-BvTUxraI.js";import{C as ze}from"./chevron-down-BWwjS3gT.js";import{C as Se}from"./clock-VrNskZcj.js";import{C as me}from"./circle-check-Dp9a7yWJ.js";import{S as Le}from"./send-D3_ajtgY.js";import{C as De}from"./circle-x-8PAvSfcV.js";import{T as ar,M as sr}from"./trending-down-Br-iXn4H.js";import{T as or}from"./trending-up-BEcKNSdJ.js";import{C as $e}from"./checkbox-I_b6pm_u.js";import{D as lr,a as nr,b as ir,c as dr,d as cr,e as gr}from"./dialog-DsxQI6pV.js";import{T as mr}from"./triangle-alert-DSNUvu5X.js";import{T as Fe}from"./trash-2-DlIgWmfO.js";import{S as ur}from"./square-pen-CBQurWGn.js";import{M as Ee}from"./mail-CuC4OgwV.js";import{f as ue}from"./format-BqlaHE6C.js";import{k as be}from"./ko-DHTEdlBI.js";import{S as br}from"./shopping-cart-BrqH66a7.js";import{D as Ie}from"./download-DJ1klqUf.js";import{F as xr}from"./filter-B9lj6G-K.js";import"./index-BdQq_4o_.js";import"./index-CuBmkLNp.js";import"./tabs-Cnn4fl_7.js";import"./scroll-area-BLoHelzc.js";import"./separator-CpHMC9Ig.js";import"./refresh-cw-B4Aojzel.js";import"./paperclip-s_8gXQdJ.js";import"./textarea-BmEGHmdZ.js";import"./alert-Cr8THtQc.js";import"./index-Uj3QWJcR.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=je("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=je("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=je("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function yr({rows:n=5,columns:c=6,showPagination:b=!0}){return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsx("tr",{children:Array.from({length:c}).map((w,a)=>e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx(R,{className:"h-4 w-24"})},a))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.from({length:n}).map((w,a)=>e.jsx("tr",{children:Array.from({length:c}).map((s,p)=>e.jsx("td",{className:"px-4 py-3",children:e.jsx(R,{className:"h-4 w-full max-w-xs"})},p))},a))})]})}),b&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(R,{className:"h-8 w-48"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-8 w-20"}),e.jsx(R,{className:"h-8 w-8"}),e.jsx(R,{className:"h-8 w-8"}),e.jsx(R,{className:"h-8 w-8"}),e.jsx(R,{className:"h-8 w-20"})]}),e.jsx(R,{className:"h-8 w-32"})]})]})}function fr({data:n,columns:c,searchable:b=!1,searchPlaceholder:w="ê²€ìƒ‰...",showPagination:a=!1,pageSize:s=10,pageSizeOptions:p=[10,25,50,100],onRowClick:f,rowKey:g,emptyMessage:T="ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤",isLoading:M=!1,className:v,stickyHeader:ne=!1,maxHeight:$}){const{theme:O,actualTheme:y}=Ae(),u=y==="dark"||O==="dark"||document.documentElement.classList.contains("dark"),_=`table-${u?"dark":"light"}-${Date.now()}`;K.useEffect(()=>(()=>{if(y==="dark"||O==="dark"||document.documentElement.classList.contains("dark")){const r=document.getElementById("enhanced-table-dark-override");r&&r.remove();const o=document.createElement("style");o.id="enhanced-table-dark-override",o.textContent=`
          /* ULTIMATE TABLE DARK MODE OVERRIDE */
          .dark-table-container table,
          [data-theme="dark"] .dark-table-container table,
          html.dark .dark-table-container table {
            background-color: rgb(31 41 55) !important;
            color: rgb(241 245 249) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody,
          [data-theme="dark"] .dark-table-container table tbody,
          html.dark .dark-table-container table tbody {
            background-color: rgb(31 41 55) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr,
          [data-theme="dark"] .dark-table-container table tbody tr,
          html.dark .dark-table-container table tbody tr {
            background-color: rgb(31 41 55) !important;
            color: rgb(241 245 249) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr:nth-child(even),
          [data-theme="dark"] .dark-table-container table tbody tr:nth-child(even),
          html.dark .dark-table-container table tbody tr:nth-child(even) {
            background-color: rgba(55 65 81, 0.7) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr:hover,
          [data-theme="dark"] .dark-table-container table tbody tr:hover,
          html.dark .dark-table-container table tbody tr:hover {
            background-color: rgb(55 65 81) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table thead,
          [data-theme="dark"] .dark-table-container table thead,
          html.dark .dark-table-container table thead {
            background-color: rgb(55 65 81) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container .table-wrapper-custom,
          [data-theme="dark"] .dark-table-container .table-wrapper-custom,
          html.dark .dark-table-container .table-wrapper-custom {
            background-color: rgb(31 41 55) !important;
            forced-color-adjust: none !important;
          }
        `,document.head.appendChild(o);const i=()=>{document.querySelectorAll(".dark-table-container table").forEach(P=>{P.style.setProperty("background-color","rgb(31 41 55)","important"),P.style.setProperty("forced-color-adjust","none","important");const E=P.querySelector("tbody");E&&(E.style.setProperty("background-color","rgb(31 41 55)","important"),E.querySelectorAll("tr").forEach((Q,J)=>{J%2===0?Q.style.setProperty("background-color","rgb(31 41 55)","important"):Q.style.setProperty("background-color","rgba(55 65 81, 0.7)","important"),Q.style.setProperty("forced-color-adjust","none","important")}));const X=P.querySelector("thead");X&&X.style.setProperty("background-color","rgb(55 65 81)","important");const ie=P.closest(".table-wrapper-custom");ie&&ie.style.setProperty("background-color","rgb(31 41 55)","important")})};i(),setTimeout(i,100);const S=new MutationObserver(()=>{i()});return S.observe(document.body,{childList:!0,subtree:!0}),()=>{S.disconnect();const m=document.getElementById("enhanced-table-dark-override");m&&m.remove()}}})(),[O,y,n]);const[F,q]=K.useState(""),[B,V]=K.useState(null),[U,H]=K.useState(null),[h,z]=K.useState(1),[C,D]=K.useState(s),t=K.useMemo(()=>{if(!F)return n;const l=c.filter(x=>x.searchable!==!1);return n.filter(x=>l.some(r=>{const o=r.accessor?r.accessor(x):x[r.key];return o==null?!1:String(o).toLowerCase().includes(F.toLowerCase())}))},[n,F,c]),d=K.useMemo(()=>{if(!B||!U)return t;const l=c.find(x=>x.key===B);return l?[...t].sort((x,r)=>{const o=l.accessor?l.accessor(x):x[l.key],i=l.accessor?l.accessor(r):r[l.key];if(o==null)return 1;if(i==null)return-1;const S=o<i?-1:o>i?1:0;return U==="asc"?S:-S}):t},[t,B,U,c]),k=K.useMemo(()=>{if(!a)return d;const l=(h-1)*C;return d.slice(l,l+C)},[d,h,C,a]),j=Math.ceil(d.length/C),G=l=>{B===l?U==="asc"?H("desc"):U==="desc"&&(H(null),V(null)):(V(l),H("asc"))},he=l=>B!==l?e.jsx(tr,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"}):U==="asc"?e.jsx(Me,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):e.jsx(ze,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"});return M?e.jsx(yr,{rows:C,columns:c.length,showPagination:a}):e.jsxs("div",{className:L("w-full dark-table-container",v),"data-theme":u?"dark":"light",style:{backgroundColor:u?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},children:[b&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(W,{placeholder:w,value:F,onChange:l=>{q(l.target.value),z(1)},className:"pl-10 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100"})]})}),e.jsx("div",{className:L("border rounded-lg overflow-hidden transition-colors table-wrapper-custom","border-gray-200 dark:border-gray-700"),style:{maxHeight:$,backgroundColor:u?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},"data-dark-table":u,children:e.jsxs("table",{className:L("w-full table-custom-dark",u&&"dark-table-forced"),style:{backgroundColor:u?"rgb(31 41 55)":"white",color:u?"rgb(241 245 249)":"rgb(17 24 39)",forcedColorAdjust:"none"},"data-theme":u?"dark":"light",children:[e.jsx("thead",{className:L("border-b transition-colors thead-custom","border-gray-200 dark:border-gray-600",ne&&"sticky top-0 z-10"),style:{backgroundColor:u?"rgb(55 65 81)":"rgb(249 250 251)",forcedColorAdjust:"none"},children:e.jsx("tr",{children:c.map(l=>e.jsx("th",{className:L("px-4 py-3 text-left text-xs font-medium uppercase tracking-wider transition-colors","text-gray-600 dark:text-gray-300",l.align==="center"&&"text-center",l.align==="right"&&"text-right",l.sortable!==!1&&"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",l.className),style:{width:l.width},onClick:()=>l.sortable!==!1&&G(String(l.key)),children:e.jsxs("div",{className:L("flex items-center gap-1",l.align==="center"&&"justify-center",l.align==="right"&&"justify-end"),children:[e.jsx("span",{children:l.header}),l.sortable!==!1&&he(String(l.key))]})},String(l.key)))})}),e.jsx("tbody",{className:L("divide-y transition-colors tbody-custom","divide-gray-200 dark:divide-gray-700"),style:{backgroundColor:u?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},children:k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:c.length,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400 td-custom-empty",style:{backgroundColor:u?"rgb(31 41 55)":"white",color:u?"rgb(156 163 175)":"rgb(107 114 128)",forcedColorAdjust:"none"},children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(fe,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mb-3"}),e.jsx("p",{children:T})]})})}):k.map((l,x)=>e.jsx("tr",{className:L("transition-colors tr-custom-row",f&&"cursor-pointer"),style:{backgroundColor:u?x%2===0?"rgb(31 41 55) !important":"rgba(55 65 81, 0.7) !important":x%2===0?"white !important":"rgb(249 250 251) !important",forcedColorAdjust:"none",transition:"background-color 0.2s ease"},onMouseEnter:r=>{u?r.currentTarget.style.backgroundColor="rgb(55 65 81) !important":r.currentTarget.style.backgroundColor="rgb(243 244 246) !important"},onMouseLeave:r=>{u?r.currentTarget.style.backgroundColor=x%2===0?"rgb(31 41 55) !important":"rgba(55 65 81, 0.7) !important":r.currentTarget.style.backgroundColor=x%2===0?"white !important":"rgb(249 250 251) !important"},onClick:()=>f?.(l),children:c.map(r=>e.jsx("td",{className:L("px-4 py-3 text-sm transition-colors td-custom","text-gray-900 dark:text-gray-100",r.align==="center"&&"text-center",r.align==="right"&&"text-right",r.className),style:{backgroundColor:"transparent !important",forcedColorAdjust:"none"},children:r.accessor?r.accessor(l):l[r.key]},String(r.key)))},g(l)))})]},_)}),a&&j>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"í‘œì‹œ ê°œìˆ˜:"}),e.jsxs(ae,{value:String(C),onValueChange:l=>{D(Number(l)),z(1)},children:[e.jsx(se,{className:"w-20 h-8 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:e.jsx(oe,{})}),e.jsx(le,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:p.map(l=>e.jsx(I,{value:String(l),className:"text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:l},l))})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(1),disabled:h===1,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"ì²˜ìŒ"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(l=>Math.max(1,l-1)),disabled:h===1,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"ì´ì „"}),e.jsx("div",{className:"flex items-center gap-1 mx-2",children:Array.from({length:Math.min(5,j)},(l,x)=>{let r;return j<=5||h<=3?r=x+1:h>=j-2?r=j-4+x:r=h-2+x,e.jsx(N,{variant:h===r?"default":"outline",size:"sm",onClick:()=>z(r),className:L("h-8 w-8 p-0",h===r?"bg-blue-600 dark:bg-blue-500 text-white dark:text-white border-blue-600 dark:border-blue-500":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700"),children:r},r)})}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(l=>Math.min(j,l+1)),disabled:h===j,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"ë‹¤ìŒ"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(j),disabled:h===j,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"ë§ˆì§€ë§‰"})]}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["ì´ ",d.length,"ê°œ ì¤‘ ",(h-1)*C+1,"-",Math.min(h*C,d.length),"ê°œ"]})]})]})}const vr=Ke("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium transition-all duration-200 border",{variants:{variant:{default:"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600",primary:"bg-primary-50 text-primary-700 border-primary-200 dark:bg-primary-900/50 dark:text-primary-300 dark:border-primary-800",success:"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/50 dark:text-green-300 dark:border-green-800",warning:"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/50 dark:text-yellow-300 dark:border-yellow-800",danger:"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/50 dark:text-red-300 dark:border-red-800",info:"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/50 dark:text-blue-300 dark:border-blue-800",purple:"bg-purple-50 text-purple-700 border-purple-200 dark:bg-purple-900/50 dark:text-purple-300 dark:border-purple-800",outline:"bg-transparent border-current"},size:{sm:"text-xs px-2 py-0.5",md:"text-xs px-2.5 py-1",lg:"text-sm px-3 py-1.5"},pulse:{true:"animate-pulse",false:""},interactive:{true:"cursor-pointer hover:scale-105 active:scale-95",false:""}},defaultVariants:{variant:"default",size:"md",pulse:!1,interactive:!1}});function ve({className:n,variant:c,size:b,pulse:w,interactive:a,icon:s,children:p,onRemove:f,animate:g=!0,...T}){return e.jsxs("div",{className:L(vr({variant:c,size:b,pulse:w,interactive:a}),g&&"transition-all duration-200","group relative",n),...T,children:[s&&e.jsx(s,{className:"h-3 w-3 transition-transform duration-200 group-hover:scale-110"}),e.jsx("span",{className:"transition-colors duration-200",children:p}),f&&e.jsx("button",{onClick:M=>{M.stopPropagation(),f()},className:"ml-1 -mr-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full p-0.5 transition-all duration-200 hover:scale-110 active:scale-95 focus:outline-none focus:ring-2 focus:ring-current/20","aria-label":"ë±ƒì§€ ì œê±°",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"h-3 w-3 transition-transform duration-200",children:e.jsx("path",{d:"M5.28 4.22a.75.75 0 00-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 101.06 1.06L8 9.06l2.72 2.72a.75.75 0 101.06-1.06L9.06 8l2.72-2.72a.75.75 0 00-1.06-1.06L8 6.94 5.28 4.22z"})})})]})}function jr({prevStatus:n,...c}){const[b,w]=K.useState(!1);return K.useEffect(()=>{if(n&&n!==c.children){w(!0);const a=setTimeout(()=>w(!1),500);return()=>clearTimeout(a)}},[n,c.children]),e.jsx(ve,{...c,className:L(c.className,b&&"scale-110 shadow-lg")})}const kr={order:{draft:{label:"ìž„ì‹œì €ìž¥",variant:"default",icon:Te,pulse:!1,description:"ìž‘ì„± ì¤‘ì¸ ë°œì£¼ì„œ"},pending:{label:"ìŠ¹ì¸ ëŒ€ê¸°",variant:"warning",icon:Se,pulse:!0,description:"ìŠ¹ì¸ìž ê²€í†  ëŒ€ê¸° ì¤‘"},approved:{label:"ìŠ¹ì¸ë¨",variant:"info",icon:me,pulse:!1,description:"ìŠ¹ì¸ ì™„ë£Œë¨"},sent:{label:"ë°œì†¡ë¨",variant:"success",icon:Le,pulse:!1,description:"ê±°ëž˜ì²˜ì— ë°œì†¡ ì™„ë£Œ"},completed:{label:"ì™„ë£Œ",variant:"success",icon:me,pulse:!1,description:"ë°œì£¼ ì²˜ë¦¬ ì™„ë£Œ"},rejected:{label:"ë°˜ë ¤ë¨",variant:"danger",icon:De,pulse:!1,description:"ìŠ¹ì¸ì´ ê±°ë¶€ë¨"},cancelled:{label:"ì·¨ì†Œë¨",variant:"default",icon:pr,pulse:!1,description:"ë°œì£¼ê°€ ì·¨ì†Œë¨"}},user:{active:{label:"í™œì„±",variant:"success",icon:Re,pulse:!1},inactive:{label:"ë¹„í™œì„±",variant:"default",icon:ye,pulse:!1},pending:{label:"ìŠ¹ì¸ ëŒ€ê¸°",variant:"warning",icon:Se,pulse:!0}},vendor:{active:{label:"í™œì„±",variant:"success",icon:Ve,pulse:!1},inactive:{label:"ë¹„í™œì„±",variant:"default",icon:ye,pulse:!1},verified:{label:"ê²€ì¦ë¨",variant:"info",icon:me,pulse:!1},unverified:{label:"ë¯¸ê²€ì¦",variant:"warning",icon:Ne,pulse:!1}},project:{active:{label:"ì§„í–‰ ì¤‘",variant:"primary",icon:hr,pulse:!1},completed:{label:"ì™„ë£Œ",variant:"success",icon:me,pulse:!1},on_hold:{label:"ë³´ë¥˜",variant:"warning",icon:ye,pulse:!1},cancelled:{label:"ì·¨ì†Œ",variant:"default",icon:De,pulse:!1}},priority:{low:{label:"ë‚®ìŒ",variant:"default",icon:ar,pulse:!1},normal:{label:"ë³´í†µ",variant:"info",icon:sr,pulse:!1},high:{label:"ë†’ìŒ",variant:"warning",icon:or,pulse:!1},urgent:{label:"ê¸´ê¸‰",variant:"danger",icon:Ne,pulse:!0}}};function Nr({type:n,status:c,showIcon:b=!0,showTooltip:w=!1,animated:a=!1,prevStatus:s,className:p,...f}){const g=kr[n]?.[c];if(!g)return console.warn(`Unknown status "${c}" for type "${n}"`),e.jsx(ve,{variant:"default",className:p,...f,children:c});const T=a?jr:ve,M=a?{prevStatus:s}:{};return e.jsxs("div",{className:"relative group",children:[e.jsx(T,{variant:g.variant,icon:b?g.icon:void 0,pulse:g.pulse,className:p,...M,...f,children:g.label}),w&&g.description&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[g.description,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]})}function wr({open:n,onOpenChange:c,selectedOrders:b,onConfirm:w,isLoading:a=!1}){const s=()=>{w()},p=b.reduce((g,T)=>{const M=Number(T.totalAmount)||0;return console.log("ðŸ’° Processing order amount:",{orderId:T.id,orderNumber:T.orderNumber,totalAmount:T.totalAmount,parsed:M}),g+M},0),f=g=>new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0}).format(g);return e.jsx(lr,{open:n,onOpenChange:c,children:e.jsxs(nr,{className:"max-w-md",children:[e.jsx(ir,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-full",children:e.jsx(mr,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(dr,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"ë°œì£¼ì„œ ì¼ê´„ ì‚­ì œ"}),e.jsx(cr,{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"ì„ íƒëœ ë°œì£¼ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:[e.jsx("strong",{children:"ì£¼ì˜:"})," ì‚­ì œëœ ë°œì£¼ì„œëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ì„ íƒëœ ë°œì£¼ì„œ"}),e.jsxs(xe,{variant:"destructive",className:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300",children:[b.length,"ê°œ"]})]}),e.jsxs("div",{className:"max-h-40 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[b.slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:g.orderNumber}),g.vendorName&&e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["(",g.vendorName,")"]})]}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:f(g.totalAmount)})]},g.id)),b.length>5&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center pt-2 border-t border-gray-200 dark:border-gray-600",children:["ì™¸ ",b.length-5,"ê°œ ë”..."]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ì´ ê¸ˆì•¡"}),e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:f(p)})]})]})]}),e.jsxs(gr,{className:"gap-2",children:[e.jsx(N,{variant:"outline",onClick:()=>c(!1),disabled:a,className:"text-gray-600 dark:text-gray-400",children:"ì·¨ì†Œ"}),e.jsx(N,{variant:"destructive",onClick:s,disabled:a,className:"bg-red-600 hover:bg-red-700 text-white",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"ì‚­ì œ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),b.length,"ê°œ ë°œì£¼ì„œ ì‚­ì œ"]})})]})]})})}function Cr({orders:n,isLoading:c=!1,isBulkDeleting:b=!1,onStatusChange:w,onDelete:a,onBulkDelete:s,onEmailSend:p,onViewEmailHistory:f,onViewPdf:g,sortBy:T,sortOrder:M,onSort:v}){const[ne,$]=Oe(),{user:O}=Pe(),[y,u]=A.useState([]),[_,F]=A.useState(!1),q=O?.role==="admin",B=A.useCallback((t,d)=>{u(k=>d?[...k,t]:k.filter(j=>j!==t))},[]),V=A.useCallback(t=>{if(t){const d=n.filter(k=>k.status==="draft").map(k=>k.id);u(d)}else u([])},[n]),U=A.useCallback(()=>{y.length>0&&F(!0)},[y]),H=A.useCallback(()=>{s&&y.length>0&&(s(y),u([]),F(!1))},[s,y]),h=n.filter(t=>t.status==="draft"),z=h.length>0&&h.every(t=>y.includes(t.id));h.some(t=>y.includes(t.id)),console.log("ðŸ” EnhancedOrdersTable props:",{ordersCount:n.length,onEmailSend:!!p,onViewPdf:!!g,onViewEmailHistory:!!f,onBulkDelete:!!s,isAdmin:q,userRole:O?.role,userDetails:O?{id:O.id,name:O.name,email:O.email}:null,selectedOrderIds:y,draftOrdersCount:h.length,conditionCheck:q&&s});const C=t=>{const d=f?()=>f(t):void 0;if(!t.emailStatus||t.totalEmailsSent===0)return e.jsxs(xe,{variant:"outline",className:`text-muted-foreground ${d?"cursor-pointer hover:bg-muted":""}`,onClick:d,children:[e.jsx(Ee,{className:"h-3 w-3 mr-1"}),"ë¯¸ë°œì†¡"]});const k={sent:{icon:Le,label:"ë°œì†¡ë¨",className:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",tooltip:t.lastSentAt?`ìµœê·¼ ë°œì†¡: ${ue(new Date(t.lastSentAt),"yyyy.MM.dd HH:mm",{locale:be})}`:""},opened:{icon:we,label:"ì—´ëžŒë¨",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",tooltip:t.openedAt?`ì—´ëžŒ ì‹œê°„: ${ue(new Date(t.openedAt),"yyyy.MM.dd HH:mm",{locale:be})}`:""},clicked:{icon:we,label:"í´ë¦­ë¨",className:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300",tooltip:"ë§í¬ í´ë¦­ë¨"},failed:{icon:Ce,label:"ì‹¤íŒ¨",className:"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300",tooltip:"ë°œì†¡ ì‹¤íŒ¨"},bounced:{icon:Ce,label:"ë°˜ì†¡ë¨",className:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300",tooltip:"ì´ë©”ì¼ ë°˜ì†¡ë¨"}},j=k[t.emailStatus]||k.sent,G=j.icon;return e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(xe,{variant:"secondary",className:`${j.className} ${d?"cursor-pointer hover:opacity-80":""}`,onClick:d,children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),j.label,t.totalEmailsSent&&t.totalEmailsSent>1&&e.jsxs("span",{className:"ml-1",children:["(",t.totalEmailsSent,")"]})]})}),j.tooltip&&e.jsxs(te,{children:[e.jsx("p",{children:j.tooltip}),t.totalEmailsSent&&t.totalEmailsSent>1&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["ì´ ",t.totalEmailsSent,"íšŒ ë°œì†¡"]}),d&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"í´ë¦­í•˜ì—¬ ìƒì„¸ ì´ë ¥ ë³´ê¸°"})]})]})})},D=[...q&&s?[{key:"select",header:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx($e,{checked:z,onCheckedChange:V,disabled:h.length===0,"aria-label":"ëª¨ë“  ë°œì£¼ì„œ ì„ íƒ"})}),width:"40px",accessor:t=>e.jsx("div",{className:"flex items-center justify-center",onClick:d=>d.stopPropagation(),children:e.jsx($e,{checked:y.includes(t.id),onCheckedChange:d=>B(t.id,d),disabled:t.status!=="draft","aria-label":`ë°œì£¼ì„œ ${t.orderNumber} ì„ íƒ`})})}]:[],{key:"orderNumber",header:"ë°œì£¼ ë²ˆí˜¸",sortable:!0,searchable:!0,width:"130px",accessor:t=>e.jsx("div",{className:"font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 cursor-pointer",onClick:d=>{d.stopPropagation();try{typeof $=="function"?$(`/orders/${t.id}`):window.location.href=`/orders/${t.id}`}catch(k){console.error("Navigation error:",k),window.location.href=`/orders/${t.id}`}},children:t.orderNumber})},{key:"status",header:"ìƒíƒœ",sortable:!0,width:"100px",accessor:t=>e.jsx(Nr,{type:"order",status:t.status,showTooltip:!0,animated:!0})},{key:"emailStatus",header:"ì´ë©”ì¼",sortable:!0,width:"90px",accessor:t=>C(t)},{key:"projectName",header:"í”„ë¡œì íŠ¸",sortable:!0,searchable:!0,width:"160px",accessor:t=>e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:t.projectName||"-"})},{key:"vendorName",header:"ê±°ëž˜ì²˜",sortable:!0,searchable:!0,width:"140px",accessor:t=>e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:t.vendorName&&t.vendorId?e.jsx("div",{className:"font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 cursor-pointer hover:underline",onClick:d=>{d.stopPropagation();try{typeof $=="function"?$(`/vendors/${t.vendorId}`):window.location.href=`/vendors/${t.vendorId}`}catch(k){console.error("Navigation error:",k),window.location.href=`/vendors/${t.vendorId}`}},title:"ê±°ëž˜ì²˜ ìƒì„¸ ì •ë³´ ë³´ê¸°",children:t.vendorName}):e.jsx("span",{children:t.vendorName||"-"})})},{key:"totalAmount",header:"ê¸ˆì•¡",sortable:!0,align:"right",width:"120px",accessor:t=>e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:He(t.totalAmount)})},{key:"orderDate",header:"ë°œì£¼ì¼",sortable:!0,width:"100px",accessor:t=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:ue(new Date(t.orderDate),"yyyy.MM.dd",{locale:be})})},{key:"deliveryDate",header:"ë‚©í’ˆì˜ˆì •ì¼",sortable:!0,width:"110px",accessor:t=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t.deliveryDate?ue(new Date(t.deliveryDate),"yyyy.MM.dd",{locale:be}):"-"})},{key:"userName",header:"ìš”ì²­ìž",sortable:!0,searchable:!0,width:"120px",accessor:t=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t.userName||"-"})},{key:"actions",header:"ì•¡ì…˜",width:"160px",align:"center",accessor:t=>e.jsxs("div",{className:"flex items-center justify-center gap-1",onClick:d=>d.stopPropagation(),children:[e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(re,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/20",onClick:()=>{try{typeof $=="function"?$(`/orders/${t.id}`):window.location.href=`/orders/${t.id}`}catch{window.location.href=`/orders/${t.id}`}},children:e.jsx(_e,{className:"h-4 w-4"})})}),e.jsx(te,{children:e.jsx("p",{children:"ìƒì„¸ ë³´ê¸°"})})]})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(re,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-green-50 hover:text-green-600 dark:hover:bg-green-900/20",onClick:()=>{try{typeof $=="function"?$(`/orders/${t.id}/edit`):window.location.href=`/orders/${t.id}/edit`}catch{window.location.href=`/orders/${t.id}/edit`}},children:e.jsx(ur,{className:"h-4 w-4"})})}),e.jsx(te,{children:e.jsx("p",{children:"ìˆ˜ì •"})})]})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(re,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-orange-50 hover:text-orange-600 dark:hover:bg-orange-900/20",onClick:()=>{g&&g(t)},children:e.jsx(Te,{className:"h-4 w-4"})})}),e.jsx(te,{children:e.jsx("p",{children:"PDF ë³´ê¸°"})})]})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(re,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-purple-50 hover:text-purple-600 dark:hover:bg-purple-900/20 border border-purple-200",onClick:()=>{console.log("ðŸ” ì´ë©”ì¼ ë²„íŠ¼ í´ë¦­ë¨",{row:t,onEmailSend:!!p}),p?p(t):alert("ì´ë©”ì¼ ì „ì†¡ ê¸°ëŠ¥ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")},style:{backgroundColor:"rgba(147, 51, 234, 0.1)"},children:e.jsx(Ee,{className:"h-4 w-4 text-purple-600"})})}),e.jsx(te,{children:e.jsx("p",{children:"ì´ë©”ì¼ ì „ì†¡ (Debug)"})})]})})]})}];return e.jsxs("div",{className:"space-y-4",children:[q&&s&&y.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:[y.length,"ê°œì˜ ë°œì£¼ì„œê°€ ì„ íƒë¨"]}),e.jsx(xe,{variant:"outline",className:"text-blue-600 border-blue-300",children:"ìž„ì‹œì €ìž¥ ìƒíƒœë§Œ ì‚­ì œ ê°€ëŠ¥"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>u([]),className:"text-gray-600 dark:text-gray-400",children:"ì„ íƒ í•´ì œ"}),e.jsxs(N,{variant:"destructive",size:"sm",onClick:U,className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"ì„ íƒëœ ë°œì£¼ì„œ ì‚­ì œ"]})]})]}),e.jsx(fr,{data:n,columns:D,searchable:!0,searchPlaceholder:"ë°œì£¼ ë²ˆí˜¸, í”„ë¡œì íŠ¸, ê±°ëž˜ì²˜, ìš”ì²­ìžë¡œ ê²€ìƒ‰...",showPagination:!0,pageSize:20,pageSizeOptions:[10,20,50,100],onRowClick:t=>{try{typeof $=="function"?$(`/orders/${t.id}`):window.location.href=`/orders/${t.id}`}catch{window.location.href=`/orders/${t.id}`}},rowKey:t=>t.id,emptyMessage:"ë“±ë¡ëœ ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤",isLoading:c,stickyHeader:!0,maxHeight:"calc(100vh - 300px)",className:"shadow-sm"}),e.jsx(wr,{open:_,onOpenChange:F,selectedOrders:n.filter(t=>y.includes(t.id)),onConfirm:H,isLoading:b})]})}function it(){Pe();const{toast:n}=Qe(),[c,b]=Oe(),{theme:w}=Ae(),a=w==="dark";A.useEffect(()=>{console.log("ðŸ” Orders Page Theme Debug:",{theme:w,isDarkMode:a,htmlClass:document.documentElement.className,bodyClass:document.body.className})},[w,a]);const[s,p]=A.useState({status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"}),[f,g]=A.useState(!1),[T,M]=A.useState(!1),[v,ne]=A.useState(null),[$,O]=A.useState(!1),[y,u]=A.useState(null);A.useEffect(()=>{const r=new URLSearchParams(window.location.search),o=r.get("status"),i=r.get("filter"),S=r.get("vendor"),m={page:1,status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",limit:50};if(o&&!i)m.status=o==="all"?"":o;else if(i==="monthly"){const P=new Date,E=P.getFullYear(),X=P.getMonth(),ie=new Date(E,X,1),ke=new Date(E,X+1,0),Q=J=>{const qe=J.getFullYear(),Be=String(J.getMonth()+1).padStart(2,"0"),Ue=String(J.getDate()).padStart(2,"0");return`${qe}-${Be}-${Ue}`};m.startDate=Q(ie),m.endDate=Q(ke)}else if(i==="urgent"){const P=new Date,E=new Date;E.setDate(P.getDate()+7),m.startDate=P.toISOString().split("T")[0],m.endDate=E.toISOString().split("T")[0],m.status="approved"}S&&(m.vendorId=S),p(m)},[c]);const{data:_,isLoading:F}=Ye(s),{data:q}=We(),{data:B}=Ge(),{data:V}=Xe(),{data:U}=Je(),H=de({mutationFn:async({orderId:r,status:o})=>{await pe("PUT",`/api/orders/${r}/status`,{status:o})},onSuccess:()=>{ce.invalidateQueries({predicate:r=>r.queryKey.some(i=>i==="/api/orders-optimized"||i==="orders-optimized"||typeof i=="string"&&i.includes("orders"))}),n({title:"ì„±ê³µ",description:"ë°œì£¼ì„œ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{if(ge(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}n({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),h=de({mutationFn:async r=>{await pe("DELETE",`/api/orders/${r}`)},onSuccess:()=>{ce.invalidateQueries({predicate:r=>r.queryKey.some(i=>i==="/api/orders-optimized"||i==="orders-optimized"||typeof i=="string"&&i.includes("orders"))}),n({title:"ì„±ê³µ",description:"ë°œì£¼ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{if(ge(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}n({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),z=de({mutationFn:async r=>{console.log("ðŸ—‘ï¸ Bulk delete request:",{orderIds:r,parsedIds:r.map(o=>parseInt(o,10))}),await pe("DELETE","/api/orders/bulk",{orderIds:r.map(o=>parseInt(o,10))})},onSuccess:async(r,o)=>{await ce.invalidateQueries({predicate:i=>i.queryKey.some(m=>m==="/api/orders-optimized"||m==="orders-optimized"||typeof m=="string"&&m.includes("orders"))}),await ce.refetchQueries({predicate:i=>i.queryKey.some(m=>m==="/api/orders-optimized"||m==="orders-optimized")}),n({title:"ì„±ê³µ",description:`${o.length}ê°œì˜ ë°œì£¼ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`})},onError:r=>{if(ge(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}if(r?.response?.data?.nonDeletableOrders){const i=r.response.data.nonDeletableOrders.map(S=>S.orderNumber).join(", ");n({title:"ì¼ë¶€ ë°œì£¼ì„œ ì‚­ì œ ë¶ˆê°€",description:`ë‹¤ìŒ ë°œì£¼ì„œë“¤ì€ ìž„ì‹œì €ìž¥ ìƒíƒœê°€ ì•„ë‹ˆì–´ì„œ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${i}`,variant:"destructive"})}else n({title:"ì˜¤ë¥˜",description:r?.response?.data?.message||"ë°œì£¼ì„œ ì¼ê´„ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),C=de({mutationFn:async()=>{const r=new URLSearchParams;Object.entries(s).forEach(([P,E])=>{E&&E!=="all"&&E!==""&&r.append(P,E.toString())});const o=await fetch(`/api/orders/export?${r}`,{credentials:"include"});if(!o.ok)throw new Error("Export failed");const i=await o.blob(),S=window.URL.createObjectURL(i),m=document.createElement("a");m.href=S,m.download="orders.xlsx",document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(S),document.body.removeChild(m)},onError:r=>{if(ge(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}n({title:"ì˜¤ë¥˜",description:"ì—‘ì…€ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),D=(r,o)=>{const i=o==="all"?"":o;p(S=>({...S,[r]:i,page:1}))},t=r=>{p(o=>({...o,sortBy:r,sortOrder:o.sortBy===r&&o.sortOrder==="desc"?"asc":"desc",page:1}))},d=r=>{const o=l.find(i=>i.id===r.id);o&&(ne(o),M(!0))},k=async r=>{if(v)try{const o={orderNumber:v.orderNumber,vendorName:v.vendor?.name||"",orderDate:v.orderDate,totalAmount:v.totalAmount,siteName:v.project?.projectName,filePath:v.filePath||""};await er.sendPurchaseOrderEmail(o,r),n({title:"ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ",description:`${v.vendor?.name}ì—ê²Œ ë°œì£¼ì„œ ${v.orderNumber}ë¥¼ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.`})}catch(o){n({title:"ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨",description:o instanceof Error?o.message:"ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}},j=r=>{const o=l.find(i=>i.id===r.id);o&&(u(o),O(!0))},G=r=>{const o=l.find(i=>i.id===r.id);o&&(o.filePath?window.open(`/api/orders/${o.id}/download`,"_blank"):n({title:"PDF ìƒì„± ì¤‘",description:"ë°œì£¼ì„œ PDFë¥¼ ìƒì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."}))},he=r=>{z.mutate(r)},l=_?.orders||[],x=l.map(r=>{const o=U?.find(i=>i.id===r.id);return{...r,emailStatus:o?.email_status||null,lastSentAt:o?.last_sent_at||null,totalEmailsSent:o?.total_emails_sent||0,openedAt:o?.opened_at||null}});return console.log("ðŸ” Orders Page - ordersData:",_),console.log("ðŸ” Orders Page - orders array:",l),console.log("ðŸ” Orders Page - first order:",l[0]),console.log("ðŸ” Orders Page - emailStatusData:",U),console.log("ðŸ” Orders Page - isLoading:",F),console.log("ðŸ” Orders Page - filters:",s),e.jsx("div",{className:`min-h-screen transition-colors ${a?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${a?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(br,{className:`h-6 w-6 transition-colors ${a?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${a?"text-white":"text-gray-900"}`,children:"ë°œì£¼ì„œ ê´€ë¦¬"}),s.vendorId&&s.vendorId!==""?e.jsxs("p",{className:`text-sm font-medium mt-1 transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:[Array.isArray(q)?q.find(r=>r.id.toString()===s.vendorId)?.name:"ê±°ëž˜ì²˜"," ê±°ëž˜ì²˜ ë°œì£¼ì„œ"]}):e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì „ì²´ ë°œì£¼ì„œë¥¼ ì¡°íšŒí•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.vendorId&&s.vendorId!==""&&e.jsx(N,{variant:"outline",size:"sm",onClick:()=>D("vendorId",""),className:`transition-colors ${a?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"ì „ì²´ ë°œì£¼ì„œ ë³´ê¸°"}),e.jsxs(N,{onClick:()=>C.mutate(),disabled:C.isPending,variant:"outline",size:"sm",className:`transition-colors ${a?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),C.isPending?"ë‚´ë³´ë‚´ëŠ” ì¤‘...":"ì—‘ì…€ ë‹¤ìš´ë¡œë“œ"]})]})]})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-3 mb-3",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ê²€ìƒ‰"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx(W,{placeholder:"ë°œì£¼ë²ˆí˜¸, ê±°ëž˜ì²˜ëª…ìœ¼ë¡œ ê²€ìƒ‰...",value:s.searchText,onChange:r=>D("searchText",r.target.value),className:`pl-10 h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.searchText?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsxs("div",{className:"w-full xl:w-72",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"í˜„ìž¥"}),e.jsxs(ae,{value:s.projectId||"all",onValueChange:r=>D("projectId",r),children:[e.jsx(se,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.projectId&&s.projectId!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(oe,{placeholder:"ëª¨ë“  í˜„ìž¥"})}),e.jsxs(le,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(I,{value:"all",children:"ëª¨ë“  í˜„ìž¥"}),B?.map(r=>e.jsxs(I,{value:r.id.toString(),children:[r.projectName," (",r.projectCode,")"]},r.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(N,{variant:"outline",onClick:()=>g(!f),className:`flex items-center gap-2 h-11 text-sm px-4 rounded-lg transition-colors ${a?"border-gray-600 text-gray-200 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,size:"sm",children:[e.jsx(xr,{className:"h-4 w-4"}),"ê³ ê¸‰ í•„í„°",f?e.jsx(Me,{className:"h-4 w-4"}):e.jsx(ze,{className:"h-4 w-4"})]})})]})}),f&&e.jsx("div",{className:`border-t pt-6 mt-4 transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2 xl:col-span-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ê¸ˆì•¡ ë²”ìœ„"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{type:"number",placeholder:"ìµœì†Œê¸ˆì•¡",value:s.minAmount,onChange:r=>D("minAmount",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.minAmount?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`}),e.jsx("span",{className:`text-sm transition-colors ${a?"text-gray-500":"text-gray-400"}`,children:"~"}),e.jsx(W,{type:"number",placeholder:"ìµœëŒ€ê¸ˆì•¡",value:s.maxAmount,onChange:r=>D("maxAmount",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.maxAmount?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ë°œì£¼ì¼ ë²”ìœ„"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{type:"date",value:s.startDate,onChange:r=>D("startDate",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.startDate?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`}),e.jsx("span",{className:`text-sm transition-colors ${a?"text-gray-500":"text-gray-400"}`,children:"~"}),e.jsx(W,{type:"date",value:s.endDate,onChange:r=>D("endDate",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.endDate?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ê±°ëž˜ì²˜"}),e.jsxs(ae,{value:s.vendorId||"all",onValueChange:r=>D("vendorId",r),children:[e.jsx(se,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.vendorId&&s.vendorId!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(oe,{placeholder:"ëª¨ë“  ê±°ëž˜ì²˜"})}),e.jsxs(le,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(I,{value:"all",children:"ëª¨ë“  ê±°ëž˜ì²˜"}),Array.isArray(q)?q.map(r=>e.jsx(I,{value:r.id.toString(),children:r.name},r.id)):null]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ë°œì£¼ ìƒíƒœ"}),e.jsxs(ae,{value:s.status||"all",onValueChange:r=>D("status",r),children:[e.jsx(se,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.status&&s.status!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(oe,{placeholder:"ëª¨ë“  ìƒíƒœ"})}),e.jsxs(le,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(I,{value:"all",children:"ëª¨ë“  ìƒíƒœ"}),e.jsx(I,{value:"draft",children:Y("draft")}),e.jsx(I,{value:"pending",children:Y("pending")}),e.jsx(I,{value:"approved",children:Y("approved")}),e.jsx(I,{value:"sent",children:Y("sent")}),e.jsx(I,{value:"completed",children:Y("completed")}),e.jsx(I,{value:"rejected",children:Y("rejected")})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ìž‘ì„±ìž"}),e.jsxs(ae,{value:s.userId||"all",onValueChange:r=>D("userId",r),children:[e.jsx(se,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.userId&&s.userId!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(oe,{placeholder:"ëª¨ë“  ìž‘ì„±ìž"})}),e.jsxs(le,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(I,{value:"all",children:"ëª¨ë“  ìž‘ì„±ìž"}),Array.isArray(V)?V.map(r=>e.jsx(I,{value:r.id,children:r.name||r.email},r.id)):null]})]})]})})]})}),e.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center justify-between gap-3 pt-4 mt-4 border-t transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:(s.projectId!==""||s.vendorId!==""||s.userId!==""||s.status!==""||s.startDate||s.endDate||s.minAmount||s.maxAmount||s.searchText)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`text-xs font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì ìš©ëœ í•„í„°:"}),s.searchText&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${a?"bg-blue-900/20 text-blue-300 border-blue-700":"bg-blue-50 text-blue-700 border-blue-200"}`,children:['ê²€ìƒ‰: "',s.searchText,'"',e.jsx("button",{onClick:()=>D("searchText",""),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${a?"hover:bg-blue-800 text-blue-400":"hover:bg-blue-100 text-blue-600"}`,children:"Ã—"})]}),s.projectId&&s.projectId!=="all"&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${a?"bg-gray-800 text-gray-300 border-gray-600":"bg-gray-50 text-gray-700 border-gray-200"}`,children:["í˜„ìž¥: ",Array.isArray(B)&&B.find(r=>r.id.toString()===s.projectId)?.projectName||"ì„ íƒëœ í˜„ìž¥",e.jsx("button",{onClick:()=>D("projectId","all"),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${a?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-100 text-gray-600"}`,children:"Ã—"})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[(s.projectId!==""||s.vendorId!==""||s.userId!==""||s.status!==""||s.startDate||s.endDate||s.minAmount||s.maxAmount||s.searchText)&&e.jsx(N,{variant:"outline",size:"sm",onClick:()=>{p({status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"})},className:`h-9 text-sm px-4 rounded-lg transition-colors ${a?"border-gray-600 hover:bg-gray-800":"border-gray-300 hover:bg-gray-50"}`,children:"í•„í„° ì´ˆê¸°í™”"}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>C.mutate(),disabled:C.isPending,className:`h-9 text-sm px-4 rounded-lg transition-colors ${a?"border-gray-600 hover:bg-gray-800":"border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),C.isPending?"ë‚´ë³´ë‚´ëŠ” ì¤‘...":"ì—‘ì…€ ë‹¤ìš´ë¡œë“œ"]})]})]})]})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx(Cr,{orders:x.map(r=>{const o={...r,vendorName:r.vendor?.name||r.vendorName,vendorId:r.vendor?.id||r.vendorId,projectName:r.project?.projectName||r.projectName,userName:r.user?.name||r.userName};return console.log("ðŸ” Mapped order:",o),o}),isLoading:F,isBulkDeleting:z.isPending,onStatusChange:(r,o)=>H.mutate({orderId:r,status:o}),onDelete:r=>h.mutate(r),onBulkDelete:he,onEmailSend:d,onViewEmailHistory:j,onViewPdf:G,sortBy:s.sortBy,sortOrder:s.sortOrder,onSort:t})}),v&&e.jsx(rr,{open:T,onOpenChange:M,orderData:{orderNumber:v.orderNumber,vendorName:v.vendor?.name||"",vendorEmail:v.vendor?.email,orderDate:new Date(v.orderDate).toLocaleDateString(),totalAmount:v.totalAmount,siteName:v.project?.projectName},onSendEmail:k}),y&&e.jsx(Ze,{orderId:y.id,orderNumber:y.orderNumber,isOpen:$,onClose:()=>{O(!1),u(null)}})]})})}export{it as default};
