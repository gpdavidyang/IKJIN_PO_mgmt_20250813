import{d as je,e as be,h as pe,u as Ne,g as ve,r as y,p as q,av as fe,q as V,k as A,j as e,n as M,B as b,P as we,I as N,f as K,aE as ne,N as $e,aw as Ce,ax as d,ay as x,az as g,aA as m,aB as h,S as _,x as z,y as Q,z as U,A as c,aF as De,aG as Se,aH as Me,L as Te,Y as ke,aI as Be,s as Fe,t as Ie}from"./index-BY9b8ocI-1757223020308.js";import{T as Pe,a as Le,b as I,c as v,d as Ee,e as i}from"./table-B2X01v2n-1757223020308.js";import{D as Oe,a as qe,b as Ve,c as Ae}from"./dialog-C3Tse2Vi-1757223020308.js";import{T as Ke}from"./textarea-D8AOLv4T-1757223020308.js";import{C as _e,a as ze,b as Qe,c as Ue,d as Ge}from"./command-Bwy1b1E--1757223020308.js";import{F as G}from"./folder-open-BwZCFv7T-1757223020308.js";import{S as He}from"./search-UHFUx5Tm-1757223020308.js";import{L as Re}from"./list-3_ZZojd4-1757223020308.js";import{G as We}from"./grid-3x3-DhK_gkgv-1757223020308.js";import{S as le}from"./square-pen-CVbUTIN8-1757223020308.js";import{T as oe}from"./trash-2-CEBibf7b-1757223020308.js";import{M as Ye}from"./map-pin-Bg-OxP88-1757223020308.js";import{D as Je}from"./dollar-sign-BySLwpSS-1757223020308.js";import{C as Xe}from"./calendar-CrW7k8yI-1757223020308.js";import{C as Ze}from"./chevrons-up-down-DiFTl2mD-1757223020308.js";import"./index-zE_B6_yr-1757223020308.js";const ie=u=>{switch(u){case"active":return"default";case"completed":return"secondary";case"on_hold":return"outline";case"cancelled":return"destructive";default:return"outline"}},ce=u=>{switch(u){case"active":return"진행중";case"completed":return"완료";case"on_hold":return"보류";case"cancelled":return"취소";default:return u}};function ys(){const{user:u}=je(),{toast:f}=be(),{theme:de}=pe(),t=de==="dark";console.log("🔍 Projects page - Current user:",u),console.log("🔍 User role:",u?.role),console.log("🔍 Can add project:",u?.role&&["admin","hq_management","project_manager"].includes(u.role));const[,H]=Ne(),T=ve(),[j,P]=y.useState(""),[p,xe]=y.useState(null),[k,R]=y.useState("asc"),[L,W]=y.useState("table"),[ge,w]=y.useState(!1),[$,E]=y.useState(null),[Y,me]=y.useState(!1),[O,J]=y.useState("none");y.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("filter");a==="recent"?(J("recent"),P("최근 1개월 시작")):a==="new"&&(J("new"),P("이번 달 신규"))},[]);const{data:B=[],isLoading:X}=q({queryKey:["/api/projects"]}),{data:F=[]}=q({queryKey:["/api/users"]}),{data:Z=[]}=q({queryKey:["/api/project-members"]}),l=fe({defaultValues:{projectName:"",projectCode:"",clientName:"",projectType:"",location:"",status:"active",projectManagerId:"",orderManagerIds:[],description:"",startDate:"",endDate:"",totalBudget:"",isActive:!0}}),ee=V({mutationFn:async s=>A("POST","/api/projects",s),onSuccess:()=>{T.invalidateQueries({queryKey:["/api/projects"]}),w(!1),l.reset(),f({description:"현장이 성공적으로 추가되었습니다."})},onError:s=>{f({variant:"destructive",description:s.message||"현장 추가 중 오류가 발생했습니다."})}}),se=V({mutationFn:async s=>A("PUT",`/api/projects/${$?.id}`,s),onSuccess:()=>{T.invalidateQueries({queryKey:["/api/projects"]}),w(!1),E(null),l.reset(),f({description:"현장이 성공적으로 수정되었습니다."})},onError:s=>{f({variant:"destructive",description:s.message||"현장 수정 중 오류가 발생했습니다."})}}),he=V({mutationFn:async s=>A("DELETE",`/api/projects/${s}`),onSuccess:()=>{T.invalidateQueries({queryKey:["/api/projects"]}),f({description:"프로젝트가 성공적으로 삭제되었습니다."})},onError:s=>{f({variant:"destructive",description:s.message||"현장 삭제 중 오류가 발생했습니다."})}}),C=y.useMemo(()=>{let s=B;if(O==="recent"){const a=new Date,r=new Date;r.setMonth(a.getMonth()-1),s=B.filter(n=>{if(!n.startDate)return!1;const o=new Date(n.startDate);return o>=r&&o<=a})}else if(O==="new"){const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1);s=B.filter(n=>{if(!n.startDate)return!1;const o=new Date(n.startDate);return o>=r&&o<=a})}return j&&!j.includes("최근 1개월")&&!j.includes("이번 달")&&(s=s.filter(a=>a.projectName.toLowerCase().includes(j.toLowerCase())||a.projectCode&&a.projectCode.toLowerCase().includes(j.toLowerCase())||a.clientName&&a.clientName.toLowerCase().includes(j.toLowerCase()))),s},[B,j,O]),ue=async s=>{const a={...s,totalBudget:s.totalBudget?s.totalBudget.toString().replace(/[^\d]/g,""):null,startDate:s.startDate||null,endDate:s.endDate||null};if($){const r={...a};if(delete r.orderManagerIds,await se.mutateAsync(r),s.orderManagerIds){const n=Z.filter(o=>o.projectId===$.id);for(const o of n)await fetch(`/api/project-members/${o.id}`,{method:"DELETE"});for(const o of s.orderManagerIds)await fetch("/api/project-members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:$.id,userId:o,role:"order_manager"})});T.invalidateQueries({queryKey:["/api/project-members"]}),T.invalidateQueries({queryKey:["/api/projects"]})}}else ee.mutate(a)},te=s=>{E(s);const a=Z.filter(r=>r.projectId===s.id).map(r=>r.userId);l.reset({projectName:s.projectName,projectCode:s.projectCode||"",clientName:s.clientName||"",projectType:s.projectType||"",location:s.location||"",status:s.status,projectManagerId:s.projectManagerId||"",orderManagerIds:a,description:s.description||"",startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:"",totalBudget:s.totalBudget||"",isActive:s.isActive}),w(!0)},ae=s=>{confirm("정말로 이 현장을 삭제하시겠습니까?")&&he.mutate(s)},ye=()=>{E(null),l.reset(),w(!0)},D=s=>{p===s?R(k==="asc"?"desc":"asc"):(xe(s),R("asc"))},S=s=>p!==s?null:k==="asc"?e.jsx(Fe,{className:"h-4 w-4"}):e.jsx(Ie,{className:"h-4 w-4"}),re=y.useMemo(()=>p?[...C].sort((s,a)=>{let r=s[p],n=a[p];return r==null&&(r=""),n==null&&(n=""),p==="totalBudget"?(r=parseFloat(r||"0"),n=parseFloat(n||"0")):p==="startDate"||p==="endDate"?(r=r?new Date(r).getTime():0,n=n?new Date(n).getTime():0):(r=String(r).toLowerCase(),n=String(n).toLowerCase()),k==="asc"?r<n?-1:r>n?1:0:n<r?-1:n>r?1:0}):C,[C,p,k]);return e.jsx("div",{className:`min-h-screen transition-colors ${t?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(G,{className:`h-6 w-6 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${t?"text-white":"text-gray-900"}`,children:"현장 관리"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"프로젝트 현장을 조회하고 관리하세요"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(M,{variant:"outline",className:`text-sm transition-colors ${t?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:["총 ",C.length,"개"]}),u?.role&&["admin","hq_management","project_manager"].includes(u.role)&&e.jsxs(b,{onClick:ye,className:`shadow-md hover:shadow-lg transition-all duration-200 ${t?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"현장 추가"]})]})]})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx(N,{placeholder:"현장명, 고객사명으로 검색...",value:j,onChange:s=>P(s.target.value),className:`pl-10 h-11 text-sm rounded-lg transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${j?`${t?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:`flex items-center rounded-lg p-1 transition-colors ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx(b,{variant:L==="table"?"default":"ghost",size:"sm",onClick:()=>W("table"),className:"h-8 w-8 p-0",title:"목록 보기",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx(b,{variant:L==="card"?"default":"ghost",size:"sm",onClick:()=>W("card"),className:"h-8 w-8 p-0",title:"카드 보기",children:e.jsx(We,{className:"h-4 w-4"})})]})})]})})}),L==="table"?e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pe,{children:[e.jsx(Le,{children:e.jsxs(I,{className:`border-b transition-colors ${t?"border-gray-600":"border-gray-200"}`,children:[e.jsx(v,{className:`px-6 py-3 text-sm font-medium cursor-pointer select-none transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>D("projectName"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"현장명"}),S("projectName")]})}),e.jsx(v,{className:`px-6 py-3 text-sm font-medium cursor-pointer select-none transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>D("clientName"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"고객사"}),S("clientName")]})}),e.jsx(v,{className:`px-6 py-3 text-sm font-medium cursor-pointer select-none transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>D("status"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"상태"}),S("status")]})}),e.jsx(v,{className:`px-6 py-3 text-sm font-medium cursor-pointer select-none transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>D("location"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"위치"}),S("location")]})}),e.jsx(v,{className:`px-6 py-3 text-sm font-medium cursor-pointer select-none transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>D("totalBudget"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"예산"}),S("totalBudget")]})}),e.jsx(v,{className:`px-6 py-3 text-sm font-medium cursor-pointer select-none transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>D("startDate"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"시작일"}),S("startDate")]})}),e.jsx(v,{className:`px-6 py-3 text-sm font-medium text-right transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"관리"})]})}),e.jsx(Ee,{children:X?[...Array(5)].map((s,a)=>e.jsxs(I,{children:[e.jsx(i,{children:e.jsx("div",{className:`h-3 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(i,{children:e.jsx("div",{className:`h-3 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(i,{children:e.jsx("div",{className:`h-3 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(i,{children:e.jsx("div",{className:`h-3 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(i,{children:e.jsx("div",{className:`h-3 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(i,{children:e.jsx("div",{className:`h-3 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(i,{})]},a)):re.length===0?e.jsx(I,{children:e.jsx(i,{colSpan:7,className:`text-center py-6 text-xs transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:j?"검색 결과가 없습니다":"등록된 현장이 없습니다"})}):re.map(s=>e.jsxs(I,{className:`border-b transition-colors ${t?"hover:bg-gray-700 border-gray-600":"hover:bg-gray-50 border-gray-100"}`,children:[e.jsx(i,{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium cursor-pointer overflow-hidden text-ellipsis whitespace-nowrap transition-colors ${t?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,onClick:()=>H(`/projects/${s.id}`),title:s.projectName,children:s.projectName}),e.jsx("div",{className:`text-sm transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:s.projectCode||"-"})]})}),e.jsx(i,{className:"py-4 px-6",children:e.jsx("div",{className:`text-sm transition-colors ${t?"text-gray-300":"text-gray-900"}`,children:s.clientName||"-"})}),e.jsx(i,{className:"py-4 px-6",children:e.jsx(M,{variant:ie(s.status),children:ce(s.status)})}),e.jsx(i,{className:"py-4 px-6",children:e.jsx("div",{className:`text-sm transition-colors ${t?"text-gray-300":"text-gray-900"}`,children:s.location||"-"})}),e.jsx(i,{className:"py-4 px-6",children:e.jsx("div",{className:`text-sm font-medium transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:s.totalBudget?K(s.totalBudget):"-"})}),e.jsx(i,{className:"py-4 px-6",children:e.jsx("div",{className:`text-sm transition-colors ${t?"text-gray-300":"text-gray-900"}`,children:s.startDate?ne(s.startDate):"-"})}),e.jsx(i,{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>te(s),className:`h-6 w-6 p-0 transition-colors ${t?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,title:"수정",children:e.jsx(le,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>ae(s.id),className:`h-6 w-6 p-0 transition-colors ${t?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"삭제",children:e.jsx(oe,{className:"h-3 w-3"})})]})})]},s.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2",children:X?[...Array(6)].map((s,a)=>e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`h-4 rounded animate-pulse ${t?"bg-gray-600":"bg-gray-200"}`}),e.jsx("div",{className:`h-3 rounded animate-pulse w-3/4 ${t?"bg-gray-600":"bg-gray-200"}`}),e.jsx("div",{className:`h-3 rounded animate-pulse w-1/2 ${t?"bg-gray-600":"bg-gray-200"}`})]})})},a)):C.length===0?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx(G,{className:`mx-auto h-8 w-8 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("p",{className:`text-xs mt-2 transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"등록된 현장이 없습니다."})]}):C.map(s=>e.jsxs("div",{className:`p-3 hover:shadow-md transition-shadow shadow-sm rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-colors ${t?"bg-blue-900/30":"bg-blue-100"}`,children:e.jsx(G,{className:`h-4 w-4 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-sm font-semibold cursor-pointer transition-colors ${t?"text-gray-100 hover:text-blue-400":"text-gray-900 hover:text-blue-600"}`,onClick:()=>H(`/projects/${s.id}`),children:s.projectName}),s.projectCode&&e.jsx("span",{className:`text-xs transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:s.projectCode})]})]}),e.jsx(M,{variant:ie(s.status),children:ce(s.status)})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:`flex items-center text-xs gap-2 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx($e,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:"고객사:"}),e.jsx("span",{className:"ml-1",children:s.clientName||"-"})]}),s.location&&e.jsxs("div",{className:`flex items-center text-xs gap-2 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Ye,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:"위치:"}),e.jsx("span",{className:"ml-1",children:s.location})]}),s.totalBudget&&e.jsxs("div",{className:`flex items-center text-xs gap-2 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Je,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:"예산:"}),e.jsx("span",{className:`ml-1 font-medium transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:K(s.totalBudget)})]}),s.startDate&&e.jsxs("div",{className:`flex items-center text-xs gap-2 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Xe,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:"시작일:"}),e.jsx("span",{className:"ml-1",children:ne(s.startDate)})]})]}),e.jsxs("div",{className:`flex items-center justify-end gap-2 pt-2 border-t transition-colors ${t?"border-gray-600":"border-gray-200"}`,children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>te(s),className:`h-8 w-8 p-0 transition-colors ${t?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,title:"수정",children:e.jsx(le,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>ae(s.id),className:`h-8 w-8 p-0 transition-colors ${t?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"삭제",children:e.jsx(oe,{className:"h-3 w-3"})})]})]},s.id))}),e.jsx(Oe,{open:ge,onOpenChange:w,children:e.jsxs(qe,{className:`max-w-2xl max-h-[90vh] overflow-y-auto transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(Ve,{children:e.jsx(Ae,{className:`transition-colors ${t?"text-white":"text-gray-900"}`,children:$?"현장 수정":"새 현장 추가"})}),e.jsx(Ce,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(ue),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{control:l.control,name:"projectName",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"현장명 *"}),e.jsx(m,{children:e.jsx(N,{...s,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"projectCode",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"현장 코드"}),e.jsx(m,{children:e.jsx(N,{...s,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{control:l.control,name:"clientName",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"고객사"}),e.jsx(m,{children:e.jsx(N,{...s,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"projectType",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"현장 유형"}),e.jsxs(_,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(m,{children:e.jsx(z,{className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(Q,{placeholder:"현장 유형을 선택하세요"})})}),e.jsxs(U,{className:`transition-colors ${t?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(c,{value:"아파트",children:"아파트"}),e.jsx(c,{value:"오피스텔",children:"오피스텔"}),e.jsx(c,{value:"단독주택",children:"단독주택"}),e.jsx(c,{value:"상업시설",children:"상업시설"}),e.jsx(c,{value:"사무실",children:"사무실"}),e.jsx(c,{value:"쇼핑몰",children:"쇼핑몰"}),e.jsx(c,{value:"공장",children:"공장"}),e.jsx(c,{value:"창고",children:"창고"}),e.jsx(c,{value:"인프라",children:"인프라"})]})]}),e.jsx(h,{})]})})]}),e.jsx(d,{control:l.control,name:"location",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"위치"}),e.jsx(m,{children:e.jsx(N,{...s,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(d,{control:l.control,name:"status",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"상태"}),e.jsxs(_,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(m,{children:e.jsx(z,{className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(Q,{})})}),e.jsxs(U,{className:`transition-colors ${t?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(c,{value:"active",children:"진행중"}),e.jsx(c,{value:"completed",children:"완료"}),e.jsx(c,{value:"on_hold",children:"보류"}),e.jsx(c,{value:"cancelled",children:"취소"})]})]}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"projectManagerId",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"현장 관리자"}),e.jsxs(_,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(z,{className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(Q,{placeholder:"선택하세요"})})}),e.jsx(U,{className:`transition-colors ${t?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:F.map(a=>e.jsx(c,{value:a.id,children:a.name},a.id))})]}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"orderManagerIds",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"발주 관리자 (복수 선택 가능)"}),e.jsx(m,{children:e.jsxs(De,{open:Y,onOpenChange:me,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(b,{variant:"outline",role:"combobox","aria-expanded":Y,className:`w-full justify-between transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:[!s.value||s.value.length===0?"발주 관리자를 선택하세요":e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.value.slice(0,2).map(a=>{const r=F.find(n=>n.id===a);return e.jsx(M,{variant:"secondary",className:"text-xs",children:r?.name||a},a)}),s.value.length>2&&e.jsxs(M,{variant:"secondary",className:"text-xs",children:["+",s.value.length-2,"명 더"]})]}),e.jsx(Ze,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Me,{className:`w-full p-0 transition-colors ${t?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:e.jsxs(_e,{className:`transition-colors ${t?"bg-gray-700":"bg-white"}`,children:[e.jsx(ze,{placeholder:"담당자 검색...",className:`transition-colors ${t?"bg-gray-700 text-gray-100":"bg-white"}`}),e.jsx(Qe,{className:`transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"담당자를 찾을 수 없습니다."}),e.jsx(Ue,{children:F.map(a=>e.jsxs(Ge,{onSelect:()=>{const r=s.value||[];r.includes(a.id)?s.onChange(r.filter(o=>o!==a.id)):s.onChange([...r,a.id])},children:[e.jsx(Te,{className:ke("mr-2 h-4 w-4",s.value?.includes(a.id)?"opacity-100":"opacity-0")}),a.name]},a.id))})]})})]})}),e.jsx(h,{}),s.value&&s.value.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"선택된 발주 관리자:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.value.map(a=>{const r=F.find(n=>n.id===a);return e.jsxs(M,{variant:"outline",className:`text-xs transition-colors ${t?"bg-blue-900/20 text-blue-400 border-blue-600":"bg-blue-50 text-blue-700 border-blue-200"}`,children:[r?.name||a,e.jsx("button",{type:"button",onClick:()=>{const n=s.value||[];s.onChange(n.filter(o=>o!==a))},className:"ml-1 hover:text-blue-900",children:"×"})]},a)})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(d,{control:l.control,name:"startDate",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"시작일"}),e.jsx(m,{children:e.jsx(N,{type:"date",...s,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"endDate",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"종료일"}),e.jsx(m,{children:e.jsx(N,{type:"date",...s,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"totalBudget",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"총 예산"}),e.jsx(m,{children:e.jsx(N,{type:"text",placeholder:"₩0",value:s.value?K(s.value):"",onChange:a=>{const r=Be(a.target.value);s.onChange(r.toString())},onBlur:s.onBlur,name:s.name,ref:s.ref,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})})]}),e.jsx(d,{control:l.control,name:"description",render:({field:s})=>e.jsxs(x,{children:[e.jsx(g,{className:`transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"설명"}),e.jsx(m,{children:e.jsx(Ke,{...s,rows:3,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>w(!1),children:"취소"}),e.jsx(b,{type:"submit",disabled:ee.isPending||se.isPending,children:$?"수정":"추가"})]})]})})]})})]})})}export{ys as default};
