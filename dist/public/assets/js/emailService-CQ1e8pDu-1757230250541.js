import{k as o}from"./index-DoUKJjFS-1757230250541.js";const n=class n{static async sendPurchaseOrderEmailOriginalFormat(e,r){try{return{success:!0,messageId:(await o("POST",`${this.BASE_URL}/send-email-original-format`,{filePath:e,...r})).data?.messageId}}catch(t){return console.error("ì›ë³¸ í˜•ì‹ ìœ ì§€ ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",t),{success:!1,error:t instanceof Error?t.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static async sendPurchaseOrderEmail(e,r){if(e.filePath){const t={to:r.to,cc:r.cc,subject:r.subject,additionalMessage:r.message,poData:{orderNumber:e.orderNumber,orderDate:e.orderDate,siteName:e.siteName,vendorName:e.vendorName,totalAmount:e.totalAmount}};t.attachments=[],e.attachmentUrls&&e.attachmentUrls.length>0&&(t.attachments=e.attachmentUrls.map((s,c)=>({path:s,filename:`ì²¨ë¶€íŒŒì¼_${e.orderNumber}_${c+1}`})));try{return await o("POST",`${this.BASE_URL}/send-email`,t)}catch(s){throw console.error("Email send error:",s),new Error("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}try{const t={orderData:{orderNumber:e.orderNumber,vendorName:e.vendorName,orderDate:e.orderDate,totalAmount:e.totalAmount,siteName:e.siteName},to:r.to,cc:r.cc,subject:r.subject,message:r.message,selectedAttachmentIds:r.selectedAttachmentIds,attachmentUrls:e.attachmentUrls,emailSettings:{subject:r.subject,message:r.message,cc:r.cc}};return e.attachmentUrls&&e.attachmentUrls.length>0&&console.log("ğŸ“ ì²¨ë¶€íŒŒì¼ URL ì¶”ê°€:",e.attachmentUrls),console.log("ğŸ“§ ì´ë©”ì¼ API ìš”ì²­ ë°ì´í„°:",t),{success:!0,messageId:(await o("POST","/api/orders/send-email",t)).messageId}}catch(t){throw console.error("Email send error:",t),new Error("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async testEmailConnection(){try{return await o("GET",`${this.BASE_URL}/test-email`)}catch(e){return console.error("Email connection test error:",e),{success:!1,message:"ì´ë©”ì¼ ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"}}}static async extractSheets(e,r=["ê°‘ì§€","ì„ì§€"]){try{return await o("POST",`${this.BASE_URL}/extract-sheets`,{filePath:e,sheets:r})}catch(t){throw console.error("Sheet extraction error:",t),new Error("ì‹œíŠ¸ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async convertToPDF(e,r){try{return await o("POST",`${this.BASE_URL}/convert-to-pdf`,{excelPath:e,sheets:r})}catch(t){throw console.error("PDF conversion error:",t),new Error("PDF ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async processComplete(e,r){const t=new FormData;t.append("file",e),Object.entries(r).forEach(([s,c])=>{c!==void 0&&(Array.isArray(c)?t.append(s,c.join(",")):t.append(s,c.toString()))});try{return await o("POST",`${this.BASE_URL}/process-complete`,t)}catch(s){throw console.error("Complete process error:",s),new Error("í†µí•© ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}};n.BASE_URL="/api/po-template";let a=n;export{a as E};
