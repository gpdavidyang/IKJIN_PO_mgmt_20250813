import{k as o}from"./index-DoUKJjFS-1757230250541.js";const n=class n{static async sendPurchaseOrderEmailOriginalFormat(e,r){try{return{success:!0,messageId:(await o("POST",`${this.BASE_URL}/send-email-original-format`,{filePath:e,...r})).data?.messageId}}catch(t){return console.error("원본 형식 유지 이메일 발송 오류:",t),{success:!1,error:t instanceof Error?t.message:"알 수 없는 오류"}}}static async sendPurchaseOrderEmail(e,r){if(e.filePath){const t={to:r.to,cc:r.cc,subject:r.subject,additionalMessage:r.message,poData:{orderNumber:e.orderNumber,orderDate:e.orderDate,siteName:e.siteName,vendorName:e.vendorName,totalAmount:e.totalAmount}};t.attachments=[],e.attachmentUrls&&e.attachmentUrls.length>0&&(t.attachments=e.attachmentUrls.map((s,c)=>({path:s,filename:`첨부파일_${e.orderNumber}_${c+1}`})));try{return await o("POST",`${this.BASE_URL}/send-email`,t)}catch(s){throw console.error("Email send error:",s),new Error("이메일 발송 중 오류가 발생했습니다.")}}try{const t={orderData:{orderNumber:e.orderNumber,vendorName:e.vendorName,orderDate:e.orderDate,totalAmount:e.totalAmount,siteName:e.siteName},to:r.to,cc:r.cc,subject:r.subject,message:r.message,selectedAttachmentIds:r.selectedAttachmentIds,attachmentUrls:e.attachmentUrls,emailSettings:{subject:r.subject,message:r.message,cc:r.cc}};return e.attachmentUrls&&e.attachmentUrls.length>0&&console.log("📎 첨부파일 URL 추가:",e.attachmentUrls),console.log("📧 이메일 API 요청 데이터:",t),{success:!0,messageId:(await o("POST","/api/orders/send-email",t)).messageId}}catch(t){throw console.error("Email send error:",t),new Error("이메일 발송 중 오류가 발생했습니다.")}}static async testEmailConnection(){try{return await o("GET",`${this.BASE_URL}/test-email`)}catch(e){return console.error("Email connection test error:",e),{success:!1,message:"이메일 서버 연결 테스트 실패"}}}static async extractSheets(e,r=["갑지","을지"]){try{return await o("POST",`${this.BASE_URL}/extract-sheets`,{filePath:e,sheets:r})}catch(t){throw console.error("Sheet extraction error:",t),new Error("시트 추출 중 오류가 발생했습니다.")}}static async convertToPDF(e,r){try{return await o("POST",`${this.BASE_URL}/convert-to-pdf`,{excelPath:e,sheets:r})}catch(t){throw console.error("PDF conversion error:",t),new Error("PDF 변환 중 오류가 발생했습니다.")}}static async processComplete(e,r){const t=new FormData;t.append("file",e),Object.entries(r).forEach(([s,c])=>{c!==void 0&&(Array.isArray(c)?t.append(s,c.join(",")):t.append(s,c.toString()))});try{return await o("POST",`${this.BASE_URL}/process-complete`,t)}catch(s){throw console.error("Complete process error:",s),new Error("통합 처리 중 오류가 발생했습니다.")}}};n.BASE_URL="/api/po-template";let a=n;export{a as E};
