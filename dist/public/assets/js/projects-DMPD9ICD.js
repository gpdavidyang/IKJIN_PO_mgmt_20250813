import{u as pe,a as K,e as ge,b as A,j as e}from"./chunk-D67rGsji.js";import{r as u}from"./chunk-BgLp_VvL.js";import{u as ve}from"./chunk-CFxRDIMf.js";import{k as Ne,l as fe,C as I,g as F,I as N,B as v,f as _,j as ne,F as ye,n as o,o as d,p as x,q as m,r as h,b as be,x as we}from"./chunk-DV-F1ehd.js";import{B as T}from"./chunk-Bw5QEQRA.js";import{g as Q,n as Ce,o as De,p as L,r as y,s as Se,t as i,D as Me,a as Te,b as Pe,c as Be,S as z,h as H,i as U,j as $,k as c,f as ke}from"./chunk-bdHBeqB0.js";import{P as Ie,a as Fe,b as Le}from"./chunk-D-mEonCb.js";import{C as Ee,a as Oe,b as Ve,c as qe,d as Ke}from"./chunk-3uln87AG.js";import{P as Ae}from"./chunk-D-9WNujI.js";import{_ as _e,aJ as Qe,aK as ze,av as le,K as ie,B as He,ax as Ue,as as $e,ar as Re,ak as Ge,b as Je,H as We,G as Ye}from"./chunk-CVirgo2y.js";import"./chunk-CZez8RVl.js";const ce=j=>{switch(j){case"active":return"default";case"completed":return"secondary";case"on_hold":return"outline";case"cancelled":return"destructive";default:return"outline"}},oe=j=>{switch(j){case"active":return"ì§„í–‰ì¤‘";case"completed":return"ì™„ë£Œ";case"on_hold":return"ë³´ë¥˜";case"cancelled":return"ì·¨ì†Œ";default:return j}};function os(){const{user:j}=Ne(),{toast:b}=fe();console.log("ðŸ” Projects page - Current user:",j),console.log("ðŸ” User role:",j?.role),console.log("ðŸ” Can add project:",j?.role&&["admin","hq_management","project_manager"].includes(j.role));const[,R]=ve(),S=pe(),[p,E]=u.useState(""),[g,de]=u.useState(null),[P,G]=u.useState("asc"),[O,J]=u.useState("table"),[xe,w]=u.useState(!1),[f,V]=u.useState(null),[W,me]=u.useState(!1),[q,Y]=u.useState("none");u.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("filter");a==="recent"?(Y("recent"),E("ìµœê·¼ 1ê°œì›” ì‹œìž‘")):a==="new"&&(Y("new"),E("ì´ë²ˆ ë‹¬ ì‹ ê·œ"))},[]);const{data:B=[],isLoading:X}=K({queryKey:["/api/projects"]}),{data:k=[]}=K({queryKey:["/api/users"]}),{data:Z=[]}=K({queryKey:["/api/project-members"]}),n=ge({defaultValues:{projectName:"",projectCode:"",clientName:"",projectType:"",location:"",status:"active",projectManagerId:"",orderManagerIds:[],description:"",startDate:"",endDate:"",totalBudget:"",isActive:!0}}),ee=A({mutationFn:async s=>Q("POST","/api/projects",s),onSuccess:()=>{S.invalidateQueries({queryKey:["/api/projects"]}),w(!1),n.reset(),b({description:"í˜„ìž¥ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:s=>{b({variant:"destructive",description:s.message||"í˜„ìž¥ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),se=A({mutationFn:async s=>Q("PUT",`/api/projects/${f?.id}`,s),onSuccess:()=>{S.invalidateQueries({queryKey:["/api/projects"]}),w(!1),V(null),n.reset(),b({description:"í˜„ìž¥ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:s=>{b({variant:"destructive",description:s.message||"í˜„ìž¥ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),he=A({mutationFn:async s=>Q("DELETE",`/api/projects/${s}`),onSuccess:()=>{S.invalidateQueries({queryKey:["/api/projects"]}),b({description:"í”„ë¡œì íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:s=>{b({variant:"destructive",description:s.message||"í˜„ìž¥ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),M=u.useMemo(()=>{let s=B;if(q==="recent"){const a=new Date,t=new Date;t.setMonth(a.getMonth()-1),s=B.filter(r=>{if(!r.startDate)return!1;const l=new Date(r.startDate);return l>=t&&l<=a})}else if(q==="new"){const a=new Date,t=new Date(a.getFullYear(),a.getMonth(),1);s=B.filter(r=>{if(!r.startDate)return!1;const l=new Date(r.startDate);return l>=t&&l<=a})}return p&&!p.includes("ìµœê·¼ 1ê°œì›”")&&!p.includes("ì´ë²ˆ ë‹¬")&&(s=s.filter(a=>a.projectName.toLowerCase().includes(p.toLowerCase())||a.projectCode&&a.projectCode.toLowerCase().includes(p.toLowerCase())||a.clientName&&a.clientName.toLowerCase().includes(p.toLowerCase()))),s},[B,p,q]),ue=async s=>{const a={...s,totalBudget:s.totalBudget?s.totalBudget.toString().replace(/[^\d]/g,""):null,startDate:s.startDate||null,endDate:s.endDate||null};if(f){const t={...a};if(delete t.orderManagerIds,await se.mutateAsync({id:f.id,...t}),s.orderManagerIds){const r=Z.filter(l=>l.projectId===f.id);for(const l of r)await fetch(`/api/project-members/${l.id}`,{method:"DELETE"});for(const l of s.orderManagerIds)await fetch("/api/project-members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:f.id,userId:l,role:"order_manager"})});S.invalidateQueries({queryKey:["/api/project-members"]}),S.invalidateQueries({queryKey:["/api/projects"]})}}else ee.mutate(a)},ae=s=>{V(s);const a=Z.filter(t=>t.projectId===s.id).map(t=>t.userId);n.reset({projectName:s.projectName,projectCode:s.projectCode||"",clientName:s.clientName||"",projectType:s.projectType||"",location:s.location||"",status:s.status,projectManagerId:s.projectManagerId||"",orderManagerIds:a,description:s.description||"",startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:"",totalBudget:s.totalBudget||"",isActive:s.isActive}),w(!0)},te=s=>{confirm("ì •ë§ë¡œ ì´ í˜„ìž¥ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&he.mutate(s)},je=()=>{V(null),n.reset(),w(!0)},C=s=>{g===s?G(P==="asc"?"desc":"asc"):(de(s),G("asc"))},D=s=>g!==s?null:P==="asc"?e.jsx(We,{className:"h-4 w-4"}):e.jsx(Ye,{className:"h-4 w-4"}),re=u.useMemo(()=>g?[...M].sort((s,a)=>{let t=s[g],r=a[g];return t==null&&(t=""),r==null&&(r=""),g==="totalBudget"?(t=parseFloat(t||"0"),r=parseFloat(r||"0")):g==="startDate"||g==="endDate"?(t=t?new Date(t).getTime():0,r=r?new Date(r).getTime():0):(t=String(t).toLowerCase(),r=String(r).toLowerCase()),P==="asc"?t<r?-1:t>r?1:0:r<t?-1:r>t?1:0}):M,[M,g,P]);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(Ae,{title:"í˜„ìž¥ ê´€ë¦¬",actionLabel:"í˜„ìž¥ ì¶”ê°€",onAction:je,showAction:!0}),e.jsx(I,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(_e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{placeholder:"í˜„ìž¥ëª…, í˜„ìž¥ ì½”ë“œ, ê³ ê°ì‚¬ëª…ìœ¼ë¡œ ê²€ìƒ‰...",value:p,onChange:s=>E(s.target.value),className:"pl-10 h-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[M.length,"ê°œ í˜„ìž¥"]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(v,{variant:O==="table"?"default":"ghost",size:"sm",onClick:()=>J("table"),className:"h-8 w-8 p-0",title:"ëª©ë¡ ë³´ê¸°",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(v,{variant:O==="card"?"default":"ghost",size:"sm",onClick:()=>J("card"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(ze,{className:"h-4 w-4"})})]})]})]})})}),O==="table"?e.jsx(I,{children:e.jsx(F,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs(L,{className:"border-b",children:[e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>C("projectName"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"í˜„ìž¥ëª…"}),D("projectName")]})}),e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>C("clientName"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ê³ ê°ì‚¬"}),D("clientName")]})}),e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>C("status"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ìƒíƒœ"}),D("status")]})}),e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>C("location"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ìœ„ì¹˜"}),D("location")]})}),e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>C("totalBudget"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ì˜ˆì‚°"}),D("totalBudget")]})}),e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>C("startDate"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ì‹œìž‘ì¼"}),D("startDate")]})}),e.jsx(y,{className:"h-11 px-4 text-sm font-semibold text-gray-700 w-[120px]",children:"ìž‘ì—…"})]})}),e.jsx(Se,{children:X?[...Array(5)].map((s,a)=>e.jsxs(L,{children:[e.jsx(i,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(i,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(i,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(i,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(i,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(i,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(i,{})]},a)):re.length===0?e.jsx(L,{children:e.jsx(i,{colSpan:7,className:"text-center py-8 text-gray-500",children:p?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ í˜„ìž¥ì´ ì—†ìŠµë‹ˆë‹¤"})}):re.map(s=>e.jsxs(L,{className:"h-12 hover:bg-gray-50 border-b border-gray-100",children:[e.jsx(i,{className:"py-2 px-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-800 hover:underline overflow-hidden text-ellipsis whitespace-nowrap",onClick:()=>R(`/projects/${s.id}`),title:s.projectName,children:s.projectName}),e.jsx("div",{className:"text-xs text-gray-500",children:s.projectCode||"-"})]})}),e.jsx(i,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:s.clientName||"-"})}),e.jsx(i,{className:"py-2 px-4",children:e.jsx(T,{variant:ce(s.status),children:oe(s.status)})}),e.jsx(i,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:s.location||"-"})}),e.jsx(i,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm font-semibold text-blue-600",children:s.totalBudget?_(s.totalBudget):"-"})}),e.jsx(i,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:s.startDate?ne(s.startDate):"-"})}),e.jsx(i,{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>ae(s),className:"h-7 w-7 p-0",title:"ìˆ˜ì •",children:e.jsx(le,{className:"h-3 w-3"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>te(s.id),className:"h-7 w-7 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(ie,{className:"h-3 w-3"})})]})})]},s.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:X?[...Array(6)].map((s,a)=>e.jsx(I,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})]})})},a)):M.map(s=>e.jsx(I,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsx(F,{className:"p-4",onClick:()=>R(`/projects/${s.id}`),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{children:e.jsx("h3",{className:"font-semibold text-gray-900 cursor-pointer hover:text-blue-600",children:s.projectName})}),e.jsx(T,{variant:ce(s.status),children:oe(s.status)})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{children:s.clientName||"-"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:s.location||"-"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-blue-600",children:s.totalBudget?_(s.totalBudget):"-"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),e.jsx("span",{children:s.startDate?ne(s.startDate):"-"})]})]}),e.jsxs("div",{className:"flex items-center justify-end -space-x-1 pt-2 border-t",onClick:a=>a.stopPropagation(),children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),ae(s)},className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"ìˆ˜ì •",children:e.jsx(le,{className:"h-3 w-3"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),te(s.id)},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"ì‚­ì œ",children:e.jsx(ie,{className:"h-3 w-3"})})]})]})})},s.id))}),e.jsx(Me,{open:xe,onOpenChange:w,children:e.jsxs(Te,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Pe,{children:e.jsx(Be,{children:f?"í˜„ìž¥ ìˆ˜ì •":"ìƒˆ í˜„ìž¥ ì¶”ê°€"})}),e.jsx(ye,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(ue),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(o,{control:n.control,name:"projectName",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"í˜„ìž¥ëª… *"}),e.jsx(m,{children:e.jsx(N,{...s})}),e.jsx(h,{})]})}),e.jsx(o,{control:n.control,name:"projectCode",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"í˜„ìž¥ ì½”ë“œ"}),e.jsx(m,{children:e.jsx(N,{...s})}),e.jsx(h,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(o,{control:n.control,name:"clientName",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ê³ ê°ì‚¬"}),e.jsx(m,{children:e.jsx(N,{...s})}),e.jsx(h,{})]})}),e.jsx(o,{control:n.control,name:"projectType",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"í˜„ìž¥ ìœ í˜•"}),e.jsxs(z,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(m,{children:e.jsx(H,{children:e.jsx(U,{placeholder:"í˜„ìž¥ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsxs($,{children:[e.jsx(c,{value:"ì•„íŒŒíŠ¸",children:"ì•„íŒŒíŠ¸"}),e.jsx(c,{value:"ì˜¤í”¼ìŠ¤í…”",children:"ì˜¤í”¼ìŠ¤í…”"}),e.jsx(c,{value:"ë‹¨ë…ì£¼íƒ",children:"ë‹¨ë…ì£¼íƒ"}),e.jsx(c,{value:"ìƒì—…ì‹œì„¤",children:"ìƒì—…ì‹œì„¤"}),e.jsx(c,{value:"ì‚¬ë¬´ì‹¤",children:"ì‚¬ë¬´ì‹¤"}),e.jsx(c,{value:"ì‡¼í•‘ëª°",children:"ì‡¼í•‘ëª°"}),e.jsx(c,{value:"ê³µìž¥",children:"ê³µìž¥"}),e.jsx(c,{value:"ì°½ê³ ",children:"ì°½ê³ "}),e.jsx(c,{value:"ì¸í”„ë¼",children:"ì¸í”„ë¼"})]})]}),e.jsx(h,{})]})})]}),e.jsx(o,{control:n.control,name:"location",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ìœ„ì¹˜"}),e.jsx(m,{children:e.jsx(N,{...s})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(o,{control:n.control,name:"status",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ìƒíƒœ"}),e.jsxs(z,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(m,{children:e.jsx(H,{children:e.jsx(U,{})})}),e.jsxs($,{children:[e.jsx(c,{value:"active",children:"ì§„í–‰ì¤‘"}),e.jsx(c,{value:"completed",children:"ì™„ë£Œ"}),e.jsx(c,{value:"on_hold",children:"ë³´ë¥˜"}),e.jsx(c,{value:"cancelled",children:"ì·¨ì†Œ"})]})]}),e.jsx(h,{})]})}),e.jsx(o,{control:n.control,name:"projectManagerId",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €"}),e.jsxs(z,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(H,{children:e.jsx(U,{placeholder:"ì„ íƒí•˜ì„¸ìš”"})})}),e.jsx($,{children:k.map(a=>e.jsx(c,{value:a.id,children:a.name},a.id))})]}),e.jsx(h,{})]})}),e.jsx(o,{control:n.control,name:"orderManagerIds",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ë°œì£¼ ê´€ë¦¬ìž (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)"}),e.jsx(m,{children:e.jsxs(Ie,{open:W,onOpenChange:me,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(v,{variant:"outline",role:"combobox","aria-expanded":W,className:"w-full justify-between",children:[!s.value||s.value.length===0?"ë°œì£¼ ê´€ë¦¬ìžë¥¼ ì„ íƒí•˜ì„¸ìš”":e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.value.slice(0,2).map(a=>{const t=k.find(r=>r.id===a);return e.jsx(T,{variant:"secondary",className:"text-xs",children:t?.name||a},a)}),s.value.length>2&&e.jsxs(T,{variant:"secondary",className:"text-xs",children:["+",s.value.length-2,"ëª… ë”"]})]}),e.jsx(Ge,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Le,{className:"w-full p-0",children:e.jsxs(Ee,{children:[e.jsx(Oe,{placeholder:"ë‹´ë‹¹ìž ê²€ìƒ‰..."}),e.jsx(Ve,{children:"ë‹´ë‹¹ìžë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx(qe,{children:k.map(a=>e.jsxs(Ke,{onSelect:()=>{const t=s.value||[];t.includes(a.id)?s.onChange(t.filter(l=>l!==a.id)):s.onChange([...t,a.id])},children:[e.jsx(Je,{className:be("mr-2 h-4 w-4",s.value?.includes(a.id)?"opacity-100":"opacity-0")}),a.name]},a.id))})]})})]})}),e.jsx(h,{}),s.value&&s.value.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ì„ íƒëœ ë°œì£¼ ê´€ë¦¬ìž:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.value.map(a=>{const t=k.find(r=>r.id===a);return e.jsxs(T,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[t?.name||a,e.jsx("button",{type:"button",onClick:()=>{const r=s.value||[];s.onChange(r.filter(l=>l!==a))},className:"ml-1 hover:text-blue-900",children:"Ã—"})]},a)})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(o,{control:n.control,name:"startDate",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ì‹œìž‘ì¼"}),e.jsx(m,{children:e.jsx(N,{type:"date",...s})}),e.jsx(h,{})]})}),e.jsx(o,{control:n.control,name:"endDate",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ì¢…ë£Œì¼"}),e.jsx(m,{children:e.jsx(N,{type:"date",...s})}),e.jsx(h,{})]})}),e.jsx(o,{control:n.control,name:"totalBudget",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ì´ ì˜ˆì‚°"}),e.jsx(m,{children:e.jsx(N,{type:"text",placeholder:"â‚©0",value:s.value?_(s.value):"",onChange:a=>{const t=we(a.target.value);s.onChange(t.toString())},onBlur:s.onBlur,name:s.name,ref:s.ref})}),e.jsx(h,{})]})})]}),e.jsx(o,{control:n.control,name:"description",render:({field:s})=>e.jsxs(d,{children:[e.jsx(x,{children:"ì„¤ëª…"}),e.jsx(m,{children:e.jsx(ke,{...s,rows:3})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>w(!1),children:"ì·¨ì†Œ"}),e.jsx(v,{type:"submit",disabled:ee.isPending||se.isPending,children:f?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})})]})}export{os as default};
