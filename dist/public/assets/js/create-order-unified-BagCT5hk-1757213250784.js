import{c as oe,r as g,j as e,e as Le,s as z,n as _,G as B,H as V,ao as Qe,a as te,t as L,F as q,b as D,z as H,B as h,N as We,E as de,O as $e,ap as Me,p as re,d as Ue,D as ye,J as I,I as G,P as qe,al as Ye,am as es,aq as ss,L as ts,X as Se,m as rs,ar as ge,u as as}from"./index-BfDc6Omt-1757213250784.js";import{A as ae,a as le}from"./alert-COSiiwC3-1757213250784.js";import{Z as we}from"./zap-GaLJLBju-1757213250784.js";import{U as Be}from"./users-DFvByWQM-1757213250784.js";import{P as ls}from"./pen-line-Docc1AgI-1757213250784.js";import{P as be}from"./progress-DuZK7-yS-1757213250784.js";import{S as is}from"./separator-BsI4cP4l-1757213250784.js";import{C as ne}from"./circle-check-BO3IP98f-1757213250784.js";import{C as ns}from"./circle-play-DoXB5i-A-1757213250784.js";import{R as Y}from"./refresh-cw-CVqRgU6S-1757213250784.js";import{C as ke}from"./circle-x-BWH4ORUI-1757213250784.js";import{A as ce}from"./arrow-right-BUgpd0PG-1757213250784.js";import{I as he}from"./info-CKu1PqNX-1757213250784.js";import{D as se}from"./download-Bsg6xcv--1757213250784.js";import{P as ds}from"./paperclip-BHZO3Lqx-1757213250784.js";import{M as pe}from"./mail-CWuNivJ3-1757213250784.js";import{U as Ce}from"./upload-DPiNX7Vn-1757213250784.js";import{T as Pe}from"./textarea-qWNYibjv-1757213250784.js";import{S as J,a as Z,b as X,c as Q,d as O}from"./select-BLTlOVj9-1757213250784.js";import{C as Te}from"./checkbox-D_CQ2E-T-1757213250784.js";import{g as cs,b as Ae}from"./order-utils-C4eLdozv-1757213250784.js";import{P as Ve}from"./package-DoesSaI9-1757213250784.js";import{T as os}from"./trash-2-Vt9HzQc1-1757213250784.js";import{D as xs}from"./dollar-sign-CphQbANq-1757213250784.js";import{C as ms}from"./calendar-Bk7TvZtk-1757213250784.js";import{a as hs,b as ps,c as gs,D as Ee,f as us}from"./dialog-Bo48vr0k-1757213250784.js";import{T as js,a as fs,b as Fe,c as ue}from"./tabs-BQBrwsH2-1757213250784.js";import{h as ys,E as bs}from"./html2canvas.esm-BiHlHATk-1757213250784.js";import{P as Ne}from"./printer-F2QNxMRa-1757213250784.js";import{E as Ns}from"./email-send-dialog-DT27Rw5d-1757213250784.js";import{A as vs}from"./archive-Bda_YPu_-1757213250784.js";import{T as ws}from"./triangle-alert-CrwRroiq-1757213250784.js";import{T as De}from"./trending-up-kGnMmAZP-1757213250784.js";import{S as Ie}from"./save-D-19p1G_-1757213250784.js";import{C as Ss}from"./chevron-left-C_HJWEvB-1757213250784.js";import{A as ks}from"./arrow-left-DECUl3xp-1757213250784.js";import"./index-38EM6Lo0-1757213250784.js";import"./chevron-down-C_SK49in-1757213250784.js";import"./chevron-up-DBeMyJPH-1757213250784.js";import"./index-Bkwo1L4z-1757213250784.js";import"./send-DCwOAJQH-1757213250784.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=oe("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=oe("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=oe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=oe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=oe("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),W=[];for(let s=0;s<256;++s)W.push((s+256).toString(16).slice(1));function Ts(s,t=0){return(W[s[t+0]]+W[s[t+1]]+W[s[t+2]]+W[s[t+3]]+"-"+W[s[t+4]]+W[s[t+5]]+"-"+W[s[t+6]]+W[s[t+7]]+"-"+W[s[t+8]]+W[s[t+9]]+"-"+W[s[t+10]]+W[s[t+11]]+W[s[t+12]]+W[s[t+13]]+W[s[t+14]]+W[s[t+15]]).toLowerCase()}let je;const As=new Uint8Array(16);function Es(){if(!je){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");je=crypto.getRandomValues.bind(crypto)}return je(As)}const Fs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_e={randomUUID:Fs};function Re(s,t,n){if(_e.randomUUID&&!t&&!s)return _e.randomUUID();s=s||{};const i=s.random??s.rng?.()??Es();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Ts(i)}const Ds={PDF_GENERATION:{id:"pdf_generation",title:"PDF ìƒì„±",description:"ë°œì£¼ì„œë¥¼ PDFë¡œ ë³€í™˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},VENDOR_VALIDATION:{id:"vendor_validation",title:"ê±°ëž˜ì²˜ ê²€ì¦",description:"ê±°ëž˜ì²˜ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},EMAIL_PREPARATION:{id:"email_preparation",title:"ì´ë©”ì¼ ì¤€ë¹„",description:"ì´ë©”ì¼ì„ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},ATTACHMENT_PROCESSING:{id:"attachment_processing",title:"ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬",description:"ì²¨ë¶€íŒŒì¼ì„ ì¤€ë¹„í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},FINAL_VALIDATION:{id:"final_validation",title:"ìµœì¢… ê²€ì¦",description:"ëª¨ë“  ì •ë³´ë¥¼ ìµœì¢… í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤"}},Ke={select:{title:"ë°©ì‹ ì„ íƒ",description:"í‘œì¤€/ì—‘ì…€ ì„ íƒ",required:!0,validation:s=>!!s.creationMethod},create:{title:"ë°œì£¼ì„œ ìž‘ì„±",description:"ë°ì´í„° ìž…ë ¥",required:!0,validation:s=>s.stepStates.creation.isValid},approve:{title:"ìŠ¹ì¸ ì²˜ë¦¬",description:"ì„ íƒì ",required:!1,validation:s=>!s.stepStates.approval.required||s.stepStates.approval.status==="approved"},process:{title:"í›„ì²˜ë¦¬",description:"PDF/ì´ë©”ì¼",required:!0,validation:s=>s.stepStates.processing.failedSteps.length===0},complete:{title:"ì™„ë£Œ",description:"ê²°ê³¼ í™•ì¸",required:!0,validation:s=>!!s.stepStates.completed.savedAt}},He=g.createContext(void 0),Ge=()=>({currentStep:"select",steps:Object.entries(Ke).map(([s,t])=>({id:s,title:t.title,description:t.description,status:s==="select"?"current":"pending"})),stepStates:{creation:{isValid:!1},approval:{required:!1},processing:{steps:Object.values(Ds).map(s=>({...s,status:"idle"})),completedSteps:[],failedSteps:[]},completed:{}},metadata:{workflowId:Re(),startedAt:new Date,lastModified:new Date,userId:"",sessionId:Re(),version:"1.0.0"},flags:{skipApproval:!1,autoProcess:!0,sendEmails:!0,generatePDF:!0}}),Is=(s,t)=>{switch(t.type){case"SET_STEP":return{...s,currentStep:t.payload,steps:s.steps.map(d=>({...d,status:d.id===t.payload?"current":s.steps.findIndex(p=>p.id===d.id)<s.steps.findIndex(p=>p.id===t.payload)?"completed":"pending"})),metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_STEP_STATUS":return{...s,steps:s.steps.map(d=>d.id===t.payload.step?{...d,status:t.payload.status}:d),metadata:{...s.metadata,lastModified:new Date}};case"SET_CREATION_METHOD":return{...s,creationMethod:t.payload,stepStates:{...s.stepStates,creation:{...s.stepStates.creation,method:t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_ORDER_DATA":return{...s,orderData:t.payload,metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_CREATION_STATE":return{...s,stepStates:{...s.stepStates,creation:{...s.stepStates.creation,...t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_APPROVAL_STATE":return{...s,stepStates:{...s.stepStates,approval:{...s.stepStates.approval,...t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_PROCESSING_STEP":const n=s.stepStates.processing.steps.map(d=>d.id===t.payload.stepId?{...d,...t.payload.update}:d),i=n.filter(d=>d.status==="completed").map(d=>d.id),o=n.filter(d=>d.status==="error").map(d=>d.id);return{...s,stepStates:{...s.stepStates,processing:{...s.stepStates.processing,steps:n,completedSteps:i,failedSteps:o}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_COMPLETED_STATE":return{...s,stepStates:{...s.stepStates,completed:{...s.stepStates.completed,...t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"SET_FLAGS":return{...s,flags:{...s.flags,...t.payload},metadata:{...s.metadata,lastModified:new Date}};case"RESET_WORKFLOW":return Ge();default:return s}},Os=({children:s})=>{const[t,n]=g.useReducer(Is,Ge()),i=["select","create","approve","process","complete"],o=g.useCallback(()=>i.indexOf(t.currentStep),[t.currentStep]),d=g.useCallback(()=>{const u=Ke[t.currentStep];return u.validation?u.validation(t):!0},[t]),p=g.useCallback(()=>{const u=o();if(u<i.length-1){const C=i[u+1];C==="approve"&&!t.stepStates.approval.required?(n({type:"UPDATE_STEP_STATUS",payload:{step:"approve",status:"skipped"}}),n({type:"SET_STEP",payload:"process"})):n({type:"SET_STEP",payload:C})}},[o,t.stepStates.approval.required]),b=g.useCallback(()=>{const u=o();if(u>0){const C=i[u-1];C==="approve"&&t.steps.find(A=>A.id==="approve")?.status==="skipped"?n({type:"SET_STEP",payload:"create"}):n({type:"SET_STEP",payload:C})}},[o,t.steps]),f=g.useCallback(u=>{n({type:"SET_STEP",payload:u})},[]),a=g.useCallback(u=>{n({type:"SET_CREATION_METHOD",payload:u})},[]),k=g.useCallback(u=>{n({type:"UPDATE_ORDER_DATA",payload:u})},[]),F=g.useCallback((u,C)=>{n({type:"UPDATE_PROCESSING_STEP",payload:{stepId:u,update:C}})},[]),R=g.useCallback(u=>t.steps.find(C=>C.id===u),[t.steps]);g.useEffect(()=>{localStorage.getItem(`workflow_${t.metadata.workflowId}`)||localStorage.setItem(`workflow_${t.metadata.workflowId}`,JSON.stringify(t))},[t]);const P={state:t,dispatch:n,goToNextStep:p,goToPreviousStep:b,goToStep:f,setCreationMethod:a,updateOrderData:k,updateProcessingStep:F,canProceed:d,getCurrentStepIndex:o,getStepStatus:R};return e.jsx(He.Provider,{value:P,children:s})},_s=()=>{const s=g.useContext(He);if(!s)throw new Error("useOrderWorkflow must be used within OrderWorkflowProvider");return s},Rs=(s,t=!1)=>{const n=["select","create","approve","process","complete"],i=n.indexOf(s);if(i===-1||i===n.length-1)return null;const o=n[i+1];return o==="approve"&&t?n[i+2]||null:o},zs=(s,t=!1)=>{const n=["select","create","approve","process","complete"],i=n.indexOf(s);if(i<=0)return null;const o=n[i-1];return o==="approve"&&t?n[i-2]||null:o},Ls=s=>{const t=s.steps.filter(i=>i.id!=="approve"||s.stepStates.approval.required).length,n=s.steps.filter(i=>i.status==="completed"||i.status==="skipped").length;return Math.round(n/t*100)},Ws=s=>{const t={select:1,create:5,approve:10,process:3,complete:1};return s.steps.filter(i=>i.status==="pending"||i.status==="current").reduce((i,o)=>o.id==="approve"&&!s.stepStates.approval.required?i:i+(t[o.id]||0),0)},$s=(s,t)=>{const n={};return s==="standard"?(t?.projectId||(n.projectId="í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),t?.vendorId||(n.vendorId="ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),(!t?.items||t.items.length===0)&&(n.items="í’ˆëª©ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”"),t?.orderDate||(n.orderDate="ë°œì£¼ì¼ìžë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),t?.deliveryDate||(n.deliveryDate="ë‚©ê¸°ì¼ìžë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”")):s==="excel"&&(t?((!t.type||t.type!=="excel")&&(n.type="ì—‘ì…€ ì—…ë¡œë“œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"),(!t.orders||t.orders.length===0)&&(n.orders="íŒŒì‹±ëœ ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"),t.filePath||(n.filePath="íŒŒì¼ ê²½ë¡œê°€ ì—†ìŠµë‹ˆë‹¤"),t.parseErrors&&t.parseErrors.length>0&&(n.parse="ì—‘ì…€ íŒŒì¼ íŒŒì‹± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤")):n.data="ì—…ë¡œë“œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"),{isValid:Object.keys(n).length===0,errors:n}},Ms=s=>{const t=[];return s.generatePDF&&t.push({id:"pdf_generation",title:"PDF ìƒì„±",description:"ë°œì£¼ì„œë¥¼ PDFë¡œ ë³€í™˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),t.push({id:"vendor_validation",title:"ê±°ëž˜ì²˜ ê²€ì¦",description:"ê±°ëž˜ì²˜ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),s.sendEmails&&(t.push({id:"email_preparation",title:"ì´ë©”ì¼ ì¤€ë¹„",description:"ì´ë©”ì¼ì„ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),t.push({id:"attachment_processing",title:"ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬",description:"ì²¨ë¶€íŒŒì¼ì„ ì¤€ë¹„í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"})),t.push({id:"final_validation",title:"ìµœì¢… ê²€ì¦",description:"ëª¨ë“  ì •ë³´ë¥¼ ìµœì¢… í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),t},Us=s=>{const t=`workflow_${s.metadata.workflowId}`;localStorage.setItem(t,JSON.stringify(s));const n=Je(),i=[{id:s.metadata.workflowId,date:s.metadata.lastModified},...n.filter(o=>o.id!==s.metadata.workflowId)].slice(0,10);localStorage.setItem("recentWorkflows",JSON.stringify(i))},qs=s=>{const t=`workflow_${s}`,n=localStorage.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(i){return console.error("Failed to parse workflow state:",i),null}},Je=()=>{const s=localStorage.getItem("recentWorkflows");if(!s)return[];try{return JSON.parse(s)}catch{return[]}},Bs=s=>s.status==="error"&&!["final_validation"].includes(s.id),Vs=s=>Math.min(1e3*Math.pow(2,s),3e4),Ks=(s,t)=>{if(!s)return"-";const i=(t||new Date).getTime()-s.getTime(),o=Math.floor(i/1e3);if(o<60)return`${o}ì´ˆ`;const d=Math.floor(o/60),p=o%60;return`${d}ë¶„ ${p}ì´ˆ`},Hs=s=>({select:"ðŸ“‹",create:"âœï¸",approve:"âœ…",process:"âš™ï¸",complete:"ðŸŽ‰"})[s]||"ðŸ“„",Gs=s=>({pending:"text-gray-500 bg-gray-100",current:"text-blue-700 bg-blue-100",completed:"text-green-700 bg-green-100",error:"text-red-700 bg-red-100",skipped:"text-gray-400 bg-gray-50"})[s]||"text-gray-500 bg-gray-100",K={getNextStep:Rs,getPreviousStep:zs,calculateWorkflowProgress:Ls,estimateRemainingTime:Ws,validateCreationData:$s,createProcessingPipeline:Ms,saveWorkflowState:Us,loadWorkflowState:qs,getRecentWorkflows:Je,canRetryStep:Bs,getRetryDelay:Vs,formatStepDuration:Ks,getStepIcon:Hs,getStatusColor:Gs},ve={post:async(s,t)=>s.includes("check-approval")?{data:{required:t.amount>1e6}}:s.includes("generate-pdf")?{data:{url:"/api/downloads/order.pdf"}}:s.includes("validate")?{data:{valid:!0,suggestions:[]}}:{data:{}}},Js=()=>{const s=_s(),{toast:t}=Le(),[n,i]=g.useState(!1),[o,d]=g.useState(null),p=s.canProceed(),b=s.getCurrentStepIndex()>0,f=K.calculateWorkflowProgress(s.state),a=K.estimateRemainingTime(s.state),k=g.useCallback(()=>{if(!p){t({title:"ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",description:"í˜„ìž¬ ë‹¨ê³„ë¥¼ ì™„ë£Œí•´ì£¼ì„¸ìš”",variant:"destructive"});return}s.goToNextStep()},[p,s,t]),F=g.useCallback(()=>{b&&s.goToPreviousStep()},[b,s]),R=g.useCallback(N=>{const y=["select","create","approve","process","complete"].indexOf(N),S=s.getCurrentStepIndex();if(y>S+1){t({title:"ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",description:"ì´ì „ ë‹¨ê³„ë¥¼ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”",variant:"destructive"});return}s.goToStep(N)},[s,t]),P=g.useCallback(N=>{s.setCreationMethod(N),setTimeout(()=>{s.goToNextStep()},500)},[s]),u=g.useCallback(async N=>{try{const y=K.validateCreationData(s.state.creationMethod,N);if(!y.isValid){const x=Object.values(y.errors).join(", ");t({title:"ìž…ë ¥ ì˜¤ë¥˜",description:x||"í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”",variant:"destructive"}),console.error("Validation errors:",y.errors),console.error("Submitted data:",N);return}s.updateOrderData(N),s.dispatch({type:"UPDATE_CREATION_STATE",payload:{data:N,isValid:!0,validationErrors:{}}});const S=await Zs(N);s.dispatch({type:"UPDATE_APPROVAL_STATE",payload:{required:S}}),K.saveWorkflowState(s.state),t({title:"ì €ìž¥ ì™„ë£Œ",description:"ë°œì£¼ì„œ ì •ë³´ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"}),setTimeout(()=>{s.goToNextStep()},1e3)}catch(y){console.error("Failed to submit order data:",y),t({title:"ì €ìž¥ ì‹¤íŒ¨",description:"ë°œì£¼ì„œ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",variant:"destructive"})}},[s,t]),C=g.useCallback(async()=>{i(!0);try{const N=K.createProcessingPipeline(s.state.flags);for(const y of N){d(y.id),s.updateProcessingStep(y.id,{status:"processing"});try{const S=await ze(y,s.state);s.updateProcessingStep(y.id,{status:"completed",result:S,progress:100})}catch(S){throw s.updateProcessingStep(y.id,{status:"error",error:S.message}),S}}s.dispatch({type:"UPDATE_COMPLETED_STATE",payload:{savedAt:new Date,orderNumber:s.state.orderData?.orderNumber,nextActions:["ë°œì£¼ì„œ ëª©ë¡ ë³´ê¸°","ìƒˆ ë°œì£¼ì„œ ìž‘ì„±"]}}),K.saveWorkflowState(s.state),s.goToNextStep(),t({title:"ì²˜ë¦¬ ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤"})}catch(N){t({title:"ì²˜ë¦¬ ì‹¤íŒ¨",description:N.message||"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",variant:"destructive"})}finally{i(!1),d(null)}},[s,t]),A=g.useCallback(async N=>{const y=s.state.stepStates.processing.steps.find(S=>S.id===N);if(!(!y||!K.canRetryStep(y))){i(!0),d(N);try{s.updateProcessingStep(N,{status:"processing"});const S=await ze(y,s.state);s.updateProcessingStep(N,{status:"completed",result:S,progress:100}),t({title:"ìž¬ì‹œë„ ì„±ê³µ",description:`${y.title} ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤`}),s.state.stepStates.processing.failedSteps.length===1&&await C()}catch(S){s.updateProcessingStep(N,{status:"error",error:S.message}),t({title:"ìž¬ì‹œë„ ì‹¤íŒ¨",description:S.message||"ìž¬ì‹œë„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",variant:"destructive"})}finally{i(!1),d(null)}}},[s,C,t]),T=g.useCallback(()=>{K.saveWorkflowState(s.state),t({title:"ì €ìž¥ ì™„ë£Œ",description:"ì§„í–‰ ìƒí™©ì´ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"})},[s.state,t]),M=g.useCallback(N=>{const y=K.loadWorkflowState(N);t(y?{title:"ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ",description:"ì €ìž¥ëœ ì§„í–‰ ìƒí™©ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤"}:{title:"ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨",description:"ì €ìž¥ëœ ì§„í–‰ ìƒí™©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",variant:"destructive"})},[t]);return g.useEffect(()=>{const N=setTimeout(()=>{K.saveWorkflowState(s.state)},2e3);return()=>clearTimeout(N)},[s.state]),{workflow:s.state,isProcessing:n,currentProcessingStep:o,canGoNext:p,canGoPrevious:b,goNext:k,goPrevious:F,goToStep:R,selectCreationMethod:P,submitOrderData:u,startProcessing:C,retryProcessingStep:A,progress:f,estimatedTime:a,saveProgress:T,loadProgress:M}};async function Zs(s){try{return(await ve.post("/api/orders/check-approval",{amount:s.totalAmount,projectId:s.projectId})).data.required}catch{return!0}}async function ze(s,t){switch(await new Promise(n=>setTimeout(n,1e3)),s.id){case"pdf_generation":return{pdfUrl:(await ve.post("/api/orders/generate-pdf",{orderData:t.orderData})).data.url};case"vendor_validation":const i=await ve.post("/api/vendors/validate",{vendorId:t.orderData.vendorId,vendorEmail:t.orderData.vendorEmail});return{isValid:i.data.valid,suggestions:i.data.suggestions};case"email_preparation":return{subject:`ë°œì£¼ì„œ - ${t.orderData.orderNumber}`,recipients:[t.orderData.vendorEmail],body:"ë°œì£¼ì„œë¥¼ ì²¨ë¶€í•©ë‹ˆë‹¤."};case"attachment_processing":return{attachments:["purchase_order.pdf","additional_docs.zip"]};case"final_validation":return{allChecksPass:!0};default:throw new Error(`Unknown processing step: ${s.id}`)}}const Xs=[{id:"excel",title:"ì—‘ì…€ ë°œì£¼ì„œ",description:"ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë°œì£¼ì„œë¥¼ ìžë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤",icon:e.jsx(We,{className:"w-8 h-8 text-green-600"}),features:["ë‹¤ëŸ‰ì˜ ë°œì£¼ì„œ ì¼ê´„ ì²˜ë¦¬","ê¸°ì¡´ ì—‘ì…€ ì–‘ì‹ í™œìš©","ìžë™ ë°ì´í„° íŒŒì‹±","ê±°ëž˜ì²˜ ìžë™ ê²€ì¦","PDF ë³€í™˜ ë° ì´ë©”ì¼ ë°œì†¡"],pros:["ë¹ ë¥¸ ëŒ€ëŸ‰ ì²˜ë¦¬","ê¸°ì¡´ ì—…ë¬´ ë°©ì‹ ìœ ì§€","ìžë™í™”ëœ í›„ì²˜ë¦¬"],cons:["ì—‘ì…€ ì–‘ì‹ ì¤€ìˆ˜ í•„ìš”","ì˜¤ë¥˜ ì‹œ ì¼ê´„ ìˆ˜ì • ì–´ë ¤ì›€"],estimatedTime:"3-5ë¶„",difficulty:"easy",recommended:!0},{id:"standard",title:"í‘œì¤€ ë°œì£¼ì„œ",description:"ì›¹ í¼ì„ í†µí•´ ë°œì£¼ì„œë¥¼ ì§ì ‘ ìž…ë ¥í•˜ì—¬ ìƒì„±í•©ë‹ˆë‹¤",icon:e.jsx(ls,{className:"w-8 h-8 text-blue-600"}),features:["ì§ê´€ì ì¸ ì›¹ í¼ ì¸í„°íŽ˜ì´ìŠ¤","ì‹¤ì‹œê°„ ìž…ë ¥ ê²€ì¦","ë‹¨ê³„ë³„ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°","ê°œë³„ ë°œì£¼ì„œ ì •ë°€ ê´€ë¦¬","PDF ë¯¸ë¦¬ë³´ê¸°"],pros:["ì •í™•í•œ ë°ì´í„° ìž…ë ¥","ìœ ì—°í•œ ìˆ˜ì • ê°€ëŠ¥","ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° ì§€ì›"],cons:["ê°œë³„ ìž…ë ¥ìœ¼ë¡œ ì‹œê°„ ì†Œìš”","ëŒ€ëŸ‰ ì²˜ë¦¬ ì‹œ ë¹„íš¨ìœ¨ì "],estimatedTime:"5-10ë¶„",difficulty:"medium"}],Qs=s=>{switch(s){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800"}},Ys=({onMethodSelect:s,disabled:t=!1})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ë°œì£¼ì„œ ìž‘ì„± ë°©ì‹ ì„ íƒ"}),e.jsx("p",{className:"text-gray-600",children:"í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë§žëŠ” ë°œì£¼ì„œ ìž‘ì„± ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-[1366px] mx-auto",children:Xs.map(n=>e.jsxs(z,{className:`relative transition-all duration-300 hover:shadow-xl hover:-translate-y-1 transform ${n.recommended?"ring-2 ring-blue-500 ring-opacity-50":""} ${t?"opacity-50":""} h-full flex flex-col`,children:[n.recommended&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsxs(_,{className:"bg-blue-600 text-white px-3 py-1",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"ì¶”ì²œ"]})}),e.jsxs(B,{className:"pb-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[n.icon,e.jsxs("div",{children:[e.jsx(V,{className:"text-xl",children:n.title}),e.jsx(Qe,{className:"mt-1",children:n.description})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:n.estimatedTime})]}),e.jsx(_,{variant:"secondary",className:Qs(n.difficulty),children:n.difficulty==="easy"?"ì‰¬ì›€":n.difficulty==="medium"?"ë³´í†µ":"ì–´ë ¤ì›€"})]})]}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx(q,{className:"w-4 h-4 mr-1"}),"ì£¼ìš” ê¸°ëŠ¥"]}),e.jsx("ul",{className:"space-y-1",children:n.features.map((i,o)=>e.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(D,{className:"w-3 h-3 text-green-500 mr-2 flex-shrink-0"}),i]},o))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-700 mb-2 flex items-center text-sm",children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"ìž¥ì "]}),e.jsx("ul",{className:"space-y-1",children:n.pros.map((i,o)=>e.jsxs("li",{className:"text-xs text-green-600 ml-5",children:["â€¢ ",i]},o))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-orange-700 mb-2 flex items-center text-sm",children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),"ê³ ë ¤ì‚¬í•­"]}),e.jsx("ul",{className:"space-y-1",children:n.cons.map((i,o)=>e.jsxs("li",{className:"text-xs text-orange-600 ml-5",children:["â€¢ ",i]},o))})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(h,{onClick:()=>s(n.id),disabled:t,className:`w-full h-12 ${n.id==="excel"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,size:"lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[n.icon,e.jsxs("span",{children:[n.title," ì„ íƒ"]})]})})})]})]},n.id))}),e.jsx(z,{className:"bg-blue-50 border-blue-200",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Be,{className:"w-4 h-4 text-blue-600"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"ì–´ë–¤ ë°©ì‹ì„ ì„ íƒí•´ì•¼ í• ê¹Œìš”?"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ì—‘ì…€ ë°œì£¼ì„œ"}),": ì—¬ëŸ¬ ê°œì˜ ë°œì£¼ì„œë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•´ì•¼ í•˜ê±°ë‚˜, ê¸°ì¡´ ì—‘ì…€ ì–‘ì‹ì´ ìžˆëŠ” ê²½ìš°"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"í‘œì¤€ ë°œì£¼ì„œ"}),": ê°œë³„ ë°œì£¼ì„œë¥¼ ì •í™•ížˆ ê´€ë¦¬í•˜ê³  ì‹¶ê±°ë‚˜, ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°ê°€ í•„ìš”í•œ ê²½ìš°"]})]})]})]})})})]}),et=s=>{switch(s.id){case"pdf_generation":return e.jsx(q,{className:"w-5 h-5"});case"vendor_validation":return e.jsx(Me,{className:"w-5 h-5"});case"email_preparation":return e.jsx(pe,{className:"w-5 h-5"});case"attachment_processing":return e.jsx(ds,{className:"w-5 h-5"});case"final_validation":return e.jsx(D,{className:"w-5 h-5"});default:return e.jsx(D,{className:"w-5 h-5"})}},st=s=>{switch(s){case"completed":return"text-green-600 bg-green-50 border-green-200";case"processing":return"text-blue-600 bg-blue-50 border-blue-200";case"error":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},tt=s=>{switch(s.status){case"completed":return e.jsx(D,{className:"w-6 h-6 text-green-600"});case"processing":return e.jsx(Y,{className:"w-6 h-6 text-blue-600 animate-spin"});case"error":return e.jsx(H,{className:"w-6 h-6 text-red-600"});default:return e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"})}},ee=s=>s<60?`${s}ì´ˆ`:s<3600?`${Math.floor(s/60)}ë¶„ ${s%60}ì´ˆ`:`${Math.floor(s/3600)}ì‹œê°„ ${Math.floor(s%3600/60)}ë¶„`,rt=({steps:s,currentStep:t,onRetry:n,onPreview:i,onEdit:o,onPause:d,onResume:p,onSkip:b,onCancel:f,isProcessing:a=!1,isPaused:k=!1,canPause:F=!1,canSkip:R=!1,totalElapsedTime:P=0,estimatedTimeRemaining:u,onStepComplete:C,maxRetries:A=3})=>{const[T,M]=g.useState(new Date),[N,y]=g.useState(new Set);g.useEffect(()=>{const l=setInterval(()=>{M(new Date)},1e3);return()=>clearInterval(l)},[]);const S=s.filter(l=>l.status==="completed").length,x=s.length,c=x>0?Math.round(S/x*100):0,r=s.some(l=>l.status==="error"),m=S===x,j=s.find(l=>l.status==="processing"),v=s.filter(l=>l.status==="error"),w=l=>{const E=new Set(N);E.has(l)?E.delete(l):E.add(l),y(E)};return e.jsxs("div",{className:"max-w-[1366px] mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"í›„ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸"}),a&&!k&&e.jsxs(_,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"ì²˜ë¦¬ ì¤‘"]}),k&&e.jsxs(_,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"ì¼ì‹œì •ì§€"]}),r&&e.jsxs(_,{variant:"destructive",className:"bg-red-100 text-red-800",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),"ì˜¤ë¥˜ ",v.length,"ê°œ"]}),m&&!r&&e.jsxs(_,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(ne,{className:"w-3 h-3 mr-1"}),"ì™„ë£Œ"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì„œ ìƒì„± í›„ í•„ìš”í•œ ìž‘ì—…ë“¤ì„ ìžë™ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤"})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[c,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[S,"/",x," ë‹¨ê³„ ì™„ë£Œ"]}),P>0&&e.jsxs("div",{className:"text-xs text-gray-500",children:["ê²½ê³¼: ",ee(P)]}),u&&e.jsxs("div",{className:"text-xs text-blue-600",children:[e.jsx(me,{className:"w-3 h-3 inline mr-1"}),"ì˜ˆìƒ ",ee(u)," ë‚¨ìŒ"]}),e.jsx("div",{className:"text-xs text-gray-400",children:T.toLocaleTimeString("ko-KR")})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[a&&F&&!k&&d&&e.jsxs(h,{variant:"outline",size:"sm",onClick:d,className:"text-yellow-600 border-yellow-300 hover:bg-yellow-50",children:[e.jsx(xe,{className:"w-4 h-4 mr-1"}),"ì¼ì‹œì •ì§€"]}),k&&p&&e.jsxs(h,{variant:"outline",size:"sm",onClick:p,className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(ns,{className:"w-4 h-4 mr-1"}),"ìž¬ê°œ"]}),r&&v.length>0&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>{v.forEach(l=>n?.(l.id))},className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"ëª¨ë“  ì˜¤ë¥˜ ìž¬ì‹œë„"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:f&&e.jsxs(h,{variant:"outline",size:"sm",onClick:f,disabled:m,className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:[e.jsx(ke,{className:"w-4 h-4 mr-1"}),"ì·¨ì†Œ"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"ì „ì²´ ì§„í–‰ë¥ "}),j&&e.jsxs(_,{variant:"outline",className:"text-xs px-2 py-0.5",children:[j.title," ì²˜ë¦¬ ì¤‘"]})]}),e.jsxs("span",{className:"font-semibold text-lg",children:[c,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{value:c,className:"h-3"}),a&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-30 animate-pulse rounded-full h-3"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:[S,"ê°œ ì™„ë£Œ"]}),e.jsxs("span",{children:[x-S,"ê°œ ë‚¨ìŒ"]})]})]}),k&&e.jsxs(ae,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(xe,{className:"h-4 w-4 text-yellow-600"}),e.jsx(le,{className:"text-yellow-800",children:"í›„ì²˜ë¦¬ ìž‘ì—…ì´ ì¼ì‹œì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ìž¬ê°œ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê³„ì† ì§„í–‰í•˜ì„¸ìš”."})]}),r&&e.jsxs(ae,{className:"border-red-200 bg-red-50",children:[e.jsx(H,{className:"h-4 w-4 text-red-600"}),e.jsxs(le,{className:"text-red-800",children:[e.jsxs("div",{className:"font-medium mb-1",children:[v.length,"ê°œ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"]}),e.jsxs("div",{className:"text-sm",children:[v.map(l=>l.title).join(", ")," ë‹¨ê³„ë¥¼ í™•ì¸í•˜ê³  ìž¬ì‹œë„í•´ì£¼ì„¸ìš”."]})]})]}),m&&!r&&e.jsxs(ae,{className:"border-green-200 bg-green-50",children:[e.jsx(D,{className:"h-4 w-4 text-green-600"}),e.jsxs(le,{className:"text-green-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"ëª¨ë“  í›„ì²˜ë¦¬ ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"}),e.jsxs("div",{className:"text-sm",children:["ì´ ",x,"ê°œ ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.",P>0&&` (ì†Œìš”ì‹œê°„: ${ee(P)})`]})]})]}),e.jsx("div",{className:"space-y-3",children:s.map((l,E)=>{const $=N.has(l.id),U=l.retryCount||0,ie=l.status==="error"&&U<A;return e.jsxs(z,{className:`border transition-all duration-300 transform hover:scale-[1.01] ${st(l.status)} ${l.id===t?"shadow-lg ring-2 ring-blue-200 ring-opacity-50":"shadow-sm"}`,children:[e.jsx(B,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[tt(l),l.status==="processing"&&e.jsx("div",{className:"absolute -inset-2 border-2 border-blue-400 rounded-full opacity-30 animate-pulse"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-1",children:[e.jsxs(V,{className:"text-base flex items-center space-x-2",children:[et(l),e.jsx("span",{children:l.title})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[l.status==="processing"&&e.jsxs(_,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs px-2 py-0.5",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-1"}),"ì§„í–‰ ì¤‘"]}),l.status==="completed"&&e.jsxs(_,{variant:"secondary",className:"bg-green-100 text-green-800 text-xs px-2 py-0.5",children:[e.jsx(ne,{className:"w-3 h-3 mr-1"}),"ì™„ë£Œ"]}),l.status==="error"&&e.jsxs(_,{variant:"destructive",className:"bg-red-100 text-red-800 text-xs px-2 py-0.5",children:[e.jsx(ke,{className:"w-3 h-3 mr-1"}),"ì˜¤ë¥˜ ",U>0&&`(${U}/${A} ì‹œë„)`]}),l.priority&&e.jsx(_,{variant:"outline",className:"text-xs px-2 py-0.5",children:l.priority==="high"?"ë†’ìŒ":l.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:l.description}),(l.startedAt||l.completedAt||l.estimatedDuration)&&e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-2",children:[l.startedAt&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsxs("span",{children:["ì‹œìž‘: ",l.startedAt.toLocaleTimeString("ko-KR")]})]}),l.completedAt&&l.startedAt&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(me,{className:"w-3 h-3"}),e.jsxs("span",{children:["ì†Œìš”: ",ee(Math.round((l.completedAt.getTime()-l.startedAt.getTime())/1e3))]})]}),l.estimatedDuration&&l.status==="pending"&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(me,{className:"w-3 h-3"}),e.jsxs("span",{children:["ì˜ˆìƒ: ",ee(l.estimatedDuration)]})]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["ë‹¨ê³„ ",E+1,"/",s.length]}),(l.details?.length||l.result||l.error)&&e.jsxs(h,{variant:"ghost",size:"sm",onClick:()=>w(l.id),className:"text-xs px-2 py-1 h-6",children:[$?"ì ‘ê¸°":"íŽ¼ì¹˜ê¸°",e.jsx(ce,{className:`w-3 h-3 ml-1 transition-transform duration-200 ${$?"rotate-90":""}`})]})]})})]})}),e.jsxs(L,{className:"pt-0",children:[l.status==="processing"&&l.progress!==void 0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsx("span",{className:"font-medium",children:"ì²˜ë¦¬ ì§„í–‰ë¥ "}),e.jsxs("span",{className:"font-bold",children:[l.progress,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{value:l.progress,className:"h-2"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-20 animate-pulse rounded-full h-2"})]})]}),$&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(is,{}),l.status==="error"&&l.error&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(H,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-red-800 mb-2",children:"ì˜¤ë¥˜ ìƒì„¸ ì •ë³´"}),e.jsx("div",{className:"text-sm text-red-700 bg-red-100 p-3 rounded border border-red-200 font-mono",children:l.error}),U>0&&e.jsxs("div",{className:"text-xs text-red-600 mt-2",children:["ìž¬ì‹œë„ íšŸìˆ˜: ",U,"/",A]})]})]})}),l.details&&l.details.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(he,{className:"w-4 h-4 text-blue-600"}),e.jsx("div",{className:"font-medium text-blue-800",children:"ì²˜ë¦¬ ë‚´ìš©"})]}),e.jsx("ul",{className:"space-y-2",children:l.details.map((Ze,Xe)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:Ze})]},Xe))})]}),l.status==="completed"&&l.result&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(ne,{className:"w-4 h-4 text-green-600"}),e.jsx("div",{className:"font-medium text-green-800",children:"ì²˜ë¦¬ ê²°ê³¼"})]}),e.jsx("div",{className:"text-sm text-green-700",children:typeof l.result=="string"?l.result:l.result.message||"ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤"}),l.result?.details&&e.jsx("div",{className:"mt-2 text-xs text-green-600 bg-green-100 p-2 rounded border border-green-200",children:JSON.stringify(l.result.details,null,2)})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[l.status==="error"&&n&&ie&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>n(l.id),className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"ìž¬ì‹œë„ (",A-U,"íšŒ ë‚¨ìŒ)"]}),l.status==="pending"&&R&&b&&l.priority!=="high"&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>b(l.id),className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),"ê±´ë„ˆë›°ê¸°"]}),l.status==="completed"&&i&&(l.id==="pdf_generation"||l.id==="email_preparation")&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>i(l.id,l.result),className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(de,{className:"w-3 h-3 mr-1"}),"ë¯¸ë¦¬ë³´ê¸°"]}),l.status==="completed"&&l.id==="pdf_generation"&&l.result?.pdfUrl&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>window.open(l.result.pdfUrl,"_blank"),className:"text-green-600 border-green-300 hover:bg-green-50",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]}),l.status==="completed"&&o&&l.id==="email_preparation"&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>o(l.id,l.result),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx($e,{className:"w-3 h-3 mr-1"}),"íŽ¸ì§‘"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[l.status==="completed"&&e.jsxs("div",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(ne,{className:"w-3 h-3 mr-1"}),"ì™„ë£Œ"]}),l.status==="processing"&&e.jsxs("div",{className:"text-xs text-blue-600 flex items-center",children:[e.jsx(Y,{className:"w-3 h-3 mr-1 animate-spin"}),"ì²˜ë¦¬ ì¤‘"]})]})]}),E<s.length-1&&e.jsx("div",{className:"flex justify-center mt-4 mb-2",children:e.jsx("div",{className:`w-0.5 h-4 transition-colors duration-300 ${l.status==="completed"?"bg-green-400":l.status==="processing"?"bg-blue-400":l.status==="error"?"bg-red-400":"bg-gray-300"}`})})]})]},l.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:S}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì™„ë£Œëœ ë‹¨ê³„"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:s.filter(l=>l.status==="processing").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì²˜ë¦¬ ì¤‘"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:v.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì˜¤ë¥˜ ë°œìƒ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600 mb-1",children:s.filter(l=>l.status==="pending").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ëŒ€ê¸° ì¤‘"})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[a&&!k&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx(Y,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:j?`${j.title} ì²˜ë¦¬ ì¤‘...`:"ì²˜ë¦¬ ì¤‘ìž…ë‹ˆë‹¤..."})]}),k&&e.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì¼ì‹œì •ì§€ë¨"})]}),m&&!r&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì˜¤ë¥˜ê°€ ë°œìƒí•œ ìž‘ì—…ì´ ìžˆìŠµë‹ˆë‹¤"})]}),!a&&!m&&!r&&!k&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì‹œìž‘ ëŒ€ê¸° ì¤‘"})]})]}),(P>0||u)&&e.jsxs("div",{className:"flex items-center justify-center space-x-6 mt-3 text-xs text-gray-500",children:[P>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(me,{className:"w-3 h-3"}),e.jsxs("span",{children:["ê²½ê³¼: ",ee(P)]})]}),u&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsxs("span",{children:["ë‚¨ì€ ì‹œê°„: ",ee(u)]})]})]})]})]})]})},at=({onUploadComplete:s,disabled:t})=>{const[n,i]=g.useState(null),[o,d]=g.useState(!1),[p,b]=g.useState(!1),[f,a]=g.useState(null),[k,F]=g.useState(0),[R,P]=g.useState(!1),[u,C]=g.useState([{id:"upload",title:"íŒŒì¼ ì—…ë¡œë“œ",description:"ì—‘ì…€ íŒŒì¼ì„ ì„œë²„ë¡œ ì—…ë¡œë“œ",status:"pending"},{id:"parse",title:"Input ì‹œíŠ¸ íŒŒì‹±",description:"ì—‘ì…€ íŒŒì¼ì˜ Input ì‹œíŠ¸ ë°ì´í„° ë¶„ì„",status:"pending"},{id:"save",title:"ë°ì´í„°ë² ì´ìŠ¤ ì €ìž¥",description:"ë°œì£¼ì„œ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ìž¥",status:"pending"},{id:"extract",title:"ê°‘ì§€/ì„ì§€ ì¶”ì¶œ",description:"ê°‘ì§€/ì„ì§€ ì‹œíŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì¶”ì¶œ",status:"pending"}]),A=r=>{r.preventDefault(),r.stopPropagation(),r.type==="dragenter"||r.type==="dragover"?d(!0):r.type==="dragleave"&&d(!1)},T=r=>{if(r.preventDefault(),r.stopPropagation(),d(!1),r.dataTransfer.files&&r.dataTransfer.files[0]){const m=r.dataTransfer.files[0];m.type.includes("excel")||m.type.includes("spreadsheet")||m.name.endsWith(".xlsx")?(i(m),a(null),N()):alert("ì—‘ì…€ íŒŒì¼(.xlsx)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")}},M=r=>{r.target.files&&r.target.files[0]&&(i(r.target.files[0]),a(null),N())},N=()=>{C(r=>r.map(m=>({...m,status:"pending",message:void 0})))},y=(r,m,j)=>{C(v=>v.map(w=>w.id===r?{...w,status:m,message:j}:w))},S=(r,m,j,v)=>{const w=r[m];if(!w){console.error("ì„ íƒëœ ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤.");return}const l={orderNumber:w.orderNumber,projectName:w.projectName,projectId:w.projectId,vendorName:w.vendorName,vendorId:w.vendorId,vendorEmail:w.vendorEmail,orderDate:w.orderDate,deliveryDate:w.dueDate||w.deliveryDate,dueDate:w.dueDate||w.deliveryDate,totalAmount:w.totalAmount||0,totalItems:w.items?.length||0,items:w.items||[],notes:w.notes||w.remarks||"",remarks:w.notes||w.remarks||"",createdBy:w.createdBy||"",creationMethod:"excel",type:"excel",excelFileName:j.data?.fileName,filePath:j.data?.filePath,processedExcelUrl:v?`/api/po-template/download/${v.split("/").pop()}`:void 0,processedExcelPath:v,allOrders:r,totalOrders:r.length,selectedOrderIndex:m};console.log("ExcelUploadComponent submitting orderData:",l),s(l),P(!1)},x=async()=>{if(n){b(!0);try{y("upload","processing");const r=new FormData;r.append("file",n);const m=await fetch("/api/po-template/upload",{method:"POST",body:r}),j=await m.json();if(!m.ok){y("upload","error",j.error||"íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨"),b(!1);return}y("upload","completed",`${j.data.fileName} ì—…ë¡œë“œ ì™„ë£Œ`),y("parse","completed",`ë°œì£¼ì„œ ${j.data.totalOrders}ê°œ, ì•„ì´í…œ ${j.data.totalItems}ê°œ íŒŒì‹± ì™„ë£Œ`),y("save","processing");const v=await fetch("/api/po-template/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:j.data.orders})}),w=await v.json();if(!v.ok){y("save","error",w.error||"ë°ì´í„°ë² ì´ìŠ¤ ì €ìž¥ ì‹¤íŒ¨"),b(!1);return}y("save","completed",`ë°œì£¼ì„œ ${w.data.savedOrders}ê°œ ì €ìž¥ ì™„ë£Œ`),y("extract","processing");const l=await fetch("/api/po-template/extract-sheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:j.data.filePath})}),E=await l.json();let $;l.ok?(y("extract","completed",`${E.data.extractedSheets.join(", ")} ì‹œíŠ¸ ì¶”ì¶œ ì™„ë£Œ`),$=E.data?.extractedPath,console.log("Extracted file path:",$)):y("extract","error",E.error||"ì‹œíŠ¸ ì¶”ì¶œ ì‹¤íŒ¨"),a(j),j.data.orders.length>1?(P(!0),a({...j,extractedPath:$})):S(j.data.orders,0,j,$)}catch(r){console.error("Processing error:",r),y("upload","error","ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{b(!1)}}},c=()=>u.filter(m=>m.status==="completed").length/u.length*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{className:"border-blue-200 bg-blue-50",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"ðŸ“‹ ì—‘ì…€ íŒŒì¼ ìš”êµ¬ì‚¬í•­"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì‹œíŠ¸ëª…:"})," 'Input' (ëŒ€ì†Œë¬¸ìž êµ¬ë¶„)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì»¬ëŸ¼ êµ¬ì¡°:"})," A~Pì—´ (16ê°œ ì»¬ëŸ¼) í‘œì¤€ êµ¬ì¡°"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í˜•ì‹:"})," .xlsx (Excel 2007 ì´ìƒ)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í¬ê¸°:"})," ìµœëŒ€ 10MB"]})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"ðŸ“¥ í‘œì¤€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"ì‹œìŠ¤í…œì— ìµœì í™”ëœ 16ê°œ ì»¬ëŸ¼ êµ¬ì¡°ì˜ í‘œì¤€ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”."}),e.jsxs(h,{onClick:async()=>{try{const r=await fetch("/api/excel-template/download",{method:"GET"});if(r.ok){const m=await r.blob(),j=window.URL.createObjectURL(m),v=document.createElement("a");v.href=j,v.download="PO_Excel_Template.xlsx",document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(j)}else throw new Error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨")}catch(r){console.error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:",r),alert("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",disabled:t,children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"PO_Excel_Template.xlsx ë‹¤ìš´ë¡œë“œ"]})]})]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${t?"opacity-50 pointer-events-none":""}`,onDragEnter:A,onDragLeave:A,onDragOver:A,onDrop:T,children:[e.jsx(Ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(n.size/1024/1024).toFixed(2)," MB"]}),e.jsx(_,{variant:"secondary",className:"mt-2",children:"íŒŒì¼ ì¤€ë¹„ ì™„ë£Œ"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"ì—‘ì…€ íŒŒì¼ì„ ë“œëž˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì§€ì› í˜•ì‹: .xlsx (Excel íŒŒì¼)"})]}),e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:M,className:"hidden",id:"file-upload",disabled:t}),e.jsx("label",{htmlFor:"file-upload",className:`inline-block mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors font-medium ${t?"opacity-50 pointer-events-none":""}`,children:"íŒŒì¼ ì„ íƒ"})]}),n&&e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx(h,{onClick:x,disabled:p||t,className:"flex-1 h-12",size:"lg",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì‹œìž‘"]})}),e.jsx(h,{variant:"outline",onClick:()=>{i(null),a(null),N()},className:"h-12",size:"lg",disabled:p||t,children:"ì·¨ì†Œ"})]}),p&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"ì²˜ë¦¬ ì§„í–‰ ìƒí™©"}),e.jsxs("span",{className:"text-sm text-blue-700",children:[Math.round(c()),"%"]})]}),e.jsx(be,{value:c(),className:"h-2 mb-3"}),e.jsx("div",{className:"text-sm text-blue-700",children:u.find(r=>r.status==="processing")?.title||"ì²˜ë¦¬ ì¤‘..."})]})]}),f&&f.data?.orders&&e.jsx(z,{className:"mt-6",children:e.jsxs(L,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600"}),"ë°œì£¼ì„œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs("div",{className:"space-y-6",children:[f.data.orders.slice(0,2).map((r,m)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:r.orderNumber}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ê±°ëž˜ì²˜: ",r.vendorName," | ë‚©í’ˆì²˜: ",r.deliveryName||r.vendorName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["í˜„ìž¥: ",r.siteName," | ë°œì£¼ì¼: ",r.orderDate," | ë‚©ê¸°ì¼: ",r.dueDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(r.totalAmount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.items.length,"ê°œ í’ˆëª©"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ê·œê²©"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ë‹¨ê°€"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ê¸ˆì•¡"})]})}),e.jsxs("tbody",{children:[r.items.slice(0,3).map((j,v)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:j.itemName}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:j.specification}),e.jsx("td",{className:"border border-gray-300 px-2 py-1 text-right",children:new Intl.NumberFormat("ko-KR").format(j.quantity)}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR").format(j.unitPrice),"ì›"]}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR").format(j.totalAmount),"ì›"]})]},v)),r.items.length>3&&e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"border border-gray-300 px-2 py-1 text-center text-gray-500",children:["... ì™¸ ",r.items.length-3,"ê°œ í’ˆëª©"]})})]})]})})]},m)),f.data.orders.length>2&&e.jsx("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-gray-600",children:["... ì™¸ ",f.data.orders.length-2,"ê°œ ë°œì£¼ì„œ"]})})]})]})}),R&&f&&f.data&&e.jsx(z,{children:e.jsx(L,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ë°œì£¼ì„œ ì„ íƒ"}),e.jsxs(_,{variant:"secondary",children:[f.data.orders.length,"ê°œ ë°œì£¼ì„œ"]})]}),e.jsxs(ae,{children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx(le,{children:"ì—¬ëŸ¬ ê°œì˜ ë°œì£¼ì„œê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ì²˜ë¦¬í•  ë°œì£¼ì„œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."})]}),e.jsx("div",{className:"space-y-3",children:f.data.orders.map((r,m)=>e.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${k===m?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>F(m),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:r.orderNumber}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.projectName," | ",r.vendorName]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[r.items?.length||0,"ê°œ í’ˆëª© | ì´ì•¡: â‚©",(r.totalAmount||0).toLocaleString()]})]}),e.jsx("input",{type:"radio",name:"orderSelection",checked:k===m,onChange:()=>F(m),className:"w-4 h-4 text-blue-600"})]})},m))}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{onClick:()=>S(f.data.orders,k,f,f.extractedPath),className:"flex-1",disabled:t,children:"ì„ íƒí•œ ë°œì£¼ì„œë¡œ ì§„í–‰"}),e.jsx(h,{variant:"outline",onClick:()=>{P(!1),a(null),i(null),N()},disabled:t,children:"ì·¨ì†Œ"})]})]})})}),f&&!R&&e.jsxs(ae,{children:[e.jsx(D,{className:"h-4 w-4"}),e.jsxs(le,{children:["ì—‘ì…€ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì£¼ì„œ ",f.data?.totalOrders,"ê°œ, í’ˆëª© ",f.data?.totalItems,"ê°œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."]})]})]})},lt=({onFormComplete:s,disabled:t})=>{const[n]=g.useState(cs()),[i,o]=g.useState(!1),[d,p]=g.useState({site:"",deliveryDate:"",isNegotiable:!1,receiver:"",manager:"",notes:"",items:[{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:"",vendorId:"",deliveryLocation:"",deliveryToSite:!1}]}),b=()=>d.items.reduce((x,c)=>x+(c.totalPrice||0),0),{data:f=[]}=re({queryKey:["/api/projects"],select:x=>x?.filter(c=>c.isActive)||[]});Ue();const{data:a=[]}=re({queryKey:["/api/users"],select:x=>x?.filter(c=>c.isActive)||[]}),{data:k=[]}=re({queryKey:["/api/vendors"],select:x=>x?.filter(c=>c.isActive)||[]}),{data:F=[]}=re({queryKey:["/api/item-categories/major"],queryFn:()=>fetch("/api/item-categories/major").then(x=>x.json())}),{data:R=[]}=re({queryKey:["/api/item-categories/middle"],queryFn:()=>fetch("/api/item-categories/middle").then(x=>x.json())}),{data:P=[]}=re({queryKey:["/api/item-categories/minor"],queryFn:()=>fetch("/api/item-categories/minor").then(x=>x.json())}),u=x=>R,C=x=>P,A=(x,c)=>{p(r=>({...r,[x]:c}))},T=(x,c,r)=>{const m=[...d.items];if(m[x]={...m[x],[c]:r},c==="quantity"||c==="unitPrice"){const j=c==="quantity"?r:m[x].quantity,v=c==="unitPrice"?r:m[x].unitPrice;m[x].totalPrice=j*v}c==="majorCategory"?(m[x].middleCategory="",m[x].minorCategory=""):c==="middleCategory"&&(m[x].minorCategory=""),c==="deliveryToSite"&&r===!0&&(m[x].deliveryLocation="í˜„ìž¥"),p(j=>({...j,items:m}))},M=()=>{p(x=>({...x,items:[...x.items,{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:"",vendorId:"",deliveryLocation:"",deliveryToSite:!1}]}))},N=x=>{d.items.length>1&&p(c=>({...c,items:c.items.filter((r,m)=>m!==x)}))},y=()=>d.site?d.deliveryDate?d.items.some(x=>!x.name||x.quantity<=0)?(alert("ëª¨ë“  í’ˆëª©ì˜ ì´ë¦„ê³¼ ìˆ˜ëŸ‰ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”."),!1):d.items[0]?.vendorId?!0:(alert("ìµœì†Œí•œ í•˜ë‚˜ì˜ í’ˆëª©ì— ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."),!1):(alert("í¬ë§ ë‚©ê¸°ì¼ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”."),!1):(alert("í˜„ìž¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”."),!1),S=async()=>{if(y()){o(!0);try{const x=f.find(m=>m.projectName===d.site),c=d.items[0]?.vendorId||"",r={type:"standard",orderNumber:n,projectId:x?.id?.toString()||"",vendorId:c,siteName:d.site,orderDate:new Date().toISOString().split("T")[0],deliveryDate:d.deliveryDate,isNegotiable:d.isNegotiable,receiver:d.receiver,manager:d.manager,notes:d.notes,totalAmount:b(),items:d.items.map(m=>({itemName:m.name,specification:m.specs,quantity:m.quantity,unit:m.unit,unitPrice:m.unitPrice,totalAmount:m.totalPrice,category:m.category,majorCategory:m.majorCategory,middleCategory:m.middleCategory,minorCategory:m.minorCategory,remarks:m.remarks,vendorId:m.vendorId,deliveryLocation:m.deliveryLocation,deliveryToSite:m.deliveryToSite}))};s(r)}catch(x){console.error("Form submission error:",x),alert("ë°œì£¼ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{o(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{className:"border-blue-200 bg-blue-50",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„± ì•ˆë‚´"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"ë‹¨ê³„ë³„ ìž…ë ¥ìœ¼ë¡œ ì •í™•í•œ ë°œì£¼ì„œ ìž‘ì„±"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"ì‹¤ì‹œê°„ ë°ì´í„° ê²€ì¦ ë° ìžë™ ì™„ì„±"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"ìžë™ ì €ìž¥ìœ¼ë¡œ ì•ˆì „í•œ ë°ì´í„° ë³´ê´€"})]})]})]})})}),e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"ë°œì£¼ì„œ ê¸°ë³¸ ì •ë³´"]})}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"poNumber",children:"ë°œì£¼ì„œ ë²ˆí˜¸"}),e.jsx(G,{id:"poNumber",value:n,disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"site",children:"í˜„ìž¥ ì„ íƒ *"}),e.jsxs(J,{value:d.site,onValueChange:x=>A("site",x),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(Q,{children:f.map(x=>e.jsx(O,{value:x.projectName,children:x.projectName},x.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"deliveryDate",children:"í¬ë§ ë‚©ê¸°ì¼ *"}),e.jsx(G,{id:"deliveryDate",type:"date",value:d.deliveryDate,onChange:x=>A("deliveryDate",x.target.value),disabled:t})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-8",children:[e.jsx(Te,{id:"isNegotiable",checked:d.isNegotiable,onCheckedChange:x=>A("isNegotiable",x),disabled:t}),e.jsx(I,{htmlFor:"isNegotiable",children:"ë‚©ê¸° í˜‘ì˜ ê°€ëŠ¥"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"receiver",children:"ìˆ˜ì‹ ìž"}),e.jsxs(J,{value:d.receiver,onValueChange:x=>A("receiver",x),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ìˆ˜ì‹ ìžë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(Q,{children:a.map(x=>e.jsxs(O,{value:x.name,children:[x.name," (",x.role,")"]},x.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"manager",children:"ë‹´ë‹¹ìž"}),e.jsx(G,{id:"manager",value:d.manager,onChange:x=>A("manager",x.target.value),placeholder:"ë‹´ë‹¹ìžëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:t})]})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"notes",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx(Pe,{id:"notes",value:d.notes,onChange:x=>A("notes",x.target.value),placeholder:"íŠ¹ì´ì‚¬í•­ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”",rows:3,disabled:t})]})]})]}),e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),"ë°œì£¼ í’ˆëª©"]}),e.jsxs(h,{onClick:M,variant:"outline",size:"sm",disabled:t,children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"í’ˆëª© ì¶”ê°€"]})]})}),e.jsx(L,{children:e.jsx("div",{className:"space-y-4",children:d.items.map((x,c)=>e.jsx(z,{className:"border border-gray-200",children:e.jsxs(L,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(_,{variant:"outline",children:["í’ˆëª© ",c+1]}),d.items.length>1&&e.jsx(h,{onClick:()=>N(c),variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",disabled:t,children:e.jsx(os,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"í’ˆëª©ëª… *"}),e.jsx(G,{value:x.name,onChange:r=>T(c,"name",r.target.value),placeholder:"í’ˆëª©ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:t})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ê·œê²©"}),e.jsx(G,{value:x.specs,onChange:r=>T(c,"specs",r.target.value),placeholder:"ê·œê²©ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:t})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(I,{children:"ëŒ€ë¶„ë¥˜"}),e.jsxs(J,{value:x.majorCategory,onValueChange:r=>T(c,"majorCategory",r),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsx(Q,{children:F.map(r=>e.jsx(O,{value:r.categoryValue||r.categoryName,children:r.categoryValue||r.categoryName},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ì¤‘ë¶„ë¥˜"}),e.jsxs(J,{value:x.middleCategory,onValueChange:r=>T(c,"middleCategory",r),disabled:t||!x.majorCategory,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsx(Q,{children:u(x.majorCategory).map(r=>e.jsx(O,{value:r.categoryValue||r.categoryName,children:r.categoryValue||r.categoryName},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ì†Œë¶„ë¥˜"}),e.jsxs(J,{value:x.minorCategory,onValueChange:r=>T(c,"minorCategory",r),disabled:t||!x.middleCategory,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsx(Q,{children:C(x.middleCategory).map(r=>e.jsx(O,{value:r.categoryValue||r.categoryName,children:r.categoryValue||r.categoryName},r.id))})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"ìˆ˜ëŸ‰ *"}),e.jsx(G,{type:"number",value:x.quantity||"",onChange:r=>T(c,"quantity",parseFloat(r.target.value)||0),placeholder:"0",min:"0",step:"0.01",disabled:t})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ë‹¨ìœ„"}),e.jsxs(J,{value:x.unit,onValueChange:r=>T(c,"unit",r),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ë‹¨ìœ„ ì„ íƒ"})}),e.jsxs(Q,{children:[e.jsx(O,{value:"ea",children:"ea"}),e.jsx(O,{value:"set",children:"set"}),e.jsx(O,{value:"ton",children:"ton"}),e.jsx(O,{value:"kg",children:"kg"}),e.jsx(O,{value:"g",children:"g"}),e.jsx(O,{value:"m",children:"m"}),e.jsx(O,{value:"cm",children:"cm"}),e.jsx(O,{value:"mm",children:"mm"}),e.jsx(O,{value:"mÂ²",children:"mÂ²"}),e.jsx(O,{value:"mÂ³",children:"mÂ³"}),e.jsx(O,{value:"L",children:"L"}),e.jsx(O,{value:"mL",children:"mL"}),e.jsx(O,{value:"ê¸°íƒ€",children:"ê¸°íƒ€"})]})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ë‹¨ê°€"}),e.jsx(G,{type:"number",value:x.unitPrice||"",onChange:r=>T(c,"unitPrice",parseFloat(r.target.value)||0),placeholder:"0",min:"0",step:"0.01",disabled:t})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ì´ì•¡"}),e.jsx(G,{value:Ae(x.totalPrice),disabled:!0,className:"bg-gray-50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"ê±°ëž˜ì²˜"}),e.jsxs(J,{value:x.vendorId||"",onValueChange:r=>T(c,"vendorId",r),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(Q,{children:k.map(r=>e.jsx(O,{value:r.id.toString(),children:r.name},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(J,{value:x.deliveryLocation||"",onValueChange:r=>T(c,"deliveryLocation",r),disabled:t||x.deliveryToSite,className:"flex-1",children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(Q,{children:k.map(r=>e.jsx(O,{value:r.name,children:r.name},r.id))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{id:`deliveryToSite-${c}`,checked:x.deliveryToSite||!1,onCheckedChange:r=>{T(c,"deliveryToSite",r),r&&T(c,"deliveryLocation","í˜„ìž¥")},disabled:t}),e.jsx(I,{htmlFor:`deliveryToSite-${c}`,className:"text-sm cursor-pointer",children:"í˜„ìž¥"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(I,{children:"ë¹„ê³ "}),e.jsx(Pe,{value:x.remarks,onChange:r=>T(c,"remarks",r.target.value),placeholder:"ì¶”ê°€ ì„¤ëª…ì´ë‚˜ ìš”ì²­ì‚¬í•­",rows:2,disabled:t})]})]})]})},c))})})]}),e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"w-5 h-5"}),"ì£¼ë¬¸ ìš”ì•½"]})}),e.jsx(L,{children:e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-medium",children:"ì´ ì£¼ë¬¸ ê¸ˆì•¡"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[Ae(b()),"ì›"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:["ì´ ",d.items.length,"ê°œ í’ˆëª©"]})]})})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(h,{onClick:S,disabled:t||i,className:"flex-1 bg-blue-600 hover:bg-blue-700",size:"lg",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"ë°œì£¼ì„œ ìƒì„±"]})})})]})},it=({method:s,onDataSubmit:t,disabled:n})=>s==="excel"?e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"]})}),e.jsx(L,{children:e.jsx(at,{onUploadComplete:t,disabled:n})})]}):e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(V,{children:"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„±"})}),e.jsx(L,{children:e.jsx(lt,{onFormComplete:t,disabled:n})})]}),nt=({orderData:s})=>{const t=s.totalOrders||s.orders?.length||1,n=s.totalItems||s.items?.length||0,i=s.totalAmount||0;return e.jsxs(z,{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200",children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(D,{className:"w-6 h-6"}),"ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ ìš”ì•½"]})}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:t}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),"ë°œì£¼ì„œ"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:n}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(Ve,{className:"w-3 h-3"}),"í’ˆëª©"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:i>0?`â‚©${i.toLocaleString()}`:"-"}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(xs,{className:"w-3 h-3"}),"ì´ ê¸ˆì•¡"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:s.type==="excel"?"Excel":"í‘œì¤€"}),e.jsx("div",{className:"text-sm text-gray-600",children:"ìž‘ì„± ë°©ì‹"})]})]}),s.orderNumber&&e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"ë°œì£¼ì„œ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ë°œì£¼ì„œ ë²ˆí˜¸:"}),e.jsx(_,{variant:"outline",className:"font-mono",children:s.orderNumber})]}),s.projectName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"í”„ë¡œì íŠ¸:"}),e.jsx("span",{className:"font-medium",children:s.projectName})]}),s.vendorName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ê±°ëž˜ì²˜:"}),e.jsx("span",{className:"font-medium",children:s.vendorName})]}),s.createdAt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ìƒì„±ì¼:"}),e.jsx("span",{className:"font-medium",children:new Date(s.createdAt).toLocaleDateString("ko-KR")})]})]})]}),e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(D,{className:"w-4 h-4"}),"ëª¨ë“  ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"]})})]})]})},dt=({steps:s,onRetryStep:t,showRetryButtons:n=!1})=>{const i=s.filter(a=>a.status==="completed"),o=s.filter(a=>a.status==="error"),d=s.filter(a=>a.status==="processing"),p=a=>{switch(a.id){case"pdf_generation":return e.jsx(q,{className:"w-4 h-4"});case"vendor_validation":return e.jsx(Me,{className:"w-4 h-4"});case"email_preparation":return e.jsx(pe,{className:"w-4 h-4"});case"attachment_processing":return e.jsx(q,{className:"w-4 h-4"});case"final_validation":return e.jsx(D,{className:"w-4 h-4"});default:return e.jsx(we,{className:"w-4 h-4"})}},b=a=>{switch(a){case"completed":return e.jsx(D,{className:"w-4 h-4 text-green-600"});case"error":return e.jsx(H,{className:"w-4 h-4 text-red-600"});case"processing":return e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"});default:return e.jsx(te,{className:"w-4 h-4 text-gray-400"})}},f=a=>{switch(a){case"completed":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"processing":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-5 h-5 text-blue-600"}),"ì²˜ë¦¬ ê²°ê³¼ ìƒì„¸"]})}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:i.length}),e.jsx("div",{className:"text-sm text-green-700",children:"ì™„ë£Œ"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:d.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"ì²˜ë¦¬ ì¤‘"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:o.length}),e.jsx("div",{className:"text-sm text-red-700",children:"ì˜¤ë¥˜"})]})]}),e.jsx("div",{className:"space-y-3",children:s.map(a=>e.jsx("div",{className:`p-4 rounded-lg border ${f(a.status)} transition-all duration-200`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[p(a),b(a.status)]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.title}),e.jsx(_,{variant:"outline",className:a.status==="completed"?"border-green-600 text-green-600":a.status==="error"?"border-red-600 text-red-600":a.status==="processing"?"border-blue-600 text-blue-600":"border-gray-400 text-gray-600",children:a.status==="completed"?"ì™„ë£Œ":a.status==="error"?"ì˜¤ë¥˜":a.status==="processing"?"ì²˜ë¦¬ ì¤‘":"ëŒ€ê¸°"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:a.description}),a.progress!==void 0&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"ì§„í–‰ë¥ "}),e.jsxs("span",{children:[a.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${a.progress}%`}})})]}),a.result&&e.jsxs("div",{className:"text-sm text-green-700 bg-green-50 p-2 rounded mt-2",children:[e.jsx("strong",{children:"ê²°ê³¼:"})," ",typeof a.result=="string"?a.result:JSON.stringify(a.result)]}),a.error&&e.jsxs("div",{className:"text-sm text-red-700 bg-red-50 p-2 rounded mt-2",children:[e.jsx("strong",{children:"ì˜¤ë¥˜:"})," ",a.error]}),a.details&&a.details.length>0&&e.jsx("div",{className:"mt-2",children:e.jsxs("details",{className:"text-sm",children:[e.jsx("summary",{className:"cursor-pointer text-gray-600 hover:text-gray-800",children:"ìƒì„¸ ì •ë³´ ë³´ê¸°"}),e.jsx("ul",{className:"mt-2 space-y-1 text-gray-600 ml-4",children:a.details.map((k,F)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"â€¢"}),k]},F))})]})})]})]}),n&&a.status==="error"&&t&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>t(a.id),className:"ml-2",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"ìž¬ì‹œë„"]})]})},a.id))}),o.length===0&&i.length===s.length&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(D,{className:"w-4 h-4"}),"ëª¨ë“  ì²˜ë¦¬ ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"]})}),o.length>0&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-100 text-red-800 rounded-full text-sm font-medium",children:[e.jsx(H,{className:"w-4 h-4"}),o.length,"ê°œ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"]})})]})]})};class fe{static async generateFromElement(t,n={}){try{const{filename:i="document.pdf",orientation:o="portrait",format:d="a4",quality:p=.95,scale:b=2}=n;console.log("ðŸ“„ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì‹œìž‘...");const f=await ys(t,{scale:b,useCORS:!0,logging:!1,letterRendering:!0,allowTaint:!0,backgroundColor:"#ffffff"}),a=f.toDataURL("image/png",p),k=new bs({orientation:o,unit:"mm",format:d}),F=k.internal.pageSize.getWidth(),R=k.internal.pageSize.getHeight(),P=F,u=f.height*P/f.width;let C=u,A=0;for(k.addImage(a,"PNG",0,A,P,u),C-=R;C>0;)A=C-u,k.addPage(),k.addImage(a,"PNG",0,A,P,u),C-=R;const T=k.output("blob");return console.log("âœ… PDF ìƒì„± ì™„ë£Œ"),{success:!0,blob:T}}catch(i){return console.error("âŒ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì˜¤ë¥˜:",i),{success:!1,error:i instanceof Error?i.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static downloadPdf(t,n="document.pdf"){const i=window.URL.createObjectURL(t),o=document.createElement("a");o.href=i,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i)}static previewPdf(t){const n=window.URL.createObjectURL(t);window.open(n,"_blank"),setTimeout(()=>{window.URL.revokeObjectURL(n)},1e4)}static async generateFromHtml(t,n={}){try{const i=document.createElement("div");i.style.position="absolute",i.style.left="-9999px",i.style.width="210mm",i.innerHTML=t,document.body.appendChild(i);const o=await this.generateFromElement(i,n);return document.body.removeChild(i),o}catch(i){return console.error("âŒ HTML PDF ë³€í™˜ ì˜¤ë¥˜:",i),{success:!1,error:i instanceof Error?i.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static async generateOrderPdf(t,n={}){try{const i=`
        <div style="font-family: 'Malgun Gothic', sans-serif; padding: 20px;">
          <h1 style="text-align: center; color: #2563eb;">êµ¬ë§¤ ë°œì£¼ì„œ</h1>
          <div style="margin: 20px 0;">
            <h2>ë°œì£¼ ì •ë³´</h2>
            <table style="width: 100%; border-collapse: collapse;">
              <tr>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">ë°œì£¼ ë²ˆí˜¸</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${t.orderNumber||""}</td>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">ë°œì£¼ ì¼ìž</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${t.orderDate||""}</td>
              </tr>
              <tr>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">í”„ë¡œì íŠ¸</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${t.projectName||""}</td>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">ê±°ëž˜ì²˜</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${t.vendorName||""}</td>
              </tr>
            </table>
          </div>
          ${t.items?`
            <div style="margin: 20px 0;">
              <h2>ë°œì£¼ í’ˆëª©</h2>
              <table style="width: 100%; border-collapse: collapse;">
                <thead>
                  <tr style="background: #f3f4f6;">
                    <th style="border: 1px solid #ddd; padding: 8px;">í’ˆëª©ëª…</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ê·œê²©</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ìˆ˜ëŸ‰</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ë‹¨ê°€</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ê¸ˆì•¡</th>
                  </tr>
                </thead>
                <tbody>
                  ${t.items.map(o=>`
                    <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">${o.name||""}</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">${o.specification||""}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${o.quantity||0}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${o.unitPrice?.toLocaleString()||0}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${o.totalPrice?.toLocaleString()||0}</td>
                    </tr>
                  `).join("")}
                </tbody>
                <tfoot>
                  <tr style="background: #eff6ff;">
                    <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">ì´ ê¸ˆì•¡</td>
                    <td style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">
                      ${t.totalAmount?.toLocaleString()||0} ì›
                    </td>
                  </tr>
                </tfoot>
              </table>
            </div>
          `:""}
        </div>
      `;return await this.generateFromHtml(i,{...n,filename:`PO_${t.orderNumber||"draft"}.pdf`})}catch(i){return console.error("âŒ ë°œì£¼ì„œ PDF ìƒì„± ì˜¤ë¥˜:",i),{success:!1,error:i instanceof Error?i.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}}const ct=({orderData:s,isOpen:t,onClose:n,trigger:i,onDownload:o})=>{const[d,p]=g.useState({status:"idle"}),[b,f]=g.useState(100),[a,k]=g.useState(1),[F,R]=g.useState(1),[P,u]=g.useState(!1);g.useRef(null);const C=async()=>{p({status:"generating",progress:0});try{if(console.log("ðŸ“„ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì‹œìž‘..."),!s||Object.keys(s).length===0)throw new Error("ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");p({status:"generating",progress:30});const c=await fe.generateOrderPdf(s,{filename:`PO_${s.orderNumber||"draft"}.pdf`,orientation:"portrait",format:"a4"});if(p({status:"generating",progress:70}),!c.success||!c.blob)throw new Error(c.error||"PDF ìƒì„± ì‹¤íŒ¨");const r=window.URL.createObjectURL(c.blob);p({status:"generating",progress:100}),await new Promise(m=>setTimeout(m,200)),p({status:"ready",url:r,blob:c.blob}),console.log("âœ… í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì™„ë£Œ")}catch(c){console.error("âŒ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì˜¤ë¥˜:",c),p({status:"error",error:c instanceof Error?c.message:"PDF ìƒì„± ì‹¤íŒ¨"})}},A=async()=>{p({status:"generating",progress:0});try{if(console.log("PDF ìƒì„± ì‹œìž‘ - orderData:",s),!s||Object.keys(s).length===0)throw new Error("ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë°œì£¼ì„œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");const c=[{message:"ë°œì£¼ì„œ ë°ì´í„° ì¤€ë¹„ ì¤‘...",progress:15},{message:"PDF í…œí”Œë¦¿ ë¡œë”© ì¤‘...",progress:30},{message:"HTML ì½˜í…ì¸  ìƒì„± ì¤‘...",progress:50},{message:"PDF ë³€í™˜ ì¤‘...",progress:75},{message:"ìµœì¢… ê²€ì¦ ì¤‘...",progress:90},{message:"ì™„ë£Œ",progress:100}];for(let v=0;v<c.length-1;v++){const w=c[v];p({status:"generating",progress:w.progress}),await new Promise(l=>setTimeout(l,v===0?300:600))}console.log("ðŸ“„ API í˜¸ì¶œ ì‹œìž‘...");const r={orderData:{orderNumber:s.orderNumber||"PO-TEMP-001",projectName:s.projectName||s.project?.name||s.project?.projectName||"í”„ë¡œì íŠ¸ ë¯¸ì§€ì •",vendorName:s.vendorName||s.vendor?.name||"ê±°ëž˜ì²˜ ë¯¸ì§€ì •",items:Array.isArray(s.items)?s.items:[],totalAmount:Number(s.totalAmount)||0,notes:s.notes||s.remarks||"",orderDate:s.orderDate||new Date().toISOString(),deliveryDate:s.deliveryDate||s.dueDate||null,createdBy:s.createdBy||s.user?.name||"ì‹œìŠ¤í…œ"},options:{includeWatermark:!0,format:"A4",orientation:"portrait"}};console.log("ðŸ“¤ ì „ì†¡í•  ë°ì´í„°:",JSON.stringify(r,null,2));const m=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(r)});if(console.log("ðŸ“¨ ì‘ë‹µ ìƒíƒœ:",m.status,m.statusText),!m.ok){let v=`ì„œë²„ ì˜¤ë¥˜ (${m.status})`;try{const w=await m.json();console.error("ðŸ“¨ ì„œë²„ ì—ëŸ¬ ì‘ë‹µ:",w),v=w.error||w.details||v}catch(w){console.error("ðŸ“¨ ì—ëŸ¬ ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨:",w);const l=await m.text();console.error("ðŸ“¨ í…ìŠ¤íŠ¸ ì‘ë‹µ:",l)}throw new Error(v)}const j=await m.json();if(console.log("âœ… PDF ìƒì„± ì„±ê³µ ì‘ë‹µ:",j),!j.success)throw new Error(j.error||"PDF ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");if(!j.pdfUrl)throw new Error("PDF URLì´ ì‘ë‹µì— í¬í•¨ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");p({status:"generating",progress:100}),await new Promise(v=>setTimeout(v,200)),p({status:"ready",url:j.pdfUrl,message:j.message})}catch(c){console.error("âŒ PDF ìƒì„± ì˜¤ë¥˜:",c);let r="PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";c instanceof Error&&(c.message.includes("fetch")?r="ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.":c.message.includes("timeout")?r="ì²˜ë¦¬ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.":c.message.includes("ë°œì£¼ì„œ ë°ì´í„°")?r=c.message:c.message.includes("puppeteer")||c.message.includes("PDF ìƒì„± ì‹¤íŒ¨")?r="PDF ë³€í™˜ ë„êµ¬ì— ë¬¸ì œê°€ ìžˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.":r=c.message),p({status:"error",error:r})}},T=async()=>{const c=window.location.hostname.includes("vercel.app")||window.location.hostname.includes("ikjin-po");if(console.log("ðŸ” PDF ìƒì„± í™˜ê²½ ê°ì§€:",{hostname:window.location.hostname,isServerless:c,useClientPdf:P}),P||c)console.log("ðŸ“„ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì‹œìž‘"),await C();else{console.log("ðŸ“„ ì„œë²„ PDF ìƒì„± ì‹œë„");try{await A()}catch(r){console.error("âŒ ì„œë²„ PDF ì‹¤íŒ¨, í´ë¼ì´ì–¸íŠ¸ PDFë¡œ ì „í™˜",r),u(!0),await C()}}};g.useEffect(()=>{t&&d.status==="idle"&&T()},[t]);const M=()=>{if(d.blob)fe.downloadPdf(d.blob,`PO_${s?.orderNumber||"draft"}.pdf`);else if(d.url&&o)o(d.url);else if(d.url){const c=document.createElement("a");c.href=d.url,c.download=`ë°œì£¼ì„œ_${s?.orderNumber||"unknown"}.pdf`,document.body.appendChild(c),c.click(),document.body.removeChild(c)}},N=()=>{d.blob?fe.previewPdf(d.blob):d.url&&window.open(d.url,"_blank")},y=async()=>{try{console.log("ðŸ”„ ëŒ€ì•ˆ PDF ë‹¤ìš´ë¡œë“œ ì‹œìž‘...");const c={orderData:{orderNumber:s?.orderNumber||"PO-TEMP-001",projectName:s?.projectName||s?.project?.name||"í”„ë¡œì íŠ¸ ë¯¸ì§€ì •",vendorName:s?.vendorName||s?.vendor?.name||"ê±°ëž˜ì²˜ ë¯¸ì§€ì •",items:Array.isArray(s?.items)?s.items:[],totalAmount:Number(s?.totalAmount)||0,notes:s?.notes||s?.remarks||"",orderDate:s?.orderDate||new Date().toISOString(),deliveryDate:s?.deliveryDate||s?.dueDate||null,createdBy:s?.createdBy||s?.user?.name||"ì‹œìŠ¤í…œ"}},r=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(r.ok){const m=await r.json();if(m.success&&m.pdfUrl)window.open(`${m.pdfUrl}?download=true`,"_blank");else throw new Error(m.error||"ëŒ€ì•ˆ PDF ìƒì„± ì‹¤íŒ¨")}else throw new Error(`ì„œë²„ ì˜¤ë¥˜ (${r.status})`)}catch(c){console.error("âŒ ëŒ€ì•ˆ PDF ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:",c),alert("ëŒ€ì•ˆ PDF ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì¸ì‡„ ê¸°ëŠ¥ì„ ì´ìš©í•´ë³´ì„¸ìš”.")}},S=()=>{switch(d.status){case"generating":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx(ts,{className:"w-12 h-12 text-blue-600 animate-spin"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF ìƒì„± ì¤‘..."}),e.jsx("div",{className:"w-80 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${d.progress||0}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[d.progress||0,"% ì™„ë£Œ"]})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-6",children:[e.jsx(H,{className:"w-16 h-16 text-red-500"}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"PDF ìƒì„± ì‹¤íŒ¨"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 max-w-md",children:d.error})]}),e.jsxs("div",{className:"w-full max-w-2xl space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"ðŸ’¡ í•´ê²° ë°©ë²•"}),e.jsxs("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsx("li",{children:"â€¢ ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”"}),e.jsx("li",{children:"â€¢ ë‹¤ë¥¸ ë¸Œë¼ìš°ì €(Chrome, Firefox ë“±)ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”"}),e.jsx("li",{children:"â€¢ íŽ˜ì´ì§€ë¥¼ ìž ì‹œ ê¸°ë‹¤ë¦° í›„ ìž¬ì‹œë„í•´ë³´ì„¸ìš”"}),e.jsx("li",{children:"â€¢ ë°œì£¼ì„œ ë°ì´í„°ê°€ ì™„ì „ížˆ ë¡œë“œëœ í›„ ì‹œë„í•´ë³´ì„¸ìš”"})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100 mb-2",children:"âœ¨ ëŒ€ì•ˆ ë°©ë²•"}),e.jsxs("ul",{className:"text-sm text-green-800 dark:text-green-200 space-y-1",children:[e.jsx("li",{children:'â€¢ "ë‹¨ìˆœ PDF ìƒì„±" ë²„íŠ¼ìœ¼ë¡œ ì§ì ‘ ë‹¤ìš´ë¡œë“œ ì‹œë„'}),e.jsx("li",{children:"â€¢ ë°œì£¼ì„œ ìƒì„¸ íŽ˜ì´ì§€ì—ì„œ ì§ì ‘ ë‹¤ìš´ë¡œë“œ"}),e.jsx("li",{children:"â€¢ ë¸Œë¼ìš°ì €ì˜ ì¸ì‡„ ê¸°ëŠ¥(Ctrl+P)ì„ ì´ìš©í•´ PDFë¡œ ì €ìž¥"}),e.jsx("li",{children:"â€¢ Excel í˜•íƒœë¡œ ë‚´ë³´ë‚´ê¸° í›„ ìˆ˜ë™ìœ¼ë¡œ PDF ë³€í™˜"})]})]}),!1]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[e.jsxs(h,{onClick:T,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"ë‹¤ì‹œ ì‹œë„"]}),e.jsxs(h,{onClick:()=>{u(!0),C()},variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"ë¸Œë¼ìš°ì € PDF ìƒì„±"]}),e.jsxs(h,{onClick:()=>window.location.reload(),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"íŽ˜ì´ì§€ ìƒˆë¡œê³ ì¹¨"]}),s?.id&&e.jsxs(h,{onClick:()=>{n&&n(),window.location.href=`/orders/${s.id}`},variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"ìƒì„¸ íŽ˜ì´ì§€ë¡œ"]}),e.jsxs(h,{onClick:()=>{u(!0),C()},disabled:!s?.orderNumber,className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"ì§ì ‘ ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(h,{onClick:y,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"ë‹¨ìˆœ PDF ìƒì„±"]})]})]});case"ready":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>f(Math.max(50,b-25)),disabled:b<=50,children:e.jsx(Ye,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium px-2",children:[b,"%"]}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>f(Math.min(200,b+25)),disabled:b>=200,children:e.jsx(es,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[a," / ",F]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:N,children:[e.jsx(Ne,{className:"w-4 h-4 mr-1"}),"ì¸ì‡„"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:M,children:[e.jsx(se,{className:"w-4 h-4 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 min-h-[600px] flex flex-col items-center justify-center",children:d.blob?e.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx(D,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"PDF ìƒì„± ì™„ë£Œ!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"PDFê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(h,{onClick:M,className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"PDF ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(h,{onClick:N,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"PDF ë³´ê¸°"]})]})]})}):d.url?e.jsxs(e.Fragment,{children:[e.jsx("iframe",{src:`${d.url}#view=FitH&zoom=${b}`,className:"w-full h-[600px] border-0 rounded",title:"PDF ë¯¸ë¦¬ë³´ê¸°",onError:c=>{console.error("âŒ iframe PDF ë¡œë“œ ì‹¤íŒ¨");const r=c.target;r.style.display="none",u(!0),C()}}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"PDFê°€ í‘œì‹œë˜ì§€ ì•Šë‚˜ìš”?"}),e.jsx(h,{onClick:()=>window.open(d.url,"_blank"),variant:"outline",size:"sm",children:"ìƒˆ íƒ­ì—ì„œ ì—´ê¸°"})]})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(q,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"PDF ë¡œë”© ì¤‘..."})]})})]});default:return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs(h,{onClick:T,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"PDF ë¯¸ë¦¬ë³´ê¸° ì‹œìž‘"]})})}},x=e.jsxs(hs,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(ps,{children:e.jsxs(gs,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"PDF ë¯¸ë¦¬ë³´ê¸°",s?.orderNumber&&e.jsx(_,{variant:"outline",children:s.orderNumber})]})}),e.jsxs(js,{defaultValue:"preview",className:"h-full flex flex-col",children:[e.jsxs(fs,{className:"grid w-full grid-cols-2",children:[e.jsx(Fe,{value:"preview",children:"ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx(Fe,{value:"pdf",children:"PDF ìƒì„±"})]}),e.jsx(ue,{value:"preview",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"order-preview-container bg-white",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"ë°œì£¼ì„œ Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["ë°œì£¼ë²ˆí˜¸: ",s?.orderNumber||"PO-TEMP-001"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ê±°ëž˜ì²˜ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"íšŒì‚¬ëª…:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendorName||s?.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì—°ë½ì²˜:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì´ë©”ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì£¼ì†Œ:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì¼ìž:"}),e.jsx("span",{style:{flex:"1"},children:s?.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë‚©í’ˆí¬ë§ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.deliveryDate||s?.dueDate?new Date(s.deliveryDate||s.dueDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ìž:"}),e.jsx("span",{style:{flex:"1"},children:s?.createdBy||s?.user?.name||"ì‹œìŠ¤í…œ"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ìƒíƒœ:"}),e.jsx("span",{style:{flex:"1"},children:s?.status==="pending"?"ëŒ€ê¸°":s?.status==="approved"?"ìŠ¹ì¸":s?.status==="sent"?"ë°œì†¡":s?.status||"ìž„ì‹œ"})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"í’ˆëª©ëª…"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê·œê²©"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ìˆ˜ëŸ‰"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë‹¨ê°€"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê¸ˆì•¡"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë¹„ê³ "})]})}),e.jsxs("tbody",{children:[(s?.items||[]).map((c,r)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:c.itemName||c.name}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:c.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(c.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",Number(c.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",(Number(c.quantity)*Number(c.unitPrice)).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:c.notes||"-"})]},r)),(!s?.items||s.items.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{border:"1px solid #ddd",padding:"20px",textAlign:"center",fontSize:"10px",color:"#666"},children:"í’ˆëª© ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"ì´ ê¸ˆì•¡"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["â‚©",Number(s?.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),(s?.notes||s?.remarks)&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"íŠ¹ì´ì‚¬í•­:"}),e.jsx("br",{}),s.notes||s.remarks]}),e.jsxs("div",{className:"no-print mt-6 flex justify-center space-x-4",children:[e.jsxs(h,{onClick:N,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"ì¸ì‡„"]}),e.jsxs(h,{onClick:M,variant:"outline",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"PDF ë‹¤ìš´ë¡œë“œ"]})]})]})}),e.jsx(ue,{value:"pdf",className:"flex-1 overflow-auto",children:S()}),e.jsx(ue,{value:"details",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"order-preview-container bg-white",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"ë°œì£¼ì„œ Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["ë°œì£¼ë²ˆí˜¸: ",s?.orderNumber||"PO-TEMP-001"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ê±°ëž˜ì²˜ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"íšŒì‚¬ëª…:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendorName||s?.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì—°ë½ì²˜:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì´ë©”ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì£¼ì†Œ:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì¼ìž:"}),e.jsx("span",{style:{flex:"1"},children:s?.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë‚©í’ˆí¬ë§ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.deliveryDate||s?.dueDate?new Date(s.deliveryDate||s.dueDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ìž:"}),e.jsx("span",{style:{flex:"1"},children:s?.createdBy||s?.user?.name||"ì‹œìŠ¤í…œ"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ìƒíƒœ:"}),e.jsx("span",{style:{flex:"1"},children:s?.status==="pending"?"ëŒ€ê¸°":s?.status==="approved"?"ìŠ¹ì¸":s?.status==="sent"?"ë°œì†¡":s?.status||"ìž„ì‹œ"})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"í’ˆëª©ëª…"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê·œê²©"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ìˆ˜ëŸ‰"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë‹¨ê°€"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê¸ˆì•¡"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë¹„ê³ "})]})}),e.jsxs("tbody",{children:[(s?.items||[]).map((c,r)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:c.itemName||c.name}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:c.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(c.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",Number(c.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",(Number(c.quantity)*Number(c.unitPrice)).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:c.notes||"-"})]},r)),(!s?.items||s.items.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{border:"1px solid #ddd",padding:"20px",textAlign:"center",fontSize:"10px",color:"#666"},children:"í’ˆëª© ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"ì´ ê¸ˆì•¡"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["â‚©",Number(s?.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),(s?.notes||s?.remarks)&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"íŠ¹ì´ì‚¬í•­:"}),e.jsx("br",{}),s.notes||s.remarks]})]})})]})]});return i?e.jsxs(Ee,{open:t,onOpenChange:n,children:[e.jsx(us,{asChild:!0,children:i}),x]}):e.jsx(Ee,{open:t,onOpenChange:n,children:x})},ot=({orderData:s,onViewPDF:t,onDownloadPDF:n,onSendEmail:i,onViewOrders:o,onCreateNew:d,onPrint:p,onArchive:b,onShare:f,disabled:a=!1})=>{const[k,F]=g.useState(!1),[R,P]=g.useState(!1);return e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Oe,{className:"w-5 h-5"}),"ì‚¬ìš© ê°€ëŠ¥í•œ ìž‘ì—…"]})}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ë¬¸ì„œ ê´€ë¦¬"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(h,{variant:"outline",onClick:()=>F(!0),disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(de,{className:"w-4 h-4"}),"PDF ë¯¸ë¦¬ë³´ê¸°"]}),s?.pdfUrl&&e.jsxs(h,{variant:"outline",onClick:n,disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(se,{className:"w-4 h-4"}),"PDF ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(h,{variant:"outline",onClick:p,disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Ne,{className:"w-4 h-4"}),"ì¸ì‡„í•˜ê¸°"]}),e.jsxs(h,{variant:"outline",onClick:f,disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Oe,{className:"w-4 h-4"}),"ê³µìœ í•˜ê¸°"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ì´ë©”ì¼ ë°œì†¡"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs(h,{variant:s?.emailsSent?"outline":"default",onClick:()=>P(!0),disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(pe,{className:"w-4 h-4"}),s?.emailsSent?"ì´ë©”ì¼ ìž¬ë°œì†¡":"ì´ë©”ì¼ ë°œì†¡"]}),s?.emailsSent&&e.jsx("div",{className:"text-sm text-green-600 text-center py-2 bg-green-50 rounded-lg",children:"âœ“ ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ë‹¤ìŒ ë‹¨ê³„"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(h,{onClick:()=>{o?o():window.location.href="/orders"},disabled:a,className:"flex items-center justify-center gap-2 h-12 bg-blue-600 hover:bg-blue-700",children:[e.jsx(q,{className:"w-4 h-4"}),"ë°œì£¼ì„œ ê´€ë¦¬"]}),e.jsxs(h,{onClick:()=>{d?d():window.location.href="/create-order/unified"},variant:"outline",disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(qe,{className:"w-4 h-4"}),"ìƒˆ ë°œì£¼ì„œ ìž‘ì„±"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ê¸°íƒ€"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(h,{variant:"outline",onClick:b,disabled:a,className:"flex items-center justify-center gap-2 h-10 text-gray-600",children:[e.jsx(vs,{className:"w-4 h-4"}),"ë³´ê´€í•˜ê¸°"]})})]}),s?.orderNumber&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"ë°œì£¼ì„œ ë²ˆí˜¸"}),e.jsx("div",{className:"font-mono text-blue-900",children:s.orderNumber})]})})]}),e.jsx(ct,{orderData:s,isOpen:k,onClose:()=>F(!1),onDownload:n}),e.jsx(Ns,{open:R,onOpenChange:u=>{u||P(!1)},orderData:{orderNumber:s?.orderNumber||"WORKFLOW-ORDER",vendorName:s?.vendorName||"Unknown",vendorEmail:s?.vendorEmail||"",orderDate:new Date().toLocaleDateString(),totalAmount:s?.totalAmount||0,siteName:s?.projectName||"ì›Œí¬í”Œë¡œìš° ë°œì£¼ì„œ"},onSendEmail:async u=>{console.log("ì´ë©”ì¼ ë°œì†¡:",u),i&&i()}})]})},xt=({orderData:s,onNavigate:t})=>{const i=(()=>{const a=[];return a.push({id:"view_orders",title:"ë°œì£¼ì„œ ìƒì„¸ í™•ì¸",description:"ìƒì„±ëœ ë°œì£¼ì„œì˜ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•˜ì„¸ìš”",priority:"high",status:"recommended",estimatedTime:"2-3ë¶„",url:"/orders",icon:e.jsx(q,{className:"w-4 h-4"})}),s?.emailsSent||a.push({id:"send_emails",title:"ê±°ëž˜ì²˜ì— ì´ë©”ì¼ ë°œì†¡",description:"ìƒì„±ëœ ë°œì£¼ì„œë¥¼ ê±°ëž˜ì²˜ì— ì´ë©”ì¼ë¡œ ë°œì†¡í•˜ì„¸ìš”",priority:"high",status:"pending",estimatedTime:"1-2ë¶„",url:"/orders?action=send-email",icon:e.jsx(pe,{className:"w-4 h-4"})}),s?.requiresApproval&&a.push({id:"request_approval",title:"ìŠ¹ì¸ ìš”ì²­",description:"ë°œì£¼ì„œ ìŠ¹ì¸ì„ ìœ„í•´ ìƒê¸‰ìžì—ê²Œ ìŠ¹ì¸ ìš”ì²­ì„ ë³´ë‚´ì„¸ìš”",priority:"high",status:"pending",estimatedTime:"1ë¶„",url:"/approvals/request",icon:e.jsx(Be,{className:"w-4 h-4"})}),s?.totalAmount&&s.totalAmount>1e7&&a.push({id:"financial_review",title:"ìž¬ë¬´ ê²€í†  ìš”ì²­",description:"ê³ ì•¡ ë°œì£¼ì„œë¡œ ì¸í•´ ìž¬ë¬´íŒ€ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤",priority:"medium",status:"recommended",estimatedTime:"5ë¶„",url:"/financial-review",icon:e.jsx(De,{className:"w-4 h-4"})}),s?.vendorCount&&s.vendorCount>3&&a.push({id:"vendor_management",title:"ê±°ëž˜ì²˜ ê´€ë¦¬ ê²€í† ",description:"ë‹¤ìˆ˜ ê±°ëž˜ì²˜ ë°œì£¼ì„œì´ë¯€ë¡œ ê±°ëž˜ì²˜ ì •ë³´ë¥¼ ìž¬ê²€í† í•˜ì„¸ìš”",priority:"medium",status:"optional",estimatedTime:"3-5ë¶„",url:"/vendors",icon:e.jsx($e,{className:"w-4 h-4"})}),a.push({id:"project_tracking",title:"í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸",description:"í”„ë¡œì íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œì— ë°œì£¼ì„œ ì •ë³´ë¥¼ ë°˜ì˜í•˜ì„¸ìš”",priority:"low",status:"optional",estimatedTime:"2-3ë¶„",url:"/projects",icon:e.jsx(De,{className:"w-4 h-4"})}),a})(),o=i.filter(a=>a.status==="pending"),d=i.filter(a=>a.status==="recommended"),p=i.filter(a=>a.status==="optional"),b=a=>{switch(a){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200"}},f=a=>{a.action?a.action():a.url&&(t?t(a.url):window.location.href=a.url)};return e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-blue-600"}),"ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´"]})}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600 mb-1",children:o.length}),e.jsx("div",{className:"text-sm text-orange-700",children:"í•„ìˆ˜ ìž‘ì—…"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600 mb-1",children:d.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"ê¶Œìž¥ ìž‘ì—…"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-gray-600 mb-1",children:p.length}),e.jsx("div",{className:"text-sm text-gray-700",children:"ì„ íƒ ìž‘ì—…"})]})]}),o.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-orange-700 flex items-center gap-2",children:[e.jsx(ws,{className:"w-4 h-4"}),"í•„ìˆ˜ ìž‘ì—…"]}),o.map(a=>e.jsx("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.title}),e.jsx(_,{className:b(a.priority),children:a.priority==="high"?"ë†’ìŒ":a.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"}),a.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>f(a),className:"ml-2",children:"ì‹¤í–‰"})]})},a.id))]}),d.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-blue-700 flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"ê¶Œìž¥ ìž‘ì—…"]}),d.map(a=>e.jsx("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.title}),e.jsx(_,{className:b(a.priority),children:a.priority==="high"?"ë†’ìŒ":a.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"}),a.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>f(a),className:"ml-2",children:"ì‹¤í–‰"})]})},a.id))]}),p.length>0&&e.jsxs("details",{className:"space-y-3",children:[e.jsxs("summary",{className:"font-semibold text-gray-700 cursor-pointer flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"ì„ íƒ ìž‘ì—… (",p.length,"ê°œ)"]}),e.jsx("div",{className:"space-y-3 mt-3",children:p.map(a=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.title}),e.jsx(_,{className:b(a.priority),children:a.priority==="high"?"ë†’ìŒ":a.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"}),a.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>f(a),className:"ml-2",children:"ì‹¤í–‰"})]})},a.id))})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"ðŸ’¡ ë„ì›€ë§"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("p",{children:"â€¢ í•„ìˆ˜ ìž‘ì—…ë¶€í„° ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤"}),e.jsx("p",{children:"â€¢ ê° ìž‘ì—…ì˜ ì˜ˆìƒ ì‹œê°„ì„ ì°¸ê³ í•˜ì—¬ ê³„íšì„ ì„¸ìš°ì„¸ìš”"}),e.jsx("p",{children:"â€¢ ë¬¸ì˜ì‚¬í•­ì´ ìžˆìœ¼ì‹œë©´ ì‹œìŠ¤í…œ ê´€ë¦¬ìžì—ê²Œ ì—°ë½í•˜ì„¸ìš”"})]})]})]})]})},mt=({orderData:s,processingSteps:t=[],onViewOrders:n,onCreateNew:i,onViewPDF:o,onDownloadPDF:d,onSendEmail:p,onPrint:b,onShare:f,onArchive:a,onNavigate:k,disabled:F})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(D,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"ë°œì£¼ì„œ ìž‘ì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"}),e.jsx("p",{className:"text-lg text-gray-600",children:"ëª¨ë“  ì²˜ë¦¬ ê³¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."})]}),e.jsx(nt,{orderData:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.length>0&&e.jsx("div",{className:"lg:col-span-2",children:e.jsx(dt,{steps:t,showRetryButtons:!1})}),e.jsx(ot,{orderData:s,onViewPDF:o,onDownloadPDF:d,onSendEmail:p,onViewOrders:n,onCreateNew:i,onPrint:b,onArchive:a,onShare:f,disabled:F}),e.jsx(xt,{orderData:s,onNavigate:k})]})]}),ht=({onComplete:s,onCancel:t,className:n="",helpContent:i})=>{const{workflow:o,isProcessing:d,currentProcessingStep:p,canGoNext:b,canGoPrevious:f,goNext:a,goPrevious:k,goToStep:F,selectCreationMethod:R,submitOrderData:P,startProcessing:u,retryProcessingStep:C,progress:A,estimatedTime:T,saveProgress:M}=Js(),[N,y]=g.useState(!1),[S,x]=g.useState(!1),c=l=>{R(l)},r=()=>{M(),y(!0),setTimeout(()=>y(!1),3e3)},m=()=>{t&&t()},j=o.steps.find(l=>l.id===o.currentStep),v=o.steps.findIndex(l=>l.id===o.currentStep),w=()=>{switch(o.currentStep){case"select":return e.jsx(Ys,{onMethodSelect:c,disabled:d});case"create":return e.jsx(ge.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(it,{method:o.creationMethod||"standard",onDataSubmit:P,disabled:d})});case"approve":return e.jsx(ge.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(te,{className:"w-8 h-8 text-yellow-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ìŠ¹ì¸ ëŒ€ê¸° ì¤‘"}),e.jsx("p",{className:"text-gray-600",children:"ìŠ¹ì¸ ê¶Œí•œìžì˜ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤."})]})});case"process":return e.jsx(rt,{steps:o.stepStates.processing.steps,currentStep:p,onRetry:C,isProcessing:d});case"complete":return e.jsx(ge.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(mt,{orderData:o.orderData,processingSteps:o.stepStates.processing.steps,onViewOrders:()=>{s?s(o.orderData):window.location.href="/orders"},onCreateNew:()=>{window.location.href="/create-order/unified"},onViewPDF:()=>{o.stepStates.completed.pdfUrl&&window.open(o.stepStates.completed.pdfUrl,"_blank")},onDownloadPDF:()=>{if(o.stepStates.completed.pdfUrl){const E=document.createElement("a");E.href=o.stepStates.completed.pdfUrl,E.download=`ë°œì£¼ì„œ_${o.orderData?.orderNumber||"unknown"}.pdf`,document.body.appendChild(E),E.click(),document.body.removeChild(E)}},onSendEmail:()=>{console.log("ì´ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥ (êµ¬í˜„ ì˜ˆì •)")},onPrint:()=>{window.print()},onShare:()=>{navigator.share&&o.orderData?.orderNumber&&navigator.share({title:`ë°œì£¼ì„œ ${o.orderData.orderNumber}`,text:"ë°œì£¼ì„œë¥¼ ê³µìœ í•©ë‹ˆë‹¤.",url:window.location.href})},onArchive:()=>{console.log("ë³´ê´€í•˜ê¸° ê¸°ëŠ¥ (êµ¬í˜„ ì˜ˆì •)")},onNavigate:E=>{window.location.href=E},disabled:d})});default:return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Se,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ì•Œ ìˆ˜ ì—†ëŠ” ë‹¨ê³„"}),e.jsx("p",{className:"text-gray-600",children:"í˜„ìž¬ ë‹¨ê³„ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]})}};return e.jsxs("div",{className:`h-screen flex flex-col bg-gray-50 ${n}`,children:[e.jsx("div",{className:"bg-white border-b border-gray-200 flex-shrink-0",children:e.jsx("div",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"ë°œì£¼ì„œ ìž‘ì„±"}),e.jsx("div",{className:"h-4 w-px bg-gray-300"}),e.jsx("span",{className:"text-sm text-gray-600",children:j?.title})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(h,{variant:"ghost",size:"sm",onClick:r,disabled:d,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(Ie,{className:"w-4 h-4 mr-1"}),"ì €ìž¥"]}),e.jsxs(h,{variant:"ghost",size:"sm",onClick:m,disabled:d,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(Se,{className:"w-4 h-4 mr-1"}),"ì·¨ì†Œ"]})]})]})})}),N&&e.jsx("div",{className:"absolute top-16 right-6 z-50",children:e.jsxs(ae,{className:"border-green-200 bg-green-50 shadow-lg",children:[e.jsx(Ie,{className:"h-4 w-4 text-green-600"}),e.jsx(le,{className:"text-green-800",children:"ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"})]})}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:`bg-white border-r border-gray-200 flex-shrink-0 transition-all duration-300 ${S?"w-16":"w-80"}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs(h,{variant:"ghost",size:"sm",onClick:()=>x(!S),className:"w-full justify-between",children:[!S&&e.jsx("span",{className:"text-sm font-medium",children:"ì§„í–‰ ìƒí™©"}),S?e.jsx(rs,{className:"w-4 h-4"}):e.jsx(Ss,{className:"w-4 h-4"})]})}),!S&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-4",children:o.steps.map((l,E)=>{const $=l.id===o.currentStep,U=E<v,ie=E<=v;return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${U?"bg-green-500 text-white":$?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:U?"âœ“":E+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("button",{onClick:()=>ie&&F(l.id),disabled:!ie,className:`text-left w-full ${ie?"cursor-pointer hover:text-blue-600":"cursor-not-allowed"}`,children:[e.jsx("h3",{className:`text-sm font-medium truncate ${$?"text-blue-600":U?"text-green-600":"text-gray-700"}`,children:l.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:l.description})]}),$&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all duration-300",style:{width:`${A}%`}})}),T&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ì˜ˆìƒ ì†Œìš”: ",T]})]})]})]},l.id)})})}),e.jsxs("div",{className:"p-4 border-t border-gray-100 space-y-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:k,disabled:!f||d,className:"w-full justify-start",children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"ì´ì „ ë‹¨ê³„"]}),o.currentStep==="process"?e.jsx(h,{onClick:u,disabled:d||!b,className:"w-full justify-start",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"ì²˜ë¦¬ ì‹œìž‘"]})}):o.currentStep==="complete"?e.jsx(h,{onClick:()=>s?.(o.orderData),className:"w-full justify-start bg-green-600 hover:bg-green-700",children:"ì™„ë£Œ"}):e.jsxs(h,{onClick:a,disabled:!b||d,className:"w-full justify-start",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"ë‹¤ìŒ ë‹¨ê³„"]})]})]}),S&&e.jsx("div",{className:"p-2",children:e.jsx("div",{className:"space-y-2",children:o.steps.map((l,E)=>{const $=l.id===o.currentStep,U=E<v;return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${U?"bg-green-500 text-white":$?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:U?"âœ“":E+1})},l.id)})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto flex flex-col",children:[e.jsx("div",{className:"flex-1 p-6",children:e.jsx("div",{className:"max-w-[1366px] mx-auto",children:e.jsx(z,{className:"h-full shadow-sm",children:e.jsxs(L,{className:"h-full p-6 flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:j?.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:j?.description})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:w()})]})})})}),i&&e.jsx("div",{className:"flex-shrink-0",children:i})]})]})]})},pt=s=>e.jsx(Os,{children:e.jsx(ht,{...s})});function tr(){const{user:s}=Ue(),{toast:t}=Le(),[n,i]=as();new URLSearchParams(window.location.search).get("method"),g.useEffect(()=>{if(!s){i("/login");return}t({title:"í†µí•© ë°œì£¼ì„œ ìž‘ì„±",description:"ìƒˆë¡œìš´ í†µí•© ì›Œí¬í”Œë¡œìš°ë¡œ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•´ë³´ì„¸ìš”"})},[s,i,t]);const d=b=>{t({title:"ë°œì£¼ì„œ ìž‘ì„± ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"}),i("/orders")},p=()=>{window.confirm("ìž‘ì„± ì¤‘ì¸ ë°œì£¼ì„œë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì €ìž¥ë˜ì§€ ì•Šì€ ë‚´ìš©ì€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.")&&(t({title:"ìž‘ì—… ì·¨ì†Œë¨",description:"ë°œì£¼ì„œ ìž‘ì„±ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤",variant:"destructive"}),i("/dashboard"))};return s?e.jsx(pt,{onComplete:d,onCancel:p,helpContent:e.jsx("div",{className:"bg-white border-t border-gray-200",children:e.jsx("div",{className:"max-w-[1366px] mx-auto px-6 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"ðŸ“‹ ë°©ì‹ ì„ íƒ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë§žëŠ” ë°œì£¼ì„œ ìž‘ì„± ë°©ì‹ì„ ì„ íƒí•˜ì„¸ìš”. ê° ë°©ì‹ì˜ ìž¥ë‹¨ì ì„ ë¹„êµí•˜ì—¬ ìµœì ì˜ ì„ íƒì„ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"âš™ï¸ ìžë™ ì²˜ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì„œ ìƒì„± í›„ PDF ë³€í™˜, ê±°ëž˜ì²˜ ê²€ì¦, ì´ë©”ì¼ ë°œì†¡ê¹Œì§€ ëª¨ë“  ê³¼ì •ì´ ìžë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"ðŸ’¾ ìžë™ ì €ìž¥"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ìž‘ì—… ì§„í–‰ ìƒí™©ì´ ìžë™ìœ¼ë¡œ ì €ìž¥ë˜ì–´ ì¤‘ê°„ì— ì¤‘ë‹¨ë˜ì–´ë„ ì´ì–´ì„œ ìž‘ì—…í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]})]})})})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"ë¡œê·¸ì¸ í™•ì¸ ì¤‘..."})]})})}export{tr as default};
