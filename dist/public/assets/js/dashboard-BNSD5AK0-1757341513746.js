import{q as M,h as De,u as de,r as _,j as e,t as Xe,v as Ye,F as q,H as xe,an as H,f as D,o as C,bN as be,be as ae,a as L,a$ as ye,l as te,B as I,E as He,M as et,T as tt,J as Oe,c as Ke,b as ne,w as Q,L as G,N as Z,ag as Se,m as fe,x as J,aa as he,C as Ne,ab as st,aj as rt,R as at,a5 as S,bO as nt,k as it,d as lt,e as ot,g as ct,i as dt,bP as Ce}from"./index-Cq_ZAPR7-1757341513746.js";import{b as ze}from"./orderStatusUtils-dnL6JuEg-1757341513746.js";import{C as xt}from"./chevrons-up-down-B76gjSGR-1757341513746.js";import{U as Be}from"./users-YgpftXuP-1757341513746.js";import{S as mt}from"./square-pen-CY1Z5ccH-1757341513746.js";import{D as ut}from"./download-ByvuypWs-1757341513746.js";import{T as ht}from"./truck-DDXovRIo-1757341513746.js";import{M as pt}from"./mail-check-BE6E4Zgw-1757341513746.js";import{D as gt}from"./dashboard-skeleton-DnEW0XW4-1757341513746.js";import{P as Pe}from"./progress-Cre3DZ4W-1757341513746.js";import{T as ie}from"./trending-up-DWXbOqyg-1757341513746.js";import{C as se}from"./calendar-DHDvqrtQ-1757341513746.js";import{D as we}from"./dollar-sign-BS_Lichf-1757341513746.js";import{A as Fe}from"./activity-j9dAlFNE-1757341513746.js";import{S as ke,d as yt,G as ft,f as pe,e as V,g as jt,A as vt,i as ee,h as bt,j as Le,E as Nt,k as re,l as wt,m as $t,n as At,o as R,p as Ot,c as St,q as Te,u as Ct,r as Pt,a as $e,X as Ae,Y as le,s as kt,R as Ie,C as Re,T as qe,B as Tt}from"./PieChart-CmYPt_X0-1757341513746.js";import{a as Et}from"./AreaChart-fAfKkHvs-1757341513746.js";import{L as We,A as _t}from"./advanced-chart-C33HxdYD-1757341513746.js";import{T as Dt,M as Kt,u as zt}from"./dashboard-widgets-9ZNyqRM2-1757341513746.js";import{P as ge}from"./package-Bk6EsQ1p-1757341513746.js";import"./index-CtRW1NYq-1757341513746.js";import"./refresh-cw-DLuks9WA-1757341513746.js";function Bt(t={}){const s=new URLSearchParams;return Object.entries(t).forEach(([n,r])=>{r!=null&&r!==""&&s.append(n,String(r))}),s}function Ue(t={}){const{filters:s={},...n}=t;return M({queryKey:["unified-orders",s],queryFn:async()=>{const r=Bt(s);console.log("🔍 Unified Orders API request:",`/api/orders-optimized?${r.toString()}`);const l=await fetch(`/api/orders-optimized?${r}`,{credentials:"include"});if(!l.ok)throw new Error("Failed to fetch orders");const a=await l.json();return console.log("✅ Unified Orders received:",a.orders?.length,"orders"),a},staleTime:n.staleTime??1e3,gcTime:n.gcTime??6e4,refetchOnWindowFocus:!0,refetchOnMount:!0,enabled:n.enabled??!0,refetchInterval:n.refetchInterval,...n})}function Ft(t=10){return Ue({filters:{limit:t,sortBy:"createdAt",sortOrder:"desc"},staleTime:3e4,gcTime:3e5})}function Lt(t){return Ue({filters:t,staleTime:1e3,gcTime:6e4})}function It(t,s){switch(s||t){case"draft":return e.jsx(Oe,{className:"h-3 w-3"});case"pending":return e.jsx(L,{className:"h-3 w-3"});case"approved":case"created":return e.jsx(ne,{className:"h-3 w-3"});case"sent":return e.jsx(pt,{className:"h-3 w-3"});case"delivered":return e.jsx(ht,{className:"h-3 w-3"});case"completed":return e.jsx(ne,{className:"h-3 w-3"});case"rejected":return e.jsx(Ke,{className:"h-3 w-3"});case"urgent":return e.jsx(xe,{className:"h-3 w-3"});default:return e.jsx(Oe,{className:"h-3 w-3"})}}function Rt({order:t,onOrderClick:s,isDarkMode:n}){const r=_.useMemo(()=>ze(t),[t]);return e.jsxs("div",{className:`flex items-center justify-between p-1 rounded cursor-pointer transition-colors ${n?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"min-w-0 flex-1",onClick:()=>s?.(t.id),children:[e.jsx("div",{className:`text-xs font-medium truncate transition-colors ${n?"text-gray-100":"text-gray-900"}`,children:t.orderNumber}),e.jsx("div",{className:`text-xs transition-colors ${n?"text-gray-400":"text-gray-500"}`,children:t.vendor?.name||t.vendorName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsx("div",{className:`text-xs font-semibold transition-colors ${n?"text-blue-400":"text-blue-600"}`,children:D(t.totalAmount||0).replace("₩","").replace(",000,000","M")})}),r&&e.jsx("button",{onClick:l=>{l.stopPropagation(),window.open(`/api/orders/${t.id}/download-pdf`,"_blank")},className:`p-1 rounded transition-colors ${n?"text-orange-400 hover:bg-orange-900/20 hover:text-orange-300":"text-orange-500 hover:bg-orange-50 hover:text-orange-700"}`,title:"PDF 다운로드",children:e.jsx(q,{className:"h-3 w-3"})})]})]})}function qt({order:t,onOrderClick:s,isDarkMode:n,sortBy:r,sortOrder:l,onSort:a,showActions:h=!1}){const g=_.useMemo(()=>ze(t),[t]);return e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors ${n?"border-gray-700":"border-gray-200"}`,children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{onClick:()=>s?.(t.id),className:`text-xs font-medium transition-colors ${n?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,children:t.orderNumber})}),e.jsx("td",{className:`px-3 py-2 text-xs ${n?"text-gray-300":"text-gray-700"}`,children:e.jsx("div",{className:"truncate max-w-[120px]",title:t.vendor?.name||t.vendorName,children:t.vendor?.name||t.vendorName||"-"})}),e.jsx("td",{className:`px-3 py-2 text-xs font-medium text-right ${n?"text-gray-100":"text-gray-900"}`,children:D(t.totalAmount||0).replace("₩","").replace(",000,000","M")}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(C,{variant:"secondary",className:H("text-xs px-2 py-0",be(t.orderStatus||t.status)),children:ae(t.orderStatus||t.status)})}),h&&e.jsx("td",{className:"px-3 py-2 text-center",children:g&&e.jsx("button",{onClick:x=>{x.stopPropagation(),window.open(`/api/orders/${t.id}/download-pdf`,"_blank")},className:`p-1 rounded transition-colors ${n?"text-orange-400 hover:bg-orange-900/20 hover:text-orange-300":"text-orange-500 hover:bg-orange-50 hover:text-orange-700"}`,title:"PDF 다운로드",children:e.jsx(q,{className:"h-3 w-3"})})})]})}function Wt({order:t,onOrderClick:s,isDarkMode:n}){return e.jsxs("div",{className:H("group flex items-center justify-between p-3 rounded-lg","hover:bg-gray-50 transition-all duration-200","cursor-pointer hover:shadow-sm",n&&"hover:bg-gray-800"),onClick:()=>s?.(t.id),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:`text-sm font-medium group-hover:text-primary-600 transition-colors ${n?"text-gray-100":"text-gray-900"}`,children:t.orderNumber}),e.jsx(C,{variant:"secondary",className:H("text-xs px-2 py-0",be(t.orderStatus||t.status)),children:ae(t.orderStatus||t.status)})]}),e.jsxs("div",{className:`flex items-center gap-3 text-xs ${n?"text-gray-400":"text-gray-500"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:ye(t.createdAt||t.orderDate)})]}),(t.vendor?.name||t.vendorName)&&e.jsx("span",{className:"truncate",children:t.vendor?.name||t.vendorName})]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsx("p",{className:`text-sm font-semibold ${n?"text-gray-100":"text-gray-900"}`,children:D(t.totalAmount)})})]})}function Ut({order:t,onOrderClick:s,onStatusChange:n,onDeleteOrder:r,isDarkMode:l,showActions:a=!0}){const[,h]=de(),g=(x,u)=>{x.stopPropagation(),u()};return e.jsxs("div",{className:`p-4 border rounded-lg transition-colors ${l?"border-gray-700 hover:bg-gray-800":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${l?"bg-blue-900/30":"bg-blue-100"}`,children:It(t.status,t.orderStatus)}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold cursor-pointer transition-colors ${l?"text-gray-100 hover:text-blue-400":"text-gray-900 hover:text-blue-600"}`,onClick:()=>s?.(t.id),children:t.orderNumber}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(C,{variant:"secondary",className:H("text-xs px-2 py-0",be(t.orderStatus||t.status)),children:ae(t.orderStatus||t.status)}),t.approvalStatus&&e.jsx(C,{variant:"outline",className:"text-xs px-2 py-0",children:ae(t.approvalStatus)})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold ${l?"text-gray-100":"text-gray-900"}`,children:D(t.totalAmount)}),e.jsx("div",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:ye(t.createdAt||t.orderDate)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:`h-4 w-4 ${l?"text-gray-400":"text-gray-500"}`}),e.jsx("span",{className:`text-sm ${l?"text-gray-300":"text-gray-700"}`,children:t.project?.projectName||t.projectName||"프로젝트 없음"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:`h-4 w-4 ${l?"text-gray-400":"text-gray-500"}`}),e.jsx("span",{className:`text-sm ${l?"text-gray-300":"text-gray-700"}`,children:t.vendor?.name||t.vendorName||"거래처 없음"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:`h-4 w-4 ${l?"text-gray-400":"text-gray-500"}`}),e.jsx("span",{className:`text-sm ${l?"text-gray-300":"text-gray-700"}`,children:t.deliveryDate?ye(t.deliveryDate):"배송일 미정"})]})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:x=>g(x,()=>h(`/orders/${t.id}`)),children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),"상세보기"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:x=>g(x,()=>h(`/orders/${t.id}/edit`)),children:[e.jsx(mt,{className:"h-4 w-4 mr-1"}),"수정"]}),t.vendor?.email&&e.jsxs(I,{variant:"outline",size:"sm",onClick:x=>g(x,()=>{}),children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),"이메일"]}),t.filePath&&e.jsxs(I,{variant:"outline",size:"sm",onClick:x=>g(x,()=>window.open(`/api/orders/${t.id}/download-pdf`,"_blank")),children:[e.jsx(ut,{className:"h-4 w-4 mr-1"}),"PDF"]}),e.jsxs(I,{variant:"destructive",size:"sm",onClick:x=>g(x,()=>r?.(t.id)),children:[e.jsx(tt,{className:"h-4 w-4 mr-1"}),"삭제"]})]})]})}function Vt({mode:t="detailed",maxItems:s,showActions:n=!0,showPagination:r=!1,filters:l,orders:a,onOrderClick:h,onStatusChange:g,onDeleteOrder:x,compact:u=!1,className:m="",enableSelection:o=!1,selectedOrders:i=[],onSelectionChange:p,sortBy:b,sortOrder:j,onSort:v}){const{theme:w}=De(),c=w==="dark",[,f]=de(),A=t==="compact-table"?!1:n,P=!a,E=Ft(s||10),d=Lt(l||{}),y=t==="compact"?E:d,{data:O,isLoading:z,error:B}=P?y:{data:null,isLoading:!1,error:null},N=_.useMemo(()=>{if(a)return s?a.slice(0,s):a;const $=O?.orders||[];return s?$.slice(0,s):$},[a,O?.orders,s]),k=$=>{h?h($):f(`/orders/${$}`)},F=_.useCallback($=>b!==$?e.jsx(xt,{className:"h-3 w-3 opacity-50"}):j==="asc"?e.jsx(Xe,{className:"h-3 w-3"}):e.jsx(Ye,{className:"h-3 w-3"}),[b,j]);if(P&&z)return e.jsxs("div",{className:`flex flex-col items-center justify-center py-8 ${c?"text-gray-400":"text-gray-500"}`,children:[e.jsx(q,{className:`h-12 w-12 mb-2 animate-pulse ${c?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-sm",children:"발주서를 불러오는 중..."})]});if(P&&B)return e.jsxs("div",{className:`flex flex-col items-center justify-center py-8 ${c?"text-red-400":"text-red-500"}`,children:[e.jsx(xe,{className:"h-12 w-12 mb-2"}),e.jsx("p",{className:"text-sm",children:"발주서를 불러오는데 실패했습니다"})]});if(N.length===0)return e.jsxs("div",{className:`flex flex-col items-center justify-center py-8 ${c?"text-gray-400":"text-gray-500"}`,children:[e.jsx(q,{className:`h-12 w-12 mb-2 ${c?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-sm",children:"발주서가 없습니다"})]});const Je=()=>{switch(t){case"compact":return e.jsx("div",{className:"space-y-1",children:N.map($=>e.jsx(Rt,{order:$,onOrderClick:k,isDarkMode:c},$.id))});case"compact-table":return e.jsx("div",{className:`overflow-x-auto rounded-lg border ${c?"border-gray-700":"border-gray-200"}`,children:e.jsxs("table",{className:"w-full min-w-full",children:[e.jsx("thead",{className:`${c?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"} border-b`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-3 py-3 text-left text-xs font-medium uppercase tracking-wider ${c?"text-gray-300":"text-gray-500"}`,children:e.jsxs("button",{onClick:()=>v?.("orderNumber"),className:`flex items-center gap-1 transition-colors ${c?"hover:text-gray-100":"hover:text-gray-700"}`,children:["발주번호",F("orderNumber")]})}),e.jsx("th",{className:`px-3 py-3 text-left text-xs font-medium uppercase tracking-wider ${c?"text-gray-300":"text-gray-500"}`,children:e.jsxs("button",{onClick:()=>v?.("vendorName"),className:`flex items-center gap-1 transition-colors ${c?"hover:text-gray-100":"hover:text-gray-700"}`,children:["거래처",F("vendorName")]})}),e.jsx("th",{className:`px-3 py-3 text-right text-xs font-medium uppercase tracking-wider ${c?"text-gray-300":"text-gray-500"}`,children:e.jsxs("button",{onClick:()=>v?.("totalAmount"),className:`flex items-center gap-1 justify-end transition-colors ${c?"hover:text-gray-100":"hover:text-gray-700"}`,children:["금액",F("totalAmount")]})}),e.jsx("th",{className:`px-3 py-3 text-left text-xs font-medium uppercase tracking-wider ${c?"text-gray-300":"text-gray-500"}`,children:e.jsxs("button",{onClick:()=>v?.("orderStatus"),className:`flex items-center gap-1 transition-colors ${c?"hover:text-gray-100":"hover:text-gray-700"}`,children:["발주상태",F("orderStatus")]})}),A&&e.jsx("th",{className:`px-3 py-3 text-center text-xs font-medium uppercase tracking-wider ${c?"text-gray-300":"text-gray-500"}`,children:"액션"})]})}),e.jsx("tbody",{className:`divide-y ${c?"bg-gray-800 divide-gray-700":"bg-white divide-gray-200"}`,children:N.map($=>e.jsx(qt,{order:$,onOrderClick:k,isDarkMode:c,sortBy:b,sortOrder:j,onSort:v,showActions:A},$.id))})]})});case"detailed":return e.jsx("div",{className:"space-y-2",children:N.map($=>e.jsx(Wt,{order:$,onOrderClick:k,isDarkMode:c},$.id))});case"full":return e.jsx("div",{className:"space-y-4",children:N.map($=>e.jsx(Ut,{order:$,onOrderClick:k,onStatusChange:g,onDeleteOrder:x,isDarkMode:c,showActions:A},$.id))});default:return null}};return e.jsxs("div",{className:H("unified-orders-list",m),children:[Je(),t==="compact"&&O&&O.total>N.length&&e.jsx("div",{className:"text-center pt-2",children:e.jsxs("p",{className:`text-xs ${c?"text-gray-400":"text-gray-500"}`,children:["외 ",O.total-N.length,"개 발주서"]})})]})}function Mt({className:t="",showDetails:s=!0}){const[,n]=de(),{data:r,isLoading:l}=M({queryKey:["/api/approvals/dashboard-stats"],queryFn:async()=>{const i=await fetch("/api/approvals/dashboard-stats",{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch approval stats");return i.json()},refetchInterval:6e4}),{data:a,isLoading:h}=M({queryKey:["/api/approvals/pending-summary"],queryFn:async()=>{const i=await fetch("/api/approvals/pending-summary?limit=5",{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch pending approvals");return i.json()},refetchInterval:6e4}),{data:g,isLoading:x}=M({queryKey:["/api/approvals/recent-activity"],queryFn:async()=>{const i=await fetch("/api/approvals/recent-activity?limit=5",{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch recent activity");return i.json()},refetchInterval:6e4}),u=i=>{switch(i){case"approved":return e.jsx(ne,{className:"h-4 w-4 text-green-600"});case"rejected":return e.jsx(Ke,{className:"h-4 w-4 text-red-600"});default:return e.jsx(L,{className:"h-4 w-4 text-yellow-600"})}},m=i=>{switch(i){case"approved":return e.jsx(C,{className:"bg-green-100 text-green-700 border-green-200",children:"승인"});case"rejected":return e.jsx(C,{className:"bg-red-100 text-red-700 border-red-200",children:"반려"});default:return e.jsx(C,{className:"bg-yellow-100 text-yellow-700 border-yellow-200",children:"대기"})}},o=(i,p)=>i?e.jsx(C,{variant:"destructive",className:"text-xs",children:"긴급"}):p>3?e.jsx(C,{className:"bg-orange-100 text-orange-700 border-orange-200 text-xs",children:"지연"}):null;return s?e.jsxs(Q,{className:`shadow-sm ${t}`,children:[e.jsx(G,{children:e.jsxs(Z,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"승인 관리 현황"})]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>n("/approvals"),children:[e.jsx(fe,{className:"h-4 w-4 mr-1"}),"전체보기"]})]})}),e.jsxs(J,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4 text-yellow-500"}),e.jsx("p",{className:"text-xs text-gray-500",children:"승인 대기"})]}),e.jsx("p",{className:"text-2xl font-bold",children:r?.pendingCount||0}),r?.urgentCount?e.jsxs(C,{variant:"destructive",className:"text-xs",children:[r.urgentCount,"건 긴급"]}):null]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500",children:"오늘 처리"})]}),e.jsx("p",{className:"text-2xl font-bold",children:r?.todayCount||0}),e.jsxs("p",{className:"text-xs text-gray-400",children:["주간 ",r?.weekCount||0,"건"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-green-500"}),e.jsx("p",{className:"text-xs text-gray-500",children:"대기 금액"})]}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:D(r?.pendingAmount||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-purple-500"}),e.jsx("p",{className:"text-xs text-gray-500",children:"승인율"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[r?.approvalRate||0,"%"]}),e.jsx(Pe,{value:r?.approvalRate||0,className:"h-1"})]})]}),e.jsx(he,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-yellow-500"}),"승인 대기 목록"]}),e.jsxs(C,{variant:"outline",children:["평균 대기: ",r?.averageWaitDays||0,"일"]})]}),e.jsx(st,{className:"h-48",children:h?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("p",{className:"text-sm text-gray-400",children:"로딩 중..."})}):a&&a.length>0?e.jsx("div",{className:"space-y-2",children:a.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors",onClick:()=>n(`/orders/${i.id}/standard`),children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:i.orderNumber}),o(i.isUrgent,i.daysWaiting)]}),e.jsx("span",{className:"text-xs text-gray-500",children:i.projectName})]})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:D(i.totalAmount)}),e.jsxs("p",{className:"text-xs text-gray-400",children:[i.daysWaiting,"일 대기"]})]})]},i.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(ne,{className:"h-8 w-8 text-green-500 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"승인 대기 중인 발주서가 없습니다"})]})})]}),e.jsx(he,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-blue-500"}),"최근 활동"]}),x?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-xs text-gray-400",children:"로딩 중..."})}):g&&g.length>0?e.jsx("div",{className:"space-y-2",children:g.map(i=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[u(i.action),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:i.orderNumber}),e.jsxs("p",{className:"text-xs text-gray-500",children:[i.performedBy," • ",rt(new Date(i.performedAt),{addSuffix:!0,locale:at})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:m(i.action)})]},i.id))}):e.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"최근 활동이 없습니다"})]})]})]}):e.jsxs(Q,{className:`shadow-sm hover:shadow-md transition-shadow cursor-pointer ${t}`,onClick:()=>n("/approvals"),children:[e.jsx(G,{className:"pb-3",children:e.jsxs(Z,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"text-lg",children:"승인 관리"})]}),e.jsx(fe,{className:"h-4 w-4 text-gray-400"})]})}),e.jsxs(J,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"승인 대기"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-2xl font-bold",children:r?.pendingCount||0}),r?.urgentCount?e.jsxs(C,{variant:"destructive",className:"text-xs",children:[r.urgentCount," 긴급"]}):null]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"이번 주 처리"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r?.approvedThisWeek||0}),e.jsx(ie,{className:"h-4 w-4 text-green-600"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"승인율"}),e.jsxs("span",{className:"font-medium",children:[r?.approvalRate||0,"%"]})]}),e.jsx(Pe,{value:r?.approvalRate||0,className:"h-2"})]}),e.jsx(he,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"최근 대기 중"}),h?e.jsx("div",{className:"text-center py-2",children:e.jsx("p",{className:"text-xs text-gray-400",children:"로딩 중..."})}):a&&a.length>0?e.jsx("div",{className:"space-y-1",children:a.slice(0,3).map(i=>e.jsxs("div",{className:"flex items-center justify-between py-1 text-xs hover:bg-gray-50 rounded px-1",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(L,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.orderNumber}),o(i.isUrgent,i.daysWaiting)]}),e.jsxs("span",{className:"text-gray-500 flex-shrink-0",children:[i.daysWaiting,"일 전"]})]},i.id))}):e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"대기 중인 승인이 없습니다"})]})]})]})}function W(t){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},W(t)}function Qt(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function Gt(t,s){for(var n=0;n<s.length;n++){var r=s[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qe(r.key),r)}}function Zt(t,s,n){return s&&Gt(t.prototype,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jt(t,s,n){return s=oe(s),Xt(t,Ve()?Reflect.construct(s,n||[],oe(t).constructor):s.apply(t,n))}function Xt(t,s){if(s&&(W(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yt(t)}function Yt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ve(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ve=function(){return!!t})()}function oe(t){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},oe(t)}function Ht(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&je(t,s)}function je(t,s){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},je(t,s)}function Me(t,s,n){return s=Qe(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Qe(t){var s=es(t,"string");return W(s)=="symbol"?s:s+""}function es(t,s){if(W(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,s||"default");if(W(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var me=function(t){function s(){return Qt(this,s),Jt(this,s,arguments)}return Ht(s,t),Zt(s,[{key:"render",value:function(){return null}}])}(S.Component);Me(me,"displayName","ZAxis");Me(me,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var ts=["option","isActive"];function X(){return X=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},X.apply(this,arguments)}function ss(t,s){if(t==null)return{};var n=rs(t,s),r,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(l=0;l<a.length;l++)r=a[l],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function rs(t,s){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(s.indexOf(r)>=0)continue;n[r]=t[r]}return n}function as(t){var s=t.option,n=t.isActive,r=ss(t,ts);return typeof s=="string"?S.createElement(ke,X({option:S.createElement(yt,X({type:s},r)),isActive:n,shapeType:"symbols"},r)):S.createElement(ke,X({option:s,isActive:n,shapeType:"symbols"},r))}function U(t){"@babel/helpers - typeof";return U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},U(t)}function Y(){return Y=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Y.apply(this,arguments)}function Ee(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function T(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Ee(Object(n),!0).forEach(function(r){K(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ns(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function _e(t,s){for(var n=0;n<s.length;n++){var r=s[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ze(r.key),r)}}function is(t,s,n){return s&&_e(t.prototype,s),n&&_e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ls(t,s,n){return s=ce(s),os(t,Ge()?Reflect.construct(s,n||[],ce(t).constructor):s.apply(t,n))}function os(t,s){if(s&&(U(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cs(t)}function cs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ge(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ge=function(){return!!t})()}function ce(t){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ce(t)}function ds(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&ve(t,s)}function ve(t,s){return ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},ve(t,s)}function K(t,s,n){return s=Ze(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Ze(t){var s=xs(t,"string");return U(s)=="symbol"?s:s+""}function xs(t,s){if(U(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,s||"default");if(U(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var ue=function(t){function s(){var n;ns(this,s);for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return n=ls(this,s,[].concat(l)),K(n,"state",{isAnimationFinished:!1}),K(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0})}),K(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1})}),K(n,"id",Ct("recharts-scatter-")),n}return ds(s,t),is(s,[{key:"renderSymbolsStatically",value:function(r){var l=this,a=this.props,h=a.shape,g=a.activeShape,x=a.activeIndex,u=pe(this.props,!1);return r.map(function(m,o){var i=x===o,p=i?g:h,b=T(T({},u),m);return S.createElement(V,Y({className:"recharts-scatter-symbol",key:"symbol-".concat(m?.cx,"-").concat(m?.cy,"-").concat(m?.size,"-").concat(o)},jt(l.props,m,o),{role:"img"}),S.createElement(as,Y({option:p,isActive:i,key:"symbol-".concat(o)},b)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,l=this.props,a=l.points,h=l.isAnimationActive,g=l.animationBegin,x=l.animationDuration,u=l.animationEasing,m=l.animationId,o=this.state.prevPoints;return S.createElement(vt,{begin:g,duration:x,isActive:h,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(i){var p=i.t,b=a.map(function(j,v){var w=o&&o[v];if(w){var c=ee(w.cx,j.cx),f=ee(w.cy,j.cy),A=ee(w.size,j.size);return T(T({},j),{},{cx:c(p),cy:f(p),size:A(p)})}var P=ee(0,j.size);return T(T({},j),{},{size:P(p)})});return S.createElement(V,null,r.renderSymbolsStatically(b))})}},{key:"renderSymbols",value:function(){var r=this.props,l=r.points,a=r.isAnimationActive,h=this.state.prevPoints;return a&&l&&l.length&&(!h||!bt(h,l))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(l)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var l=this.props,a=l.points,h=l.xAxis,g=l.yAxis,x=l.children,u=Le(x,Nt);return u?u.map(function(m,o){var i=m.props,p=i.direction,b=i.dataKey;return S.cloneElement(m,{key:"".concat(p,"-").concat(b,"-").concat(a[o]),data:a,xAxis:h,yAxis:g,layout:p==="x"?"vertical":"horizontal",dataPointFormatter:function(v,w){return{x:v.cx,y:v.cy,value:p==="x"?+v.node.x:+v.node.y,errorVal:re(v,w)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,l=r.points,a=r.line,h=r.lineType,g=r.lineJointType,x=pe(this.props,!1),u=pe(a,!1),m,o;if(h==="joint")m=l.map(function(f){return{x:f.cx,y:f.cy}});else if(h==="fitting"){var i=wt(l),p=i.xmin,b=i.xmax,j=i.a,v=i.b,w=function(A){return j*A+v};m=[{x:p,y:w(p)},{x:b,y:w(b)}]}var c=T(T(T({},x),{},{fill:"none",stroke:x&&x.fill},u),{},{points:m});return S.isValidElement(a)?o=S.cloneElement(a,c):$t(a)?o=a(c):o=S.createElement(At,Y({},c,{type:g})),S.createElement(V,{className:"recharts-scatter-line",key:"recharts-scatter-line"},o)}},{key:"render",value:function(){var r=this.props,l=r.hide,a=r.points,h=r.line,g=r.className,x=r.xAxis,u=r.yAxis,m=r.left,o=r.top,i=r.width,p=r.height,b=r.id,j=r.isAnimationActive;if(l||!a||!a.length)return null;var v=this.state.isAnimationFinished,w=nt("recharts-scatter",g),c=x&&x.allowDataOverflow,f=u&&u.allowDataOverflow,A=c||f,P=R(b)?this.id:b;return S.createElement(V,{className:w,clipPath:A?"url(#clipPath-".concat(P,")"):null},c||f?S.createElement("defs",null,S.createElement("clipPath",{id:"clipPath-".concat(P)},S.createElement("rect",{x:c?m:m-i/2,y:f?o:o-p/2,width:c?i:i*2,height:f?p:p*2}))):null,h&&this.renderLine(),this.renderErrorBar(),S.createElement(V,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!j||v)&&Ot.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(r,l){return r.animationId!==l.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:l.curPoints}:r.points!==l.curPoints?{curPoints:r.points}:null}}])}(_.PureComponent);K(ue,"displayName","Scatter");K(ue,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!ft.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});K(ue,"getComposedData",function(t){var s=t.xAxis,n=t.yAxis,r=t.zAxis,l=t.item,a=t.displayedData,h=t.xAxisTicks,g=t.yAxisTicks,x=t.offset,u=l.props.tooltipType,m=Le(l.props.children,St),o=R(s.dataKey)?l.props.dataKey:s.dataKey,i=R(n.dataKey)?l.props.dataKey:n.dataKey,p=r&&r.dataKey,b=r?r.range:me.defaultProps.range,j=b&&b[0],v=s.scale.bandwidth?s.scale.bandwidth():0,w=n.scale.bandwidth?n.scale.bandwidth():0,c=a.map(function(f,A){var P=re(f,o),E=re(f,i),d=!R(p)&&re(f,p)||"-",y=[{name:R(s.dataKey)?l.props.name:s.name||s.dataKey,unit:s.unit||"",value:P,payload:f,dataKey:o,type:u},{name:R(n.dataKey)?l.props.name:n.name||n.dataKey,unit:n.unit||"",value:E,payload:f,dataKey:i,type:u}];d!=="-"&&y.push({name:r.name||r.dataKey,unit:r.unit||"",value:d,payload:f,dataKey:p,type:u});var O=Te({axis:s,ticks:h,bandSize:v,entry:f,index:A,dataKey:o}),z=Te({axis:n,ticks:g,bandSize:w,entry:f,index:A,dataKey:i}),B=d!=="-"?r.scale(d):j,N=Math.sqrt(Math.max(B,0)/Math.PI);return T(T({},f),{},{cx:O,cy:z,x:O-N,y:z-N,xAxis:s,yAxis:n,zAxis:r,width:2*N,height:2*N,size:B,node:{x:P,y:E,z:d},tooltipPayload:y,tooltipPosition:{x:O,y:z},payload:f},m&&m[A]&&m[A].props)});return T({points:c},x)});var ms=Pt({chartName:"ComposedChart",GraphicalChild:[We,Et,$e,ue],axisComponents:[{axisType:"xAxis",AxisComp:Ae},{axisType:"yAxis",AxisComp:le},{axisType:"zAxis",AxisComp:me}],formatAxisMap:kt});const us=()=>{const{data:t,isLoading:s,error:n}=M({queryKey:["dashboard","monthly-comparison"],queryFn:()=>it("GET","/api/dashboard/monthly-comparison"),refetchInterval:3e5});if(s)return e.jsxs(Q,{className:"col-span-1 md:col-span-2",children:[e.jsx(G,{children:e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"월별 발주 현황 비교"]})}),e.jsx(J,{children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"h-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})})]});if(n||!t)return e.jsxs(Q,{className:"col-span-1 md:col-span-2",children:[e.jsx(G,{children:e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"월별 발주 현황 비교"]})}),e.jsx(J,{children:e.jsx("div",{className:"text-center py-8 text-gray-500",children:"데이터를 불러오는 중 오류가 발생했습니다."})})]});const{currentMonth:r,lastMonth:l,changes:a,dailyData:h}=t,g=Array.from({length:31},(o,i)=>{const p=i+1,b=h.find(j=>j.day===p);return{day:`${p}일`,orderCount:b?.orderCount||0,totalAmount:b?.totalAmount||0}}).slice(0,new Date(r.year,new Date().getMonth()+1,0).getDate()),x=o=>o>0?e.jsx(ie,{className:"h-4 w-4 text-green-600"}):o<0?e.jsx(Dt,{className:"h-4 w-4 text-red-600"}):e.jsx(Kt,{className:"h-4 w-4 text-gray-600"}),u=o=>o>0?"text-green-600 bg-green-50 border-green-200":o<0?"text-red-600 bg-red-50 border-red-200":"text-gray-600 bg-gray-50 border-gray-200",m=o=>`${(o/1e6).toFixed(1)}백만원`;return e.jsxs(Q,{className:"col-span-1 md:col-span-2",children:[e.jsx(G,{children:e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"월별 발주 현황 비교"]})}),e.jsxs(J,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-blue-900",children:"발주서 수"})]}),e.jsxs(C,{variant:"outline",className:u(a.orderCount),children:[x(a.orderCount),Math.abs(a.orderCount),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-blue-600 font-medium",children:[l.name," ",l.year]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[l.orderCount,"건"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-blue-600 font-medium",children:[r.name," ",r.year]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[r.orderCount,"건"]})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-900",children:"발주 금액"})]}),e.jsxs(C,{variant:"outline",className:u(a.totalAmount),children:[x(a.totalAmount),Math.abs(a.totalAmount),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-green-600 font-medium",children:[l.name," ",l.year]}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:m(l.totalAmount)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-green-600 font-medium",children:[r.name," ",r.year]}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:m(r.totalAmount)})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-gray-600"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[r.name," 일별 발주 현황"]})]}),e.jsx("div",{className:"h-64",children:e.jsx(Ie,{width:"100%",height:"100%",children:e.jsxs(ms,{data:g,children:[e.jsx(Re,{strokeDasharray:"3 3"}),e.jsx(Ae,{dataKey:"day",fontSize:12,interval:"preserveStartEnd"}),e.jsx(le,{yAxisId:"count",orientation:"left",fontSize:12}),e.jsx(le,{yAxisId:"amount",orientation:"right",fontSize:12,tickFormatter:o=>`${Math.round(o/1e6)}M`}),e.jsx(qe,{formatter:(o,i)=>i==="orderCount"?[`${o}건`,"발주서 수"]:i==="totalAmount"?[`${m(Number(o))}`,"발주 금액"]:[o,i],labelStyle:{color:"#374151"}}),e.jsx($e,{yAxisId:"count",dataKey:"orderCount",fill:"#3B82F6",name:"orderCount",radius:[2,2,0,0]}),e.jsx(We,{yAxisId:"amount",type:"monotone",dataKey:"totalAmount",stroke:"#10B981",strokeWidth:2,name:"totalAmount",dot:{fill:"#10B981",strokeWidth:2,r:3}})]})})})]})]})]})};function Ks(){const{user:t,isLoading:s}=lt(),{toast:n}=ot(),[,r]=de();ct();const{theme:l}=De(),a=l==="dark",[h,g]=_.useState({sortBy:"createdAt",sortOrder:"desc"}),x=_.useCallback(d=>{g(y=>({sortBy:d,sortOrder:y.sortBy===d&&y.sortOrder==="desc"?"asc":"desc"}))},[]);_.useEffect(()=>{if(!s&&!t){n({title:"Unauthorized",description:"You are logged out. Redirecting to login...",variant:"destructive"}),setTimeout(()=>{r("/login")},500);return}},[t,s,n]);const{data:u,isLoading:m,error:o}=dt();_.useEffect(()=>{o&&console.error("Dashboard data fetch error:",o),u&&console.log("Dashboard data loaded:",u)},[u,o]);const i=u?.statistics||{},p=u?.recentOrders||[],b=_.useMemo(()=>p.length?[...p].sort((y,O)=>{const{sortBy:z,sortOrder:B}=h;let N,k;switch(z){case"orderNumber":N=y.orderNumber||"",k=O.orderNumber||"";break;case"vendorName":N=y.vendor?.name||y.vendorName||"",k=O.vendor?.name||O.vendorName||"";break;case"totalAmount":N=y.totalAmount||0,k=O.totalAmount||0;break;case"orderStatus":N=y.orderStatus||y.status||"",k=O.orderStatus||O.status||"";break;case"createdAt":default:N=new Date(y.createdAt||y.orderDate).getTime(),k=new Date(O.createdAt||O.orderDate).getTime();break}if(typeof N=="string"){const F=N.localeCompare(k);return B==="asc"?F:-F}else return B==="asc"?N-k:k-N}):[],[p,h]),j=u?.monthlyStats||[];u?.statusStats;const v=u?.orderStatusStats||[],w=u?.projectStats||[],c=u?.categoryStats||[];i.activeProjects;const{data:f,loading:A,refresh:P}=zt(i,async()=>(await(await fetch("/api/dashboard/unified")).json()).statistics||{},3e4,!!t);f.totalOrders||i.totalOrders,i.totalOrders,f.totalAmount||i.totalAmount,i.totalAmount,f.completedOrders||i.completedOrders,i.completedOrders;const E=m;return E?e.jsx(gt,{}):t?e.jsx("div",{className:`p-2 min-h-screen transition-colors ${a?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{children:e.jsx("h1",{className:`text-sm font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"대시보드"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:P,disabled:A,className:`text-xs flex items-center gap-1 px-1 py-0.5 rounded transition-colors ${a?"text-gray-400 hover:text-gray-300 hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Fe,{className:`h-3 w-3 ${A?"animate-spin":""}`}),A?"업데이트":"새로고침"]}),e.jsx("span",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:new Date().toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-1 mb-2",children:[e.jsx("div",{className:`rounded border p-2 hover:shadow-sm transition-all cursor-pointer ${a?"bg-blue-900/20 border-blue-700 hover:bg-blue-900/30":"bg-blue-50/30 border-blue-300 hover:bg-blue-50/50"}`,onClick:()=>r("/orders?status=completed"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a?"bg-green-900/30":"bg-green-100"}`,children:e.jsx(ge,{className:`h-3 w-3 ${a?"text-green-400":"text-green-600"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:i.completedOrders||0}),e.jsx("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"발주완료"})]})]})}),e.jsx("div",{className:`rounded border p-2 hover:shadow-sm transition-all cursor-pointer ${a?"bg-blue-900/20 border-blue-700 hover:bg-blue-900/30":"bg-blue-50/30 border-blue-300 hover:bg-blue-50/50"}`,onClick:()=>r("/orders?filter=urgent"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a?"bg-red-900/30":"bg-red-100"}`,children:e.jsx(xe,{className:`h-3 w-3 ${a?"text-red-400":"text-red-600"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:i.urgentOrders||0}),e.jsx("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"긴급발주"})]})]})}),e.jsx("div",{className:`rounded border p-2 transition-colors ${a?"bg-blue-900/20 border-blue-700":"bg-blue-50/30 border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a?"bg-blue-800/30":"bg-blue-100"}`,children:e.jsx(q,{className:`h-3 w-3 ${a?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:i.totalOrders||0}),e.jsx("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"총발주서"})]})]})}),e.jsx("div",{className:`rounded border p-2 transition-colors ${a?"bg-blue-900/20 border-blue-700":"bg-blue-50/30 border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a?"bg-emerald-900/30":"bg-emerald-100"}`,children:e.jsx(we,{className:`h-3 w-3 ${a?"text-emerald-400":"text-emerald-600"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-bold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:D(i.totalAmount||0).replace("₩","").replace(",000,000","M")}),e.jsx("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"총금액"})]})]})}),e.jsx("div",{className:`rounded border p-2 transition-colors ${a?"bg-blue-900/20 border-blue-700":"bg-blue-50/30 border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a?"bg-purple-900/30":"bg-purple-100"}`,children:e.jsx(te,{className:`h-3 w-3 ${a?"text-purple-400":"text-purple-600"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:i.activeProjects||0}),e.jsx("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"활성현장"})]})]})}),e.jsx("div",{className:`rounded border p-2 transition-colors ${a?"bg-blue-900/20 border-blue-700":"bg-blue-50/30 border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a?"bg-indigo-900/30":"bg-indigo-100"}`,children:e.jsx(Be,{className:`h-3 w-3 ${a?"text-indigo-400":"text-indigo-600"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:i.activeVendors||0}),e.jsx("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"활성거래처"})]})]})})]}),e.jsx("div",{className:"mb-2",children:e.jsx(us,{})}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"space-y-1",children:[!E&&j&&Array.isArray(j)&&j.length>0?(()=>{const d=j.map(y=>({month:y.month.replace("-","/"),orders:Number(y.count)||0}));return e.jsxs("div",{className:`rounded border p-2 transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-blue-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(ie,{className:`h-3 w-3 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),e.jsx("h3",{className:`text-xs font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"월별 발주 통계"})]}),e.jsx("div",{className:"h-[140px] w-full",children:e.jsx(Ie,{width:"100%",height:"100%",children:e.jsxs(Tt,{data:d,margin:{top:5,right:5,left:5,bottom:5},children:[e.jsx(Re,{strokeDasharray:"2 2",stroke:"#f3f4f6"}),e.jsx(Ae,{dataKey:"month",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(le,{fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(qe,{formatter:y=>[`${y}건`,"발주 건수"]}),e.jsx($e,{dataKey:"orders",fill:"#3b82f6",radius:[2,2,0,0]})]})})})]})})():e.jsxs("div",{className:`rounded border p-2 transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-blue-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(ie,{className:`h-3 w-3 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),e.jsx("h3",{className:`text-xs font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"월별 발주 통계"})]}),e.jsx("div",{className:`h-[140px] flex items-center justify-center transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{className:`h-6 w-6 mx-auto mb-1 transition-colors ${a?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})]}),e.jsxs("div",{className:`rounded border p-2 transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-blue-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(ge,{className:`h-3 w-3 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),e.jsx("h3",{className:`text-xs font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"발주상태분포"})]}),E?e.jsx("div",{className:`h-[140px] flex items-center justify-center transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{className:`h-6 w-6 mx-auto mb-1 transition-colors ${a?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})}):e.jsx("div",{className:"h-[140px] w-full",children:e.jsx(_t,{data:[{name:"임시저장",value:v.find(d=>d.status==="draft")?.count||0,status:"draft"},{name:"발주생성",value:v.find(d=>d.status==="created")?.count||0,status:"created"},{name:"발주완료",value:v.find(d=>d.status==="sent")?.count||0,status:"sent"},{name:"납품완료",value:v.find(d=>d.status==="delivered")?.count||0,status:"delivered"}],dataKey:"value",nameKey:"name",height:140,showExport:!1,showLabels:!1,showLegend:!1,innerRadius:20,outerRadius:45,colors:["#6b7280","#f59e0b","#3b82f6","#10b981"],formatValue:d=>`${d}건`})})]})]}),e.jsxs("div",{className:`rounded border p-2 transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:`h-3 w-3 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),e.jsx("h3",{className:`text-xs font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"현장별 발주 현황"})]}),e.jsx("span",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"상위 10개"})]}),e.jsx("div",{className:"h-[260px] overflow-y-auto",children:!E&&w&&Array.isArray(w)&&w.length>0?e.jsx("div",{className:"space-y-1",children:w.slice(0,10).map((d,y)=>e.jsxs("div",{className:`flex items-center justify-between p-1.5 rounded cursor-pointer transition-colors ${a?"hover:bg-gray-700":"hover:bg-gray-50"}`,onClick:()=>r(`/projects/${d.id}`),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs font-medium w-4 text-center transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:y+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:`text-xs font-medium truncate transition-colors ${a?"text-gray-100":"text-gray-900"}`,title:d.projectName,children:d.projectName}),e.jsxs("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:[d.orderCount,"건"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:`text-xs font-semibold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:D(d.totalAmount||0).replace("₩","").replace(",000,000","M")})})]},y))}):e.jsx("div",{className:`h-[240px] flex items-center justify-center transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(te,{className:`h-6 w-6 mx-auto mb-1 transition-colors ${a?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})})]}),e.jsxs("div",{className:"space-y-1",children:[t&&["admin","executive","hq_management","project_manager"].includes(t.role)&&e.jsx(Mt,{className:"mb-1",showDetails:!1}),e.jsxs("div",{className:`rounded border p-2 transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:`h-3 w-3 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),e.jsx("h3",{className:`text-xs font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"최근 발주서"})]}),e.jsx("button",{onClick:()=>r("/orders"),className:`text-xs font-medium transition-colors ${a?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,children:"전체보기"})]}),e.jsx("div",{className:"h-[140px] overflow-y-auto",children:e.jsx(Vt,{mode:"compact-table",maxItems:6,orders:b,onOrderClick:d=>r(`/orders/${d}`),sortBy:h.sortBy,sortOrder:h.sortOrder,onSort:x,showActions:!1})})]}),e.jsxs("div",{className:`rounded border p-2 transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:`h-3 w-3 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),e.jsx("h3",{className:`text-xs font-semibold transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:"품목 분류"})]}),e.jsx("button",{onClick:()=>r("/category-management"),className:`text-xs font-medium transition-colors ${a?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,children:"관리"})]}),e.jsx("div",{className:"h-[120px] overflow-y-auto",children:!E&&c&&Array.isArray(c)&&c.length>0?e.jsx("div",{className:"space-y-1",children:c.slice(0,6).sort((d,y)=>y.totalAmount-d.totalAmount).map((d,y)=>e.jsxs("div",{className:`flex items-center justify-between p-1 rounded cursor-pointer transition-colors ${a?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`text-xs font-medium transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:d.majorCategory}),d.middleCategory!=="미분류"&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:`h-2 w-2 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`text-xs truncate transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:d.middleCategory})]})]}),e.jsxs("div",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:[d.orderCount,"건"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:`text-xs font-semibold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:D(d.totalAmount).replace("₩","").replace(",000,000","M")})})]},y))}):e.jsx("div",{className:`h-[100px] flex items-center justify-center transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:`h-6 w-6 mx-auto mb-1 transition-colors ${a?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})})]})]})]})]})}):null}export{Ks as default};
