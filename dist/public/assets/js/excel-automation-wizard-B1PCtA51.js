import{g as ee,r as c,j as e,s as V,G as C,H as T,N as U,aq as D,t as F,F as k,B as m,n as j}from"./index-B5aSphH7.js";import{u as se}from"./index-DYMRwy0X.js";import{S as te}from"./separator-CO_8toA1.js";import{A as H,a as q}from"./alert-BXC6_2B1.js";import{P as re}from"./progress-DFwZp-ML.js";import{V as ae}from"./vendor-validation-modal-DGZBarXw.js";import{C as v}from"./circle-x-DLDhUBHX.js";import{M as ie}from"./mail-CXeqvvVG.js";import{D as G}from"./download-Bfbpieyb.js";import{S as le}from"./send-BCW318Af.js";import{C as I}from"./circle-check-h6eZTtM7.js";import{T as ne}from"./triangle-alert-BdQI4N1N.js";import{T as oe}from"./trash-2-BNLUUISF.js";import"./index-Bb2Q5Qo1.js";import"./dialog-DEeopRYd.js";import"./index-DIhXHIGT.js";function Se(){const{theme:K}=ee(),t=K==="dark",[$,g]=c.useState(0),[p,P]=c.useState([{id:"upload",title:"íŒŒì¼ ì—…ë¡œë“œ ë° íŒŒì‹±",description:"Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  Input ì‹œíŠ¸ë¥¼ íŒŒì‹±í•©ë‹ˆë‹¤",status:"pending"},{id:"save",title:"ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥",description:"ë°œì£¼ì„œ ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤",status:"pending"},{id:"validate",title:"ê±°ë˜ì²˜ ê²€ì¦",description:"ê±°ë˜ì²˜ëª…ì„ ê²€ì¦í•˜ê³  ì´ë©”ì¼ ì£¼ì†Œë¥¼ í™•ì¸í•©ë‹ˆë‹¤",status:"pending"},{id:"preview",title:"ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸°",description:"ë°œì†¡í•  ì´ë©”ì¼ ë‚´ìš©ê³¼ ìˆ˜ì‹ ìë¥¼ í™•ì¸í•©ë‹ˆë‹¤",status:"pending"}]),[a,E]=c.useState(null),[x,u]=c.useState(!1),[y,n]=c.useState(null),[A,S]=c.useState(!1),[ce,M]=c.useState([]),[o,O]=c.useState(null),L=c.useCallback(async s=>{const r=s[0];if(r){u(!0),n(null),g(0),P(i=>i.map(l=>({...l,status:"pending"})));try{h("upload","processing");const i=new FormData;i.append("file",r),console.log("ğŸ“¤ [í´ë¼ì´ì–¸íŠ¸] íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘:",{fileName:r.name,fileSize:r.size,fileType:r.type});const l=new AbortController,Z=setTimeout(()=>l.abort(),58e3),d=await fetch("/api/excel-automation/upload-and-process",{method:"POST",body:i,credentials:"include",signal:l.signal});if(clearTimeout(Z),console.log("ğŸ“¥ [í´ë¼ì´ì–¸íŠ¸] ì„œë²„ ì‘ë‹µ ìˆ˜ì‹ :",{status:d.status,ok:d.ok}),d.status===401){n("ì¸ì¦ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");return}if(!d.ok){const R=await d.text();let b=`ì„œë²„ ì˜¤ë¥˜ (${d.status})`;try{const J=JSON.parse(R);b=J.error||J.message||b}catch{b=R||b}throw new Error(b)}const w=await d.json();if(!w.success)throw new Error(w.error||"íŒŒì¼ ì²˜ë¦¬ ì‹¤íŒ¨");h("upload","completed"),h("save","completed"),h("validate","completed"),h("preview","completed"),E(w.data),w.data.vendorValidation.needsUserAction?S(!0):g(1)}catch(i){console.error("ğŸ“‹ [í´ë¼ì´ì–¸íŠ¸] ìë™í™” ì²˜ë¦¬ ì˜¤ë¥˜:",i);let l="ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤";i instanceof Error&&(l=i.message,i.message.includes("Failed to fetch")?l="ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.":i.message.includes("timeout")||i.name==="AbortError"?l="ìš”ì²­ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. íŒŒì¼ í¬ê¸°ë¥¼ ì¤„ì´ê±°ë‚˜ ë‚˜ëˆ„ì–´ì„œ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.":i.message.includes("500")?l="ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.":i.message.includes("413")?l="íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤ (ìµœëŒ€ 10MB). ë” ì‘ì€ íŒŒì¼ë¡œ ì‹œë„í•´ì£¼ì„¸ìš”.":i.message.includes("422")&&(l="íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. Excel íŒŒì¼(.xlsx, .xlsm, .xls)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")),console.error("ğŸ“‹ [í´ë¼ì´ì–¸íŠ¸] ìµœì¢… ì—ëŸ¬ ë©”ì‹œì§€:",l),n(l),h("upload","error")}finally{u(!1)}}},[]),{getRootProps:W,getInputProps:X,isDragActive:f,isDragReject:N,rejectedFiles:de}=se({onDrop:L,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel.sheet.macroEnabled.12":[".xlsm"],"application/vnd.ms-excel":[".xls"]},maxFiles:1,maxSize:10485760,disabled:x,onDropRejected:s=>{const r=s[0];r&&(r.file.size>10485760?n("íŒŒì¼ í¬ê¸°ê°€ 10MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤. ë” ì‘ì€ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”."):n("ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. .xlsx, .xlsm, .xls íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤."))}}),h=(s,r)=>{P(i=>i.map(l=>l.id===s?{...l,status:r}:l))},_=async s=>{if(a?.filePath){M(s),S(!1),u(!0);try{const r=await fetch("/api/excel-automation/update-email-preview",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({filePath:a.filePath,selectedVendors:s})});if(r.status===401){n("ì¸ì¦ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");return}if(!r.ok){const l=await r.text();throw new Error(`ì„œë²„ ì˜¤ë¥˜ (${r.status}): ${l||r.statusText}`)}const i=await r.json();if(i.success)E(l=>l?{...l,emailPreview:i.data.emailPreview}:null),g(1);else throw new Error(i.error)}catch(r){n(r instanceof Error?r.message:"ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨")}finally{u(!1)}}},Q=async()=>{if(a?.emailPreview){u(!0),n(null);try{const s=await fetch("/api/excel-automation/send-emails",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({processedFilePath:`uploads/${a.emailPreview.attachmentInfo.processedFile}`,recipients:a.emailPreview.recipients,emailOptions:{subject:a.emailPreview.subject,orderNumber:`AUTO-${Date.now()}`,additionalMessage:"ìë™í™” ì‹œìŠ¤í…œì„ í†µí•´ ë°œì†¡ëœ ë°œì£¼ì„œì…ë‹ˆë‹¤."}})});if(s.status===401){n("ì¸ì¦ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");return}if(!s.ok){const i=await s.text();throw new Error(`ì„œë²„ ì˜¤ë¥˜ (${s.status}): ${i||s.statusText}`)}const r=await s.json();if(r.success)O(r.data),g(2);else throw new Error(r.error)}catch(s){n(s instanceof Error?s.message:"ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨")}finally{u(!1)}}},z=()=>{g(0),E(null),n(null),M([]),O(null),P(s=>s.map(r=>({...r,status:"pending"})))},B=s=>s>1024*1024?`${(s/(1024*1024)).toFixed(1)}MB`:`${(s/1024).toFixed(1)}KB`,Y=s=>{switch(s){case"completed":return e.jsx(I,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(v,{className:"h-5 w-5 text-red-500"});case"processing":return e.jsx("div",{className:`h-5 w-5 border-2 border-t-transparent rounded-full animate-spin transition-colors ${t?"border-blue-400":"border-blue-500"}`});default:return e.jsx("div",{className:`h-5 w-5 border-2 rounded-full transition-colors ${t?"border-gray-600":"border-gray-300"}`})}};if($===0&&!a)return e.jsx("div",{className:"space-y-6",children:e.jsxs(V,{className:`transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs(C,{children:[e.jsxs(T,{className:`flex items-center gap-2 transition-colors ${t?"text-white":"text-gray-900"}`,children:[e.jsx(U,{className:"h-5 w-5"}),"Excel ë°œì£¼ì„œ ìë™í™” ì²˜ë¦¬"]}),e.jsx(D,{className:`transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ë°œì£¼ì„œ ë°ì´í„° ì €ì¥ë¶€í„° ì´ë©”ì¼ ë°œì†¡ê¹Œì§€ ìë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤"})]}),e.jsxs(F,{children:[e.jsxs("div",{...W(),className:`relative border-2 border-dashed rounded-lg p-8 text-center transition-all duration-300 ${N?t?"border-red-400 bg-red-900/30 scale-105":"border-red-500 bg-red-50 scale-105":f?t?"border-blue-400 bg-blue-900/30 scale-105 shadow-lg":"border-blue-500 bg-blue-50 scale-105 shadow-lg":t?"border-gray-600 hover:border-gray-500 hover:bg-gray-800/20":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"} ${x?"opacity-50 cursor-not-allowed":"cursor-pointer hover:shadow-md"}`,children:[e.jsx("input",{...X()}),e.jsx("div",{className:`transition-all duration-300 ${f?"animate-bounce":N?"animate-pulse":""}`,children:N?e.jsx(v,{className:`h-16 w-16 mx-auto mb-4 transition-colors ${t?"text-red-400":"text-red-600"}`}):f?e.jsx(U,{className:`h-16 w-16 mx-auto mb-4 transition-colors ${t?"text-blue-400":"text-blue-600"}`}):e.jsx(k,{className:`h-12 w-12 mx-auto mb-4 transition-colors ${t?"text-gray-500":"text-gray-400"} group-hover:text-blue-500`})}),N?e.jsxs("div",{children:[e.jsx("p",{className:`text-lg font-semibold mb-2 transition-colors ${t?"text-red-400":"text-red-600"}`,children:"ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ì…ë‹ˆë‹¤! âŒ"}),e.jsx("p",{className:`text-sm transition-colors ${t?"text-red-300":"text-red-500"}`,children:".xlsx, .xlsm, .xls íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤"})]}):f?e.jsxs("div",{children:[e.jsx("p",{className:`text-lg font-semibold mb-2 transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:"íŒŒì¼ì„ ì—¬ê¸°ì— ë†“ìœ¼ì„¸ìš”! ğŸ“"}),e.jsx("p",{className:`text-sm transition-colors ${t?"text-blue-300":"text-blue-500"}`,children:"Excel íŒŒì¼ì´ ìë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤"})]}):e.jsxs("div",{children:[e.jsx("p",{className:`text-lg mb-2 font-medium transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:"ğŸ“„ Excel íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"}),e.jsx("p",{className:`text-sm mb-2 transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:".xlsx, .xlsm, .xls íŒŒì¼ ì§€ì› (ìµœëŒ€ 10MB)"}),e.jsx("div",{className:"mt-4",children:e.jsx(m,{variant:"outline",size:"sm",disabled:x,className:`transition-colors ${t?"border-gray-600 hover:border-blue-400 hover:text-blue-400":"border-gray-300 hover:border-blue-500 hover:text-blue-600"}`,onClick:s=>s.preventDefault(),children:"íŒŒì¼ ì„ íƒí•˜ê¸°"})})]}),f&&e.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-br from-blue-500/10 to-purple-500/10 animate-pulse"})]}),x&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:`flex items-center justify-between text-sm transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{children:"ì²˜ë¦¬ ì§„í–‰ ìƒí™©"}),e.jsxs("span",{children:[p.filter(s=>s.status==="completed").length," / ",p.length]})]}),e.jsx(re,{value:p.filter(s=>s.status==="completed").length/p.length*100}),e.jsx("div",{className:"space-y-2",children:p.map(s=>e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded transition-colors ${t?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[Y(s.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:s.title}),e.jsx("div",{className:`text-sm transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:s.description})]})]},s.id))})]}),y&&e.jsxs(H,{className:"mt-4",variant:"destructive",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(q,{children:y})]})]})]})});if(A&&a){const s={vendorValidations:a.vendorValidation.invalidVendors.map(r=>({vendorName:r.vendorName,exists:!1,suggestions:r.suggestions?.map(i=>({...i,contactPerson:i.contactPerson||"",distance:i.distance||0}))||[]})),deliveryValidations:[],emailConflicts:[],summary:{totalVendors:a.vendorValidation.validVendors.length+a.vendorValidation.invalidVendors.length,totalDeliveries:0,unregisteredVendors:a.vendorValidation.invalidVendors.length,unregisteredDeliveries:0,emailConflicts:0,needsAction:a.vendorValidation.needsUserAction}};return e.jsx(ae,{isOpen:A,onClose:()=>S(!1),validationData:s,onConfirm:r=>{const i=r.filter(l=>l.action==="use_existing"&&l.existingVendorId).map(l=>({originalName:l.originalName,selectedVendorId:l.existingVendorId,selectedVendorEmail:""}));_(i)}})}return $===1&&a?e.jsx("div",{className:"space-y-6",children:e.jsxs(V,{className:`transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs(C,{children:[e.jsxs(T,{className:`flex items-center gap-2 transition-colors ${t?"text-white":"text-gray-900"}`,children:[e.jsx(ie,{className:"h-5 w-5"}),"ì´ë©”ì¼ ë°œì†¡ ë¯¸ë¦¬ë³´ê¸°"]}),e.jsx(D,{className:`transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"ë°œì†¡í•  ì´ë©”ì¼ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ì „ì†¡í•˜ì„¸ìš”"})]}),e.jsxs(F,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:`text-center p-4 rounded-lg transition-colors ${t?"bg-green-900/20":"bg-green-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${t?"text-green-400":"text-green-600"}`,children:a.savedOrders}),e.jsx("div",{className:`text-sm transition-colors ${t?"text-green-400":"text-green-600"}`,children:"ì €ì¥ëœ ë°œì£¼ì„œ"})]}),e.jsxs("div",{className:`text-center p-4 rounded-lg transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:a.vendorValidation.validVendors.length}),e.jsx("div",{className:`text-sm transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:"í™•ì¸ëœ ê±°ë˜ì²˜"})]}),e.jsxs("div",{className:`text-center p-4 rounded-lg transition-colors ${t?"bg-purple-900/20":"bg-purple-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${t?"text-purple-400":"text-purple-600"}`,children:a.emailPreview.recipients.length}),e.jsx("div",{className:`text-sm transition-colors ${t?"text-purple-400":"text-purple-600"}`,children:"ì´ë©”ì¼ ìˆ˜ì‹ ì"})]})]}),e.jsx(te,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"ìˆ˜ì‹ ì"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:a.emailPreview.recipients.map((s,r)=>e.jsx(j,{variant:"secondary",children:s},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"ì œëª©"}),e.jsx("div",{className:`mt-1 p-2 rounded border transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"}`,children:a.emailPreview.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsxs("div",{className:`p-2 rounded border flex items-center gap-2 transition-colors ${t?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx(k,{className:`h-4 w-4 transition-colors ${t?"text-blue-400":"text-blue-500"}`}),e.jsx("span",{className:`flex-1 transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:a.emailPreview.attachmentInfo.processedFile}),e.jsx(j,{variant:"outline",children:B(a.emailPreview.attachmentInfo.fileSize)})]}),a.emailPreview.attachmentInfo.processedPdfFile&&e.jsxs("div",{className:`p-2 rounded border flex items-center gap-2 transition-colors ${t?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx(k,{className:`h-4 w-4 transition-colors ${t?"text-red-400":"text-red-500"}`}),e.jsx("span",{className:`flex-1 transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:a.emailPreview.attachmentInfo.processedPdfFile}),e.jsx(j,{variant:"outline",children:B(a.emailPreview.attachmentInfo.pdfFileSize||0)})]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(m,{variant:"outline",onClick:z,children:"ì²˜ìŒë¶€í„° ë‹¤ì‹œ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>{const s=document.createElement("a");s.href=`/api/excel-automation/download/${a.emailPreview.attachmentInfo.processedFile}`,s.click()},children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Excel ë‹¤ìš´ë¡œë“œ"]}),a.emailPreview.attachmentInfo.processedPdfFile&&e.jsxs(m,{variant:"outline",onClick:()=>{const s=document.createElement("a");s.href=`/api/excel-automation/download/${a.emailPreview.attachmentInfo.processedPdfFile}`,s.click()},children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"PDF ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(m,{onClick:Q,disabled:!a.emailPreview.canProceed||x,children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),x?"ë°œì†¡ ì¤‘...":"ì´ë©”ì¼ ë°œì†¡"]})]})]}),y&&e.jsxs(H,{variant:"destructive",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(q,{children:y})]})]})]})}):$===2&&o?e.jsx("div",{className:"space-y-6",children:e.jsxs(V,{className:`transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs(C,{children:[e.jsxs(T,{className:`flex items-center gap-2 transition-colors ${t?"text-white":"text-gray-900"}`,children:[o.success?e.jsx(I,{className:"h-5 w-5 text-green-500"}):e.jsx(ne,{className:"h-5 w-5 text-yellow-500"}),"ì´ë©”ì¼ ë°œì†¡ ê²°ê³¼"]}),e.jsx(D,{className:`transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:o.success?`ëª¨ë“  ì´ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤ (${o.sentEmails}ê°œ)`:`ì¼ë¶€ ì´ë©”ì¼ ë°œì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤ (ì„±ê³µ: ${o.sentEmails}ê°œ, ì‹¤íŒ¨: ${o.failedEmails.length}ê°œ)`})]}),e.jsxs(F,{className:"space-y-6",children:[e.jsx("div",{className:"space-y-2",children:o.emailResults.map((s,r)=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded border transition-colors ${s.status==="sent"?t?"bg-green-900/20 border-green-700":"bg-green-50 border-green-200":t?"bg-red-900/20 border-red-700":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="sent"?e.jsx(I,{className:"h-4 w-4 text-green-500"}):e.jsx(v,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:s.email})]}),e.jsx("div",{className:"text-sm",children:s.status==="sent"?e.jsx(j,{variant:"secondary",children:"ë°œì†¡ ì™„ë£Œ"}):e.jsx(j,{variant:"destructive",children:"ì‹¤íŒ¨"})})]},r))}),o.failedEmails.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${t?"text-red-400":"text-red-600"}`,children:"ë°œì†¡ ì‹¤íŒ¨ ìƒì„¸"}),e.jsx("div",{className:"space-y-2",children:o.failedEmails.map((s,r)=>e.jsxs("div",{className:`p-2 rounded border transition-colors ${t?"bg-red-900/20 border-red-700":"bg-red-50 border-red-200"}`,children:[e.jsx("div",{className:`font-medium transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:s.email}),e.jsx("div",{className:`text-sm transition-colors ${t?"text-red-400":"text-red-600"}`,children:s.error})]},r))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(m,{variant:"outline",onClick:z,children:"ìƒˆ íŒŒì¼ ì²˜ë¦¬"}),e.jsxs(m,{variant:"outline",onClick:()=>{fetch("/api/excel-automation/cleanup",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({filePaths:[a?.filePath,`uploads/${a?.emailPreview.attachmentInfo.processedFile}`,a?.emailPreview.attachmentInfo.processedPdfFile?`uploads/${a.emailPreview.attachmentInfo.processedPdfFile}`:null].filter(Boolean)})})},children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"ì„ì‹œ íŒŒì¼ ì •ë¦¬"]})]})]})]})}):null}export{Se as ExcelAutomationWizard};
