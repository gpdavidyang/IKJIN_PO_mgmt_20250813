import{aX as l,e as Re,h as Ge,r as g,q as $,aQ as Ye,aY as We,s as ye,j as e,w as _,L as q,N as E,x as O,O as k,S as V,z as L,A as M,D as z,G as I,y as j,B as v,P as Xe,f as W,aO as Ze,T as pe,F as et,K as X,k as ue}from"./index-DXwZMnAa-1757332288518.js";import{T as tt}from"./textarea-fpYpSC5x-1757332288518.js";import{T as rt,a as st,b as Z,c as u,d as at,e as m}from"./table-DOuJjKqf-1757332288518.js";import{i as xe}from"./authUtils-CcDzk6i0-1757332288518.js";import{U as ot}from"./upload-Cukqy9kY-1757332288518.js";const it=l.object({itemId:l.number().optional(),itemName:l.string().min(1,"í’ˆëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"),specification:l.string().optional(),majorCategory:l.string().optional(),middleCategory:l.string().optional(),minorCategory:l.string().optional(),quantity:l.number().positive("ìˆ˜ëŸ‰ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤"),unitPrice:l.number().positive("ë‹¨ê°€ëŠ” 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤"),notes:l.string().optional()}),nt=l.object({templateId:l.number().optional(),projectId:l.number().min(1,"í˜„ì¥ì„ ì„ íƒí•˜ì„¸ìš”"),vendorId:l.number().min(1,"ê±°ë˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"),orderDate:l.string().min(1,"ë°œì£¼ì¼ìë¥¼ ì„ íƒí•˜ì„¸ìš”"),deliveryDate:l.string().optional(),notes:l.string().optional(),items:l.array(it).min(1,"ìµœì†Œ í•˜ë‚˜ì˜ í’ˆëª©ì„ ì¶”ê°€í•˜ì„¸ìš”"),customFields:l.record(l.any()).optional()});function ht({orderId:b,onSuccess:ee,onCancel:he,preselectedTemplateId:lt}){const{toast:c}=Re(),{theme:je}=Ge(),a=je==="dark",[U,ct]=g.useState(null),[be,fe]=g.useState([]),[Ne,te]=g.useState(!0),[ve,re]=g.useState(null),[se,we]=g.useState(!1);g.useEffect(()=>{(async()=>{try{te(!0),console.log("Loading templates...");const r=await fetch("/api/admin/templates",{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(console.log("Template response status:",r.status),!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.json();console.log("Templates loaded:",s),fe(s),re(null)}catch(r){console.error("Error loading templates:",r),re(r)}finally{te(!1)}})()},[]);const{data:Ce}=$({queryKey:["/api/admin/templates",U],enabled:!!U,retry:1}),w=Ce,{data:$e,isLoading:dt,error:mt}=$({queryKey:["/api/items"],select:t=>t.items||[],retry:1}),{data:B,isLoading:Ie,error:De}=$({queryKey:["/api/categories"],queryFn:async()=>{console.log("ğŸ” Fetching categories from /api/categories");const t=await fetch("/api/categories",{credentials:"include"});if(console.log("ğŸ” Categories response status:",t.status),!t.ok)throw new Error("Failed to fetch categories");const r=await t.json();return console.log("ğŸ” Categories response data:",r),r},retry:1});B?.categories;const H=B?.flatCategories||[],T=H.filter(t=>t.categoryType==="major"),A=H.filter(t=>t.categoryType==="middle"),ae=H.filter(t=>t.categoryType==="minor"),{data:oe,isLoading:Te}=$({queryKey:["/api/projects"],retry:1});console.log("Items data:",$e),console.log("Templates data:",be),console.log("Templates loading:",Ne),console.log("Templates error:",ve),console.log("API endpoint test for templates"),console.log("ğŸ” Categories debug:",{isLoadingCategories:Ie,categoriesError:De,categoriesResponse:B,majorCategoriesCount:T?.length,middleCategoriesCount:A?.length,minorCategoriesCount:ae?.length});const[d,S]=g.useState([{itemId:0,itemName:"",specification:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unitPrice:0,notes:""}]),[x,P]=g.useState([""]),[F,ie]=g.useState([]),[D,Q]=g.useState(!1),[y,Se]=g.useState(null),[p,Pe]=g.useState(null),ne=t=>t===0||isNaN(t)?"":W(t),le=t=>{const r=t.replace(/[â‚©,\s]/g,""),s=parseFloat(r);return isNaN(s)?0:s},{register:J,handleSubmit:Fe,watch:_e,setValue:C,reset:qe,formState:{errors:f}}=Ye({resolver:We(nt),defaultValues:{templateId:void 0,projectId:0,vendorId:0,orderDate:new Date().toISOString().split("T")[0],deliveryDate:"",notes:"",items:d,customFields:{}}}),{data:ce}=$({queryKey:["/api/vendors"]});$({queryKey:["/api/projects"]});const{data:K,isLoading:R}=$({queryKey:["/api/orders",b],enabled:!!b}),G=ye({mutationFn:async t=>{const r=`order_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;c({title:"ğŸ“ ë°œì£¼ì„œ ìƒì„± ì‹œì‘",description:"ë°œì£¼ì„œë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."});const s=new EventSource(`/api/orders/progress/${r}`);s.onmessage=n=>{try{const h=JSON.parse(n.data);h.step==="validation"?c({title:"âœ… ë°ì´í„° ê²€ì¦ ì™„ë£Œ",description:h.message}):h.step==="saving"?c({title:"ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì¤‘",description:h.message}):h.step==="pdf"?c({title:"ğŸ“„ PDF ìƒì„± ì¤‘",description:h.message}):h.step==="complete"&&(c({title:"âœ… ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ",description:h.message}),s.close())}catch(h){console.error("SSE ë©”ì‹œì§€ íŒŒì‹± ì˜¤ë¥˜:",h)}},s.onerror=n=>{console.error("SSE ì—°ê²° ì˜¤ë¥˜:",n),s.close()};const o=new FormData;o.append("sessionId",r),o.append("method","manual"),o.append("projectId",t.projectId.toString()),o.append("vendorId",t.vendorId.toString()),o.append("orderDate",t.orderDate),t.deliveryDate&&o.append("deliveryDate",t.deliveryDate),t.notes&&o.append("notes",t.notes),t.customFields&&o.append("customFields",JSON.stringify(t.customFields)),o.append("items",JSON.stringify(d.map(n=>({...n,itemId:Number(n.itemId),quantity:Number(n.quantity),unitPrice:Number(n.unitPrice),totalAmount:(n.quantity||0)*(n.unitPrice||0)})))),F.forEach(n=>{o.append("attachments",n)});const i=await fetch("/api/orders/create-unified",{method:"POST",body:o,credentials:"include"});if(!i.ok){const n=await i.text();throw new Error(n||"Order creation failed")}return i.json()},onSuccess:t=>{X.invalidateQueries({queryKey:["/api/orders"]}),c({title:"âœ… ëª¨ë“  ì‘ì—… ì™„ë£Œ",description:`ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ë°œì£¼ë²ˆí˜¸: ${t.orderNumber||t.orderId}${t.attachmentId?`
PDF íŒŒì¼ì´ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.`:""}`}),ee?.()},onError:t=>{if(xe(t)){c({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}c({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Y=ye({mutationFn:async t=>{const{items:r,...s}=t;if(await ue("PUT",`/api/orders/${b}`,{...s,items:r.map(o=>({...o,totalAmount:(o.quantity||0)*(o.unitPrice||0)}))}),F.length>0){const o=new FormData;F.forEach(i=>{o.append("files",i)}),await ue("POST",`/api/orders/${b}/attachments`,o)}},onSuccess:()=>{X.invalidateQueries({queryKey:["/api/orders"]}),X.invalidateQueries({queryKey:["/api/orders",b]}),c({title:"ì„±ê³µ",description:"ë°œì£¼ì„œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),ee?.()},onError:t=>{if(xe(t)){c({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}c({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});g.useEffect(()=>{if(K&&!R&&typeof K=="object"&&!se){const t=K,r=(t.items||[]).map(s=>({itemId:s.itemId||0,itemName:s.itemName,specification:s.specification||"",majorCategory:s.majorCategory||"",middleCategory:s.middleCategory||"",minorCategory:s.minorCategory||"",quantity:s.quantity,unitPrice:s.unitPrice,notes:s.notes||""}));qe({vendorId:t.vendorId,orderDate:new Date(t.orderDate).toISOString().split("T")[0],deliveryDate:t.deliveryDate?new Date(t.deliveryDate).toISOString().split("T")[0]:"",notes:t.notes||"",items:r}),S(r),we(!0)}},[K,R,se]);const Ee=()=>{const t=d.length>0?d[d.length-1]:null,r=x.length>0?x[x.length-1]:"",s=t?{itemId:t.itemId,itemName:t.itemName,specification:t.specification,majorCategory:t.majorCategory,middleCategory:t.middleCategory,minorCategory:t.minorCategory,quantity:t.quantity,unitPrice:t.unitPrice,notes:t.notes}:{itemId:0,itemName:"",specification:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unitPrice:0,notes:""},o=[...d,s];S(o),C("items",o),P([...x,r])},Oe=t=>{const r=d[t],s=x[t]||"",o={itemId:r.itemId,itemName:r.itemName,specification:r.specification,majorCategory:r.majorCategory,middleCategory:r.middleCategory,minorCategory:r.minorCategory,quantity:r.quantity,unitPrice:r.unitPrice,notes:r.notes},i=[...d,o];S(i),C("items",i),P([...x,s])},ke=t=>{if(d.length===1)return;const r=d.filter((o,i)=>i!==t),s=x.filter((o,i)=>i!==t);S(r),C("items",r),P(s)},N=(t,r,s)=>{const o=[...d];o[t]={...o[t],[r]:s},r==="majorCategory"?(o[t].middleCategory="",o[t].minorCategory=""):r==="middleCategory"&&(o[t].minorCategory=""),S(o),C("items",o)},Ve=t=>{if(console.log("ğŸ” getMiddleCategoriesForMajor called with:",t),console.log("ğŸ” Major categories available:",T?.length),console.log("ğŸ” Middle categories available:",A?.length),!t)return console.log("âŒ No major category name provided"),[];const r=T.find(o=>o.categoryName===t);if(console.log("ğŸ” Found major category:",r),!r)return console.log("âŒ Major category not found"),console.log("Available major categories:",T?.map(o=>o.categoryName)),[];const s=A.filter(o=>o.parentId===r.id);return console.log("ğŸ” Filtered middle categories:",s),s},Le=t=>{if(!t)return[];const r=A.find(s=>s.categoryName===t);return r?ae.filter(s=>s.parentId===r.id):[]},de=t=>(t.quantity||0)*(t.unitPrice||0),Me=()=>d.reduce((t,r)=>t+de(r),0),me=t=>{const r=t.filter(s=>s.size>52428800?(c({title:"íŒŒì¼ í¬ê¸° ì˜¤ë¥˜",description:`${s.name}ì€(ëŠ”) íŒŒì¼ í¬ê¸°ê°€ 50MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤.`,variant:"destructive"}),!1):!0);r.length>0&&(ie(s=>[...s,...r]),c({title:"íŒŒì¼ ì—…ë¡œë“œ",description:`${r.length}ê°œì˜ íŒŒì¼ì´ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.`}))},ze=t=>{const r=Array.from(t.target.files||[]);me(r),t.target&&(t.target.value="")},Ae=t=>{t.preventDefault(),t.stopPropagation(),Q(!0)},Ke=t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget.contains(t.relatedTarget)||Q(!1)},Ue=t=>{t.preventDefault(),t.stopPropagation()},Be=t=>{t.preventDefault(),t.stopPropagation(),Q(!1);const r=Array.from(t.dataTransfer.files);r.length>0&&me(r)},He=t=>{ie(r=>r.filter((s,o)=>o!==t))},Qe=()=>{if(!w?.fieldsConfig)return null;try{const t=typeof w.fieldsConfig=="string"?JSON.parse(w.fieldsConfig):w.fieldsConfig,r=[];if(w.templateType==="material_extrusion")t.basic_fields&&r.push({key:"basic_fields",name:"ê¸°ë³¸ ì •ë³´",fields:t.basic_fields}),t.extrusion_list&&r.push({key:"extrusion_list",name:"ì••ì¶œ ëª©ë¡",fields:t.extrusion_list}),t.schedule_fields&&r.push({key:"schedule_fields",name:"ì¼ì • ì •ë³´",fields:t.schedule_fields}),t.specification_fields&&r.push({key:"specification_fields",name:"ì‚¬ì–‘ ì •ë³´",fields:t.specification_fields});else if(w.templateType==="panel_manufacturing")t.basic_fields&&r.push({key:"basic_fields",name:"ê¸°ë³¸ ì •ë³´",fields:t.basic_fields}),t.color_breakdown&&r.push({key:"color_breakdown",name:"ìƒ‰ìƒ ë¶„ë¥˜",fields:t.color_breakdown}),t.material_fields&&r.push({key:"material_fields",name:"ì¬ë£Œ ì •ë³´",fields:t.material_fields}),t.panel_breakdown&&r.push({key:"panel_breakdown",name:"íŒë„¬ ë¶„ë¥˜",fields:t.panel_breakdown}),t.delivery_schedule&&r.push({key:"delivery_schedule",name:"ë°°ì†¡ ì¼ì •",fields:t.delivery_schedule}),t.insulation_details&&r.push({key:"insulation_details",name:"ë‹¨ì—´ì¬ ìƒì„¸",fields:t.insulation_details});else if(t.fields&&Array.isArray(t.fields)){const s=t.fields.reduce((o,i)=>{const n=i.sectionName||"ê¸°ë³¸ ì •ë³´";return o[n]||(o[n]=[]),o[n].push(i),o},{});Object.entries(s).forEach(([o,i])=>{r.push({key:o,name:o,fields:i})})}return r.length===0?null:r.map(s=>e.jsxs(_,{className:`mb-4 transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(q,{className:"pb-2",children:e.jsx(E,{className:`text-lg transition-colors ${a?"text-white":"text-gray-900"}`,children:s.name})}),e.jsx(O,{className:"pt-2",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:Array.isArray(s.fields)?s.fields.map(o=>ge(o)):Object.entries(s.fields).map(([o,i])=>ge({fieldName:o,label:i,fieldType:o.includes("date")?"date":o.includes("amount")||o.includes("price")||o.includes("quantity")||o.includes("count")||o.includes("weight")||o.includes("kg")||o.includes("area")||o==="quantity"?"number":"text"}))})})]},s.key))}catch(t){return console.error("Error rendering dynamic template fields:",t),null}},ge=t=>{const r=t.fieldName||t.id,s=t.label,o=t.fieldType||"text";return e.jsxs("div",{children:[e.jsx(k,{htmlFor:r,className:`transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:s}),e.jsx(j,{id:r,type:o,placeholder:`${s}ì„ ì…ë ¥í•˜ì„¸ìš”`,className:`transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,onChange:i=>{const n=_e("customFields")||{};C("customFields",{...n,[r]:i.target.value})}})]},r)},Je=t=>{const r=Number(t.vendorId);if(!r||r===0){c({title:"ì˜¤ë¥˜",description:"ê±°ë˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}const s=Number(t.projectId);if(!s||s===0){c({title:"ì˜¤ë¥˜",description:"í˜„ì¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}if(d.length===0){c({title:"ì˜¤ë¥˜",description:"ìµœì†Œ í•˜ë‚˜ì˜ í’ˆëª©ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.",variant:"destructive"});return}const o={...t,vendorId:r,projectId:s,orderDate:t.orderDate,deliveryDate:t.deliveryDate||void 0,items:d};b?Y.mutate(o):G.mutate(o)};return R&&b?e.jsx("div",{className:"p-6",children:"Loading..."}):e.jsx("div",{className:`max-w-[1366px] mx-auto compact-form space-y-3 pb-20 transition-colors ${a?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("form",{onSubmit:Fe(Je),className:"space-y-3",children:[e.jsxs(_,{className:`transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(q,{className:"pb-2",children:e.jsx(E,{className:`text-lg transition-colors ${a?"text-white":"text-gray-900"}`,children:"ê¸°ë³¸ ì •ë³´"})}),e.jsxs(O,{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"projectId",className:`transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"í˜„ì¥ *"}),e.jsxs(V,{onValueChange:t=>{const r=parseInt(t);C("projectId",r);const s=oe?.find(o=>o.id===r);s&&Se(s)},children:[e.jsx(L,{className:`transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"í˜„ì¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(z,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:Te?e.jsx(I,{value:"loading",disabled:!0,children:"ë¡œë”© ì¤‘..."}):oe?.map(t=>e.jsxs(I,{value:t.id.toString(),children:[t.projectName," (",t.projectCode,")"]},t.id))||e.jsx(I,{value:"no-projects",disabled:!0,children:"í˜„ì¥ì´ ì—†ìŠµë‹ˆë‹¤"})})]}),f.projectId&&e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-red-400":"text-red-500"}`,children:f.projectId.message})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"vendorId",className:`transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ê±°ë˜ì²˜ *"}),e.jsxs(V,{onValueChange:t=>{const r=parseInt(t);C("vendorId",r);const s=ce?.find(o=>o.id===r);s&&Pe(s)},children:[e.jsx(L,{className:`transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"ê±°ë˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(z,{className:`z-[100] dropdown-high-priority transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,style:{position:"fixed",zIndex:9999},children:ce?.map(t=>e.jsx(I,{value:t.id.toString(),children:t.name},t.id))})]}),f.vendorId&&e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-red-400":"text-red-500"}`,children:f.vendorId.message})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"orderDate",className:`transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ë°œì£¼ì„œ ì‘ì„±ì¼ *"}),e.jsx(j,{id:"orderDate",type:"date",className:`transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,...J("orderDate")}),f.orderDate&&e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-red-400":"text-red-500"}`,children:f.orderDate.message})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"deliveryDate",className:`transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ë‚©í’ˆ í¬ë§ì¼"}),e.jsx(j,{id:"deliveryDate",type:"date",className:`transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,...J("deliveryDate")})]})]}),(y||p)&&e.jsx("div",{className:`mt-4 pt-4 border-t transition-colors ${a?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y&&e.jsxs("div",{className:`p-3 rounded-lg transition-colors ${a?"bg-blue-900/20 border border-blue-800":"bg-blue-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${a?"text-blue-300":"text-blue-900"}`,children:"í˜„ì¥ ì •ë³´"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"í˜„ì¥ëª…:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:y.projectName})]}),y.location&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì£¼ì†Œ:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:y.location})]}),y.projectManager&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"í˜„ì¥ ê´€ë¦¬ì:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:y.projectManager})]}),y.managerPhone&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì „í™”ë²ˆí˜¸:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:y.managerPhone})]}),y.managerEmail&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì´ë©”ì¼:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:y.managerEmail})]})]})]}),p&&e.jsxs("div",{className:`p-3 rounded-lg transition-colors ${a?"bg-green-900/20 border border-green-800":"bg-green-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${a?"text-green-300":"text-green-900"}`,children:"ê±°ë˜ì²˜ ì •ë³´"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ê±°ë˜ì²˜ëª…:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:p.name})]}),p.contactPerson&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ë‹´ë‹¹ì:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:p.contactPerson})]}),p.phone&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì—°ë½ì²˜:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:p.phone})]}),p.email&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì´ë©”ì¼:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:p.email})]}),p.address&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì£¼ì†Œ:"}),e.jsx("span",{className:`ml-2 transition-colors ${a?"text-gray-200":"text-gray-900"}`,children:p.address})]})]})]})]})})]})]}),w&&Qe(),e.jsxs(_,{className:`transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(q,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:`text-lg transition-colors ${a?"text-white":"text-gray-900"}`,children:"ë°œì£¼ í’ˆëª©"}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:Ee,children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"í’ˆëª© ì¶”ê°€"]})]})}),e.jsxs(O,{className:"pt-2",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(rt,{children:[e.jsx(st,{children:e.jsxs(Z,{children:[e.jsx(u,{className:"py-2",children:"í’ˆëª©ëª…"}),e.jsx(u,{className:"py-2",children:"ê·œê²©"}),e.jsx(u,{className:"py-2",children:"ëŒ€ë¶„ë¥˜"}),e.jsx(u,{className:"py-2",children:"ì¤‘ë¶„ë¥˜"}),e.jsx(u,{className:"py-2",children:"ì†Œë¶„ë¥˜"}),e.jsx(u,{className:"py-2",children:"ìˆ˜ëŸ‰"}),e.jsx(u,{className:"py-2",children:"ë‹¨ê°€"}),e.jsx(u,{className:"py-2",children:"ê¸ˆì•¡"}),e.jsx(u,{className:"py-2",children:"ë¹„ê³ "}),e.jsx(u,{className:"py-2 text-center",children:"ë³µì‚¬"}),e.jsx(u,{className:"py-2 text-center",children:"ì‚­ì œ"})]})}),e.jsx(at,{children:d.map((t,r)=>e.jsxs(Z,{children:[e.jsx(m,{className:"py-1",children:e.jsx("div",{className:"min-w-[180px]",children:e.jsx(j,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,placeholder:"í’ˆëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”",value:t.itemName,onChange:s=>N(r,"itemName",s.target.value)})})}),e.jsx(m,{className:"py-1",children:e.jsx(j,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,placeholder:"ê·œê²©",value:t.specification,onChange:s=>N(r,"specification",s.target.value)})}),e.jsx(m,{className:"py-1",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsxs(V,{value:t.majorCategory,onValueChange:s=>N(r,"majorCategory",s),children:[e.jsx(L,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"ëŒ€ë¶„ë¥˜ ì„ íƒ"})}),e.jsx(z,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:T?.map(s=>e.jsx(I,{value:s.categoryName,children:s.categoryName},s.id))})]})})}),e.jsx(m,{className:"py-1",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsxs(V,{value:t.middleCategory,onValueChange:s=>N(r,"middleCategory",s),disabled:!t.majorCategory,children:[e.jsx(L,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"ì¤‘ë¶„ë¥˜ ì„ íƒ"})}),e.jsx(z,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:Ve(t.majorCategory)?.map(s=>e.jsx(I,{value:s.categoryName,children:s.categoryName},s.id))})]})})}),e.jsx(m,{className:"py-1",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsxs(V,{value:t.minorCategory,onValueChange:s=>N(r,"minorCategory",s),disabled:!t.middleCategory,children:[e.jsx(L,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"ì†Œë¶„ë¥˜ ì„ íƒ"})}),e.jsx(z,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:Le(t.middleCategory)?.map(s=>e.jsx(I,{value:s.categoryName,children:s.categoryName},s.id))})]})})}),e.jsx(m,{className:"py-1",children:e.jsx(j,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,type:"number",placeholder:"ìˆ˜ëŸ‰",value:t.quantity||"",onChange:s=>N(r,"quantity",parseFloat(s.target.value)||0)})}),e.jsx(m,{className:"py-1",children:e.jsx(j,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,type:"text",placeholder:"â‚©0",value:x[r]||ne(t.unitPrice),onChange:s=>{const o=[...x];o[r]=s.target.value,P(o);const i=le(s.target.value);N(r,"unitPrice",i)},onBlur:s=>{const o=le(s.target.value),i=ne(o),n=[...x];n[r]=i,P(n)}})}),e.jsx(m,{className:"py-1",children:e.jsx(j,{className:`h-8 transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,readOnly:!0,value:W(de(t))})}),e.jsx(m,{className:"py-1",children:e.jsx(j,{className:`h-8 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,placeholder:"ë¹„ê³ ",value:t.notes,onChange:s=>N(r,"notes",s.target.value)})}),e.jsx(m,{className:"py-1 text-center",children:e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>Oe(r),className:"h-6 w-6 p-0",children:e.jsx(Ze,{className:"h-3 w-3 text-blue-500"})})}),e.jsx(m,{className:"py-1 text-center",children:e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>ke(r),disabled:d.length===1,className:"h-6 w-6 p-0",children:e.jsx(pe,{className:"h-3 w-3 text-red-500"})})})]},r))}),e.jsx("tfoot",{className:`transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs(Z,{children:[e.jsx(m,{colSpan:7,className:`py-2 text-right font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì´ ê¸ˆì•¡:"}),e.jsx(m,{className:`py-2 font-bold text-lg transition-colors ${a?"text-white":"text-gray-900"}`,children:W(Me())}),e.jsx(m,{colSpan:3,className:"py-2"})]})})]})}),f.items&&e.jsx("p",{className:`text-sm mt-2 transition-colors ${a?"text-red-400":"text-red-500"}`,children:f.items.message})]})]}),e.jsxs(_,{className:`transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(q,{className:"pb-2",children:e.jsx(E,{className:`text-lg transition-colors ${a?"text-white":"text-gray-900"}`,children:"íŒŒì¼ ì²¨ë¶€"})}),e.jsxs(O,{className:"pt-2",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 cursor-pointer ${D?a?"border-blue-400 bg-blue-900/20 scale-[1.02]":"border-blue-500 bg-blue-50 scale-[1.02]":a?"border-gray-600 hover:border-blue-400/50 hover:bg-gray-700/50":"border-gray-300 hover:border-blue-400/50 hover:bg-gray-50"}`,onDragEnter:Ae,onDragLeave:Ke,onDragOver:Ue,onDrop:Be,onClick:()=>document.getElementById("fileUpload")?.click(),children:[e.jsx(ot,{className:`mx-auto h-8 w-8 mb-3 transition-all duration-200 ${D?a?"text-blue-400 scale-110":"text-blue-500 scale-110":a?"text-gray-500":"text-gray-400"}`}),e.jsx("p",{className:`text-base mb-2 font-medium transition-colors ${D?a?"text-blue-400":"text-blue-600":a?"text-gray-300":"text-gray-700"}`,children:D?"íŒŒì¼ì„ ë†“ì•„ì£¼ì„¸ìš”":"íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"}),e.jsx("p",{className:`text-sm mb-4 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ëª¨ë“  íŒŒì¼ í˜•ì‹ ì§€ì› (ìµœëŒ€ 10MB)"}),e.jsx("input",{type:"file",multiple:!0,accept:"*",onChange:ze,className:"hidden",id:"fileUpload"}),e.jsx(v,{type:"button",variant:D?"default":"outline",size:"sm",className:`transition-all duration-200 ${D?"scale-105":""}`,onClick:t=>{t.stopPropagation(),document.getElementById("fileUpload")?.click()},children:"íŒŒì¼ ì„ íƒ"})]}),F.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("h4",{className:`text-sm font-medium transition-colors ${a?"text-white":"text-gray-900"}`,children:"ì²¨ë¶€ëœ íŒŒì¼"}),F.map((t,r)=>e.jsxs("div",{className:`flex items-center justify-between p-1 rounded text-xs transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(et,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:t.name}),e.jsxs("span",{className:`transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:["(",(t.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",className:"h-4 w-4 p-0",onClick:()=>He(r),children:e.jsx(pe,{className:"h-3 w-3 text-red-500"})})]},r))]})]})]}),e.jsxs(_,{className:`transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(q,{className:"pb-2",children:e.jsx(E,{className:`text-lg transition-colors ${a?"text-white":"text-gray-900"}`,children:"íŠ¹ì´ì‚¬í•­"})}),e.jsx(O,{className:"pt-2",children:e.jsx(tt,{...J("notes"),placeholder:"ë°œì£¼ ê´€ë ¨ íŠ¹ì´ì‚¬í•­ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”",rows:3,className:`text-sm transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})})]}),e.jsx("div",{className:"sticky bottom-0 z-10 mt-6",children:e.jsx("div",{className:`p-4 border-t shadow-lg transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto flex flex-col sm:flex-row justify-end gap-3",children:[e.jsx(v,{type:"button",variant:"outline",className:"w-full sm:w-auto px-6 py-3 text-base font-medium",onClick:he,children:"ì·¨ì†Œ"}),e.jsx(v,{type:"button",variant:"secondary",className:"w-full sm:w-auto px-6 py-3 text-base font-medium",onClick:()=>{c({title:"ì„ì‹œ ì €ì¥",description:"ì„ì‹œ ì €ì¥ ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤."})},children:"ì„ì‹œ ì €ì¥"}),e.jsx(v,{type:"submit",className:"w-full sm:w-auto px-6 py-3 text-base font-medium",disabled:G.isPending||Y.isPending,children:G.isPending||Y.isPending?"ì €ì¥ ì¤‘...":b?"ìˆ˜ì •":"ë°œì£¼ì„œ ìƒì„±"})]})})})]})},`general-${U}`)}export{ht as OrderForm};
