import{d as R,h as F,r as n,j as e,w as B,ab as M,ac as O,b5 as P,x as H,a0 as G,a1 as z,a2 as S,a3 as E,ah as o,S as b,z as p,A as N,D as v,G as i,B as k,H as D,be as I,y as q,b as T,a8 as L,a9 as V,u as J}from"./index-BiVyPGWZ-1757248621245.js";import{P as K}from"./page-header-DnzDLV0h-1757248621245.js";import{D as Q}from"./download-BlU-HFFy-1757248621245.js";import{U as W}from"./upload-C9wkCLGt-1757248621245.js";function X(){R();const{theme:d}=F(),s=d==="dark",[a,h]=n.useState("vendors"),[r,U]=n.useState("excel"),[x,y]=n.useState(null),[f,w]=n.useState(!1),[c,$]=n.useState(null),[C,j]=n.useState(null),g={vendors:"거래처",projects:"현장",purchase_orders:"발주서"},_=async()=>{try{const t=await fetch(`/api/export/${a}?format=${r}`,{method:"GET",credentials:"include"});if(!t.ok)throw new Error("Export failed");const l=await t.blob(),u=window.URL.createObjectURL(l),m=document.createElement("a");m.href=u,m.download=`${a}_${new Date().toISOString().split("T")[0]}.${r==="csv"?"csv":"xlsx"}`,document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(u),document.body.removeChild(m)}catch(t){j("내보내기 중 오류가 발생했습니다."),console.error("Export error:",t)}},A=async()=>{if(!x){j("파일을 선택해 주세요.");return}w(!0),j(null),$(null);const t=new FormData;t.append("file",x);try{const l=await fetch(`/api/import/${a}`,{method:"POST",credentials:"include",body:t});if(!l.ok)throw new Error("Import failed");const u=await l.json();$(u),y(null)}catch(l){j("가져오기 중 오류가 발생했습니다."),console.error("Import error:",l)}finally{w(!1)}};return e.jsxs(B,{className:`w-full max-w-4xl mx-auto shadow-sm transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs(M,{children:[e.jsx(O,{className:`transition-colors ${s?"text-white":"text-gray-900"}`,children:"데이터 가져오기/내보내기"}),e.jsx(P,{className:`transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"엑셀 또는 CSV 파일을 사용하여 데이터를 일괄로 가져오거나 내보낼 수 있습니다."})]}),e.jsxs(H,{children:[e.jsxs(G,{defaultValue:"export",className:"w-full",children:[e.jsxs(z,{className:`grid w-full grid-cols-2 transition-colors ${s?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx(S,{value:"export",className:`transition-colors ${s?"data-[state=active]:bg-gray-600 data-[state=active]:text-white":"data-[state=active]:bg-white data-[state=active]:text-gray-900"}`,children:"내보내기"}),e.jsx(S,{value:"import",className:`transition-colors ${s?"data-[state=active]:bg-gray-600 data-[state=active]:text-white":"data-[state=active]:bg-white data-[state=active]:text-gray-900"}`,children:"가져오기"})]}),e.jsxs(E,{value:"export",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"데이터 유형"}),e.jsxs(b,{value:a,onValueChange:t=>h(t),children:[e.jsx(p,{children:e.jsx(N,{})}),e.jsxs(v,{children:[e.jsx(i,{value:"vendors",children:"거래처"}),e.jsx(i,{value:"projects",children:"현장"}),e.jsx(i,{value:"purchase_orders",children:"발주서"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"파일 형식"}),e.jsxs(b,{value:r,onValueChange:t=>U(t),children:[e.jsx(p,{children:e.jsx(N,{})}),e.jsxs(v,{children:[e.jsx(i,{value:"excel",children:"Excel (.xlsx)"}),e.jsx(i,{value:"csv",children:"CSV (.csv)"})]})]})]})]}),e.jsxs(k,{onClick:_,className:"w-full",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),g[a]," 데이터 내보내기"]})]}),e.jsxs(E,{value:"import",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white text-sm font-medium rounded-full flex items-center justify-center",children:"1"}),e.jsx(o,{className:`text-base font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"데이터 유형 선택"})]}),e.jsxs(b,{value:a,onValueChange:t=>h(t),children:[e.jsx(p,{className:"max-w-sm",children:e.jsx(N,{placeholder:"가져올 데이터 유형을 선택하세요"})}),e.jsxs(v,{children:[e.jsx(i,{value:"vendors",children:"거래처"}),e.jsx(i,{value:"projects",children:"현장"}),e.jsx(i,{value:"purchase_orders",children:"발주서"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white text-sm font-medium rounded-full flex items-center justify-center",children:"2"}),e.jsx(o,{className:`text-base font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"템플릿 확인 및 데이터 준비"})]}),e.jsx("div",{className:`border rounded-lg p-4 transition-colors ${s?"bg-amber-900/20 border-amber-800":"bg-amber-50 border-amber-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:`h-5 w-5 flex-shrink-0 mt-0.5 transition-colors ${s?"text-amber-400":"text-amber-600"}`}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:`text-sm font-medium transition-colors ${s?"text-amber-200":"text-amber-800"}`,children:[g[a]," 데이터를 가져오기 전에 올바른 형식을 확인하세요"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("a",{href:`/templates/${a}_template.xlsx`,download:!0,className:`inline-flex items-center gap-1 text-xs px-2 py-1 rounded transition-colors ${s?"bg-amber-800/20 hover:bg-amber-700/30 text-amber-300":"bg-amber-100 hover:bg-amber-200 text-amber-800"}`,children:[e.jsx(I,{className:"h-3 w-3"}),"Excel 템플릿"]}),e.jsxs("a",{href:`/templates/${a}_template.csv`,download:!0,className:`inline-flex items-center gap-1 text-xs px-2 py-1 rounded transition-colors ${s?"bg-amber-800/20 hover:bg-amber-700/30 text-amber-300":"bg-amber-100 hover:bg-amber-200 text-amber-800"}`,children:[e.jsx(I,{className:"h-3 w-3"}),"CSV 템플릿"]})]})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white text-sm font-medium rounded-full flex items-center justify-center",children:"3"}),e.jsx(o,{className:`text-base font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"파일 업로드"})]}),e.jsxs("div",{className:"max-w-md",children:[e.jsx(q,{type:"file",accept:".xlsx,.xls,.csv",onChange:t=>y(t.target.files?.[0]||null),className:"cursor-pointer"}),x&&e.jsxs("p",{className:`text-sm mt-2 flex items-center gap-1 transition-colors ${s?"text-green-400":"text-green-600"}`,children:[e.jsx(T,{className:"h-4 w-4"}),"선택된 파일: ",x.name]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white text-sm font-medium rounded-full flex items-center justify-center",children:"4"}),e.jsx(o,{className:`text-base font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"데이터 가져오기"})]}),e.jsxs(k,{onClick:A,disabled:!x||f,className:"bg-green-600 hover:bg-green-700 text-white px-8",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),f?"가져오는 중...":`${g[a]} 데이터 가져오기`]})]}),c&&e.jsxs(L,{className:`transition-colors ${c.errors.length>0?s?"border-yellow-600 bg-yellow-900/20":"border-yellow-500":s?"border-green-600 bg-green-900/20":"border-green-500"}`,children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx(V,{className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:["전체 ",c.totalRows,"개 중 ",c.imported,"개 가져오기 완료"]}),c.errors.length>0&&e.jsxs("details",{children:[e.jsxs("summary",{className:`cursor-pointer text-sm transition-colors ${s?"text-gray-400":"text-muted-foreground"}`,children:[c.errors.length,"개 오류 (클릭하여 자세히 보기)"]}),e.jsx("div",{className:"mt-2 space-y-1 text-sm",children:c.errors.map((t,l)=>e.jsxs("div",{className:`transition-colors ${s?"text-red-400":"text-red-600"}`,children:["행 ",t.row,": ",t.error]},l))})]})]})})]})]})]}),C&&e.jsxs(L,{variant:"destructive",className:`mt-4 transition-colors ${s?"bg-red-900/20 border-red-800":"border-red-500"}`,children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(V,{className:`transition-colors ${s?"text-red-200":"text-red-700"}`,children:C})]})]})]})}function re(){const{user:d,loading:s}=R(),[,a]=J(),{theme:h}=F(),r=h==="dark";return n.useEffect(()=>{!s&&!d&&a("/login")},[d,s,a]),s?e.jsx("div",{children:"Loading..."}):d?e.jsx("div",{className:`min-h-screen transition-colors ${r?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx(K,{title:"데이터 가져오기/내보내기",description:"엑셀 및 CSV 파일을 사용하여 데이터를 일괄 처리합니다."}),e.jsx(X,{}),e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:`rounded-lg shadow-sm border p-6 transition-colors ${r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${r?"text-white":"text-gray-900"}`,children:"💡 사용팁"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`rounded-lg p-4 transition-colors ${r?"bg-blue-900/20 border border-blue-800":"bg-blue-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${r?"text-blue-300":"text-blue-900"}`,children:"📥 데이터 가져오기"}),e.jsxs("ul",{className:`text-sm space-y-1 transition-colors ${r?"text-blue-200":"text-blue-800"}`,children:[e.jsx("li",{children:"• 1단계: 데이터 유형(거래처/현장/발주서) 선택"}),e.jsx("li",{children:"• 2단계: 템플릿을 다운로드하여 형식 확인"}),e.jsx("li",{children:"• 3단계: 템플릿에 맞춰 데이터를 입력한 파일 업로드"}),e.jsx("li",{children:"• 4단계: '데이터 가져오기' 버튼 클릭"}),e.jsx("li",{children:"• 필수 항목은 반드시 입력해야 합니다"}),e.jsx("li",{children:"• 사업자번호는 하이픈(-) 없이 숫자만 입력"})]})]}),e.jsxs("div",{className:`rounded-lg p-4 transition-colors ${r?"bg-green-900/20 border border-green-800":"bg-green-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${r?"text-green-300":"text-green-900"}`,children:"📤 데이터 내보내기"}),e.jsxs("ul",{className:`text-sm space-y-1 transition-colors ${r?"text-green-200":"text-green-800"}`,children:[e.jsx("li",{children:"• Excel 형식은 서식이 유지됩니다"}),e.jsx("li",{children:"• CSV 형식은 데이터만 추출됩니다"}),e.jsx("li",{children:"• 파일명에 날짜가 자동으로 포함됩니다"}),e.jsx("li",{children:"• 현재 등록된 모든 데이터가 포함됩니다"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`rounded-lg p-4 transition-colors ${r?"bg-amber-900/20 border border-amber-800":"bg-amber-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${r?"text-amber-300":"text-amber-900"}`,children:"⚠️ 주의사항"}),e.jsxs("ul",{className:`text-sm space-y-1 transition-colors ${r?"text-amber-200":"text-amber-800"}`,children:[e.jsx("li",{children:"• 중복된 사업자번호는 업데이트됩니다"}),e.jsx("li",{children:"• 잘못된 형식의 데이터는 건너뛰어집니다"}),e.jsx("li",{children:"• 가져오기 전에 기존 데이터 백업 권장"}),e.jsx("li",{children:"• 파일 크기는 10MB 이하로 제한"})]})]}),e.jsxs("div",{className:`rounded-lg p-4 transition-colors ${r?"bg-purple-900/20 border border-purple-800":"bg-purple-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${r?"text-purple-300":"text-purple-900"}`,children:"🚀 효율적인 사용법"}),e.jsxs("ul",{className:`text-sm space-y-1 transition-colors ${r?"text-purple-200":"text-purple-800"}`,children:[e.jsx("li",{children:"• 정기적으로 데이터를 백업하세요"}),e.jsx("li",{children:"• 템플릿에 맞춰 데이터를 미리 정리"}),e.jsx("li",{children:"• 오류 발생 시 상세 로그를 확인하세요"}),e.jsx("li",{children:"• 관리자에게 문의하여 권한을 확인하세요"})]})]})]})]})})]})})]})}):null}export{re as default};
