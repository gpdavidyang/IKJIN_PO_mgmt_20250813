import{r as b,j as e,E as W,m as H,B as o,F as B,an as q,ao as I,b as _,z as G,at as J,J as D}from"./index-5AzehvID.js";import{a as Z,b as V,c as Q,D as T,f as X}from"./dialog-Bg9PSh1a.js";import{T as Y,a as ee,b as O,c as L}from"./tabs-ahwECebr.js";import{h as se,E as te}from"./html2canvas.esm-4x7zRhus.js";import{P as $}from"./printer-D8DJFk1A.js";import{D as S}from"./download-BuPvymCt.js";import{R as U}from"./refresh-cw-CRXhSHPr.js";class R{static async generateFromElement(d,a={}){try{const{filename:l="document.pdf",orientation:r="portrait",format:i="a4",quality:c=.95,scale:f=2}=a;console.log("ğŸ“„ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì‹œì‘...");const y=await se(d,{scale:f,useCORS:!0,logging:!1,letterRendering:!0,allowTaint:!0,backgroundColor:"#ffffff"}),k=y.toDataURL("image/png",c),m=new te({orientation:r,unit:"mm",format:i}),P=m.internal.pageSize.getWidth(),C=m.internal.pageSize.getHeight(),j=P,g=y.height*j/y.width;let p=g,v=0;for(m.addImage(k,"PNG",0,v,j,g),p-=C;p>0;)v=p-g,m.addPage(),m.addImage(k,"PNG",0,v,j,g),p-=C;const N=m.output("blob");return console.log("âœ… PDF ìƒì„± ì™„ë£Œ"),{success:!0,blob:N}}catch(l){return console.error("âŒ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì˜¤ë¥˜:",l),{success:!1,error:l instanceof Error?l.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static downloadPdf(d,a="document.pdf"){const l=window.URL.createObjectURL(d),r=document.createElement("a");r.href=l,r.download=a,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(l)}static previewPdf(d){const a=window.URL.createObjectURL(d);window.open(a,"_blank"),setTimeout(()=>{window.URL.revokeObjectURL(a)},1e4)}static async generateFromHtml(d,a={}){try{const l=document.createElement("div");l.style.position="absolute",l.style.left="-9999px",l.style.width="210mm",l.innerHTML=d,document.body.appendChild(l);const r=await this.generateFromElement(l,a);return document.body.removeChild(l),r}catch(l){return console.error("âŒ HTML PDF ë³€í™˜ ì˜¤ë¥˜:",l),{success:!1,error:l instanceof Error?l.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static async generateOrderPdf(d,a={}){try{const l=`
        <div style="font-family: 'Malgun Gothic', sans-serif; padding: 20px;">
          <h1 style="text-align: center; color: #2563eb;">êµ¬ë§¤ ë°œì£¼ì„œ</h1>
          <div style="margin: 20px 0;">
            <h2>ë°œì£¼ ì •ë³´</h2>
            <table style="width: 100%; border-collapse: collapse;">
              <tr>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">ë°œì£¼ ë²ˆí˜¸</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.orderNumber||""}</td>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">ë°œì£¼ ì¼ì</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.orderDate||""}</td>
              </tr>
              <tr>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">í”„ë¡œì íŠ¸</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.projectName||""}</td>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">ê±°ë˜ì²˜</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.vendorName||""}</td>
              </tr>
            </table>
          </div>
          ${d.items?`
            <div style="margin: 20px 0;">
              <h2>ë°œì£¼ í’ˆëª©</h2>
              <table style="width: 100%; border-collapse: collapse;">
                <thead>
                  <tr style="background: #f3f4f6;">
                    <th style="border: 1px solid #ddd; padding: 8px;">í’ˆëª©ëª…</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ê·œê²©</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ìˆ˜ëŸ‰</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ë‹¨ê°€</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">ê¸ˆì•¡</th>
                  </tr>
                </thead>
                <tbody>
                  ${d.items.map(r=>`
                    <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">${r.name||""}</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">${r.specification||""}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${r.quantity||0}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${r.unitPrice?.toLocaleString()||0}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${r.totalPrice?.toLocaleString()||0}</td>
                    </tr>
                  `).join("")}
                </tbody>
                <tfoot>
                  <tr style="background: #eff6ff;">
                    <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">ì´ ê¸ˆì•¡</td>
                    <td style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">
                      ${d.totalAmount?.toLocaleString()||0} ì›
                    </td>
                  </tr>
                </tfoot>
              </table>
            </div>
          `:""}
        </div>
      `;return await this.generateFromHtml(l,{...a,filename:`PO_${d.orderNumber||"draft"}.pdf`})}catch(l){return console.error("âŒ ë°œì£¼ì„œ PDF ìƒì„± ì˜¤ë¥˜:",l),{success:!1,error:l instanceof Error?l.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}}const xe=({orderData:s,isOpen:d,onClose:a,trigger:l,onDownload:r})=>{const[i,c]=b.useState({status:"idle"}),[f,y]=b.useState(100),[k,m]=b.useState(1),[P,C]=b.useState(1),[j,g]=b.useState(!1);b.useRef(null);const p=async()=>{c({status:"generating",progress:0});try{if(console.log("ğŸ“„ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì‹œì‘..."),!s||Object.keys(s).length===0)throw new Error("ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");c({status:"generating",progress:30});const t=await R.generateOrderPdf(s,{filename:`PO_${s.orderNumber||"draft"}.pdf`,orientation:"portrait",format:"a4"});if(c({status:"generating",progress:70}),!t.success||!t.blob)throw new Error(t.error||"PDF ìƒì„± ì‹¤íŒ¨");const n=window.URL.createObjectURL(t.blob);c({status:"generating",progress:100}),await new Promise(x=>setTimeout(x,200)),c({status:"ready",url:n,blob:t.blob}),console.log("âœ… í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì™„ë£Œ")}catch(t){console.error("âŒ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì˜¤ë¥˜:",t),c({status:"error",error:t instanceof Error?t.message:"PDF ìƒì„± ì‹¤íŒ¨"})}},v=async()=>{c({status:"generating",progress:0});try{if(console.log("PDF ìƒì„± ì‹œì‘ - orderData:",s),!s||Object.keys(s).length===0)throw new Error("ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë°œì£¼ì„œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");const t=[{message:"ë°œì£¼ì„œ ë°ì´í„° ì¤€ë¹„ ì¤‘...",progress:15},{message:"PDF í…œí”Œë¦¿ ë¡œë”© ì¤‘...",progress:30},{message:"HTML ì½˜í…ì¸  ìƒì„± ì¤‘...",progress:50},{message:"PDF ë³€í™˜ ì¤‘...",progress:75},{message:"ìµœì¢… ê²€ì¦ ì¤‘...",progress:90},{message:"ì™„ë£Œ",progress:100}];for(let h=0;h<t.length-1;h++){const u=t[h];c({status:"generating",progress:u.progress}),await new Promise(A=>setTimeout(A,h===0?300:600))}console.log("ğŸ“„ API í˜¸ì¶œ ì‹œì‘...");const n={orderData:{orderNumber:s.orderNumber||"PO-TEMP-001",projectName:s.projectName||s.project?.name||s.project?.projectName||"í”„ë¡œì íŠ¸ ë¯¸ì§€ì •",vendorName:s.vendorName||s.vendor?.name||"ê±°ë˜ì²˜ ë¯¸ì§€ì •",items:Array.isArray(s.items)?s.items:[],totalAmount:Number(s.totalAmount)||0,notes:s.notes||s.remarks||"",orderDate:s.orderDate||new Date().toISOString(),deliveryDate:s.deliveryDate||s.dueDate||null,createdBy:s.createdBy||s.user?.name||"ì‹œìŠ¤í…œ"},options:{includeWatermark:!0,format:"A4",orientation:"portrait"}};console.log("ğŸ“¤ ì „ì†¡í•  ë°ì´í„°:",JSON.stringify(n,null,2));const x=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(n)});if(console.log("ğŸ“¨ ì‘ë‹µ ìƒíƒœ:",x.status,x.statusText),!x.ok){let h=`ì„œë²„ ì˜¤ë¥˜ (${x.status})`;try{const u=await x.json();console.error("ğŸ“¨ ì„œë²„ ì—ëŸ¬ ì‘ë‹µ:",u),h=u.error||u.details||h}catch(u){console.error("ğŸ“¨ ì—ëŸ¬ ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨:",u);const A=await x.text();console.error("ğŸ“¨ í…ìŠ¤íŠ¸ ì‘ë‹µ:",A)}throw new Error(h)}const w=await x.json();if(console.log("âœ… PDF ìƒì„± ì„±ê³µ ì‘ë‹µ:",w),!w.success)throw new Error(w.error||"PDF ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");if(!w.pdfUrl)throw new Error("PDF URLì´ ì‘ë‹µì— í¬í•¨ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");c({status:"generating",progress:100}),await new Promise(h=>setTimeout(h,200)),c({status:"ready",url:w.pdfUrl,message:w.message})}catch(t){console.error("âŒ PDF ìƒì„± ì˜¤ë¥˜:",t);let n="PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";t instanceof Error&&(t.message.includes("fetch")?n="ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.":t.message.includes("timeout")?n="ì²˜ë¦¬ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.":t.message.includes("ë°œì£¼ì„œ ë°ì´í„°")?n=t.message:t.message.includes("puppeteer")||t.message.includes("PDF ìƒì„± ì‹¤íŒ¨")?n="PDF ë³€í™˜ ë„êµ¬ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.":n=t.message),c({status:"error",error:n})}},N=async()=>{const t=window.location.hostname.includes("vercel.app")||window.location.hostname.includes("ikjin-po");if(console.log("ğŸ” PDF ìƒì„± í™˜ê²½ ê°ì§€:",{hostname:window.location.hostname,isServerless:t,useClientPdf:j}),j||t)console.log("ğŸ“„ í´ë¼ì´ì–¸íŠ¸ PDF ìƒì„± ì‹œì‘"),await p();else{console.log("ğŸ“„ ì„œë²„ PDF ìƒì„± ì‹œë„");try{await v()}catch(n){console.error("âŒ ì„œë²„ PDF ì‹¤íŒ¨, í´ë¼ì´ì–¸íŠ¸ PDFë¡œ ì „í™˜",n),g(!0),await p()}}};b.useEffect(()=>{d&&i.status==="idle"&&N()},[d]);const F=()=>{if(i.blob)R.downloadPdf(i.blob,`PO_${s?.orderNumber||"draft"}.pdf`);else if(i.url&&r)r(i.url);else if(i.url){const t=document.createElement("a");t.href=i.url,t.download=`ë°œì£¼ì„œ_${s?.orderNumber||"unknown"}.pdf`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},z=()=>{i.blob?R.previewPdf(i.blob):i.url&&window.open(i.url,"_blank")},K=async()=>{try{console.log("ğŸ”„ ëŒ€ì•ˆ PDF ë‹¤ìš´ë¡œë“œ ì‹œì‘...");const t={orderData:{orderNumber:s?.orderNumber||"PO-TEMP-001",projectName:s?.projectName||s?.project?.name||"í”„ë¡œì íŠ¸ ë¯¸ì§€ì •",vendorName:s?.vendorName||s?.vendor?.name||"ê±°ë˜ì²˜ ë¯¸ì§€ì •",items:Array.isArray(s?.items)?s.items:[],totalAmount:Number(s?.totalAmount)||0,notes:s?.notes||s?.remarks||"",orderDate:s?.orderDate||new Date().toISOString(),deliveryDate:s?.deliveryDate||s?.dueDate||null,createdBy:s?.createdBy||s?.user?.name||"ì‹œìŠ¤í…œ"}},n=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(n.ok){const x=await n.json();if(x.success&&x.pdfUrl)window.open(`${x.pdfUrl}?download=true`,"_blank");else throw new Error(x.error||"ëŒ€ì•ˆ PDF ìƒì„± ì‹¤íŒ¨")}else throw new Error(`ì„œë²„ ì˜¤ë¥˜ (${n.status})`)}catch(t){console.error("âŒ ëŒ€ì•ˆ PDF ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:",t),alert("ëŒ€ì•ˆ PDF ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì¸ì‡„ ê¸°ëŠ¥ì„ ì´ìš©í•´ë³´ì„¸ìš”.")}},M=()=>{switch(i.status){case"generating":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx(D,{className:"w-12 h-12 text-blue-600 animate-spin"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF ìƒì„± ì¤‘..."}),e.jsx("div",{className:"w-80 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i.progress||0}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.progress||0,"% ì™„ë£Œ"]})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-6",children:[e.jsx(G,{className:"w-16 h-16 text-red-500"}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"PDF ìƒì„± ì‹¤íŒ¨"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 max-w-md",children:i.error})]}),e.jsxs("div",{className:"w-full max-w-2xl space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"ğŸ’¡ í•´ê²° ë°©ë²•"}),e.jsxs("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsx("li",{children:"â€¢ ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”"}),e.jsx("li",{children:"â€¢ ë‹¤ë¥¸ ë¸Œë¼ìš°ì €(Chrome, Firefox ë“±)ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”"}),e.jsx("li",{children:"â€¢ í˜ì´ì§€ë¥¼ ì ì‹œ ê¸°ë‹¤ë¦° í›„ ì¬ì‹œë„í•´ë³´ì„¸ìš”"}),e.jsx("li",{children:"â€¢ ë°œì£¼ì„œ ë°ì´í„°ê°€ ì™„ì „íˆ ë¡œë“œëœ í›„ ì‹œë„í•´ë³´ì„¸ìš”"})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100 mb-2",children:"âœ¨ ëŒ€ì•ˆ ë°©ë²•"}),e.jsxs("ul",{className:"text-sm text-green-800 dark:text-green-200 space-y-1",children:[e.jsx("li",{children:'â€¢ "ë‹¨ìˆœ PDF ìƒì„±" ë²„íŠ¼ìœ¼ë¡œ ì§ì ‘ ë‹¤ìš´ë¡œë“œ ì‹œë„'}),e.jsx("li",{children:"â€¢ ë°œì£¼ì„œ ìƒì„¸ í˜ì´ì§€ì—ì„œ ì§ì ‘ ë‹¤ìš´ë¡œë“œ"}),e.jsx("li",{children:"â€¢ ë¸Œë¼ìš°ì €ì˜ ì¸ì‡„ ê¸°ëŠ¥(Ctrl+P)ì„ ì´ìš©í•´ PDFë¡œ ì €ì¥"}),e.jsx("li",{children:"â€¢ Excel í˜•íƒœë¡œ ë‚´ë³´ë‚´ê¸° í›„ ìˆ˜ë™ìœ¼ë¡œ PDF ë³€í™˜"})]})]}),!1]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[e.jsxs(o,{onClick:N,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"ë‹¤ì‹œ ì‹œë„"]}),e.jsxs(o,{onClick:()=>{g(!0),p()},variant:"outline",className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"ë¸Œë¼ìš°ì € PDF ìƒì„±"]}),e.jsxs(o,{onClick:()=>window.location.reload(),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨"]}),s?.id&&e.jsxs(o,{onClick:()=>{a&&a(),window.location.href=`/orders/${s.id}`},variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"ìƒì„¸ í˜ì´ì§€ë¡œ"]}),e.jsxs(o,{onClick:()=>{g(!0),p()},disabled:!s?.orderNumber,className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"ì§ì ‘ ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(o,{onClick:K,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"ë‹¨ìˆœ PDF ìƒì„±"]})]})]});case"ready":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>y(Math.max(50,f-25)),disabled:f<=50,children:e.jsx(q,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium px-2",children:[f,"%"]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>y(Math.min(200,f+25)),disabled:f>=200,children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[k," / ",P]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:z,children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"ì¸ì‡„"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:F,children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 min-h-[600px] flex flex-col items-center justify-center",children:i.blob?e.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx(_,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"PDF ìƒì„± ì™„ë£Œ!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"PDFê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(o,{onClick:F,className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"PDF ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(o,{onClick:z,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"PDF ë³´ê¸°"]})]})]})}):i.url?e.jsxs(e.Fragment,{children:[e.jsx("iframe",{src:`${i.url}#view=FitH&zoom=${f}`,className:"w-full h-[600px] border-0 rounded",title:"PDF ë¯¸ë¦¬ë³´ê¸°",onError:t=>{console.error("âŒ iframe PDF ë¡œë“œ ì‹¤íŒ¨");const n=t.target;n.style.display="none",g(!0),p()}}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"PDFê°€ í‘œì‹œë˜ì§€ ì•Šë‚˜ìš”?"}),e.jsx(o,{onClick:()=>window.open(i.url,"_blank"),variant:"outline",size:"sm",children:"ìƒˆ íƒ­ì—ì„œ ì—´ê¸°"})]})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"PDF ë¡œë”© ì¤‘..."})]})})]});default:return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs(o,{onClick:N,children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"PDF ë¯¸ë¦¬ë³´ê¸° ì‹œì‘"]})})}},E=e.jsxs(Z,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(V,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"PDF ë¯¸ë¦¬ë³´ê¸°",s?.orderNumber&&e.jsx(H,{variant:"outline",children:s.orderNumber})]})}),e.jsxs(Y,{defaultValue:"preview",className:"h-full flex flex-col",children:[e.jsxs(ee,{className:"grid w-full grid-cols-2",children:[e.jsx(O,{value:"preview",children:"ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx(O,{value:"pdf",children:"PDF ìƒì„±"})]}),e.jsx(L,{value:"preview",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"order-preview-container bg-white",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"ë°œì£¼ì„œ Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["ë°œì£¼ë²ˆí˜¸: ",s?.orderNumber||"PO-TEMP-001"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ê±°ë˜ì²˜ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"íšŒì‚¬ëª…:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendorName||s?.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì‚¬ì—…ìë²ˆí˜¸:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì—°ë½ì²˜:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì´ë©”ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì£¼ì†Œ:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì¼ì:"}),e.jsx("span",{style:{flex:"1"},children:s?.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë‚©í’ˆí¬ë§ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.deliveryDate||s?.dueDate?new Date(s.deliveryDate||s.dueDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì:"}),e.jsx("span",{style:{flex:"1"},children:s?.createdBy||s?.user?.name||"ì‹œìŠ¤í…œ"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ìƒíƒœ:"}),e.jsx("span",{style:{flex:"1"},children:s?.status==="pending"?"ëŒ€ê¸°":s?.status==="approved"?"ìŠ¹ì¸":s?.status==="sent"?"ë°œì†¡":s?.status||"ì„ì‹œ"})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"í’ˆëª©ëª…"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê·œê²©"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ìˆ˜ëŸ‰"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë‹¨ê°€"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê¸ˆì•¡"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë¹„ê³ "})]})}),e.jsxs("tbody",{children:[(s?.items||[]).map((t,n)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:t.itemName||t.name}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:t.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(t.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",Number(t.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",(Number(t.quantity)*Number(t.unitPrice)).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:t.notes||"-"})]},n)),(!s?.items||s.items.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{border:"1px solid #ddd",padding:"20px",textAlign:"center",fontSize:"10px",color:"#666"},children:"í’ˆëª© ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"ì´ ê¸ˆì•¡"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["â‚©",Number(s?.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),(s?.notes||s?.remarks)&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"íŠ¹ì´ì‚¬í•­:"}),e.jsx("br",{}),s.notes||s.remarks]}),e.jsxs("div",{className:"no-print mt-6 flex justify-center space-x-4",children:[e.jsxs(o,{onClick:z,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"ì¸ì‡„"]}),e.jsxs(o,{onClick:F,variant:"outline",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"PDF ë‹¤ìš´ë¡œë“œ"]})]})]})}),e.jsx(L,{value:"pdf",className:"flex-1 overflow-auto",children:M()}),e.jsx(L,{value:"details",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"order-preview-container bg-white",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"ë°œì£¼ì„œ Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["ë°œì£¼ë²ˆí˜¸: ",s?.orderNumber||"PO-TEMP-001"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ê±°ë˜ì²˜ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"íšŒì‚¬ëª…:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendorName||s?.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì‚¬ì—…ìë²ˆí˜¸:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì—°ë½ì²˜:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì´ë©”ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì£¼ì†Œ:"}),e.jsx("span",{style:{flex:"1"},children:s?.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì¼ì:"}),e.jsx("span",{style:{flex:"1"},children:s?.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë‚©í’ˆí¬ë§ì¼:"}),e.jsx("span",{style:{flex:"1"},children:s?.deliveryDate||s?.dueDate?new Date(s.deliveryDate||s.dueDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì:"}),e.jsx("span",{style:{flex:"1"},children:s?.createdBy||s?.user?.name||"ì‹œìŠ¤í…œ"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ìƒíƒœ:"}),e.jsx("span",{style:{flex:"1"},children:s?.status==="pending"?"ëŒ€ê¸°":s?.status==="approved"?"ìŠ¹ì¸":s?.status==="sent"?"ë°œì†¡":s?.status||"ì„ì‹œ"})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"í’ˆëª©ëª…"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê·œê²©"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ìˆ˜ëŸ‰"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë‹¨ê°€"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê¸ˆì•¡"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë¹„ê³ "})]})}),e.jsxs("tbody",{children:[(s?.items||[]).map((t,n)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:t.itemName||t.name}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:t.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(t.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",Number(t.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",(Number(t.quantity)*Number(t.unitPrice)).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:t.notes||"-"})]},n)),(!s?.items||s.items.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{border:"1px solid #ddd",padding:"20px",textAlign:"center",fontSize:"10px",color:"#666"},children:"í’ˆëª© ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"ì´ ê¸ˆì•¡"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["â‚©",Number(s?.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),(s?.notes||s?.remarks)&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"íŠ¹ì´ì‚¬í•­:"}),e.jsx("br",{}),s.notes||s.remarks]})]})})]})]});return l?e.jsxs(T,{open:d,onOpenChange:a,children:[e.jsx(X,{asChild:!0,children:l}),E]}):e.jsx(T,{open:d,onOpenChange:a,children:E})};export{xe as P};
