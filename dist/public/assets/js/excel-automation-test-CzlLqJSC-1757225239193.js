import{h as S,r as h,j as e,w as j,a3 as v,a4 as g,aZ as P,x as p,y as F,B as o,o as u,a0 as m,a1 as x}from"./index-BV8YMSqX-1757225239193.js";import{P as $}from"./page-header-DunZ6-Tb-1757225239193.js";function E(){const{theme:f}=S(),r=f==="dark",[i,N]=h.useState(null),[c,d]=h.useState(!1),[a,n]=h.useState(null),b=s=>{const l=s.target.files?.[0];l&&(N(l),n(null))},y=async()=>{if(!i){alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}d(!0),n(null);try{const s=new FormData;s.append("excel",i);const t=await(await fetch("/api/excel-automation/parse-input-sheet",{method:"POST",body:s})).json();n(t)}catch(s){console.error("ì—…ë¡œë“œ ì˜¤ë¥˜:",s),n({success:!1,error:"íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}finally{d(!1)}},w=async()=>{if(!i){alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}d(!0);try{const s=new FormData;s.append("excel",i);const t=await(await fetch("/api/excel-automation/debug-excel",{method:"POST",body:s})).json();console.log("ë””ë²„ê·¸ ê²°ê³¼:",t),alert("ë””ë²„ê·¸ ì •ë³´ê°€ ì½˜ì†”ì— ì¶œë ¥ë˜ì—ˆìŠµë‹ˆë‹¤. ì„œë²„ ë¡œê·¸ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.")}catch(s){console.error("ë””ë²„ê·¸ ì˜¤ë¥˜:",s),alert("ë””ë²„ê·¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{d(!1)}},V=async()=>{if(!i){alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}d(!0),n(null);try{const s=new FormData;s.append("excel",i);const t=await(await fetch("/api/excel-automation/simple-parse",{method:"POST",body:s})).json();console.log("ê°„ë‹¨ íŒŒì‹± ê²°ê³¼:",t),n({success:t.success,data:t.success?{rows:t.data.sampleData||[],validation:{isValid:!0,errors:[],warnings:[],totalRows:t.data.totalRows||0},meta:{uploadedBy:"test",uploadedAt:new Date().toISOString(),filename:i.name}}:void 0,error:t.error})}catch(s){console.error("ê°„ë‹¨ íŒŒì‹± ì˜¤ë¥˜:",s),n({success:!1,error:"ê°„ë‹¨ íŒŒì‹± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}finally{d(!1)}},C=async()=>{if(!i){alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}d(!0),n(null);try{const s=new FormData;s.append("excel",i);const t=await(await fetch("/api/excel-automation/parse-and-validate",{method:"POST",body:s})).json();console.log("íŒŒì‹±+ê²€ì¦ ê²°ê³¼:",t),t.success?n({success:!0,data:{rows:t.data.parsing.data||[],validation:{isValid:!0,errors:[],warnings:[],totalRows:t.data.parsing.totalRows||0},meta:{uploadedBy:"test",uploadedAt:t.data.meta.uploadedAt,filename:t.data.meta.filename},vendorValidation:t.data.validation},error:void 0}):n({success:!1,error:t.error||"íŒŒì‹± ë° ê²€ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}catch(s){console.error("íŒŒì‹±+ê²€ì¦ ì˜¤ë¥˜:",s),n({success:!1,error:"íŒŒì‹± ë° ê²€ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}finally{d(!1)}};return e.jsx("div",{className:`min-h-screen transition-colors ${r?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx($,{title:"ì—‘ì…€ í…œí”Œë¦¿ ìë™í™” í…ŒìŠ¤íŠ¸",description:"Input ì‹œíŠ¸ì˜ A:P ì—´ì„ íŒŒì‹±í•˜ì—¬ JSONìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤."}),e.jsxs(j,{children:[e.jsxs(v,{children:[e.jsx(g,{children:"1ë‹¨ê³„: ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"}),e.jsx(P,{children:"'Input' ì‹œíŠ¸ê°€ í¬í•¨ëœ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”."})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{type:"file",accept:".xlsx,.xls",onChange:b,className:"flex-1"}),e.jsx(o,{onClick:y,disabled:!i||c,className:"min-w-24",children:c?"íŒŒì‹±ì¤‘...":"íŒŒì‹±í•˜ê¸°"}),e.jsx(o,{onClick:V,disabled:!i||c,variant:"secondary",className:"min-w-24",children:"ğŸ“Š ê°„ë‹¨íŒŒì‹±"}),e.jsx(o,{onClick:C,disabled:!i||c,variant:"default",className:"min-w-32 bg-blue-600 hover:bg-blue-700",children:"ğŸ” íŒŒì‹±+ê²€ì¦"}),e.jsx(o,{onClick:w,disabled:!i||c,variant:"outline",className:"min-w-24",children:"ğŸ› ë””ë²„ê·¸"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(o,{variant:"outline",onClick:()=>window.open("/api/excel-automation/sample-excel","_blank"),className:"w-auto",children:"ğŸ“¥ ìƒ˜í”Œ Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ê¸°ëŠ¥ì„ í™•ì¸í•´ë³´ì„¸ìš”."})]}),i&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ì„ íƒëœ íŒŒì¼: ",i.name," (",(i.size/1024/1024).toFixed(2)," MB)"]})]})]}),a&&e.jsxs(j,{children:[e.jsx(v,{children:e.jsxs(g,{className:"flex items-center gap-2",children:["íŒŒì‹± ê²°ê³¼",e.jsx(u,{variant:a.success?"default":"destructive",children:a.success?"ì„±ê³µ":"ì‹¤íŒ¨"})]})}),e.jsx(p,{className:"space-y-4",children:a.success&&a.data?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ì´ í–‰ ìˆ˜"}),e.jsxs("div",{className:"text-lg",children:[a.data.validation.totalRows,"ê°œ"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ì˜¤ë¥˜"}),e.jsxs("div",{className:"text-lg text-red-600",children:[a.data.validation.errors.length,"ê°œ"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ê²½ê³ "}),e.jsxs("div",{className:"text-lg text-yellow-600",children:[a.data.validation.warnings.length,"ê°œ"]})]})]}),a.data.validation.errors.length>0&&e.jsx(m,{variant:"destructive",children:e.jsxs(x,{children:[e.jsx("div",{className:"font-medium mb-2",children:"ì˜¤ë¥˜ ëª©ë¡:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:a.data.validation.errors.map((s,l)=>e.jsx("li",{className:"text-sm",children:s},l))})]})}),a.data.validation.warnings.length>0&&e.jsx(m,{variant:"default",children:e.jsxs(x,{children:[e.jsx("div",{className:"font-medium mb-2",children:"ê²½ê³  ëª©ë¡:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:a.data.validation.warnings.map((s,l)=>e.jsx("li",{className:"text-sm",children:s},l))})]})}),a.data.vendorValidation&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"font-medium text-lg",children:"ğŸ” ê±°ë˜ì²˜ ê²€ì¦ ê²°ê³¼ (Phase 2)"}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-4 gap-4 p-4 rounded-lg transition-colors ${r?"bg-blue-900/20 border border-blue-800":"bg-blue-50"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ê±°ë˜ì²˜ ê²€ì¦"}),e.jsxs("div",{className:`text-lg transition-colors ${r?"text-blue-400":"text-blue-600"}`,children:[a.data.vendorValidation.vendorValidations.filter(s=>s.exists).length," / ",a.data.vendorValidation.vendorValidations.length]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ë‚©í’ˆì²˜ ê²€ì¦"}),e.jsxs("div",{className:`text-lg transition-colors ${r?"text-blue-400":"text-blue-600"}`,children:[a.data.vendorValidation.deliveryValidations.filter(s=>s.exists).length," / ",a.data.vendorValidation.deliveryValidations.length]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ì´ë©”ì¼ ì¶©ëŒ"}),e.jsxs("div",{className:`text-lg transition-colors ${r?"text-red-400":"text-red-600"}`,children:[a.data.vendorValidation.emailConflicts.filter(s=>s.type==="conflict").length,"ê°œ"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"ì¶”ì²œ ì—…ì²´"}),e.jsxs("div",{className:`text-lg transition-colors ${r?"text-green-400":"text-green-600"}`,children:[a.data.vendorValidation.vendorValidations.reduce((s,l)=>s+l.suggestions.length,0),"ê°œ"]})]})]}),a.data.vendorValidation.vendorValidations.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"ê±°ë˜ì²˜ëª… ê²€ì¦ ìƒì„¸:"}),a.data.vendorValidation.vendorValidations.some(s=>!s.exists&&s.suggestions.length>0&&s.suggestions[0].phone==="02-0000-0000")&&e.jsx(m,{variant:"default",className:"mb-4",children:e.jsxs(x,{children:["âš ï¸ ",e.jsx("strong",{children:"í´ë°± ëª¨ë“œ"}),": ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ì œë¡œ ì¸í•´ ìƒ˜í”Œ ì¶”ì²œ ë°ì´í„°ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤."]})}),e.jsx("div",{className:"space-y-2",children:a.data.vendorValidation.vendorValidations.map((s,l)=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium",children:s.vendorName}),e.jsx(u,{variant:s.exists?"default":"secondary",children:s.exists?"âœ… ì¡´ì¬":"âŒ ì—†ìŒ"}),!s.exists&&s.suggestions.length>0&&s.suggestions[0].phone==="02-0000-0000"&&e.jsx(u,{variant:"outline",className:"text-xs",children:"ğŸ”„ í´ë°±"})]}),s.exactMatch&&e.jsxs("div",{className:`text-sm mb-2 transition-colors ${r?"text-green-400":"text-green-700"}`,children:["ğŸ“ ë§¤ì¹­: ",s.exactMatch.name," (ë‹´ë‹¹ì: ",s.exactMatch.contactPerson,")"]}),s.suggestions.length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"ğŸ’¡ ìœ ì‚¬ ì—…ì²´ ì¶”ì²œ:"}),s.suggestions.slice(0,3).map((t,D)=>e.jsxs("div",{className:`text-xs ml-2 transition-colors ${r?"text-gray-400":"text-gray-600"}`,children:["â€¢ ",t.name," (ìœ ì‚¬ë„: ",(t.similarity*100).toFixed(1),"%)",t.phone==="02-0000-0000"&&e.jsx("span",{className:`ml-1 transition-colors ${r?"text-orange-400":"text-orange-500"}`,children:"[ìƒ˜í”Œ]"})]},D))]})]},l))})]}),a.data.vendorValidation.emailConflicts.filter(s=>s.type==="conflict").length>0&&e.jsx(m,{variant:"destructive",children:e.jsxs(x,{children:[e.jsx("div",{className:"font-medium mb-2",children:"ğŸ“§ ì´ë©”ì¼ ì¶©ëŒ ë°œê²¬:"}),a.data.vendorValidation.emailConflicts.filter(s=>s.type==="conflict").map((s,l)=>e.jsxs("div",{className:"text-sm mb-2",children:[e.jsxs("div",{className:"font-medium",children:[s.vendorName,":"]}),e.jsxs("div",{children:["Excel: ",s.excelEmail]}),e.jsxs("div",{children:["DB: ",s.dbEmail]})]},l))]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"íŒŒì‹±ëœ ë°ì´í„° (JSON):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg overflow-x-auto",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:JSON.stringify(a.data.rows,null,2)})})]})]}):e.jsx(m,{variant:"destructive",children:e.jsx(x,{children:a.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})})})]})]})})}export{E as default};
