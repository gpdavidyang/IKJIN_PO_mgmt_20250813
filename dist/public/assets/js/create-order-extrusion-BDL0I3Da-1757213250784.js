import{r as p,p as W,j as e,F as re,B as o,s as y,G as B,H as U,D as ke,t as b,J as n,N as $,n as ne,O as Oe,P as k,Q as X,R as Y,T as ee,I as le,V as Te}from"./index-BfDc6Omt-1757213250784.js";import{r as Ie,u as ce}from"./xlsx-ocdEQCFM-1757213250784.js";import{S as V,a as L,b as R,c as M,d as F}from"./select-BLTlOVj9-1757213250784.js";import{D as Be,f as Ue,a as $e,b as Pe,c as Ee}from"./dialog-Bo48vr0k-1757213250784.js";import{C as se}from"./calendar-Btt8Ci-7-1757213250784.js";import{A as de}from"./arrow-left-DECUl3xp-1757213250784.js";import{S as oe}from"./save-D-19p1G_-1757213250784.js";import{C as ae}from"./calendar-days-COos_WQ6-1757213250784.js";import{U as He}from"./upload-DPiNX7Vn-1757213250784.js";import{T as xe}from"./trash-2-Vt9HzQc1-1757213250784.js";import{A as Ke}from"./arrow-right-BUgpd0PG-1757213250784.js";import"./index-38EM6Lo0-1757213250784.js";import"./chevron-down-C_SK49in-1757213250784.js";import"./chevron-up-DBeMyJPH-1757213250784.js";import"./index-Bkwo1L4z-1757213250784.js";import"./format-pq49SRM7-1757213250784.js";import"./chevron-left-C_HJWEvB-1757213250784.js";class Ze{constructor(c){this.data=c}getCellReference(c){const t=c.match(/^([A-Z]+)(\d+)$/);if(!t)return 0;const x=this.columnToIndex(t[1]),d=Number.parseInt(t[2])-1;if(d>=0&&d<this.data.length&&x>=0&&x<(this.data[d]?.length||0)){const N=this.data[d][x];if(N){const m=N.displayValue!==void 0?N.displayValue:N.value,f=String(m).replace(/[,\s]/g,""),S=Number.parseFloat(f);return isNaN(S)?0:S}}return 0}columnToIndex(c){let t=0;for(let x=0;x<c.length;x++)t=t*26+(c.charCodeAt(x)-64);return t-1}evaluate(c){try{return c=c.replace(/^=/,"").trim(),c.includes("SUM(")?this.evaluateSum(c):(c=c.replace(/[A-Z]+\d+/g,t=>this.getCellReference(t).toString()),this.evaluateArithmetic(c))}catch(t){return console.error("Formula evaluation error:",t),0}}evaluateSum(c){const t=c.match(/SUM\(([^)]+)\)/i);if(!t)return 0;const x=t[1].trim(),d=x.match(/([A-Z]+\d+):([A-Z]+\d+)/i);if(d){const m=d[1].toUpperCase(),f=d[2].toUpperCase();return this.sumRange(m,f)}return x.split(",").map(m=>m.trim().toUpperCase()).reduce((m,f)=>m+this.getCellReference(f),0)}sumRange(c,t){const x=c.match(/^([A-Z]+)(\d+)$/),d=t.match(/^([A-Z]+)(\d+)$/);if(!x||!d)return 0;const N=this.columnToIndex(x[1]),m=Number.parseInt(x[2])-1,f=this.columnToIndex(d[1]),S=Number.parseInt(d[2])-1;let I=0;for(let C=m;C<=S;C++)for(let z=N;z<=f;z++)if(C>=0&&C<this.data.length&&z>=0&&z<(this.data[C]?.length||0)){const l=this.data[C][z];if(l){const h=l.displayValue!==void 0?l.displayValue:l.value,P=String(h).replace(/[,\s]/g,""),T=Number.parseFloat(P);isNaN(T)||(I+=T)}}return I}evaluateArithmetic(c){try{const t=c.replace(/[^0-9+\-*/().\s]/g,"");return t.trim()?Function(`"use strict"; return (${t})`)():0}catch(t){return console.error("Arithmetic evaluation error:",t),0}}}const te=w=>typeof w=="string"?w==="협의"?"협의":new Date(w).toLocaleDateString("ko-KR"):w.toLocaleDateString("ko-KR");function O({title:w,onAdd:c,trigger:t}){const[x,d]=p.useState(""),[N,m]=p.useState(!1),f=()=>{x.trim()&&(c(x.trim()),d(""),m(!1))};return e.jsxs(Be,{open:N,onOpenChange:m,children:[e.jsx(Ue,{asChild:!0,children:t}),e.jsxs($e,{children:[e.jsx(Pe,{children:e.jsxs(Ee,{children:[w," 추가"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(n,{htmlFor:"newItem",children:["새 ",w]}),e.jsx(le,{id:"newItem",value:x,onChange:S=>d(S.target.value),placeholder:`${w}을 입력하세요`,onKeyDown:S=>S.key==="Enter"&&f()})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>m(!1),children:"취소"}),e.jsx(o,{onClick:f,children:"추가"})]})]})]})]})}function ds(){const[w,c]=p.useState("input"),[t,x]=p.useState(null),[d,N]=p.useState([]),[m,f]=p.useState(""),[S,I]=p.useState(!1),[C,z]=p.useState({}),[l,h]=p.useState({siteName:"",materialReceiver:"",headOfficeManager:"",specialNotes:"",extrusion:{deliveryDate:"",supplier:"",deliveryLocation:""},painting:{deliveryDate:"",supplier:"",deliveryLocation:""},insulation:{deliveryDate:"",supplier:"",deliveryLocation:""}}),{data:P=[]}=W({queryKey:["/api/projects"]}),{data:T=[]}=W({queryKey:["/api/vendors"]}),{data:E=[]}=W({queryKey:["/api/users"]}),me=Array.isArray(P)?P.map(s=>s.name||s.projectName).filter(Boolean):[],he=Array.isArray(T)?T.map(s=>s.companyName||s.name).filter(Boolean):[],ue=Array.isArray(T)?T.map(s=>s.companyName||s.name).filter(Boolean):[],je=Array.isArray(E)?E.map(s=>s.name).filter(Boolean):[],ge=Array.isArray(E)?E.map(s=>s.name).filter(Boolean):[],[pe,Ne]=p.useState([]),[fe,ve]=p.useState([]),[ye,be]=p.useState([]),[we,Se]=p.useState([]),K=[...he,...pe],Z=[...ue,...fe],De=[...je,...ye],Ce=[...ge,...we],_=s=>{Ne(a=>[...a,s])},q=s=>{ve(a=>[...a,s])},Ae=s=>{be(a=>[...a,s])},Ve=s=>{Se(a=>[...a,s])},ie=()=>{c("input")},Le=()=>{const s=new Date().toISOString();x({projectSettings:l,spreadsheetData:d,fileName:m,timestamp:s}),c("pdf-preview")},Re=s=>{const a=s.target.files?.[0];if(!a)return;I(!0),f(a.name);const g=new FileReader;g.onload=u=>{try{const j=new Uint8Array(u.target?.result),v=Ie(j,{type:"array"}),i=v.SheetNames[0],D=v.Sheets[i],r=ce.decode_range(D["!ref"]||"A1:A1"),A=[];for(let G=r.s.r;G<=r.e.r;G++){const J=[];for(let Q=r.s.c;Q<=r.e.c;Q++){const Fe=ce.encode_cell({r:G,c:Q}),H=D[Fe];if(H){const ze={value:H.v,formula:H.f,displayValue:H.v};J.push(ze)}else J.push({value:"",displayValue:""})}A.push(J)}N(A),setTimeout(()=>Me(A),100)}catch(j){console.error("Error parsing Excel file:",j),alert("파일을 읽는 중 오류가 발생했습니다.")}finally{I(!1)}},g.readAsArrayBuffer(a)},Me=p.useCallback(s=>{const a=new Ze(s),g=s.map(u=>u.map(j=>{if(j.formula&&j.formula.startsWith("=")){const v=a.evaluate(j.formula);return{...j,displayValue:v}}return{...j,displayValue:j.displayValue!==void 0?j.displayValue:j.value}}));N(g)},[]);return w==="pdf-preview"&&t?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"발주서 미리보기"}),e.jsx("p",{className:"text-sm text-gray-600",children:"저장된 발주서 내용을 확인하고 최종 제출하세요."})]})]}),e.jsxs(o,{onClick:ie,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"수정하기"]})]}),e.jsxs(y,{className:"hover:shadow-md transition-shadow",children:[e.jsx(B,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5 text-blue-600"}),"현장 정보"]})}),e.jsxs(b,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"현장명"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.siteName})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"자재 인수자"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.materialReceiver})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"본사 담당자"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.headOfficeManager})]})]}),t.projectSettings.specialNotes&&e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"특이사항"}),e.jsx("p",{className:"text-sm",children:t.projectSettings.specialNotes})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(y,{className:"border-blue-200",children:[e.jsx(B,{className:"bg-blue-50",children:e.jsx(U,{className:"text-blue-700 text-sm",children:"압출 공정"})}),e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"납품희망일"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.extrusion.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"거래처"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.extrusion.supplier})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"납품처"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.extrusion.deliveryLocation})]})]})})]}),e.jsxs(y,{className:"border-green-200",children:[e.jsx(B,{className:"bg-green-50",children:e.jsx(U,{className:"text-green-700 text-sm",children:"도장 공정"})}),e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"납품희망일"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.painting.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"거래처"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.painting.supplier})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"납품처"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.painting.deliveryLocation})]})]})})]}),e.jsxs(y,{className:"border-orange-200",children:[e.jsx(B,{className:"bg-orange-50",children:e.jsx(U,{className:"text-orange-700 text-sm",children:"단열 공정"})}),e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"납품희망일"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.insulation.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"거래처"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.insulation.supplier})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-gray-600",children:"납품처"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.insulation.deliveryLocation})]})]})})]})]}),e.jsxs(y,{className:"hover:shadow-md transition-shadow",children:[e.jsx(B,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-green-600"}),"발주 품목 목록"]})}),e.jsxs(b,{children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["파일명: ",t.fileName]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:t.spreadsheetData[0]?.map((s,a)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+a)},a))})}),e.jsx("tbody",{children:t.spreadsheetData.slice(0,10).map((s,a)=>e.jsx("tr",{className:"border-t",children:s.map((g,u)=>e.jsx("td",{className:"px-3 py-2 border-r",children:g.displayValue||g.value||""},u))},a))})]}),t.spreadsheetData.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... 그 외 ",t.spreadsheetData.length-10,"개 행"]})]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-6",children:[e.jsxs(o,{onClick:ie,variant:"outline",size:"lg",className:"flex items-center gap-2 px-6",children:[e.jsx(de,{className:"h-4 w-4"}),"이전 단계"]}),e.jsxs(o,{size:"lg",className:"flex items-center gap-2 px-8 bg-green-600 hover:bg-green-700",onClick:()=>{alert("발주서가 성공적으로 제출되었습니다!")},children:[e.jsx(oe,{className:"h-4 w-4"}),"최종 제출"]})]})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"압출 발주서"}),e.jsx("p",{className:"text-sm text-gray-600",children:"압출 공정 전용 발주서를 작성하고 관리합니다."})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(ne,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"실험적 기능"})})]}),e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Oe,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"발주서 기본 정보"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700",children:"프로젝트 명"}),e.jsxs(V,{value:l.siteName,onValueChange:s=>h(a=>({...a,siteName:s})),children:[e.jsx(L,{className:`h-10 ${l.siteName?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{placeholder:"현장을 선택하세요"})}),e.jsx(M,{children:me.map(s=>e.jsx(F,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700",children:"자재 인수자"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.materialReceiver,onValueChange:s=>h(a=>({...a,materialReceiver:s})),children:[e.jsx(L,{className:`flex-1 h-10 ${l.materialReceiver?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{placeholder:"자재 인수자 선택"})}),e.jsx(M,{children:De.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"자재 인수자",onAdd:Ae,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(k,{className:"h-4 w-4"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700",children:"본사 담당자"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.headOfficeManager,onValueChange:s=>h(a=>({...a,headOfficeManager:s})),children:[e.jsx(L,{className:`flex-1 h-10 ${l.headOfficeManager?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{placeholder:"본사 담당자 선택"})}),e.jsx(M,{children:Ce.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"본사 담당자",onAdd:Ve,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(k,{className:"h-4 w-4"})})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"font-semibold text-blue-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"압출"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-blue-700 font-medium",children:"납품희망일"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",className:"flex-1 justify-start text-left font-normal h-8",children:[e.jsx(ae,{className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:l.extrusion.deliveryDate?te(l.extrusion.deliveryDate):"날짜 선택"})]})}),e.jsx(ee,{className:"w-auto p-0",align:"start",children:e.jsx(se,{mode:"single",selected:l.extrusion.deliveryDate&&l.extrusion.deliveryDate!=="협의"?new Date(l.extrusion.deliveryDate):void 0,onSelect:s=>{s&&h(a=>({...a,extrusion:{...a.extrusion,deliveryDate:s.toISOString().split("T")[0]}}))},initialFocus:!0})})]}),e.jsx(o,{variant:l.extrusion.deliveryDate==="협의"?"default":"outline",size:"sm",className:"text-xs h-8 px-2",onClick:()=>h(s=>({...s,extrusion:{...s.extrusion,deliveryDate:"협의"}})),children:"협의"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-blue-700 font-medium",children:"거래처명"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.extrusion.supplier,onValueChange:s=>h(a=>({...a,extrusion:{...a.extrusion,supplier:s}})),children:[e.jsx(L,{className:"flex-1 h-8 text-xs",children:e.jsx(R,{placeholder:"거래처 선택"})}),e.jsx(M,{children:K.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"거래처",onAdd:_,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-3 w-3"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-blue-700 font-medium",children:"납품처"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.extrusion.deliveryLocation,onValueChange:s=>h(a=>({...a,extrusion:{...a.extrusion,deliveryLocation:s}})),children:[e.jsx(L,{className:"flex-1 h-8 text-xs",children:e.jsx(R,{placeholder:"납품처 선택"})}),e.jsx(M,{children:Z.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"납품처",onAdd:q,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-3 w-3"})})})]})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"font-semibold text-green-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"도장"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-green-700 font-medium",children:"납품희망일"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",className:"flex-1 justify-start text-left font-normal h-8",children:[e.jsx(ae,{className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:l.painting.deliveryDate?te(l.painting.deliveryDate):"날짜 선택"})]})}),e.jsx(ee,{className:"w-auto p-0",align:"start",children:e.jsx(se,{mode:"single",selected:l.painting.deliveryDate&&l.painting.deliveryDate!=="협의"?new Date(l.painting.deliveryDate):void 0,onSelect:s=>{s&&h(a=>({...a,painting:{...a.painting,deliveryDate:s.toISOString().split("T")[0]}}))},initialFocus:!0})})]}),e.jsx(o,{variant:l.painting.deliveryDate==="협의"?"default":"outline",size:"sm",className:"text-xs h-8 px-2",onClick:()=>h(s=>({...s,painting:{...s.painting,deliveryDate:"협의"}})),children:"협의"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-green-700 font-medium",children:"거래처명"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.painting.supplier,onValueChange:s=>h(a=>({...a,painting:{...a.painting,supplier:s}})),children:[e.jsx(L,{className:"flex-1 h-8 text-xs",children:e.jsx(R,{placeholder:"거래처 선택"})}),e.jsx(M,{children:K.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"거래처",onAdd:_,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-3 w-3"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-green-700 font-medium",children:"납품처"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.painting.deliveryLocation,onValueChange:s=>h(a=>({...a,painting:{...a.painting,deliveryLocation:s}})),children:[e.jsx(L,{className:"flex-1 h-8 text-xs",children:e.jsx(R,{placeholder:"납품처 선택"})}),e.jsx(M,{children:Z.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"납품처",onAdd:q,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-3 w-3"})})})]})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-orange-50 rounded-lg border border-orange-200",children:[e.jsxs("h3",{className:"font-semibold text-orange-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"단열"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-orange-700 font-medium",children:"납품희망일"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",className:"flex-1 justify-start text-left font-normal h-8",children:[e.jsx(ae,{className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:l.insulation.deliveryDate?te(l.insulation.deliveryDate):"날짜 선택"})]})}),e.jsx(ee,{className:"w-auto p-0",align:"start",children:e.jsx(se,{mode:"single",selected:l.insulation.deliveryDate&&l.insulation.deliveryDate!=="협의"?new Date(l.insulation.deliveryDate):void 0,onSelect:s=>{s&&h(a=>({...a,insulation:{...a.insulation,deliveryDate:s.toISOString().split("T")[0]}}))},initialFocus:!0})})]}),e.jsx(o,{variant:l.insulation.deliveryDate==="협의"?"default":"outline",size:"sm",className:"text-xs h-8 px-2",onClick:()=>h(s=>({...s,insulation:{...s.insulation,deliveryDate:"협의"}})),children:"협의"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-orange-700 font-medium",children:"거래처명"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.insulation.supplier,onValueChange:s=>h(a=>({...a,insulation:{...a.insulation,supplier:s}})),children:[e.jsx(L,{className:"flex-1 h-8 text-xs",children:e.jsx(R,{placeholder:"거래처 선택"})}),e.jsx(M,{children:K.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"거래처",onAdd:_,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-3 w-3"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs text-orange-700 font-medium",children:"납품처"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:l.insulation.deliveryLocation,onValueChange:s=>h(a=>({...a,insulation:{...a.insulation,deliveryLocation:s}})),children:[e.jsx(L,{className:"flex-1 h-8 text-xs",children:e.jsx(R,{placeholder:"납품처 선택"})}),e.jsx(M,{children:Z.map(s=>e.jsx(F,{value:s,children:s},s))})]}),e.jsx(O,{title:"납품처",onAdd:q,trigger:e.jsx(o,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-3 w-3"})})})]})]})]})]})]})]})]})}),e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx($,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"특이 사항"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"specialNotes",className:"text-sm font-medium text-gray-700",children:"프로젝트 특이사항 및 요청사항"}),e.jsx("textarea",{id:"specialNotes",value:l.specialNotes,onChange:s=>h(a=>({...a,specialNotes:s.target.value})),placeholder:"프로젝트 진행 시 고려해야 할 특이사항이나 요청사항을 입력해주세요...",className:"w-full min-h-[100px] p-3 border border-gray-300 rounded-md resize-vertical focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",rows:4}),e.jsx("p",{className:"text-xs text-gray-500",children:"예: 납품 시간 제한, 특별 포장 요구사항, 품질 기준, 설치 관련 주의사항 등"})]})]})}),e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(He,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"엑셀 파일 업로드"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(le,{type:"file",accept:".xlsx,.xls",onChange:Re,disabled:S,className:"h-10"}),m&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-700 font-medium",children:["업로드된 파일: ",m]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{f(""),N([]);const s=document.querySelector('input[type="file"]');s&&(s.value="")},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(xe,{className:"h-4 w-4"})})]})]}),S&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm",children:"파일을 처리하고 있습니다..."})]})]})]})}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx($,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"발주요약표 (B1:E4)"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsx("div",{className:"overflow-auto",children:e.jsx("table",{className:"w-full border-collapse",children:e.jsx("tbody",{children:d.slice(0,4).map((s,a)=>e.jsx("tr",{className:"hover:bg-gray-50 transition-colors",children:Array.from({length:4},(g,u)=>{const j=u+1,v=s[j];let i=v?.displayValue!==void 0?v.displayValue:v?.value;if(i==null||i===""||i===0||i==="0")i="";else if(typeof i=="number"&&!isNaN(i))i=Number(i).toFixed(1);else if(typeof i=="string"&&!isNaN(Number(i))){const D=Number(i);D===0?i="":i=D.toFixed(1)}return e.jsx("td",{className:"border border-gray-300 p-2 text-center",children:e.jsx("span",{className:"text-sm text-gray-900",children:String(i||"")})},u)})},a))})})})})]})}),e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx($,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"발주 품목 리스트 (A6:I22)"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsx("tr",{children:["No","품명","Dies No","색상","길이","단중","중량","비고","기타"].map((s,a)=>e.jsx("th",{className:"border border-gray-300 p-2 text-left font-semibold text-gray-700 bg-blue-50 text-xs",children:s},a))})}),e.jsx("tbody",{children:d.slice(6,22).map((s,a)=>{const g=a+1,u=g===16,j=s[1]?.displayValue||s[1]?.value||"";return!u&&String(j).trim()===""?null:e.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${u?"bg-yellow-100":""}`,children:Array.from({length:9},(v,i)=>{const D=s[i];let r=D?.displayValue!==void 0?D.displayValue:D?.value;if(u&&(i>=1&&i<=6||i===8))r="";else if(r==null||r===""||r===0||r==="0")r="";else if(i===0){if(typeof r=="number"&&!isNaN(r))r=Math.round(r).toString();else if(typeof r=="string"&&!isNaN(Number(r))){const A=Number(r);A===0?r="":r=Math.round(A).toString()}}else if(typeof r=="number"&&!isNaN(r))r=Number(r).toFixed(1);else if(typeof r=="string"&&!isNaN(Number(r))){const A=Number(r);A===0?r="":r=A.toFixed(1)}return e.jsx("td",{className:`border border-gray-300 p-2 text-center ${u?"bg-yellow-100 font-semibold":""}`,children:e.jsx("span",{className:"text-xs text-gray-900",children:String(r||"")})},i)})},g)})})]})})})]})}),e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"형상 이미지 업로드"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"각 품목에 해당하는 형상 이미지를 업로드해주세요. (JPG, PNG, PDF 파일 지원)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.slice(6,22).map((s,a)=>{const g=s[0]?.displayValue||s[0]?.value||"",u=s[1]?.displayValue||s[1]?.value||"";return a===16||String(u).trim()===""?null:e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs(ne,{variant:"outline",className:"text-xs",children:["No. ",typeof g=="number"?Math.round(g):g||a+1]})}),e.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",title:String(u),children:String(u)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{type:"file",accept:".jpg,.jpeg,.png,.pdf",onChange:v=>{const i=v.target.files?.[0]||null;i&&z(D=>({...D,[a]:i}))},className:"text-xs h-8"}),C[a]&&e.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-2 rounded text-xs",children:[e.jsx("span",{className:"text-green-700 truncate",children:C[a]?.name}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>{z(v=>{const i={...v};return delete i[a],i})},className:"h-6 w-6 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(xe,{className:"h-3 w-3"})})]})]})]},a)})})]})]})})]}),d.length===0&&e.jsx(y,{className:"border-dashed border-2 border-gray-300 hover:border-blue-400 transition-colors",children:e.jsxs(b,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx($,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 text-center mb-2 font-medium",children:"엑셀 파일을 업로드하면 여기에 스프레드시트가 표시됩니다"}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"수식 지원: =A1+B1, =SUM(A1:A5), =B2*C2 등"})]})}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsxs(o,{onClick:Le,size:"lg",className:"flex items-center gap-2 px-8 h-12 text-base font-medium",disabled:!m||d.length===0,children:[e.jsx(oe,{className:"h-5 w-5"}),"저장하고 다음 단계로",e.jsx(Ke,{className:"h-5 w-5"})]})})]})}export{ds as default};
