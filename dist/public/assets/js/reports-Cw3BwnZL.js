import{w as We,r as g,l as Xe,j as e,F as ie,B as K,q as U,G as B,H,s as _,g as Re,o as Y,L,c as Ze,d as Je,u as et,C as Fe,I as le,at as tt,E as st}from"./index-CQbR3lO6.js";import{S as P,a as O,b as M,c as V,d}from"./select-vooeNxXj.js";import{D as rt,a as at,b as nt,c as lt}from"./dialog-BWdxtXl6.js";import{T as ue}from"./textarea-Hz38-iYv.js";import{C as E}from"./checkbox-B1klXRZ3.js";import{h as ot,E as it}from"./html2canvas.esm-CkWSSHMH.js";import{D as ct}from"./download-DN3CoiA2.js";import{R as pe,P as dt,b as xt,c as mt,T as oe,B as je,C as be,X as ve,Y as Ne,L as fe,a as $e}from"./PieChart-BlLk_7M9.js";import{a as b}from"./formatters-gd6aBVnV.js";import{F as ht}from"./filter-BQWmtxHS.js";import{S as gt}from"./search-Covtsv9_.js";import{A as Ce,a as we}from"./arrow-up-C9bPdDcj.js";import"./index-CIw35hCR.js";import"./chevron-down-MieLMIOv.js";import"./chevron-up-DpL2Rzvz.js";import"./index-CqO6ZkTU.js";import"./index-DOP5yldm.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=We("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);function yt({config:u,orders:j,onClose:f}){const y=g.useRef(null),G=j.reduce((c,m)=>{const o=parseFloat(m.totalAmount)||0;return c+o},0),D=G/j.length,s=Object.entries(j.reduce((c,m)=>{const o=Xe(m.status);return c[o]=(c[o]||0)+1,c},{})).map(([c,m])=>({name:c,value:m})),x=Object.entries(j.reduce((c,m)=>{const o=new Date(m.orderDate).toLocaleDateString("ko-KR",{year:"numeric",month:"long"});return c[o]=(c[o]||0)+1,c},{})).map(([c,m])=>({month:c,orders:m})),F=Object.entries(j.reduce((c,m)=>{const o=m.vendor?.name||"알 수 없음";return c[o]=(c[o]||0)+1,c},{})).sort(([,c],[,m])=>m-c).slice(0,10).map(([c,m])=>({name:c,orders:m})),A=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],ae=async()=>{if(y.current)try{const c=await ot(y.current,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"}),m=c.toDataURL("image/png"),o=new it("p","mm","a4"),k=210,a=295,Q=c.height*k/c.width;let v=Q,se=0;for(o.addImage(m,"PNG",0,se,k,Q),v-=a;v>=0;)se=v-Q,o.addPage(),o.addImage(m,"PNG",0,se,k,Q),v-=a;const C=`${u.title.replace(/[^a-zA-Z0-9가-힣]/g,"_")}.pdf`;o.save(C)}catch(c){console.error("PDF 생성 실패:",c)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-[1366px] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"보고서 미리보기"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{onClick:ae,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"PDF 다운로드"]}),e.jsx(K,{variant:"outline",onClick:f,children:"닫기"})]})]}),e.jsxs("div",{ref:y,className:"p-8 bg-white",style:{minHeight:"297mm"},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:u.title}),e.jsxs("p",{className:"text-gray-600",children:["생성일: ",new Date().toLocaleDateString("ko-KR")]}),e.jsxs("p",{className:"text-gray-600",children:["분석 데이터: ",j.length,"건"]})]}),e.jsxs(U,{className:"mb-6",children:[e.jsx(B,{children:e.jsx(H,{children:"요약 정보"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"총 발주 건수"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["₩",Math.floor(G).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"총 발주 금액"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["₩",Math.floor(D).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"평균 발주 금액"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:F.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"거래처 수"})]})]})})]}),u.summary&&e.jsxs(U,{className:"mb-6",children:[e.jsx(B,{children:e.jsx(H,{children:"분석 요약"})}),e.jsx(_,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:u.summary})})]}),e.jsxs("div",{className:"space-y-6",children:[u.includeCharts.statusDistribution&&e.jsxs(U,{children:[e.jsx(B,{children:e.jsx(H,{children:"발주 상태별 분포"})}),e.jsx(_,{children:e.jsx(pe,{width:"100%",height:300,children:u.chartTypes.statusDistribution==="pie"?e.jsxs(dt,{children:[e.jsx(xt,{data:s,cx:"50%",cy:"50%",labelLine:!1,label:({name:c,value:m,percent:o})=>`${c}: ${m}건 (${(o*100).toFixed(1)}%)`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:s.map((c,m)=>e.jsx(mt,{fill:A[m%A.length]},`cell-${m}`))}),e.jsx(oe,{})]}):e.jsxs(je,{data:s,children:[e.jsx(be,{strokeDasharray:"3 3"}),e.jsx(ve,{dataKey:"name"}),e.jsx(Ne,{}),e.jsx(oe,{}),e.jsx(fe,{}),e.jsx($e,{dataKey:"value",fill:"#8884d8"})]})})})]}),u.includeCharts.monthlyTrend&&e.jsxs(U,{children:[e.jsx(B,{children:e.jsx(H,{children:"월별 발주 현황"})}),e.jsx(_,{children:e.jsx(pe,{width:"100%",height:300,children:e.jsxs(je,{data:x,children:[e.jsx(be,{strokeDasharray:"3 3"}),e.jsx(ve,{dataKey:"month"}),e.jsx(Ne,{}),e.jsx(oe,{}),e.jsx(fe,{}),e.jsx($e,{dataKey:"orders",fill:"#82ca9d"})]})})})]}),u.includeCharts.vendorAnalysis&&e.jsxs(U,{children:[e.jsx(B,{children:e.jsx(H,{children:"거래처별 발주 현황 (상위 10개)"})}),e.jsx(_,{children:u.chartTypes.vendorAnalysis==="table"?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"거래처명"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"발주 건수"})]})}),e.jsx("tbody",{children:F.map((c,m)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border border-gray-200 px-4 py-2",children:c.name}),e.jsxs("td",{className:"border border-gray-200 px-4 py-2 text-center",children:[c.orders,"건"]})]},m))})]})}):e.jsx(pe,{width:"100%",height:300,children:e.jsxs(je,{data:F,layout:u.chartTypes.vendorAnalysis==="horizontal"?"horizontal":"vertical",children:[e.jsx(be,{strokeDasharray:"3 3"}),e.jsx(ve,{dataKey:u.chartTypes.vendorAnalysis==="horizontal"?"orders":"name"}),e.jsx(Ne,{dataKey:u.chartTypes.vendorAnalysis==="horizontal"?"name":void 0}),e.jsx(oe,{}),e.jsx(fe,{}),e.jsx($e,{dataKey:"orders",fill:"#ffc658"})]})})})]})]}),u.insights&&e.jsxs(U,{className:"mt-6",children:[e.jsx(B,{children:e.jsx(H,{children:"주요 인사이트"})}),e.jsx(_,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:u.insights})})]}),u.comments&&e.jsxs(U,{className:"mt-6",children:[e.jsx(B,{children:e.jsx(H,{children:"추가 코멘트"})}),e.jsx(_,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:u.comments})})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t text-center text-xs text-gray-500",children:[e.jsx("p",{children:"본 보고서는 발주 관리 시스템에서 자동 생성되었습니다."}),e.jsxs("p",{children:["생성 시간: ",new Date().toLocaleString("ko-KR")]})]})]})]})})}function ut({onFilterChange:u}){const{theme:j}=Re(),f=j==="dark",[y,G]=g.useState("all"),[D,s]=g.useState("all"),[x,F]=g.useState("all"),{data:A}=Y({queryKey:["/api/categories/used-in-orders"],queryFn:async()=>{const o=await fetch("/api/categories/used-in-orders");if(!o.ok)throw new Error("Failed to fetch used categories");return o.json()}}),ae=A?[...new Set(A.map(o=>o.majorCategory))].filter(Boolean):[],c=y!=="all"&&A?[...new Set(A.filter(o=>o.majorCategory===y).map(o=>o.middleCategory))].filter(Boolean):[],m=D!=="all"&&A?[...new Set(A.filter(o=>o.majorCategory===y&&o.middleCategory===D).map(o=>o.minorCategory))].filter(Boolean):[];return g.useEffect(()=>{s("all"),F("all")},[y]),g.useEffect(()=>{F("all")},[D]),g.useEffect(()=>{u({majorCategory:y,middleCategory:D,minorCategory:x})},[y,D,x,u]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded-lg border transition-colors ${f?"bg-blue-900/20 border-blue-700 text-blue-200":"bg-blue-50 border-blue-200 text-blue-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-xs font-medium",children:"실제 발주에 사용된 분류만 표시됩니다"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{className:`text-sm font-medium transition-colors ${f?"text-gray-300":"text-gray-700"}`,children:"대분류"}),e.jsxs(P,{value:y,onValueChange:G,children:[e.jsx(O,{className:`transition-colors ${f?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"대분류 선택"})}),e.jsxs(V,{className:`transition-colors ${f?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 대분류"}),ae.map(o=>e.jsx(d,{value:o,children:o},o))]})]})]}),y!=="all"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{className:`text-sm font-medium transition-colors ${f?"text-gray-300":"text-gray-700"}`,children:"중분류"}),e.jsxs(P,{value:D,onValueChange:s,children:[e.jsx(O,{className:`transition-colors ${f?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"중분류 선택"})}),e.jsxs(V,{className:`transition-colors ${f?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 중분류"}),c.map(o=>e.jsx(d,{value:o,children:o},o))]})]})]}),D!=="all"&&y!=="all"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{className:`text-sm font-medium transition-colors ${f?"text-gray-300":"text-gray-700"}`,children:"소분류"}),e.jsxs(P,{value:x,onValueChange:F,children:[e.jsx(O,{className:`transition-colors ${f?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{placeholder:"소분류 선택"})}),e.jsxs(V,{className:`transition-colors ${f?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 소분류"}),m.map(o=>e.jsx(d,{value:o,children:o},o))]})]})]}),e.jsxs("div",{className:`text-sm p-3 rounded-lg ${f?"bg-gray-800 text-gray-300":"bg-gray-50 text-gray-600"}`,children:[e.jsx("span",{className:"font-medium",children:"선택된 분류: "}),y==="all"?"전체":e.jsxs(e.Fragment,{children:[y,D!=="all"&&` → ${D}`,x!=="all"&&` → ${x}`]})]})]})}function Lt(){const{user:u,isAuthenticated:j,isLoading:f}=Ze(),{toast:y}=Je(),[,G]=et(),{theme:D}=Re(),s=D==="dark",[x,F]=g.useState("orders"),[A,ae]=g.useState("major"),[c,m]=g.useState({majorCategory:"all",middleCategory:"all",minorCategory:"all"}),[o,k]=g.useState({year:"all",startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all",search:"",month:"all",projectId:"all"}),[a,Q]=g.useState(null),[v,se]=g.useState(null),[C,Te]=g.useState(null),[q,ce]=g.useState(new Set),[de,xe]=g.useState(new Set),[me,he]=g.useState(new Set),[ge,ye]=g.useState(new Set),[Le,re]=g.useState(!1),[Pe,Se]=g.useState(!1),[Oe,Me]=g.useState([]),[$,I]=g.useState({title:"",includeCharts:{statusDistribution:!0,monthlyTrend:!0,vendorAnalysis:!0,amountAnalysis:!1},chartTypes:{statusDistribution:"pie",monthlyTrend:"bar",vendorAnalysis:"bar",amountAnalysis:"bar"},summary:"",insights:"",comments:""}),[w,Ve]=g.useState(null),W=t=>{let r="asc";v&&v.key===t&&v.direction==="asc"&&(r="desc"),se({key:t,direction:r})},Ee=t=>!v||!t?t:[...t].sort((r,n)=>{let l=r[v.key],i=n[v.key];return["orderCount","vendorCount","totalAmount","averageOrderAmount"].includes(v.key)?(l=Number(l)||0,i=Number(i)||0):["projectName","projectCode","projectStatus"].includes(v.key)&&(l=String(l||"").toLowerCase(),i=String(i||"").toLowerCase()),l<i?v.direction==="asc"?-1:1:l>i?v.direction==="asc"?1:-1:0}),X=t=>!v||v.key!==t?e.jsx(ke,{className:"h-4 w-4 text-gray-400"}):v.direction==="asc"?e.jsx(Ce,{className:"h-4 w-4 text-blue-600"}):e.jsx(we,{className:"h-4 w-4 text-blue-600"}),Z=t=>{let r="asc";C&&C.key===t&&C.direction==="asc"&&(r="desc"),Te({key:t,direction:r})},Ke=t=>!C||!t?t:[...t].sort((r,n)=>{let l=r[C.key],i=n[C.key];return["orderCount","projectCount","totalAmount","averageOrderAmount"].includes(C.key)?(l=Number(l)||0,i=Number(i)||0):["vendorName","vendorCode","businessNumber"].includes(C.key)&&(l=String(l||"").toLowerCase(),i=String(i||"").toLowerCase()),l<i?C.direction==="asc"?-1:1:l>i?C.direction==="asc"?1:-1:0}),J=t=>!C||C.key!==t?e.jsx(ke,{className:"h-4 w-4 text-gray-400"}):C.direction==="asc"?e.jsx(Ce,{className:"h-4 w-4 text-blue-600"}):e.jsx(we,{className:"h-4 w-4 text-blue-600"}),ee=t=>{let r="asc";w&&w.key===t&&w.direction==="asc"&&(r="desc"),Ve({key:t,direction:r})},Ue=t=>w?[...t].sort((r,n)=>{let l=r[w.key],i=n[w.key];return w.key==="vendor"?(l=r.vendor?.name||"",i=n.vendor?.name||""):w.key==="user"?(l=r.user?`${r.user.lastName||""} ${r.user.firstName||""}`.trim():"",i=n.user?`${n.user.lastName||""} ${n.user.firstName||""}`.trim():""):w.key==="orderDate"?(l=new Date(l||0),i=new Date(i||0)):w.key==="totalAmount"&&(l=Number(l)||0,i=Number(i)||0),l<i?w.direction==="asc"?-1:1:l>i?w.direction==="asc"?1:-1:0}):t,te=t=>!w||w.key!==t?e.jsx(ke,{className:"h-4 w-4 text-gray-400"}):w.direction==="asc"?e.jsx(Ce,{className:"h-4 w-4 text-blue-600"}):e.jsx(we,{className:"h-4 w-4 text-blue-600"}),qe=(t,r)=>{if(t){const n=new Set(r.map(l=>l.id));ce(n)}else ce(new Set)},ze=(t,r)=>{const n=new Set(q);r?n.add(t):n.delete(t),ce(n)},Be=t=>t.length>0&&t.every(r=>q.has(r.id)),He=t=>{const r=t.filter(n=>q.has(n.id)).length;return r>0&&r<t.length},_e=()=>{const t=h?.orders?.filter(n=>q.has(n.id))||[],r=`발주 현황 보고서 (${t.length}건) - ${new Date().toLocaleDateString("ko-KR")}`;I(n=>({...n,title:r,summary:Ge(t)})),re(!0)},Ge=t=>{if(t.length===0)return"";const r=t.reduce((N,T)=>{const ne=parseFloat(T.totalAmount)||0;return N+ne},0),n=r/t.length,l=t.reduce((N,T)=>(N[T.status]=(N[T.status]||0)+1,N),{}),i=Object.entries(t.reduce((N,T)=>{const ne=T.vendor?.name||"알 수 없음";return N[ne]=(N[ne]||0)+1,N},{})).sort(([,N],[,T])=>T-N).slice(0,3),R=N=>{switch(N){case"draft":return"임시 저장";case"pending":return"승인 대기";case"approved":return"승인 완료";case"sent":return"발송됨";case"completed":return"발주 완료";case"rejected":return"반려";default:return N}};return`총 ${t.length}건의 발주 데이터를 분석한 결과:
• 총 발주 금액: ₩${Math.floor(r).toLocaleString()}
• 평균 발주 금액: ₩${Math.floor(n).toLocaleString()}
• 주요 거래처: ${i.map(([N,T])=>`${N}(${T}건)`).join(", ")}
• 상태 분포: ${Object.entries(l).map(([N,T])=>`${R(N)}(${T}건)`).join(", ")}`},Ye=async()=>{try{const t=h?.orders?.filter(r=>q.has(r.id))||[];Me(t),re(!1),Se(!0)}catch{y({title:"오류",description:"보고서 생성에 실패했습니다.",variant:"destructive"})}};g.useEffect(()=>{if(!f&&!j){y({title:"권한 없음",description:"로그아웃되었습니다. 다시 로그인합니다...",variant:"destructive"}),setTimeout(()=>{G("/login")},500);return}},[j,f,y]);const{data:De}=Y({queryKey:["/api/vendors"],enabled:j}),{data:Ae}=Y({queryKey:["/api/users"],enabled:j}),{data:h,isLoading:Ie}=Y({queryKey:["/api/reports/processing",a],queryFn:async()=>{if(!a)return{orders:[],total:0};const t=new URLSearchParams;a.year&&a.year!=="all"&&t.append("year",a.year),a.startDate&&t.append("startDate",a.startDate),a.endDate&&t.append("endDate",a.endDate),a.vendorId&&a.vendorId!=="all"&&t.append("vendorId",a.vendorId),a.status&&a.status!=="all"&&t.append("status",a.status),a.projectId&&a.projectId!=="all"&&t.append("projectId",a.projectId),a.month&&a.month!=="all"&&t.append("month",a.month),a.search&&t.append("search",a.search),t.append("limit","1000");const r=await fetch(`/api/reports/processing?${t.toString()}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()},enabled:j&&!!a&&x==="orders"});Y({queryKey:["/api/reports/summary",a?.startDate,a?.endDate],queryFn:async()=>{const t=new URLSearchParams;a?.startDate&&t.append("startDate",a.startDate),a?.endDate&&t.append("endDate",a.endDate);const r=await fetch(`/api/reports/summary?${t.toString()}`);if(!r.ok)throw new Error("Failed to fetch summary report");return r.json()},enabled:j&&!!a});const{data:z}=Y({queryKey:["/api/reports/by-category",a?.startDate,a?.endDate,c],queryFn:async()=>{const t=new URLSearchParams;a?.startDate&&t.append("startDate",a.startDate),a?.endDate&&t.append("endDate",a.endDate),c.majorCategory!=="all"&&t.append("majorCategory",c.majorCategory),c.middleCategory!=="all"&&t.append("middleCategory",c.middleCategory),c.minorCategory!=="all"&&t.append("minorCategory",c.minorCategory);const r=await fetch(`/api/reports/by-category?${t.toString()}`);if(!r.ok)throw new Error("Failed to fetch category report");return r.json()},enabled:j&&!!a&&x==="category"}),{data:S}=Y({queryKey:["/api/reports/by-project",a?.startDate,a?.endDate],queryFn:async()=>{const t=new URLSearchParams;a?.startDate&&t.append("startDate",a.startDate),a?.endDate&&t.append("endDate",a.endDate);const r=await fetch(`/api/reports/by-project?${t.toString()}`);if(!r.ok)throw new Error("Failed to fetch project report");return r.json()},enabled:j&&!!a&&x==="project"}),{data:p}=Y({queryKey:["/api/reports/by-vendor",a?.startDate,a?.endDate],queryFn:async()=>{const t=new URLSearchParams;a?.startDate&&t.append("startDate",a.startDate),a?.endDate&&t.append("endDate",a.endDate);const r=await fetch(`/api/reports/by-vendor?${t.toString()}`);if(!r.ok)throw new Error("Failed to fetch vendor report");return r.json()},enabled:j&&!!a&&x==="vendor"}),Qe=async()=>{try{const t=new URLSearchParams;if(x==="orders"){const r=new URLSearchParams;a?.startDate&&r.append("startDate",a.startDate),a?.endDate&&r.append("endDate",a.endDate);const n=await fetch(`/api/reports/export-excel?type=processing&${r.toString()}`);if(!n.ok)throw new Error("Export failed");const l=await n.blob(),i=window.URL.createObjectURL(l),R=document.createElement("a");R.style.display="none",R.href=i,R.download=`orders_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(R),R.click(),window.URL.revokeObjectURL(i)}else{t.append("type",x),a?.startDate&&t.append("startDate",a.startDate),a?.endDate&&t.append("endDate",a.endDate),x==="category"&&t.append("categoryType",A);const r=await fetch(`/api/reports/export-excel?${t.toString()}`);if(!r.ok)throw new Error("Export failed");const n=await r.blob(),l=window.URL.createObjectURL(n),i=document.createElement("a");i.style.display="none",i.href=l,i.download=`${x}_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(l)}y({title:"성공",description:"Excel 파일이 다운로드되었습니다."})}catch{y({title:"오류",description:"Excel 내보내기에 실패했습니다.",variant:"destructive"})}};return f?e.jsx("div",{className:"p-6 space-y-6",style:{backgroundColor:s?"#111827":"#f9fafb"},children:e.jsx("div",{className:"animate-pulse text-lg",style:{color:s?"#d1d5db":"#374151"},children:"로딩 중..."})}):e.jsx("div",{className:"min-h-screen",style:{backgroundColor:s?"#111827":"#f9fafb"},children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fe,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${s?"text-white":"text-gray-900"}`,children:"보고서 및 분석"}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"발주 현황 및 통계를 확인하고 보고서를 생성하세요"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(K,{onClick:()=>re(!0),variant:"default",className:"gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"보고서 생성"]})})]}),e.jsx(U,{className:`shadow-sm transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:`border-b transition-colors ${s?"border-gray-600":"border-gray-200"}`,children:e.jsxs("nav",{className:"-mb-px flex",children:[e.jsx("button",{onClick:()=>F("orders"),className:`py-2 px-6 text-sm font-medium border-b-2 transition-colors ${x==="orders"?"border-blue-600 text-blue-600":s?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"발주 내역 검색"}),e.jsx("button",{onClick:()=>F("category"),className:`py-2 px-6 text-sm font-medium border-b-2 transition-colors ${x==="category"?"border-blue-600 text-blue-600":s?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"분류별 보고서"}),e.jsx("button",{onClick:()=>F("project"),className:`py-2 px-6 text-sm font-medium border-b-2 transition-colors ${x==="project"?"border-blue-600 text-blue-600":s?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"현장별 보고서"}),e.jsx("button",{onClick:()=>F("vendor"),className:`py-2 px-6 text-sm font-medium border-b-2 transition-colors ${x==="vendor"?"border-blue-600 text-blue-600":s?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"거래처별 보고서"})]})})}),e.jsxs(U,{className:`shadow-sm transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(B,{className:"pb-3",children:e.jsxs(H,{className:`text-lg font-semibold flex items-center gap-2 transition-colors ${s?"text-white":"text-gray-900"}`,children:[e.jsx(ht,{className:"h-5 w-5 text-blue-600"}),"필터 조건"]})}),e.jsxs(_,{className:"pt-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4",children:[(x==="orders"||x==="category"||x==="project"||x==="vendor")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"시작일"}),e.jsx(le,{type:"date",value:o.startDate,onChange:t=>k(r=>({...r,startDate:t.target.value})),className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"종료일"}),e.jsx(le,{type:"date",value:o.endDate,onChange:t=>k(r=>({...r,endDate:t.target.value})),className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})]})]}),x==="category"&&e.jsx(ut,{onFilterChange:m}),x==="orders"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"연도"}),e.jsxs(P,{value:o.year,onValueChange:t=>k(r=>({...r,year:t})),children:[e.jsx(O,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{})}),e.jsxs(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 연도"}),e.jsx(d,{value:"2025",children:"2025년"}),e.jsx(d,{value:"2024",children:"2024년"}),e.jsx(d,{value:"2023",children:"2023년"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"거래처"}),e.jsxs(P,{value:o.vendorId,onValueChange:t=>k(r=>({...r,vendorId:t})),children:[e.jsx(O,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{})}),e.jsxs(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 거래처"}),Array.isArray(De)&&De.map(t=>e.jsx(d,{value:t.id.toString(),children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"발주 상태"}),e.jsxs(P,{value:o.status,onValueChange:t=>k(r=>({...r,status:t})),children:[e.jsx(O,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{})}),e.jsxs(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 상태"}),e.jsx(d,{value:"draft",children:"임시 저장"}),e.jsx(d,{value:"pending",children:"승인 대기"}),e.jsx(d,{value:"approved",children:"승인 완료"}),e.jsx(d,{value:"sent",children:"발송됨"}),e.jsx(d,{value:"completed",children:"발주 완료"}),e.jsx(d,{value:"rejected",children:"반려"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"금액 범위"}),e.jsxs(P,{value:o.amountRange,onValueChange:t=>k(r=>({...r,amountRange:t})),children:[e.jsx(O,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{})}),e.jsxs(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 금액"}),e.jsx(d,{value:"0-100000",children:"10만원 이하"}),e.jsx(d,{value:"100000-500000",children:"10만원 ~ 50만원"}),e.jsx(d,{value:"500000-1000000",children:"50만원 ~ 100만원"}),e.jsx(d,{value:"1000000-5000000",children:"100만원 ~ 500만원"}),e.jsx(d,{value:"5000000-99999999",children:"500만원 이상"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"담당자"}),e.jsxs(P,{value:o.userId,onValueChange:t=>k(r=>({...r,userId:t})),children:[e.jsx(O,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(M,{})}),e.jsxs(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(d,{value:"all",children:"전체 담당자"}),Array.isArray(Ae)&&Ae.map(t=>e.jsxs(d,{value:t.id,children:[t.firstName," ",t.lastName]},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"검색어"}),e.jsx(le,{type:"text",placeholder:"발주번호, 거래처명, 현장명, 메모로 검색...",value:o.search,onChange:t=>k(r=>({...r,search:t.target.value})),className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100 placeholder-gray-400":"bg-white border-gray-300 placeholder-gray-500"}`})]})]})]}),a&&Object.values(a).some(t=>t!=="all"&&t!=="")&&e.jsx("div",{className:`mt-4 p-3 rounded-lg transition-colors ${s?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-sm transition-colors ${s?"text-gray-300":"text-gray-600"}`,children:[e.jsx("span",{className:"font-medium",children:"적용된 필터: "}),a.year!==new Date().getFullYear().toString()&&e.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:["연도: ",a.year,"년"]}),a.startDate&&e.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:["시작일: ",a.startDate]}),a.endDate&&e.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:["종료일: ",a.endDate]}),a.vendorId!=="all"&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:"거래처 필터링"}),a.status!=="all"&&e.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:["상태: ",a.status==="pending"?"승인 대기":a.status==="approved"?"승인 완료":a.status==="completed"?"발주 완료":"반려"]}),a.templateId!=="all"&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:"템플릿 필터링"}),a.amountRange!=="all"&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:"금액 범위 필터링"}),a.userId!=="all"&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:"담당자 필터링"}),a.search&&e.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs mr-2 transition-colors ${s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:['검색어: "',a.search,'"']})]}),e.jsx(K,{variant:"outline",size:"sm",onClick:()=>{const t={year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all",search:"",month:"all",projectId:"all"};k(t),Q(t)},className:"text-gray-600 hover:text-gray-800",children:"필터 초기화"})]})}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",onClick:()=>{const t={year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"};k(t)},className:"text-gray-600 hover:text-gray-800",children:"초기화"}),e.jsx(K,{onClick:()=>{Q(o)},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"검색"})]})]})]}),e.jsxs(U,{className:`shadow-sm transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(B,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(H,{className:`text-lg font-semibold flex items-center gap-2 transition-colors ${s?"text-white":"text-gray-900"}`,children:[e.jsx(gt,{className:"h-5 w-5 text-blue-600"}),x==="orders"?"검색 결과":x==="category"?"분류별 보고서 결과":x==="project"?"현장별 보고서 결과":"거래처별 보고서 결과"]}),e.jsx("p",{className:`text-sm transition-colors mt-1 ${s?"text-gray-400":"text-gray-600"}`,children:x==="orders"?Ie?"데이터 로딩 중...":h&&h.orders?`총 ${h.orders.length}건의 발주 데이터`:"검색된 데이터가 없습니다":"필터를 설정하고 검색 버튼을 클릭하세요"})]}),e.jsxs("div",{className:"flex gap-2",children:[x==="orders"&&e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>_e(),disabled:q.size===0,className:"bg-green-600 hover:bg-green-700 text-white disabled:bg-gray-300",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"보고서 생성 (",q.size,"건)"]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>Qe(),className:"gap-2",children:[e.jsx(tt,{className:"h-4 w-4"}),"Excel 내보내기"]})]})]})}),e.jsx(_,{children:a?e.jsxs(e.Fragment,{children:[x==="orders"&&(Ie?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:`transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:"데이터를 불러오는 중..."})}):h&&Array.isArray(h.orders)&&h.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:(()=>{h.orders.reduce((n,l)=>(n[l.status]=(n[l.status]||0)+1,n),{});const t=h.orders.reduce((n,l)=>{const i=parseFloat(l.totalAmount)||0;return n+i},0),r=h.orders.length>0?t/h.orders.length:0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:h.orders.length}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"총 발주"})]}),e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-blue-900/30":"bg-blue-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold font-semibold transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:b(Math.floor(t))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:"총 발주금액"})]}),e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-purple-900/30":"bg-purple-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold font-semibold transition-colors ${s?"text-purple-400":"text-blue-600"}`,children:b(Math.floor(r))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-purple-400":"text-purple-600"}`,children:"평균 발주금액"})]})]})})()}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:(()=>{const t=h.orders.reduce((r,n)=>(r[n.status]=(r[n.status]||0)+1,r),{});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-yellow-900/30":"bg-yellow-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-yellow-400":"text-yellow-700"}`,children:t.pending||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-yellow-400":"text-yellow-600"}`,children:"승인 대기"})]}),e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-blue-900/30":"bg-blue-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-blue-400":"text-blue-700"}`,children:t.approved||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:"승인 완료"})]}),e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-green-900/30":"bg-green-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-green-400":"text-green-700"}`,children:t.completed||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-green-400":"text-green-600"}`,children:"발주 완료"})]}),e.jsxs("div",{className:`p-2 rounded-lg text-center transition-colors ${s?"bg-red-900/30":"bg-red-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-red-400":"text-red-700"}`,children:t.rejected||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-red-400":"text-red-600"}`,children:"반려"})]})]})})()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${s?"border-gray-600 bg-gray-700":"border-gray-200 bg-gray-50"}`,children:[e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:e.jsx("input",{type:"checkbox",className:"rounded",checked:Be(h.orders||[]),ref:t=>{t&&(t.indeterminate=He(h.orders||[]))},onChange:t=>qe(t.target.checked,h.orders||[])})}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>ee("orderNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["발주번호",te("orderNumber")]})}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>ee("vendor"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["거래처",te("vendor")]})}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"품목"}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>ee("orderDate"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["발주일자",te("orderDate")]})}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>ee("totalAmount"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["총금액",te("totalAmount")]})}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>ee("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["상태",te("status")]})}),e.jsx("th",{className:`text-left py-3 px-4 text-sm font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>ee("user"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["작성자",te("user")]})})]})}),e.jsx("tbody",{children:Ue(h.orders).map(t=>e.jsxs("tr",{className:`border-b transition-colors ${s?"hover:bg-gray-700 border-gray-600":"hover:bg-gray-50 border-gray-200"}`,children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:q.has(t.id),onChange:r=>ze(t.id,r.target.checked)})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("button",{onClick:()=>G(`/order-preview/${t.id}`),className:`transition-colors hover:underline cursor-pointer ${s?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,children:t.orderNumber})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:t.vendorName?e.jsx("button",{onClick:()=>G(`/vendors/${t.vendorId}`),className:`transition-colors hover:underline cursor-pointer ${s?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,children:t.vendorName}):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:t.items&&t.items.length>0?e.jsxs("div",{className:"space-y-1",children:[t.items.slice(0,2).map((r,n)=>e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:`font-medium transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:r.itemName||r.name||"품목명 없음"}),e.jsxs("div",{className:"text-xs mt-1",children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:r.majorCategory||"미분류"}),r.middleCategory&&e.jsxs("span",{className:`transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[" > ",r.middleCategory]}),r.minorCategory&&e.jsxs("span",{className:`transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:[" > ",r.minorCategory]})]})]},n)),t.items.length>2&&e.jsxs("div",{className:`text-xs transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:["외 ",t.items.length-2,"개 품목"]})]}):"-"}),e.jsx("td",{className:`py-3 px-4 text-sm transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.orderDate?new Date(t.orderDate).toLocaleDateString("ko-KR"):"-"}),e.jsx("td",{className:`py-3 px-4 text-sm font-semibold transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:t.totalAmount?b(Math.floor(t.totalAmount)):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="draft"?s?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800":t.status==="pending"?s?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-800":t.status==="approved"?s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800":t.status==="sent"?s?"bg-purple-900/30 text-purple-400":"bg-purple-100 text-purple-800":t.status==="completed"?s?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800":t.status==="rejected"?s?"bg-red-900/30 text-red-400":"bg-red-100 text-red-800":s?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}`,children:t.status==="draft"?"임시 저장":t.status==="pending"?"승인 대기":t.status==="approved"?"진행 중":t.status==="sent"?"발송됨":t.status==="completed"?"완료":t.status==="rejected"?"반려":t.status})}),e.jsx("td",{className:`py-3 px-4 text-sm transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.userName||(t.userLastName||t.userFirstName?`${t.userLastName||""} ${t.userFirstName||""}`.trim():"-")})]},t.id))}),e.jsxs("tfoot",{children:[(()=>{const t=h.orders.reduce((r,n)=>{const l=parseFloat(n.totalAmount)||0;return r+l},0);return h.orders.length>0&&t/h.orders.length,e.jsxs("tr",{className:`font-medium transition-colors ${s?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm font-medium transition-colors ${s?"border-gray-600 text-gray-300":"border-gray-200"}`,children:"합계"}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`,children:e.jsx("span",{className:`font-bold font-semibold transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:b(Math.floor(t))})}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`})]})})(),(()=>{const t=h.orders.reduce((n,l)=>{const i=parseFloat(l.totalAmount)||0;return n+i},0),r=h.orders.length>0?t/h.orders.length:0;return e.jsxs("tr",{className:`font-medium transition-colors ${s?"bg-gray-600":"bg-gray-50"}`,children:[e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm font-medium transition-colors ${s?"border-gray-600 text-gray-300":"border-gray-200"}`,children:"평균"}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`,children:e.jsx("span",{className:`font-bold font-semibold transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:b(Math.floor(r))})}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`}),e.jsx("td",{className:`border px-3 py-2 text-sm transition-colors ${s?"border-gray-600":"border-gray-200"}`})]})})()]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:"검색 조건에 맞는 데이터가 없습니다."}),e.jsx("p",{className:`text-sm mt-2 transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:"필터 조건을 변경하여 다시 검색해보세요."})]})),x==="category"&&(z?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-2 transition-colors ${s?"text-white":"text-gray-900"}`,children:[A==="major"?"대분류별":A==="middle"?"중분류별":"소분류별"," 발주 보고서"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"총 분류 수:"}),e.jsx("span",{className:`ml-2 font-medium transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:z.summary?.totalCategories||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:`transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"총 발주 수:"}),e.jsx("span",{className:`ml-2 font-medium transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:z.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:`transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"총 품목 수:"}),e.jsx("span",{className:`ml-2 font-medium transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:z.summary?.totalItems||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:`transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"총 금액:"}),e.jsx("span",{className:`ml-2 font-medium transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:b(Math.floor(z.summary?.totalAmount||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${s?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("th",{className:`py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:e.jsx(E,{checked:z?.data?.length>0&&z.data.every((t,r)=>de.has(r)),onCheckedChange:t=>{xe(t?new Set(z?.data?.map((r,n)=>n)||[]):new Set)}})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"분류 계층"}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"발주 수"}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"품목 수"}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"총 수량"}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"총 금액"}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"평균 금액"}),e.jsx("th",{className:`text-left py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:"주요 품목"})]})}),e.jsx("tbody",{children:z.data?.map((t,r)=>e.jsxs("tr",{className:`border-b transition-colors ${s?"border-gray-600 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx(E,{checked:de.has(r),onCheckedChange:n=>{const l=new Set(de);n?l.add(r):l.delete(r),xe(l)}})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:`font-medium transition-colors ${s?"text-gray-100":"text-gray-900"}`,children:t.category}),t.hierarchyPath&&t.hierarchyPath!==t.category&&e.jsx("div",{className:`text-xs mt-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:t.hierarchyPath})]})}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.orderCount}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.itemCount}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.totalQuantity?.toLocaleString()}),e.jsx("td",{className:`py-3 px-4 text-right font-medium transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:b(Math.floor(t.totalAmount))}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:b(Math.floor(t.averageAmount))}),e.jsx("td",{className:"py-3 px-4",children:t.topItems&&t.topItems.length>0?e.jsxs("div",{className:"space-y-1",children:[t.topItems.slice(0,3).map((n,l)=>e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:n.itemName}),e.jsxs("span",{className:`ml-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:["(",n.quantity,"개, ",b(Math.floor(n.amount)),")"]})]},l)),t.topItems.length>3&&e.jsxs("div",{className:`text-xs transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:["외 ",t.topItems.length-3,"개 품목"]})]}):e.jsx("span",{className:`text-xs transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:"-"})})]},r))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:"분류별 보고서 데이터를 불러오는 중이거나 데이터가 없습니다."}),e.jsx("p",{className:`text-sm mt-2 transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:"필터 조건을 변경하여 다시 검색해보세요."})]})),x==="project"&&S&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${s?"text-white":"text-gray-900"}`,children:"현장별 발주 보고서"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-blue-900/30":"bg-blue-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:S.summary?.totalProjects||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:"총 프로젝트"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-green-900/30":"bg-green-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-green-400":"text-green-600"}`,children:S.summary?.totalOrders||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-green-400":"text-green-600"}`,children:"총 발주 수"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-purple-900/30":"bg-purple-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-purple-400":"text-purple-600"}`,children:b(Math.floor(S.summary?.totalAmount||0))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-purple-400":"text-purple-600"}`,children:"총 발주금액"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-orange-900/30":"bg-orange-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-orange-400":"text-orange-600"}`,children:b(Math.floor(S.summary?.averagePerProject||0))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-orange-400":"text-orange-600"}`,children:"현장당 평균"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:(()=>{const t=S.data?.reduce((l,i)=>(l[i.projectStatus]=(l[i.projectStatus]||0)+1,l),{})||{},r=S.data?.reduce((l,i)=>l+(i.vendorCount||0),0)||0,n=S.summary?.totalProjects>0?Math.round((S.summary?.totalOrders||0)/S.summary.totalProjects):0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-green-900/30":"bg-green-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-green-400":"text-green-700"}`,children:t.active||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-green-400":"text-green-600"}`,children:"진행중"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-blue-900/30":"bg-blue-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-blue-400":"text-blue-700"}`,children:t.completed||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:"완료"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-indigo-900/30":"bg-indigo-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-indigo-400":"text-indigo-700"}`,children:r}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-indigo-400":"text-indigo-600"}`,children:"총 거래처"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-teal-900/30":"bg-teal-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-teal-400":"text-teal-700"}`,children:n}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-teal-400":"text-teal-600"}`,children:"현장당 발주"})]})]})})()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${s?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("th",{className:`py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:e.jsx(E,{checked:S?.data?.length>0&&S.data.every(t=>me.has(t.projectId)),onCheckedChange:t=>{he(t?new Set(S?.data?.map(r=>r.projectId)||[]):new Set)}})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("projectName"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"현장명"}),X("projectName")]})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("projectCode"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"현장 코드"}),X("projectCode")]})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("projectStatus"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"상태"}),X("projectStatus")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("orderCount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{children:"발주 수"}),X("orderCount")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("vendorCount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{children:"거래처 수"}),X("vendorCount")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("totalAmount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{children:"총 금액"}),X("totalAmount")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium transition-colors cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none ${s?"text-gray-300":"text-gray-900"}`,onClick:()=>W("averageOrderAmount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{children:"평균 금액"}),X("averageOrderAmount")]})})]})}),e.jsx("tbody",{children:Ee(S.data||[])?.map(t=>e.jsxs("tr",{className:`border-b transition-colors ${s?"border-gray-600 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx(E,{checked:me.has(t.projectId),onCheckedChange:r=>{const n=new Set(me);r?n.add(t.projectId):n.delete(t.projectId),he(n)}})}),e.jsx("td",{className:`py-3 px-4 transition-colors ${s?"text-gray-100":"text-gray-900"}`,children:t.projectName}),e.jsx("td",{className:`py-3 px-4 transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.projectCode}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.projectStatus==="active"?s?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800":t.projectStatus==="completed"?s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800":s?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}`,children:t.projectStatus==="active"?"진행중":t.projectStatus==="completed"?"완료":"대기"})}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.orderCount}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:t.vendorCount}),e.jsx("td",{className:`py-3 px-4 text-right font-medium transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:b(Math.floor(t.totalAmount))}),e.jsx("td",{className:`py-3 px-4 text-right transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:b(Math.floor(t.averageOrderAmount))})]},t.projectId))})]})})]}),x==="vendor"&&(p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${s?"text-white":"text-gray-900"}`,children:"거래처별 발주 보고서"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-emerald-900/30":"bg-emerald-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-emerald-400":"text-emerald-600"}`,children:p.summary?.totalVendors||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-emerald-400":"text-emerald-600"}`,children:"총 거래처"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-cyan-900/30":"bg-cyan-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-cyan-400":"text-cyan-600"}`,children:p.summary?.totalOrders||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-cyan-400":"text-cyan-600"}`,children:"총 발주 수"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-rose-900/30":"bg-rose-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-rose-400":"text-rose-600"}`,children:b(Math.floor(p.summary?.totalAmount||0))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-rose-400":"text-rose-600"}`,children:"총 발주금액"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-amber-900/30":"bg-amber-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-amber-400":"text-amber-600"}`,children:b(Math.floor(p.summary?.averagePerVendor||0))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-amber-400":"text-amber-600"}`,children:"거래처당 평균"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:(()=>{const t=p.data?.reduce((i,R)=>i+(R.projectCount||0),0)||0,r=p.summary?.totalVendors>0?Math.round((p.summary?.totalOrders||0)/p.summary.totalVendors):0,n=p.data?.reduce((i,R)=>R.orderCount>(i?.orderCount||0)?R:i,null),l=p.summary?.totalOrders>0?(p.summary?.totalAmount||0)/p.summary.totalOrders:0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-violet-900/30":"bg-violet-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-violet-400":"text-violet-700"}`,children:t}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-violet-400":"text-violet-600"}`,children:"총 프로젝트"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-sky-900/30":"bg-sky-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-sky-400":"text-sky-700"}`,children:r}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-sky-400":"text-sky-600"}`,children:"거래처당 발주"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-lime-900/30":"bg-lime-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-lime-400":"text-lime-700"}`,children:n?.orderCount||0}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-lime-400":"text-lime-600"}`,children:"최다 발주"})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center transition-colors ${s?"bg-pink-900/30":"bg-pink-50"}`,children:[e.jsx("div",{className:`text-2xl font-bold transition-colors ${s?"text-pink-400":"text-pink-700"}`,children:b(Math.floor(l))}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-pink-400":"text-pink-600"}`,children:"평균 발주액"})]})]})})()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${s?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("th",{className:`py-3 px-4 font-medium transition-colors ${s?"text-gray-300":"text-gray-900"}`,children:e.jsx(E,{checked:p?.data?.length>0&&p.data.every(t=>ge.has(t.vendorId)),onCheckedChange:t=>{ye(t?new Set(p?.data?.map(r=>r.vendorId)||[]):new Set)}})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("vendorName"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["거래처명",J("vendorName")]})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("vendorCode"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["거래처 코드",J("vendorCode")]})}),e.jsx("th",{className:`text-left py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("businessNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["사업자번호",J("businessNumber")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("orderCount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["발주 수",J("orderCount")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("projectCount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["프로젝트 수",J("projectCount")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("totalAmount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["총 금액",J("totalAmount")]})}),e.jsx("th",{className:`text-right py-3 px-4 font-medium cursor-pointer select-none transition-colors ${s?"text-gray-300 hover:bg-gray-600":"text-gray-900 hover:bg-gray-100"}`,onClick:()=>Z("averageOrderAmount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["평균 금액",J("averageOrderAmount")]})})]})}),e.jsx("tbody",{children:Ke(p.data||[])?.map(t=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx(E,{checked:ge.has(t.vendorId),onCheckedChange:r=>{const n=new Set(ge);r?n.add(t.vendorId):n.delete(t.vendorId),ye(n)}})}),e.jsx("td",{className:"py-3 px-4",children:t.vendorName}),e.jsx("td",{className:"py-3 px-4",children:t.vendorCode}),e.jsx("td",{className:"py-3 px-4",children:t.businessNumber}),e.jsx("td",{className:"py-3 px-4 text-right",children:t.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:t.projectCount}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:b(Math.floor(t.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:b(Math.floor(t.averageOrderAmount))})]},t.vendorId))})]})}),p.data?.length===1&&p.data[0].topItems?.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-semibold mb-3",children:"주요 발주 품목"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 text-sm",children:"품목명"}),e.jsx("th",{className:"text-right py-2 text-sm",children:"수량"}),e.jsx("th",{className:"text-right py-2 text-sm",children:"금액"})]})}),e.jsx("tbody",{children:p.data[0].topItems.map((t,r)=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-2 text-sm",children:t.itemName}),e.jsx("td",{className:"py-2 text-right text-sm",children:t.quantity}),e.jsx("td",{className:"py-2 text-right text-sm font-medium",children:b(Math.floor(t.amount))})]},r))})]})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500",children:"거래처별 보고서 데이터를 불러오는 중이거나 데이터가 없습니다."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"필터 조건을 변경하여 다시 검색해보세요."})]}))]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:`text-lg mb-2 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:"검색 조건을 설정하고 검색 버튼을 클릭하세요"}),e.jsx("div",{className:`text-sm transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:"효율적인 성능을 위해 검색 필터를 먼저 설정해주세요"})]})})]}),e.jsx(rt,{open:Le,onOpenChange:re,children:e.jsxs(at,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(nt,{children:e.jsxs(lt,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"보고서 생성"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"기본 정보"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"reportTitle",children:"보고서 제목"}),e.jsx(le,{id:"reportTitle",value:$.title,onChange:t=>I(r=>({...r,title:t.target.value})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(L,{children:"선택된 데이터"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["총 ",q.size,"건의 발주 데이터가 선택되었습니다."]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"차트 옵션"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"statusChart",checked:$.includeCharts.statusDistribution,onCheckedChange:t=>I(r=>({...r,includeCharts:{...r.includeCharts,statusDistribution:!!t}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(L,{htmlFor:"statusChart",children:"상태별 분포"}),e.jsx("p",{className:"text-xs text-gray-600",children:"발주 상태별 통계 차트"})]}),$.includeCharts.statusDistribution&&e.jsxs(P,{value:$.chartTypes.statusDistribution,onValueChange:t=>I(r=>({...r,chartTypes:{...r.chartTypes,statusDistribution:t}})),children:[e.jsx(O,{className:"w-24",children:e.jsx(M,{})}),e.jsxs(V,{children:[e.jsx(d,{value:"pie",children:"파이"}),e.jsx(d,{value:"donut",children:"도넛"}),e.jsx(d,{value:"bar",children:"막대"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"monthlyChart",checked:$.includeCharts.monthlyTrend,onCheckedChange:t=>I(r=>({...r,includeCharts:{...r.includeCharts,monthlyTrend:!!t}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(L,{htmlFor:"monthlyChart",children:"월별 현황"}),e.jsx("p",{className:"text-xs text-gray-600",children:"월별 발주 추이 차트"})]}),$.includeCharts.monthlyTrend&&e.jsxs(P,{value:$.chartTypes.monthlyTrend,onValueChange:t=>I(r=>({...r,chartTypes:{...r.chartTypes,monthlyTrend:t}})),children:[e.jsx(O,{className:"w-24",children:e.jsx(M,{})}),e.jsxs(V,{children:[e.jsx(d,{value:"bar",children:"막대"}),e.jsx(d,{value:"line",children:"선형"}),e.jsx(d,{value:"area",children:"영역"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"vendorChart",checked:$.includeCharts.vendorAnalysis,onCheckedChange:t=>I(r=>({...r,includeCharts:{...r.includeCharts,vendorAnalysis:!!t}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(L,{htmlFor:"vendorChart",children:"거래처별 분석"}),e.jsx("p",{className:"text-xs text-gray-600",children:"거래처별 발주 통계"})]}),$.includeCharts.vendorAnalysis&&e.jsxs(P,{value:$.chartTypes.vendorAnalysis,onValueChange:t=>I(r=>({...r,chartTypes:{...r.chartTypes,vendorAnalysis:t}})),children:[e.jsx(O,{className:"w-24",children:e.jsx(M,{})}),e.jsxs(V,{children:[e.jsx(d,{value:"bar",children:"막대"}),e.jsx(d,{value:"horizontal",children:"가로막대"}),e.jsx(d,{value:"table",children:"테이블"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"amountChart",checked:$.includeCharts.amountAnalysis,onCheckedChange:t=>I(r=>({...r,includeCharts:{...r.includeCharts,amountAnalysis:!!t}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(L,{htmlFor:"amountChart",children:"금액별 분석"}),e.jsx("p",{className:"text-xs text-gray-600",children:"발주 금액 분포 차트"})]}),$.includeCharts.amountAnalysis&&e.jsxs(P,{value:$.chartTypes.amountAnalysis,onValueChange:t=>I(r=>({...r,chartTypes:{...r.chartTypes,amountAnalysis:t}})),children:[e.jsx(O,{className:"w-24",children:e.jsx(M,{})}),e.jsxs(V,{children:[e.jsx(d,{value:"bar",children:"막대"}),e.jsx(d,{value:"histogram",children:"히스토그램"}),e.jsx(d,{value:"box",children:"박스플롯"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"보고서 내용"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"summary",children:"자동 생성된 요약"}),e.jsx(ue,{id:"summary",value:$.summary,onChange:t=>I(r=>({...r,summary:t.target.value})),rows:4,className:"mt-1",placeholder:"데이터 기반 자동 요약이 여기에 표시됩니다..."})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"insights",children:"주요 인사이트"}),e.jsx(ue,{id:"insights",value:$.insights,onChange:t=>I(r=>({...r,insights:t.target.value})),rows:3,className:"mt-1",placeholder:"데이터에서 발견한 주요 패턴이나 인사이트를 입력하세요..."})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"comments",children:"추가 코멘트"}),e.jsx(ue,{id:"comments",value:$.comments,onChange:t=>I(r=>({...r,comments:t.target.value})),rows:2,className:"mt-1",placeholder:"추가적인 분석이나 권장사항을 입력하세요..."})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(K,{variant:"outline",onClick:()=>re(!1),children:"취소"}),e.jsxs(K,{onClick:Ye,className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"미리보기 및 생성"]})]})]})]})}),Pe&&e.jsx(yt,{config:$,orders:Oe,onClose:()=>Se(!1)})]})})}export{Lt as default};
