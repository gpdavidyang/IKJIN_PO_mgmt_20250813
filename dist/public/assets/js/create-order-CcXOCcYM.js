import{r as o,j as e,N as re,V as Pe,W as Oe,Z as ne,O as he,_ as ce,B as E,b as ue,i as X,Y as H,U as Fe,s as K,$ as Y,I as G,P as Te,F as J,a0 as x,H as ge,K as pe,o as se,k as te,a1 as Ae,c as Re,u as je,g as _e}from"./index-BWqYeDD5.js";import{OrderForm as Le}from"./order-form-DwMBXdK9.js";import{A as L,a as V}from"./alert-Xf90yClO.js";import{r as ve,u as fe}from"./xlsx-ocdEQCFM.js";import{P as Ve}from"./progress-CuJBwqtM.js";import{C as ie}from"./checkbox-DtVE4gdS.js";import{T as Ue}from"./textarea-CDCPPT8e.js";import{D as Ne,a as ye,b as be,c as we,e as Ee,d as Be}from"./dialog-BmGOAZiI.js";import{M as I}from"./mail-dW7H97kb.js";import{U as qe}from"./users-BY1HUJzs.js";import{P as Me}from"./paperclip-BX0D9rr2.js";import{S as Ke}from"./send-CUm2UvWb.js";import{S as Se}from"./save-BaSMsjT3.js";import{C as xe}from"./calendar-x4g63div.js";import{P as Ce}from"./package-BJSVdKBY.js";import{H as ze}from"./hash-Dzhu56OL.js";import{D as oe}from"./download-Bk5NYGP1.js";import{R as We}from"./refresh-cw-DVoKLmK3.js";import{I as De}from"./info-D_Tuf7xA.js";import{T as He,a as Xe,b as ae,c as le}from"./tabs-D5dmxfta.js";import"./select-B6bfMqsF.js";import"./index-D8359bLC.js";import"./chevron-down-VY0SKtGv.js";import"./chevron-up-DaXVkC7y.js";import"./table-DE-1M3dp.js";import"./authUtils-CcDzk6i0.js";import"./trash-2-BHX5hBPO.js";import"./index-CCD-7skc.js";function Je({onDataParsed:p}){const[N,h]=o.useState(!1),[u,r]=o.useState("idle"),[S,j]=o.useState(""),C=o.useRef(null),b=g=>{if(!g)return;h(!0),r("idle");const m=new FileReader;m.onload=n=>{try{const k=new Uint8Array(n.target?.result),$=ve(k,{type:"array"}),P=$.SheetNames[0],O=$.Sheets[P],w=fe.sheet_to_json(O,{header:1});if(w.length<2)throw new Error("Excel íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");const F=w.slice(1).filter(T=>T&&T.some(R=>R));if(F.length===0)throw new Error("ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");r("success"),j(`${F.length}ê°œì˜ í–‰ì„ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`),p(F)}catch(k){r("error"),j(k instanceof Error?k.message:"íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},m.onerror=()=>{h(!1),r("error"),j("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")},m.readAsArrayBuffer(g)},v=g=>{const m=g.target.files?.[0];m&&b(m)},D=()=>{C.current?.click()};return e.jsxs(re,{className:"w-full",children:[e.jsx(Pe,{children:e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Excel íŒŒì¼ ì—…ë¡œë“œ (ì‹¤í—˜ ê¸°ëŠ¥)"]})}),e.jsx(he,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center border-gray-300 hover:border-gray-400",children:[e.jsx("input",{ref:C,type:"file",accept:".xlsx,.xlsm,.xls,.csv",onChange:v,className:"hidden"}),e.jsx(ce,{className:"h-8 w-8 text-gray-400 mx-auto mb-3"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ í’ˆëª© ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°"}),e.jsx("p",{className:"text-sm text-gray-500",children:".xlsx, .xlsm, .xls, .csv íŒŒì¼ì„ ì§€ì›í•©ë‹ˆë‹¤"})]}),e.jsx(E,{onClick:D,disabled:N,className:"mt-3",variant:"outline",children:N?"ì²˜ë¦¬ ì¤‘...":"íŒŒì¼ ì„ íƒ"})]}),u==="success"&&e.jsxs(L,{children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx(V,{children:S})]}),u==="error"&&e.jsxs(L,{variant:"destructive",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx(V,{children:S})]}),e.jsxs(L,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs(V,{children:[e.jsx("strong",{children:"ì°¸ê³ :"})," ì²« ë²ˆì§¸ í–‰ì€ í—¤ë”ë¡œ ì²˜ë¦¬ë˜ë©°, ë‘ ë²ˆì§¸ í–‰ë¶€í„° ë°ì´í„°ë¡œ ì¸ì‹ë©ë‹ˆë‹¤. í’ˆëª©ëª…, ìˆ˜ëŸ‰, ë‹¨ê°€ ë“±ì˜ ì •ë³´ê°€ í¬í•¨ëœ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”."]})]})]})})]})}function Qe({isOpen:p,onClose:N,onSend:h,orderData:u,initialTo:r=[],initialCc:S=[]}){const[j,C]=o.useState(r),[b,v]=o.useState(S),[D,g]=o.useState(`ë°œì£¼ì„œ: ${u?.projectName||""} - ${u?.vendorName||""}`),[m,n]=o.useState(`ì•ˆë…•í•˜ì„¸ìš”.

${u?.projectName||"[í”„ë¡œì íŠ¸ëª…]"} ê´€ë ¨ ë°œì£¼ì„œë¥¼ ì†¡ë¶€ë“œë¦½ë‹ˆë‹¤.

ë°œì£¼ ë‚´ì—­:
- ê±°ë˜ì²˜: ${u?.vendorName||"[ê±°ë˜ì²˜ëª…]"}
- ë‚©ê¸°ì¼: ${u?.deliveryDate||"[ë‚©ê¸°ì¼]"}
- í’ˆëª©: ${u?.items?.[0]?.itemName||"[í’ˆëª©ëª…]"}
- ìˆ˜ëŸ‰: ${u?.items?.[0]?.quantity||"[ìˆ˜ëŸ‰]"}
- ê¸ˆì•¡: ${((u?.items?.[0]?.quantity||0)*(u?.items?.[0]?.unitPrice||0)).toLocaleString()}ì›

ì²¨ë¶€ëœ ë°œì£¼ì„œë¥¼ í™•ì¸í•˜ì‹œê³  ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.`),[k,$]=o.useState(!0),[P,O]=o.useState(!1),[w,U]=o.useState(""),[F,T]=o.useState(""),[R,z]=o.useState("to"),f=()=>{if(!w){x({title:"ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w)){x({title:"ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤",variant:"destructive"});return}const t={email:w,name:F||void 0};if(R==="to"){if(j.some(l=>l.email===w)){x({title:"ì´ë¯¸ ì¶”ê°€ëœ ìˆ˜ì‹ ìì…ë‹ˆë‹¤",variant:"destructive"});return}C([...j,t])}else{if(b.some(l=>l.email===w)){x({title:"ì´ë¯¸ ì¶”ê°€ëœ ì°¸ì¡°ìì…ë‹ˆë‹¤",variant:"destructive"});return}v([...b,t])}U(""),T("")},_=(s,t)=>{t==="to"?C(j.filter(l=>l.email!==s)):v(b.filter(l=>l.email!==s))},W=()=>{if(j.length===0){x({title:"ìˆ˜ì‹ ìë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”",variant:"destructive"});return}if(!D.trim()){x({title:"ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",variant:"destructive"});return}if(!m.trim()){x({title:"ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",variant:"destructive"});return}h({to:j,cc:b,subject:D,body:m,attachPdf:k,attachExcel:P})};return e.jsx(Ne,{open:p,onOpenChange:N,children:e.jsxs(ye,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(be,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"ì´ë©”ì¼ ì‘ì„±"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsxs(H,{className:"flex items-center gap-2 mb-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"ìˆ˜ì‹ ì (To)"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[j.map(s=>e.jsxs(K,{variant:"secondary",className:"px-2 py-1",children:[s.name&&`${s.name} `,"<",s.email,">",e.jsx("button",{onClick:()=>_(s.email,"to"),className:"ml-2 hover:text-red-600",children:e.jsx(Y,{className:"h-3 w-3"})})]},s.email)),j.length===0&&e.jsx("span",{className:"text-sm text-gray-500",children:"ìˆ˜ì‹ ìë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”"})]})]}),e.jsxs("div",{children:[e.jsxs(H,{className:"flex items-center gap-2 mb-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"ì°¸ì¡° (CC)"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[b.map(s=>e.jsxs(K,{variant:"outline",className:"px-2 py-1",children:[s.name&&`${s.name} `,"<",s.email,">",e.jsx("button",{onClick:()=>_(s.email,"cc"),className:"ml-2 hover:text-red-600",children:e.jsx(Y,{className:"h-3 w-3"})})]},s.email)),b.length===0&&e.jsx("span",{className:"text-sm text-gray-500",children:"ì°¸ì¡°ì ì—†ìŒ (ì„ íƒì‚¬í•­)"})]})]}),e.jsx("div",{className:"border rounded-lg p-3 bg-gray-50",children:e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(G,{placeholder:"ì´ë¦„ (ì„ íƒì‚¬í•­)",value:F,onChange:s=>T(s.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsx(G,{placeholder:"ì´ë©”ì¼ ì£¼ì†Œ",type:"email",value:w,onChange:s=>U(s.target.value),onKeyPress:s=>s.key==="Enter"&&f()})}),e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:R,onChange:s=>z(s.target.value),children:[e.jsx("option",{value:"to",children:"ìˆ˜ì‹ ì"}),e.jsx("option",{value:"cc",children:"ì°¸ì¡°"})]}),e.jsxs(E,{type:"button",onClick:f,size:"sm",children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),"ì¶”ê°€"]})]})}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"subject",children:"ì œëª©"}),e.jsx(G,{id:"subject",value:D,onChange:s=>g(s.target.value),placeholder:"ì´ë©”ì¼ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"body",children:"ë‚´ìš©"}),e.jsx(Ue,{id:"body",value:m,onChange:s=>n(s.target.value),placeholder:"ì´ë©”ì¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”",className:"mt-1 min-h-[200px]"})]}),e.jsxs("div",{children:[e.jsxs(H,{className:"flex items-center gap-2 mb-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"ì²¨ë¶€íŒŒì¼"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{id:"attach-pdf",checked:k,onCheckedChange:s=>$(s)}),e.jsxs("label",{htmlFor:"attach-pdf",className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx(J,{className:"h-4 w-4 text-red-600"}),"ë°œì£¼ì„œ PDF ì²¨ë¶€"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{id:"attach-excel",checked:P,onCheckedChange:s=>O(s)}),e.jsxs("label",{htmlFor:"attach-excel",className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx(J,{className:"h-4 w-4 text-green-600"}),"ì›ë³¸ ì—‘ì…€ íŒŒì¼ ì²¨ë¶€"]})]})]})]})]}),e.jsxs(Ee,{children:[e.jsx(E,{variant:"outline",onClick:N,children:"ì·¨ì†Œ"}),e.jsxs(E,{onClick:W,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"ì´ë©”ì¼ ë°œì†¡"]})]})]})})}function Ge({orders:p,onOrderUpdate:N,onOrderRemove:h,onSingleOrderSave:u,file:r}){const[S,j]=o.useState(null),[C,b]=o.useState(""),[v,D]=o.useState(p.reduce((s,t,l)=>({...s,[l]:!0}),{})),[g,m]=o.useState(null),[n,k]=o.useState(null),[$,P]=o.useState(!1),O=ge({mutationFn:async({order:s,sendEmail:t,index:l,isDraft:A=!1})=>{const a=new FormData;r&&a.append("excelFile",r),a.append("orders",JSON.stringify([s])),a.append("sendEmail",t.toString()),a.append("isDraft",A.toString());const i=await fetch("/api/orders/bulk-create-simple",{method:"POST",credentials:"include",body:a});if(!i.ok){const c=await i.text();throw new Error(c||"Failed to save order")}return i.json()},onSuccess:async(s,t)=>{await pe.invalidateQueries({predicate:l=>l.queryKey.some(a=>typeof a=="string"&&(a.includes("orders")||a.includes("/api/orders")))}),t.isDraft?(x({title:"ì„ì‹œì €ì¥ ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„ì‹œì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì£¼ì„œ ê´€ë¦¬ í™”ë©´ì—ì„œ í™•ì¸ ë° ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),h(t.index)):t.sendEmail?(k({...s,originalOrder:t.order,originalIndex:t.index}),P(!0),x({title:"ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ ì‘ì„±í•´ì£¼ì„¸ìš”."})):(x({title:"ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒì„±ëœ ë°œì£¼ì„œëŠ” ë°œì£¼ì„œ ê´€ë¦¬ í™”ë©´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),h(t.index))},onError:s=>{x({title:"ë°œì£¼ì„œ ìƒì„± ì‹¤íŒ¨",description:s.message||"ë°œì£¼ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})},onSettled:()=>{m(null)}}),w=(s,t)=>{j(s),b(t||"")},U=s=>{u?u(s,v[s]):(m(s),O.mutate({order:p[s],sendEmail:v[s],index:s}))},F=s=>{m(s),O.mutate({order:p[s],sendEmail:!1,index:s,isDraft:!0})},T=(s,t)=>{D(l=>({...l,[s]:t}))},R=(s,t,l)=>{const a={...p[s]};if(t.startsWith("item.")){const[,i]=t.split("."),c=a.items[0]||{};["quantity","unitPrice"].includes(i)?(c[i]=parseFloat(l)||0,c.quantity&&c.unitPrice&&(c.totalAmount=c.quantity*c.unitPrice)):c[i]=l,a.items=[c]}else a[t]=l;a.errors=[],a.vendorName||a.errors.push("ê±°ë˜ì²˜ëª… í•„ìˆ˜"),a.vendorEmail||a.errors.push("ì´ë©”ì¼ í•„ìˆ˜"),a.projectName||a.errors.push("í”„ë¡œì íŠ¸ í•„ìˆ˜"),a.isValid=a.errors.length===0,N(s,a),j(null)},z=(s,t,l)=>{s.key==="Enter"?(s.preventDefault(),R(t,l,C)):s.key==="Escape"&&j(null)},f=({cellId:s,value:t,orderIndex:l,field:A,type:a="text",icon:i,label:c,className:y=""})=>S===s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500 w-20",children:[c,":"]}),e.jsx(G,{type:a,value:C,onChange:B=>b(B.target.value),onKeyDown:B=>z(B,l,A),onBlur:()=>R(l,A,C),className:se("h-7 px-2 py-0 text-xs flex-1",y),autoFocus:!0})]}):e.jsxs("div",{className:"flex items-center gap-2 p-1 rounded cursor-pointer hover:bg-gray-50 group",onClick:()=>w(s,t),children:[i&&e.jsx("div",{className:"text-gray-400 w-4",children:i}),e.jsxs("span",{className:"text-xs text-gray-500 min-w-[80px]",children:[c,":"]}),e.jsx("span",{className:se("text-xs flex-1",!t&&"text-gray-400 italic"),children:t||"ì…ë ¥"})]}),_=async s=>{try{const t=await fetch("/api/orders/send-email-simple",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({to:s.to,cc:s.cc,subject:s.subject,body:s.body,orderData:{orderId:n?.orderId||n?.orderIds?.[0],orderNumber:n?.orderNumber,projectName:n?.projectName,vendorName:n?.vendorName,location:n?.location,orderDate:n?.orderDate,deliveryDate:n?.deliveryDate,totalAmount:n?.totalAmount,excelFilePath:n?.excelFilePath},attachPdf:s.attachPdf,attachExcel:s.attachExcel})}),l=await t.json();t.ok?l.message&&l.message.includes("ê°œë°œ ëª¨ë“œ")?x({title:"ì´ë©”ì¼ í…ŒìŠ¤íŠ¸ ëª¨ë“œ",description:"SMTP ì„¤ì •ì´ ì—†ì–´ ì‹¤ì œ ì´ë©”ì¼ì€ ë°œì†¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë°œì£¼ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",variant:"default"}):x({title:"ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ",description:"ë°œì£¼ì„œì™€ ì´ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."}):x({title:"ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨",description:l.error||"ì´ë©”ì¼ì€ ë°œì†¡ë˜ì§€ ì•Šì•˜ì§€ë§Œ ë°œì£¼ì„œëŠ” ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",variant:"destructive"}),n?.originalIndex!==void 0&&h(n.originalIndex)}catch(t){console.error("ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",t),x({title:"ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨",description:"ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë°œì£¼ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",variant:"destructive"}),n?.originalIndex!==void 0&&h(n.originalIndex)}finally{P(!1),k(null)}},W=()=>{P(!1),n?.originalIndex!==void 0&&h(n.originalIndex),k(null)};return e.jsxs("div",{className:"space-y-4",children:[p.map((s,t)=>{const l=p[t].items[0]||{},A=(l.quantity||0)*(l.unitPrice||0);return e.jsxs(re,{className:se("p-4 relative",s.isValid===!1&&"border-red-300 bg-red-50/30"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{variant:"outline",className:"text-xs",children:["#",t+1]}),e.jsx(K,{variant:s.isValid?"default":"destructive",className:"text-xs h-5",children:s.isValid?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),"ìœ íš¨"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"ê²€ì¦ í•„ìš”"]})}),s.errors&&s.errors.length>0&&e.jsxs("span",{className:"text-xs text-red-600",children:["(",s.errors.join(", "),")"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{id:`email-${t}`,checked:v[t],onCheckedChange:a=>T(t,a),disabled:g===t}),e.jsxs("label",{htmlFor:`email-${t}`,className:"text-xs text-gray-600 cursor-pointer",children:[e.jsx(I,{className:"h-3 w-3 inline mr-1"}),"ì´ë©”ì¼ ë°œì†¡"]})]}),e.jsxs(E,{onClick:()=>U(t),disabled:!s.isValid||g===t,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-xs",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),g===t?"ìƒì„± ì¤‘...":"ë°œì£¼ì„œ ìƒì„±"]}),e.jsxs(E,{onClick:()=>F(t),disabled:!s.isValid||g===t,size:"sm",variant:"outline",className:"text-xs",children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),g===t?"ì €ì¥ ì¤‘...":"ì„ì‹œì €ì¥"]}),e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 text-gray-400 hover:text-red-600",onClick:()=>h(t),children:e.jsx(Y,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsx(f,{cellId:`${t}-orderDate`,value:s.orderDate,orderIndex:t,field:"orderDate",label:"ë°œì£¼ì¼ì",icon:e.jsx(xe,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-deliveryDate`,value:s.deliveryDate,orderIndex:t,field:"deliveryDate",label:"ë‚©ê¸°ì¼ì",icon:e.jsx(xe,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-vendor`,value:s.vendorName,orderIndex:t,field:"vendorName",label:"ê±°ë˜ì²˜ëª…",icon:e.jsx(te,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-vendorEmail`,value:s.vendorEmail,orderIndex:t,field:"vendorEmail",label:"ê±°ë˜ì²˜ ì´ë©”ì¼",type:"email",icon:e.jsx(I,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsx(f,{cellId:`${t}-deliveryPlace`,value:s.deliveryPlace,orderIndex:t,field:"deliveryPlace",label:"ë‚©í’ˆì²˜ëª…",icon:e.jsx(te,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-deliveryEmail`,value:s.deliveryEmail,orderIndex:t,field:"deliveryEmail",label:"ë‚©í’ˆì²˜ ì´ë©”ì¼",type:"email",icon:e.jsx(I,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-project`,value:s.projectName,orderIndex:t,field:"projectName",label:"í”„ë¡œì íŠ¸ëª…",icon:e.jsx(te,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[e.jsx(f,{cellId:`${t}-itemName`,value:l.itemName,orderIndex:t,field:"item.itemName",label:"í’ˆëª©ëª…",icon:e.jsx(Ce,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-spec`,value:l.specification,orderIndex:t,field:"item.specification",label:"ê·œê²©"}),e.jsx(f,{cellId:`${t}-qty`,value:l.quantity,orderIndex:t,field:"item.quantity",label:"ìˆ˜ëŸ‰",type:"number",icon:e.jsx(ze,{className:"h-3 w-3"})}),e.jsx(f,{cellId:`${t}-price`,value:l.unitPrice,orderIndex:t,field:"item.unitPrice",label:"ë‹¨ê°€",type:"number"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"ì´ê¸ˆì•¡:"}),e.jsxs("span",{className:"text-sm font-medium",children:[A.toLocaleString(),"ì›"]})]}),e.jsx(f,{cellId:`${t}-remarks`,value:l.remarks,orderIndex:t,field:"item.remarks",label:"ë¹„ê³ "})]})}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(f,{cellId:`${t}-majorCategory`,label:"ëŒ€ë¶„ë¥˜",value:s.majorCategory||"",orderIndex:t,field:"majorCategory",className:"h-7"}),e.jsx(f,{cellId:`${t}-middleCategory`,label:"ì¤‘ë¶„ë¥˜",value:s.middleCategory||"",orderIndex:t,field:"middleCategory",className:"h-7"}),e.jsx(f,{cellId:`${t}-minorCategory`,label:"ì†Œë¶„ë¥˜",value:s.minorCategory||"",orderIndex:t,field:"minorCategory",className:"h-7"})]})})]},t)}),p.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"ì—…ë¡œë“œëœ ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤."}),$&&n&&e.jsx(Qe,{isOpen:$,onClose:W,onSend:_,orderData:n?.originalOrder||n,initialTo:[{email:n?.originalOrder?.vendorEmail||"",name:n?.originalOrder?.vendorName||""}],initialCc:n?.originalOrder?.deliveryEmail?[{email:n?.originalOrder?.deliveryEmail,name:n?.originalOrder?.deliveryPlace||""}]:[]})]})}function Ie({isOpen:p,onClose:N,errors:h,onRetry:u,onDownloadTemplate:r}){return e.jsx(Ne,{open:p,onOpenChange:N,children:e.jsxs(ye,{className:"sm:max-w-[500px] max-h-[80vh]",children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(X,{className:"h-5 w-5"}),"Excel í•„ë“œëª… ì˜¤ë¥˜"]}),e.jsx(Be,{children:"ì—…ë¡œë“œí•œ íŒŒì¼ì˜ í•„ë“œëª…ì´ í‘œì¤€ í˜•ì‹ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."})]}),e.jsx(Ae,{className:"max-h-[300px] rounded-md border p-4 bg-red-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium text-sm text-red-900 mb-3",children:"âŒ ì˜ëª»ëœ í•„ë“œëª…:"}),h.map((S,j)=>e.jsxs("div",{className:"text-sm text-red-700 ml-4",children:["â€¢ ",S]},j))]})}),e.jsxs("div",{className:"rounded-lg bg-blue-50 p-3 mt-2",children:[e.jsx("p",{className:"text-sm text-blue-900 font-medium mb-2",children:"âœ… í•´ê²° ë°©ë²•:"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 ml-4",children:[e.jsx("li",{children:"1. í‘œì¤€ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”"}),e.jsx("li",{children:"2. í…œí”Œë¦¿ì˜ í•„ë“œëª…ì„ ì •í™•íˆ ì‚¬ìš©í•˜ì„¸ìš”"}),e.jsx("li",{children:"3. í•„ë“œëª…ì„ ìˆ˜ì • í›„ ë‹¤ì‹œ ì—…ë¡œë“œí•˜ì„¸ìš”"})]})]}),e.jsxs(Ee,{className:"gap-2",children:[r&&e.jsxs(E,{onClick:r,variant:"outline",className:"gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"]}),u&&e.jsxs(E,{onClick:u,variant:"default",className:"gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"ë‹¤ì‹œ ì‹œë„"]}),e.jsx(E,{onClick:N,variant:"secondary",children:"ë‹«ê¸°"})]})]})})}function Ye(){Re();const[,p]=je(),N=o.useRef(null),[h,u]=o.useState(null),[r,S]=o.useState(!1),[j,C]=o.useState([]),[b,v]=o.useState(!1),[D,g]=o.useState(0),[m,n]=o.useState([]),[k,$]=o.useState([]),[P,O]=o.useState(!1),w=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?S(!0):a.type==="dragleave"&&S(!1)},U=a=>{if(a.preventDefault(),a.stopPropagation(),S(!1),a.dataTransfer.files&&a.dataTransfer.files[0]){const i=a.dataTransfer.files[0];T(i)}},F=a=>{a.target.files&&a.target.files[0]&&T(a.target.files[0])},T=a=>{const i=a.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls")&&!i.endsWith(".xlsm")){x({title:"íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜",description:"ì—‘ì…€ íŒŒì¼(.xlsx, .xls, .xlsm)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.",variant:"destructive"});return}u(a),R(a)},R=async a=>{v(!0),g(20);try{const i=await a.arrayBuffer();g(40);const c=ve(i,{type:"array"});g(60);const y=c.SheetNames[0],de=c.Sheets[y],B=fe.sheet_to_json(de,{header:1});if(g(80),B.length===0)throw new Error("ì—‘ì…€ íŒŒì¼ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");const ke=B[0],me=["ë°œì£¼ì¼ì","ë‚©ê¸°ì¼ì","ê±°ë˜ì²˜ëª…","ê±°ë˜ì²˜ ì´ë©”ì¼","ë‚©í’ˆì²˜ëª…","ë‚©í’ˆì²˜ ì´ë©”ì¼","í”„ë¡œì íŠ¸ëª…","ëŒ€ë¶„ë¥˜","ì¤‘ë¶„ë¥˜","ì†Œë¶„ë¥˜","í’ˆëª©ëª…","ê·œê²©","ìˆ˜ëŸ‰","ë‹¨ê°€","ì´ê¸ˆì•¡","ë¹„ê³ "],Z=[],$e=new Map;for(let d=0;d<me.length;d++){const q=me[d],M=ke[d]?.toString().trim();!M||M!==q?Z.push(`ì»¬ëŸ¼ ${d+1}: "${M||"(ë¹ˆê°’)"}" â†’ ì˜¬ë°”ë¥¸ í•„ë“œëª…: "${q}"`):$e.set(q,d)}if(Z.length>0){$(Z),O(!0),v(!1);return}const ee=B.slice(1).filter(d=>d&&d.some(q=>q)).map((d,q)=>{const M=Q=>Q?typeof Q=="number"?new Date((Q-25569)*86400*1e3).toISOString().split("T")[0]:Q.toString().trim():"";return{rowIndex:q+2,orderDate:M(d[0]),deliveryDate:M(d[1]),vendorName:d[2]?.toString().trim(),vendorEmail:d[3]?.toString().trim(),deliveryPlace:d[4]?.toString().trim(),deliveryEmail:d[5]?.toString().trim(),projectName:d[6]?.toString().trim(),majorCategory:d[7]?.toString().trim(),middleCategory:d[8]?.toString().trim(),minorCategory:d[9]?.toString().trim(),items:[{itemName:d[10]?.toString().trim(),specification:d[11]?.toString().trim(),quantity:parseFloat(d[12])||0,unitPrice:parseFloat(d[13])||0,totalAmount:parseFloat(d[14])||0,remarks:d[15]?.toString().trim()}],isValid:!0,errors:[]}});C(ee),n(ee),g(100),x({title:"ì—‘ì…€ íŒŒì¼ ë¡œë”© ì™„ë£Œ",description:`ë°œì£¼ì„œ ìƒì„±ì„ ìœ„í•´ ${ee.length}ê°œì˜ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ê° í•­ëª©ì„ í™•ì¸í•˜ê³  ìˆ˜ì •í•œ í›„ 'ëª¨ë‘ ì €ì¥' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.`})}catch(i){console.error("Excel parsing error:",i);const c=i instanceof Error?i.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";c.includes("í—¤ë”ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤")?x({title:"ì—‘ì…€ í•„ë“œ ê²€ì¦ ì‹¤íŒ¨",description:c,variant:"destructive"}):x({title:"íŒŒì¼ íŒŒì‹± ì‹¤íŒ¨",description:c,variant:"destructive"})}finally{v(!1),setTimeout(()=>g(0),1e3)}},z=(a,i)=>{const c=[...m];c[a]=i,n(c)},f=a=>{const i=m.filter((c,y)=>y!==a);n(i),x({title:"ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ",description:"ì„±ê³µì ìœ¼ë¡œ ë°œì£¼ì„œê°€ ìƒì„±ë˜ì–´ ì‘ì„± ëª©ë¡ì—ì„œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒì„±ëœ ë°œì£¼ì„œëŠ” ë°œì£¼ì„œ ê´€ë¦¬ í™”ë©´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})},_=ge({mutationFn:async a=>{const i=new FormData;h&&i.append("excelFile",h),i.append("orders",JSON.stringify(a));const c=await fetch("/api/orders/bulk-create-simple",{method:"POST",credentials:"include",body:i});if(!c.ok){const y=await c.text();throw new Error(y||"Failed to save orders")}return c.json()},onSuccess:async a=>{await pe.invalidateQueries({predicate:i=>i.queryKey.some(y=>typeof y=="string"&&(y.includes("orders")||y.includes("/api/orders")))}),x({title:"ì €ì¥ ì™„ë£Œ",description:`${a.savedCount}ê°œì˜ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`}),setTimeout(()=>p("/orders"),1500)},onError:a=>{x({title:"ì €ì¥ ì‹¤íŒ¨",description:a.message||"ë°œì£¼ì„œ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),W=()=>{const a=m.filter(i=>i.isValid!==!1);if(a.length===0){x({title:"ì €ì¥í•  ìˆ˜ ì—†ìŒ",description:"ìœ íš¨í•œ ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤.",variant:"destructive"});return}_.mutate(a)},s=()=>{u(null),C([]),n([]),g(0)},t=()=>{N.current?.click()},l=async()=>{try{const i=await(await fetch("/api/excel-template/download")).blob(),c=window.URL.createObjectURL(i),y=document.createElement("a");y.href=c,y.download="PO_Excel_Template.xlsx",document.body.appendChild(y),y.click(),window.URL.revokeObjectURL(c),document.body.removeChild(y),x({title:"í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ",description:"í‘œì¤€ Excel í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤."})}catch(a){console.error("Template download error:",a),x({title:"ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨",description:"í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}},A=()=>{O(!1),$([]),t()};return e.jsxs("div",{className:"space-y-6",children:[m.length===0&&e.jsx(re,{children:e.jsxs(he,{className:"p-8",children:[e.jsx("input",{ref:N,type:"file",accept:".xlsx,.xls,.xlsm",onChange:F,className:"hidden"}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${r?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:U,children:[e.jsx(ce,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"ì—‘ì…€ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-gray-500",children:"DB ê²€ì¦ ì—†ì´ ë°”ë¡œ í¸ì§‘ ê°€ëŠ¥í•œ ë°œì£¼ì„œë¡œ ë³€í™˜ë©ë‹ˆë‹¤"}),e.jsx("p",{className:"text-xs text-gray-400",children:".xlsx, .xls, .xlsm íŒŒì¼ ì§€ì›"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-3 mt-6",children:[e.jsx(E,{onClick:t,disabled:b,size:"lg",children:b?"ì²˜ë¦¬ ì¤‘...":"íŒŒì¼ ì„ íƒ"}),e.jsxs(E,{onClick:l,variant:"outline",size:"lg",className:"gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"]})]})]}),D>0&&e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"íŒŒì¼ ì²˜ë¦¬ ì¤‘..."}),e.jsxs("span",{children:[D,"%"]})]}),e.jsx(Ve,{value:D,className:"h-2"})]}),h&&e.jsxs(L,{className:"mt-6",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsxs(V,{children:[e.jsx("strong",{children:h.name})," (",(h.size/1024).toFixed(1)," KB)"]})]}),e.jsxs(L,{className:"mt-6 bg-blue-50 border-blue-200",children:[e.jsx(De,{className:"h-4 w-4 text-blue-600"}),e.jsx(V,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-2",children:"ğŸ“‹ í•„ìˆ˜ Excel í•„ë“œëª… (ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•¨)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-blue-800",children:[e.jsxs("div",{children:["â€¢ ",e.jsx("strong",{children:"ê¸°ë³¸ ì •ë³´:"})," ë°œì£¼ì¼ì, ë‚©ê¸°ì¼ì"]}),e.jsxs("div",{children:["â€¢ ",e.jsx("strong",{children:"ê±°ë˜ì²˜:"})," ê±°ë˜ì²˜ëª…, ê±°ë˜ì²˜ ì´ë©”ì¼"]}),e.jsxs("div",{children:["â€¢ ",e.jsx("strong",{children:"ë‚©í’ˆì²˜:"})," ë‚©í’ˆì²˜ëª…, ë‚©í’ˆì²˜ ì´ë©”ì¼"]}),e.jsxs("div",{children:["â€¢ ",e.jsx("strong",{children:"í”„ë¡œì íŠ¸:"})," í”„ë¡œì íŠ¸ëª…"]}),e.jsxs("div",{children:["â€¢ ",e.jsx("strong",{children:"ë¶„ë¥˜:"})," ëŒ€ë¶„ë¥˜, ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜"]}),e.jsxs("div",{children:["â€¢ ",e.jsx("strong",{children:"í’ˆëª©:"})," í’ˆëª©ëª…, ê·œê²©, ìˆ˜ëŸ‰, ë‹¨ê°€, ì´ê¸ˆì•¡, ë¹„ê³ "]})]})]})})]}),e.jsxs(L,{className:"mt-6",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs(V,{children:[e.jsx("strong",{children:"ì—‘ì…€ ì‹¬í”Œ ì—…ë¡œë“œ íŠ¹ì§•:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm space-y-1",children:[e.jsx("li",{children:"DB ê°’ê³¼ ë¹„êµ/ë³´ì • ê³¼ì • ì—†ìŒ"}),e.jsx("li",{children:"ì—‘ì…€ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ í‘œì‹œ"}),e.jsx("li",{children:"ëª¨ë“  í•„ë“œë¥¼ ì§ì ‘ ìˆ˜ì • ê°€ëŠ¥"}),e.jsx("li",{children:"ì—¬ëŸ¬ ë°œì£¼ì„œë¥¼ í•œë²ˆì— í¸ì§‘ ë° ì €ì¥"})]})]})]})]})}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(E,{onClick:W,disabled:_.isPending,size:"lg",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),_.isPending?"ì €ì¥ ì¤‘...":"ëª¨ë‘ ì €ì¥"]}),e.jsxs(E,{onClick:s,variant:"outline",size:"lg",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"ì´ˆê¸°í™”"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(K,{variant:"secondary",className:"px-3 py-1",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),m.length,"ê°œ ë°œì£¼ì„œ"]}),e.jsxs(K,{variant:"outline",className:"px-3 py-1",children:[m.reduce((a,i)=>a+i.items.length,0),"ê°œ í’ˆëª©"]})]})]})}),e.jsx(Ge,{orders:m,onOrderUpdate:z,onOrderRemove:f,file:h})]}),e.jsx(Ie,{isOpen:P,onClose:()=>O(!1),errors:k,onRetry:A,onDownloadTemplate:l})]})}const Ze={EXCEL_UPLOAD:!0,HANDSONTABLE:!1,APPROVAL_WORKFLOW:!1,ADVANCED_PERMISSIONS:!1};function es(p){return Ze[p]}function Os(){const[,p]=je(),[N,h]=o.useState([]),{theme:u}=_e(),r=u==="dark",S=es("EXCEL_UPLOAD");console.log("ğŸ” Create Order Debug Info:",{isExcelUploadEnabled:S,VITE_ENVIRONMENT:"production",VITE_ENABLE_EXCEL_UPLOAD:"true",NODE_ENV:void 0,timestamp:new Date().toISOString()});const j=()=>{p("/orders")},C=()=>{p("/orders")},b=v=>{h(v)};return e.jsx("div",{className:`min-h-screen transition-colors ${r?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6 pb-20",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${r?"text-white":"text-gray-900"}`,children:"ë°œì£¼ì„œ ì‘ì„±"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${r?"text-gray-400":"text-gray-600"}`,children:"ìƒˆë¡œìš´ ë°œì£¼ì„œë¥¼ ì‘ì„±í•˜ê±°ë‚˜ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”"})]})]})}),e.jsxs(L,{className:`mb-6 transition-colors ${r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(De,{className:`h-4 w-4 ${r?"text-blue-400":"text-blue-600"}`}),e.jsx(V,{className:r?"text-gray-300":"text-gray-700",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`font-medium ${r?"text-white":"text-gray-900"}`,children:"ğŸ“‹ ì‚¬ìš©íŒ"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${r?"text-blue-400":"text-blue-600"}`,children:"Excel ì—…ë¡œë“œ:"})," ëŒ€ëŸ‰ ë°œì£¼ì„œ, ë°˜ë³µ ì—…ë¬´, ìë™í™” ì²˜ë¦¬ì— ì í•© (50ê±´+ ê¶Œì¥)"]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${r?"text-green-400":"text-green-600"}`,children:"ì¼ë°˜ í¼ ì‘ì„±:"})," ì†ŒëŸ‰ ë°œì£¼ì„œ, ì„¸ë°€í•œ ì¡°ì •, ì¦‰ì‹œ ì²˜ë¦¬ì— ì í•© (10ê±´ ì´í•˜ ê¶Œì¥)"]})]}),e.jsx("div",{className:`pt-2 border-t transition-colors ${r?"border-gray-700":"border-gray-200"}`,children:e.jsxs(E,{variant:"outline",size:"sm",className:`transition-colors ${r?"text-blue-400 border-gray-600 hover:bg-gray-700 hover:border-blue-500":"text-blue-600 border-blue-200 hover:bg-blue-50"}`,onClick:()=>{const v=document.createElement("a");v.href="/PO_Excel_Template.xlsx",v.download="PO_Excel_Template.xlsx",v.click()},children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Excel í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"]})})]})})]}),e.jsxs(He,{defaultValue:"excel",className:"w-full",children:[e.jsxs(Xe,{className:`grid w-full grid-cols-3 transition-colors ${r?"bg-gray-800 border-gray-700":"bg-gray-100"}`,children:[e.jsxs(ae,{value:"excel",className:`flex items-center gap-2 transition-colors ${r?"data-[state=active]:bg-gray-700 data-[state=active]:text-white hover:bg-gray-750":"data-[state=active]:bg-white data-[state=active]:text-gray-900"}`,children:[e.jsx(ne,{className:"h-4 w-4"}),"ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"]}),e.jsxs(ae,{value:"form",className:`flex items-center gap-2 transition-colors ${r?"data-[state=active]:bg-gray-700 data-[state=active]:text-white hover:bg-gray-750":"data-[state=active]:bg-white data-[state=active]:text-gray-900"}`,children:[e.jsx(J,{className:"h-4 w-4"}),"ì§ì ‘ ì…ë ¥"]}),e.jsxs(ae,{value:"simple",className:`flex items-center gap-2 transition-colors ${r?"data-[state=active]:bg-gray-700 data-[state=active]:text-white hover:bg-gray-750":"data-[state=active]:bg-white data-[state=active]:text-gray-900"}`,children:[e.jsx(ce,{className:"h-4 w-4"}),"ì—‘ì…€ ì‹¬í”Œ ì—…ë¡œë“œv1.1"]})]}),e.jsx(le,{value:"excel",className:"mt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(Je,{onDataParsed:b}),N.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{className:`transition-colors ${r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx(V,{className:r?"text-gray-300":"text-gray-700",children:'Excel ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤. "ì§ì ‘ ì…ë ¥" íƒ­ìœ¼ë¡œ ì´ë™í•˜ì—¬ ë°œì£¼ì„œë¥¼ ì™„ì„±í•´ì£¼ì„¸ìš”.'})}),e.jsxs("div",{className:`rounded-lg p-4 transition-colors ${r?"bg-gray-800":"bg-gray-50"}`,children:[e.jsxs("h3",{className:`font-medium mb-3 transition-colors ${r?"text-white":"text-gray-900"}`,children:["ë¯¸ë¦¬ë³´ê¸° (",N.length,"ê°œ í–‰)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"min-w-full text-sm",children:e.jsxs("tbody",{children:[N.slice(0,5).map((v,D)=>e.jsx("tr",{className:`border-b transition-colors ${r?"border-gray-700":"border-gray-100"}`,children:v.slice(0,6).map((g,m)=>e.jsx("td",{className:`py-2 px-3 transition-colors ${r?"text-gray-300":"text-gray-900"}`,children:g||"-"},m))},D)),N.length>5&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:`py-2 px-3 text-center transition-colors ${r?"text-gray-400":"text-gray-500"}`,children:["... ì™¸ ",N.length-5,"ê°œ í–‰"]})})]})})})]})]})]})}),e.jsx(le,{value:"form",className:"mt-6",children:e.jsx(Le,{onSuccess:j,onCancel:C})}),e.jsx(le,{value:"simple",className:"mt-6",children:e.jsx(Ye,{})})]})]})})}export{Os as default};
