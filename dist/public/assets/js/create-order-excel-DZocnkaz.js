import{c as _,r as m,j as e,Y as R,M as h,Q as p,V as g,N as j,b as x,B as d,at as W,s as q,i as G}from"./index-BkVWclAn.js";import{A as y,a as f}from"./alert-C_xssCDR.js";import{P as H}from"./progress-CTB2DcYY.js";import{I as w}from"./info-Cl7J8Y8S.js";import{T as Q}from"./triangle-alert-DAvnIFni.js";import{D as Y}from"./download-BABcLo5Y.js";import{U}from"./upload-B-Ld201t.js";function le(){_();const[u,P]=m.useState(null),[$,S]=m.useState(!1),[C,N]=m.useState(!1),[o,v]=m.useState(null),[F,i]=m.useState("none"),[l,M]=m.useState(null);m.useState([]);const[r,B]=m.useState(null),[k,V]=m.useState([{id:"upload",title:"íŒŒì¼ ì—…ë¡œë“œ",description:"ì—‘ì…€ íŒŒì¼ì„ ì„œë²„ë¡œ ì—…ë¡œë“œ",status:"pending"},{id:"parse",title:"Input ì‹œíŠ¸ íŒŒì‹±",description:"ì—‘ì…€ íŒŒì¼ì˜ Input ì‹œíŠ¸ ë°ì´í„° ë¶„ì„",status:"pending"},{id:"save",title:"ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥",description:"ë°œì£¼ì„œ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥",status:"pending"},{id:"extract",title:"ê°‘ì§€/ì„ì§€ ì¶”ì¶œ",description:"ê°‘ì§€/ì„ì§€ ì‹œíŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì¶”ì¶œ",status:"pending"}]),D=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?S(!0):s.type==="dragleave"&&S(!1)},J=s=>{if(s.preventDefault(),s.stopPropagation(),S(!1),s.dataTransfer.files&&s.dataTransfer.files[0]){const t=s.dataTransfer.files[0];t.type.includes("excel")||t.type.includes("spreadsheet")||t.name.endsWith(".xlsx")?(P(t),v(null),O()):alert("ì—‘ì…€ íŒŒì¼(.xlsx)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")}},K=s=>{s.target.files&&s.target.files[0]&&(P(s.target.files[0]),v(null),O())},O=()=>{V(s=>s.map(t=>({...t,status:"pending",message:void 0})))},c=(s,t,a)=>{V(n=>n.map(b=>b.id===s?{...b,status:t,message:a}:b))},z=async()=>{if(u){N(!0);try{c("upload","processing");const s=new FormData;s.append("file",u);const t=await fetch("/api/po-template/upload",{method:"POST",body:s}),a=await t.json();if(!t.ok){c("upload","error",a.error||"íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨"),N(!1);return}c("upload","completed",`${a.data.fileName} ì—…ë¡œë“œ ì™„ë£Œ`),c("parse","completed",`ë°œì£¼ì„œ ${a.data.totalOrders}ê°œ, ì•„ì´í…œ ${a.data.totalItems}ê°œ íŒŒì‹± ì™„ë£Œ`),c("save","processing");const n=await fetch("/api/po-template/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:a.data.orders})}),b=await n.json();if(!n.ok){c("save","error",b.error||"ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì‹¤íŒ¨"),N(!1);return}c("save","completed",`ë°œì£¼ì„œ ${b.data.savedOrders}ê°œ ì €ì¥ ì™„ë£Œ`),c("extract","processing");const E=await fetch("/api/po-template/extract-sheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:a.data.filePath})}),A=await E.json();E.ok?c("extract","completed",`${A.data.extractedSheets.join(", ")} ì‹œíŠ¸ ì¶”ì¶œ ì™„ë£Œ`):c("extract","error",A.error||"ì‹œíŠ¸ ì¶”ì¶œ ì‹¤íŒ¨"),v(a),setTimeout(()=>{console.log("ìë™ ê±°ë˜ì²˜ í™•ì¸ ì‹œì‘, filePath:",a.data?.filePath),a.data?.filePath?L(a.data.filePath):console.error("íŒŒì¼ ê²½ë¡œê°€ ì—†ì–´ì„œ ê±°ë˜ì²˜ í™•ì¸ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")},500)}catch(s){console.error("Processing error:",s),c("upload","error","ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{N(!1)}}},T=()=>k.filter(t=>t.status==="completed").length/k.length*100,L=async s=>{i("vendor-validation"),N(!0);try{console.log("ê±°ë˜ì²˜ ê²€ì¦ API í˜¸ì¶œ ì‹œì‘, filePath:",s);const a=await(await fetch("/api/excel-automation/validate-vendors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:s})})).json();if(console.log("ê±°ë˜ì²˜ ê²€ì¦ API ì‘ë‹µ:",a),a.success)M(a.data.vendorValidation),a.data.vendorValidation.needsUserAction?i("vendor-validation"):(i("email-preview"),await I(a.data.vendorValidation.validVendors));else throw new Error(a.error)}catch(t){console.error("ê±°ë˜ì²˜ ê²€ì¦ ì˜¤ë¥˜:",t),alert("ê±°ë˜ì²˜ ê²€ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),i("none")}finally{N(!1)}},I=async s=>{if(o?.data?.filePath)try{const a=await(await fetch("/api/excel-automation/update-email-preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:o.data.filePath,selectedVendors:s.map(n=>({originalName:n.vendorName,selectedVendorId:n.vendorId,selectedVendorEmail:n.email}))})})).json();if(a.success)B(a.data.emailPreview),i("email-preview");else throw new Error(a.error)}catch(t){console.error("ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì˜¤ë¥˜:",t),alert("ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ì—‘ì…€ ë°œì£¼ì„œ ì²˜ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë°œì£¼ì„œë¥¼ ìƒì„±í•˜ì„¸ìš”."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(h,{className:"border-blue-200 bg-blue-50 shadow-sm",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(w,{className:"w-5 h-5"}),"ì—‘ì…€ ë°œì£¼ì„œ ì‘ì„± ê°€ì´ë“œ"]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"ğŸ“‹ ì—‘ì…€ íŒŒì¼ ìš”êµ¬ì‚¬í•­"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì‹œíŠ¸ëª…:"})," 'Input' (ëŒ€ì†Œë¬¸ì êµ¬ë¶„)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì»¬ëŸ¼ êµ¬ì¡°:"})," A~Pì—´ (16ê°œ ì»¬ëŸ¼) í‘œì¤€ êµ¬ì¡°"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í˜•ì‹:"})," .xlsx (Excel 2007 ì´ìƒ)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í¬ê¸°:"})," ìµœëŒ€ 10MB"]})]})]})]}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200",children:[e.jsxs("h4",{className:"font-semibold text-amber-800 mb-3 flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"âš ï¸ ì£¼ì˜ì‚¬í•­"]}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-800",children:[e.jsx("div",{children:"â€¢ í•„ìˆ˜ ì»¬ëŸ¼ (ë°œì£¼ì¼ì, ê±°ë˜ì²˜ëª…, ë‚©í’ˆì²˜ëª…, í”„ë¡œì íŠ¸ëª…, ëŒ€ë¶„ë¥˜, í’ˆëª©ëª…, ìˆ˜ëŸ‰, ë‹¨ê°€, ì´ê¸ˆì•¡) ëˆ„ë½ ì‹œ ì²˜ë¦¬ ë¶ˆê°€"}),e.jsx("div",{children:"â€¢ ê±°ë˜ì²˜ëª…ì´ ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì§€ ì•Šì€ ê²½ìš° ê´€ë¦¬ìì—ê²Œ ë“±ë¡ ìš”ì²­ í•„ìš”"}),e.jsx("div",{children:"â€¢ ì´ê¸ˆì•¡(Oì—´) = ìˆ˜ëŸ‰(Mì—´) Ã— ë‹¨ê°€(Nì—´) ìˆ˜ì‹ì´ ì •í™•í•´ì•¼ í•¨"}),e.jsx("div",{children:"â€¢ Input ì‹œíŠ¸ ì™¸ ë‹¤ë¥¸ ì‹œíŠ¸(ê°‘ì§€, ì„ì§€ ë“±)ëŠ” ê·¸ëŒ€ë¡œ ë³´ì¡´ë¨"})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"ğŸ“¥ í‘œì¤€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"ì‹œìŠ¤í…œì— ìµœì í™”ëœ 16ê°œ ì»¬ëŸ¼ êµ¬ì¡°ì˜ í‘œì¤€ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”."}),e.jsxs(d,{onClick:async()=>{try{const s=await fetch("/api/excel-template/download",{method:"GET"});if(s.ok){const t=await s.blob(),a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="PO_Excel_Template.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}else throw new Error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨")}catch(s){console.error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:",s),alert("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"PO_Excel_Template.xlsx ë‹¤ìš´ë¡œë“œ"]})]})]})]}),e.jsxs(h,{className:"shadow-sm",children:[e.jsxs(p,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5"}),"ì—‘ì…€ ë°œì£¼ì„œ ì—…ë¡œë“œ"]}),e.jsx(W,{children:"16ê°œ ì»¬ëŸ¼ êµ¬ì¡°ì˜ Input ì‹œíŠ¸ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ë°œì£¼ì„œê°€ ìƒì„±ë©ë‹ˆë‹¤."})]}),e.jsxs(j,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${$?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:D,onDragLeave:D,onDragOver:D,onDrop:J,children:[e.jsx(U,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(u.size/1024/1024).toFixed(2)," MB"]}),e.jsx(q,{variant:"secondary",className:"mt-2",children:"íŒŒì¼ ì¤€ë¹„ ì™„ë£Œ"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"ì—‘ì…€ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì§€ì› í˜•ì‹: .xlsx (Excel íŒŒì¼)"})]}),e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:K,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"inline-block mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors font-medium",children:"íŒŒì¼ ì„ íƒ"})]}),u&&e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx(d,{onClick:z,disabled:C,className:"flex-1 h-12",size:"lg",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì‹œì‘"]})}),e.jsx(d,{variant:"outline",onClick:()=>{P(null),v(null),O()},className:"h-12",size:"lg",children:"ì·¨ì†Œ"})]}),C&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"ì²˜ë¦¬ ì§„í–‰ ìƒí™©"}),e.jsxs("span",{className:"text-sm text-blue-700",children:[Math.round(T()),"%"]})]}),e.jsx(H,{value:T(),className:"h-2 mb-3"}),e.jsx("div",{className:"text-sm text-blue-700",children:k.find(s=>s.status==="processing")?.title||"ì²˜ë¦¬ ì¤‘..."})]})]})]}),o&&o.data?.orders&&e.jsxs(h,{className:"mt-6 shadow-sm",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-blue-600"}),"ë°œì£¼ì„œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°"]})}),e.jsx(j,{children:e.jsx("div",{className:"space-y-6",children:o.data.orders.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.orderNumber}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ê±°ë˜ì²˜: ",s.vendorName," | ë‚©í’ˆì²˜: ",s.deliveryName||s.vendorName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["í˜„ì¥: ",s.siteName," | ë°œì£¼ì¼: ",s.orderDate," | ë‚©ê¸°ì¼: ",s.dueDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(s.totalAmount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.items.length,"ê°œ í’ˆëª©"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ê·œê²©"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ë‹¨ê°€"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ê±°ë˜ì²˜ëª…"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ë‚©í’ˆì²˜ëª…"})]})}),e.jsx("tbody",{children:s.items.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:a.itemName}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:a.specification}),e.jsx("td",{className:"border border-gray-300 px-2 py-1 text-right",children:new Intl.NumberFormat("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a.quantity)}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a.unitPrice),"ì›"]}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a.totalAmount),"ì›"]}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:a.vendorName||"-"}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:a.deliveryName||a.vendorName||"-"})]},n))})]})})]},t))})})]}),o&&e.jsxs(h,{className:"mt-6 shadow-sm",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-green-600"}),"ì²˜ë¦¬ ê²°ê³¼"]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"grid grid-cols-2 xl:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.data?.totalOrders||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"ìƒì„±ëœ ë°œì£¼ì„œ"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.data?.totalItems||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì²˜ë¦¬ëœ ì•„ì´í…œ"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"2"}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì¶”ì¶œëœ ì‹œíŠ¸"})]}),l&&e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[l.validVendors.length,"/",l.validVendors.length+l.invalidVendors.length]}),e.jsx("div",{className:"text-sm text-gray-600",children:"ë“±ë¡ëœ ê±°ë˜ì²˜"})]})]}),l?e.jsx(y,{className:l.invalidVendors.length>0?"border-orange-200 bg-orange-50":"border-green-200 bg-green-50",children:l.invalidVendors.length>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 text-orange-600"}),e.jsxs(f,{className:"text-orange-800",children:[e.jsx("strong",{children:"ê±°ë˜ì²˜ í™•ì¸ ì™„ë£Œ:"})," ",l.invalidVendors.length,"ê°œì˜ ë¯¸ë“±ë¡ ê±°ë˜ì²˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹œìŠ¤í…œ ê´€ë¦¬ìë‚˜ ë³¸ì‚¬ ê´€ë¦¬ìì—ê²Œ ê±°ë˜ì²˜ ë“±ë¡ì„ ìš”ì²­í•´ ì£¼ì„¸ìš”."]})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"h-4 w-4 text-green-600"}),e.jsxs(f,{className:"text-green-800",children:[e.jsx("strong",{children:"ê±°ë˜ì²˜ í™•ì¸ ì™„ë£Œ:"})," ëª¨ë“  ê±°ë˜ì²˜ê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ ë°œì†¡ì„ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})]})}):e.jsxs(y,{children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx(f,{children:"ì—‘ì…€ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ê±°ë˜ì²˜ í™•ì¸ì„ ìë™ìœ¼ë¡œ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[l&&l.invalidVendors.length===0&&r&&e.jsxs(d,{onClick:async()=>{if(!r.canProceed){alert("ì´ë©”ì¼ì„ ë°œì†¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ì‹ ìë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");return}i("sending");try{const t=await(await fetch("/api/excel-automation/send-emails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({processedFilePath:`uploads/${r.attachmentInfo.processedFile}`,recipients:r.recipients,emailOptions:{subject:r.subject,orderNumber:o?.data?.orders?.[0]?.orderNumber||"AUTO",additionalMessage:"ìë™í™” ì‹œìŠ¤í…œì„ í†µí•´ ë°œì†¡ëœ ë°œì£¼ì„œì…ë‹ˆë‹¤."}})})).json();if(t.success)i("completed"),alert(`ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ! (ì„±ê³µ: ${t.data.sentEmails}ê°œ)`);else throw new Error(t.error)}catch(s){console.error("ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",s),alert("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),i("email-preview")}},disabled:!r?.canProceed||r?.recipients.length===0,className:"bg-blue-600 hover:bg-blue-700",children:["ì´ë©”ì¼ ë°œì†¡ (",r?.recipients.length||0,"ëª…)"]}),e.jsx(d,{onClick:()=>window.location.href="/orders",children:"ë°œì£¼ì„œ ê´€ë¦¬ë¡œ ì´ë™"}),e.jsx(d,{variant:"outline",onClick:()=>window.location.href="/create-order/excel",children:"ìƒˆ íŒŒì¼ ì—…ë¡œë“œ"})]})]})]}),F==="vendor-validation"&&l&&e.jsxs(h,{className:"mt-6 shadow-sm",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-orange-600"}),"ê±°ë˜ì²˜ í™•ì¸ í•„ìš”"]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.validVendors.length}),e.jsx("div",{className:"text-sm text-green-600",children:"ë“±ë¡ëœ ê±°ë˜ì²˜"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:l.invalidVendors.length}),e.jsx("div",{className:"text-sm text-orange-600",children:"í™•ì¸ í•„ìš”í•œ ê±°ë˜ì²˜"})]})]}),l.invalidVendors.length>0&&e.jsxs(y,{className:"border-orange-200 bg-orange-50",children:[e.jsx(w,{className:"h-4 w-4 text-orange-600"}),e.jsx(f,{className:"text-orange-800",children:e.jsx("strong",{children:"ë“±ë¡ë˜ì§€ ì•Šì€ ê±°ë˜ì²˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìë‚˜ ë³¸ì‚¬ ê´€ë¦¬ìì—ê²Œ ê±°ë˜ì²˜ ë“±ë¡ì„ ìš”ì²­í•´ ì£¼ì„¸ìš”."})})]}),l.invalidVendors.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"í™•ì¸ì´ í•„ìš”í•œ ê±°ë˜ì²˜"}),e.jsx("div",{className:"space-y-3",children:l.invalidVendors.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"font-medium text-red-600 mb-2",children:['"',s.vendorName,'" - ë“±ë¡ë˜ì§€ ì•Šì€ ê±°ë˜ì²˜']}),s.suggestions.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"ìœ ì‚¬í•œ ê±°ë˜ì²˜ ì¶”ì²œ:"}),e.jsx("div",{className:"space-y-1",children:s.suggestions.slice(0,3).map((a,n)=>e.jsxs("div",{className:"text-sm p-2 bg-white rounded border",children:[a.name," (",a.email,") - ìœ ì‚¬ë„: ",(a.similarity*100).toFixed(0),"%"]},n))})]})]},t))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{onClick:()=>{I(l.validVendors)},disabled:l.validVendors.length===0,children:"ë“±ë¡ëœ ê±°ë˜ì²˜ë§Œìœ¼ë¡œ ì´ë©”ì¼ ë°œì†¡ ì§„í–‰"}),e.jsx(d,{variant:"outline",onClick:()=>i("none"),children:"ì·¨ì†Œ"})]})]})})]}),F==="email-preview"&&r&&e.jsxs(h,{className:"mt-6 shadow-sm",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-blue-600"}),"ì´ë©”ì¼ ë°œì†¡ ë¯¸ë¦¬ë³´ê¸°"]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["ìˆ˜ì‹ ì (",r.recipients.length,"ëª…)"]}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded border min-h-[60px]",children:r.recipients.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:r.recipients.map((s,t)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded",children:s},t))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"ì´ë©”ì¼ ìˆ˜ì‹ ìê°€ ì—†ìŠµë‹ˆë‹¤."})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"ì œëª©"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:r.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:[r.attachmentInfo.processedFile," (",Math.round(r.attachmentInfo.fileSize/1024),"KB)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{onClick:async()=>{if(!r.canProceed){alert("ì´ë©”ì¼ì„ ë°œì†¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ì‹ ìë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");return}i("sending");try{const t=await(await fetch("/api/excel-automation/send-emails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({processedFilePath:`uploads/${r.attachmentInfo.processedFile}`,recipients:r.recipients,emailOptions:{subject:r.subject,orderNumber:o?.data?.orders?.[0]?.orderNumber||"AUTO",additionalMessage:"ìë™í™” ì‹œìŠ¤í…œì„ í†µí•´ ë°œì†¡ëœ ë°œì£¼ì„œì…ë‹ˆë‹¤."}})})).json();if(t.success)i("completed"),alert(`ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ! (ì„±ê³µ: ${t.data.sentEmails}ê°œ)`);else throw new Error(t.error)}catch(s){console.error("ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",s),alert("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),i("email-preview")}},disabled:!r.canProceed||r.recipients.length===0,className:"bg-blue-600 hover:bg-blue-700",children:["ì´ë©”ì¼ ë°œì†¡ (",r.recipients.length,"ëª…)"]}),e.jsx(d,{variant:"outline",onClick:()=>i("none"),children:"ì·¨ì†Œ"})]})]})})]}),F==="completed"&&e.jsxs(h,{className:"mt-6 shadow-sm",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-green-600"}),"ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ"]})}),e.jsxs(j,{children:[e.jsxs(y,{children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx(f,{children:"ëª¨ë“  ê³¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì£¼ì„œê°€ ì €ì¥ë˜ê³  ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(d,{onClick:()=>window.location.href="/orders",children:"ë°œì£¼ì„œ ê´€ë¦¬ë¡œ ì´ë™"}),e.jsx(d,{variant:"outline",onClick:()=>window.location.reload(),children:"ìƒˆ íŒŒì¼ ì²˜ë¦¬"})]})]})]}),e.jsxs(h,{className:"mt-6 shadow-sm",children:[e.jsx(p,{children:e.jsx(g,{children:"ì‚¬ìš©ë²• ì•ˆë‚´"})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"1. ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Input ì‹œíŠ¸ê°€ í¬í•¨ëœ ë°œì£¼ì„œ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"2. ë°œì£¼ì„œ ë°ì´í„° í™•ì¸"}),e.jsx("p",{className:"text-sm text-gray-600",children:"íŒŒì‹±ëœ ë°œì£¼ì„œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ë³´ê¸°ë¡œ í™•ì¸í•˜ì„¸ìš”."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"3. ê±°ë˜ì²˜ í™•ì¸ ë° ì´ë©”ì¼ ë°œì†¡"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê±°ë˜ì²˜ë¥¼ í™•ì¸í•˜ê³  ì´ë©”ì¼ ìˆ˜ì‹ ìë¥¼ ê²€í† í•œ í›„ ë°œì†¡í•˜ì„¸ìš”."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"4. ì™„ë£Œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"'ë°œì£¼ì„œ ê´€ë¦¬' í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ì—¬ ë°œì£¼ì„œê°€ ì •ìƒ ë“±ë¡ëœ ê²ƒì„ í™•ì¸ í›„, 'ì´ë©”ì¼ ì•„ì´ì½˜'ì„ í´ë¦­í•˜ì—¬ ë°œì†¡í•˜ëŠ” ê²ƒì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤."})]})]})})]})]})]})})}export{le as default};
