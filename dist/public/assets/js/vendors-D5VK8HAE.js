import{b as O,c as R,u as G,r as c,bu as K,o as _,n as Y,t as z,j as e,B as m,P as J,p as f,s as A,I as W,av as D,i as F,U as X}from"./index-DyuWuW3j.js";import{T as Z,a as ee,b as N,c as d,d as se,e as a}from"./table-Dqa_HkkR.js";import{VendorForm as ae}from"./vendor-form-BHeACs2F.js";import{S as te}from"./search-c8LVPAT9.js";import{L as re}from"./list-DYe3eyhz.js";import{G as le}from"./grid-3x3-Dsi099qo.js";import{S as q}from"./square-pen-DnYh_glw.js";import{T as M}from"./trash-2-CpBWm7um.js";import{H as ie}from"./hash-DXswT_D3.js";import{P as ne}from"./phone-9IQZk2ZM.js";import{C as ce}from"./chevron-up-DkMcZm1w.js";import{C as me}from"./chevron-down-McvCdMH5.js";import"./dialog-hovYlODY.js";import"./index-D2D9Pty2.js";import"./textarea-C-UOhm8J.js";import"./info-ZGD2p2Hx.js";import"./circle-check-C0lmIlX2.js";import"./select-DhBGD1cJ.js";import"./index-BdQq_4o_.js";import"./index-CNa4HaJl.js";import"./authUtils-CcDzk6i0.js";function Pe(){const{user:r}=O(),{toast:v}=R(),[,w]=G(),[L,y]=c.useState(!1),[$,C]=c.useState(null),[x,B]=c.useState(""),[o,H]=c.useState(null),[b,V]=c.useState("asc"),[S,T]=c.useState("table"),{data:i,isLoading:k,error:j}=K();console.log("ðŸ” ê±°ëž˜ì²˜ ëª©ë¡ ë””ë²„ê·¸:",{isLoading:k,error:j,errorMessage:j?.message,errorStack:j?.stack,vendors:i?.length||0,vendorsType:typeof i,isArray:Array.isArray(i),firstVendor:i?.[0],userAuthenticated:!!r,userDetails:r?{id:r.id,email:r.email,role:r.role}:null});const g=c.useMemo(()=>{if(!i||!Array.isArray(i))return[];let s=i;if(x.trim()){const t=x.toLowerCase();s=i.filter(l=>l.name?.toLowerCase().includes(t)||l.businessNumber?.includes(t)||l.industry?.toLowerCase().includes(t)||l.contactPerson?.toLowerCase().includes(t)||l.phone?.includes(t)||l.email?.toLowerCase().includes(t)||l.aliases&&Array.isArray(l.aliases)&&l.aliases.some(n=>n.toLowerCase().includes(t)))}return o&&(s=[...s].sort((t,l)=>{let n=t[o],p=l[o];return n==null&&(n=""),p==null&&(p=""),n=String(n).toLowerCase(),p=String(p).toLowerCase(),b==="asc"?n.localeCompare(p):p.localeCompare(n)})),s},[i,x,o,b]),I=_({mutationFn:async s=>{await Y("DELETE",`/api/vendors/${s}`)},onSuccess:()=>{v({title:"ì„±ê³µ",description:"ê±°ëž˜ì²˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),z.invalidateQueries({queryKey:["/api/vendors"]})},onError:s=>{if(s.status===401){v({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{w("/login")},500);return}v({title:"ì˜¤ë¥˜",description:"ê±°ëž˜ì²˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),h=s=>{o===s?V(b==="asc"?"desc":"asc"):(H(s),V("asc"))},u=s=>o!==s?null:b==="asc"?e.jsx(ce,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"}),Q=()=>{C(null),y(!0)},P=s=>{C(s),y(!0)},E=s=>{confirm("ì •ë§ë¡œ ì´ ê±°ëž˜ì²˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&I.mutate(s)},U=()=>{y(!1),C(null),z.invalidateQueries({queryKey:["/api/vendors"]})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ê±°ëž˜ì²˜ ê´€ë¦¬"}),r?.role==="admin"&&e.jsxs(m,{onClick:Q,className:"bg-blue-600 hover:bg-blue-700 text-white shadow-sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"ê±°ëž˜ì²˜ ì¶”ê°€"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê±°ëž˜ì²˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(f,{className:"shadow-sm",children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"ê²€ìƒ‰"}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(W,{placeholder:"ê±°ëž˜ì²˜ëª…, ì‚¬ì—…ìžë²ˆí˜¸ë¡œ ê²€ìƒ‰...",value:x,onChange:s=>B(s.target.value),className:`pl-8 h-10 text-sm ${x?"border-blue-500 bg-blue-50":""}`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[g.length,"ê°œ ê±°ëž˜ì²˜"]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(m,{variant:S==="table"?"default":"ghost",size:"sm",onClick:()=>T("table"),className:"h-8 w-8 p-0",title:"ëª©ë¡ ë³´ê¸°",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(m,{variant:S==="cards"?"default":"ghost",size:"sm",onClick:()=>T("cards"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(le,{className:"h-4 w-4"})})]})]})]})})})}),S==="table"?e.jsx(f,{className:"shadow-sm",children:e.jsx(A,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(N,{className:"border-b border-gray-200",children:[e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>h("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ê±°ëž˜ì²˜ëª…"}),u("name")]})}),e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>h("businessNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ì‚¬ì—…ìžë²ˆí˜¸"}),u("businessNumber")]})}),e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>h("industry"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ì—…ì¢…"}),u("industry")]})}),e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>h("contactPerson"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ë‹´ë‹¹ìž"}),u("contactPerson")]})}),e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>h("phone"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ì—°ë½ì²˜"}),u("phone")]})}),e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>h("createdAt"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ë“±ë¡ì¼"}),u("createdAt")]})}),r?.role==="admin"&&e.jsx(d,{className:"px-6 py-3 text-sm font-medium text-gray-600 text-right",children:"ê´€ë¦¬"})]})}),e.jsx(se,{children:k?[...Array(5)].map((s,t)=>e.jsxs(N,{children:[e.jsx(a,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),r?.role==="admin"&&e.jsx(a,{})]},t)):j?e.jsx(N,{children:e.jsxs(a,{colSpan:r?.role==="admin"?7:6,className:"text-center py-6 text-sm text-red-500",children:["ì˜¤ë¥˜: ",j?.message||"ê±°ëž˜ì²˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"]})}):g.length===0?e.jsx(N,{children:e.jsx(a,{colSpan:r?.role==="admin"?7:6,className:"text-center py-6 text-sm text-gray-500",children:x?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ ê±°ëž˜ì²˜ê°€ ì—†ìŠµë‹ˆë‹¤"})}):g.map(s=>e.jsxs(N,{className:"hover:bg-gray-50 border-b border-gray-100",children:[e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-700 overflow-hidden text-ellipsis whitespace-nowrap",onClick:()=>w(`/vendors/${s.id}`),title:s.name,children:s.name})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.businessNumber||"-"})}),e.jsx(a,{className:"py-4 px-6",children:s.industry?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-800",children:s.industry}):e.jsx("span",{className:"text-sm text-gray-900",children:"-"})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.contactPerson||"-"})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.phone||"-"})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:D(s.createdAt)})}),r?.role==="admin"&&e.jsx(a,{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>P(s),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",title:"ìˆ˜ì •",children:e.jsx(q,{className:"h-3 w-3"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>E(s.id),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(M,{className:"h-3 w-3"})})]})})]},s.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2",children:k?[...Array(6)].map((s,t)=>e.jsx(f,{className:"shadow-sm",children:e.jsx(A,{className:"p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-1/2"})]})})},t)):g.length===0?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx(F,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ë“±ë¡ëœ ê±°ëž˜ì²˜ê°€ ì—†ìŠµë‹ˆë‹¤."})]}):g.map(s=>e.jsxs(f,{className:"p-3 hover:shadow-md transition-shadow shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 cursor-pointer hover:text-blue-600",onClick:()=>w(`/vendors/${s.id}`),children:s.name}),s.industry&&e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-800 mt-1",children:s.industry})]})]}),e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs ${s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.isActive?"í™œì„±":"ë¹„í™œì„±"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(ie,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{className:"ml-1",children:s.businessNumber||"-"})]}),s.contactPerson&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(X,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ë‹´ë‹¹ìž:"}),e.jsx("span",{className:"ml-1",children:s.contactPerson})]}),s.phone&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(ne,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ì „í™”ë²ˆí˜¸:"}),e.jsx("span",{className:"ml-1",children:s.phone})]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:e.jsxs("span",{children:["ë“±ë¡ì¼: ",D(s.createdAt)]})}),r?.role==="admin"&&e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>P(s),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",title:"ìˆ˜ì •",children:e.jsx(q,{className:"h-3 w-3"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>E(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(M,{className:"h-3 w-3"})})]})]},s.id))}),L&&e.jsx(ae,{isOpen:L,vendor:$,onClose:()=>y(!1),onSuccess:U})]})})}export{Pe as default};
