import{aX as n,e as Qe,h as He,r as d,q as C,aQ as Re,aY as Ge,s as pe,j as e,w as F,L as _,N as q,x as E,O as k,S as O,z as V,A as L,D as M,G as $,y as h,B as N,P as Ye,f as X,aO as Je,T as ue,F as We,k as K,K as Z}from"./index-BG1rhx1f-1757295609105.js";import{T as Xe}from"./textarea-B9apWibA-1757295609105.js";import{T as Ze,a as et,b as ee,c as p,d as tt,e as c}from"./table-Be0c0fUf-1757295609105.js";import{i as xe}from"./authUtils-CcDzk6i0-1757295609105.js";import{U as at}from"./upload-CGOISBcZ-1757295609105.js";const rt=n.object({itemId:n.number().optional(),itemName:n.string().min(1,"í’ˆëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"),specification:n.string().optional(),majorCategory:n.string().optional(),middleCategory:n.string().optional(),minorCategory:n.string().optional(),quantity:n.number().positive("ìˆ˜ëŸ‰ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤"),unitPrice:n.number().positive("ë‹¨ê°€ëŠ” 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤"),notes:n.string().optional()}),st=n.object({templateId:n.number().optional(),projectId:n.number().min(1,"í˜„ì¥ì„ ì„ íƒí•˜ì„¸ìš”"),vendorId:n.number().min(1,"ê±°ë˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"),orderDate:n.string().min(1,"ë°œì£¼ì¼ìë¥¼ ì„ íƒí•˜ì„¸ìš”"),deliveryDate:n.string().optional(),notes:n.string().optional(),items:n.array(rt).min(1,"ìµœì†Œ í•˜ë‚˜ì˜ í’ˆëª©ì„ ì¶”ê°€í•˜ì„¸ìš”"),customFields:n.record(n.any()).optional()});function pt({orderId:x,onSuccess:te,onCancel:he,preselectedTemplateId:it}){const{toast:m}=Qe(),{theme:je}=He(),s=je==="dark",[U,ot]=d.useState(null),[be,fe]=d.useState([]),[Ne,ae]=d.useState(!0),[ve,re]=d.useState(null);d.useEffect(()=>{(async()=>{try{ae(!0),console.log("Loading templates...");const a=await fetch("/api/admin/templates",{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(console.log("Template response status:",a.status),!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const r=await a.json();console.log("Templates loaded:",r),fe(r),re(null)}catch(a){console.error("Error loading templates:",a),re(a)}finally{ae(!1)}})()},[]);const{data:we}=C({queryKey:["/api/admin/templates",U],enabled:!!U,retry:1}),v=we,{data:Ce,isLoading:nt,error:lt}=C({queryKey:["/api/items"],select:t=>t.items||[],retry:1}),{data:B,isLoading:$e,error:Ie}=C({queryKey:["/api/categories"],queryFn:async()=>{console.log("ğŸ” Fetching categories from /api/categories");const t=await fetch("/api/categories",{credentials:"include"});if(console.log("ğŸ” Categories response status:",t.status),!t.ok)throw new Error("Failed to fetch categories");const a=await t.json();return console.log("ğŸ” Categories response data:",a),a},retry:1});B?.categories;const Q=B?.flatCategories||[],D=Q.filter(t=>t.categoryType==="major"),z=Q.filter(t=>t.categoryType==="middle"),se=Q.filter(t=>t.categoryType==="minor"),{data:ie,isLoading:Te}=C({queryKey:["/api/projects"],retry:1});console.log("Items data:",Ce),console.log("Templates data:",be),console.log("Templates loading:",Ne),console.log("Templates error:",ve),console.log("API endpoint test for templates"),console.log("ğŸ” Categories debug:",{isLoadingCategories:$e,categoriesError:Ie,categoriesResponse:B,majorCategoriesCount:D?.length,middleCategoriesCount:z?.length,minorCategoriesCount:se?.length});const[l,S]=d.useState([{itemId:0,itemName:"",specification:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unitPrice:0,notes:""}]),[u,P]=d.useState([""]),[I,oe]=d.useState([]),[T,H]=d.useState(!1),[g,De]=d.useState(null),[y,Se]=d.useState(null),ne=t=>t===0||isNaN(t)?"":X(t),le=t=>{const a=t.replace(/[â‚©,\s]/g,""),r=parseFloat(a);return isNaN(r)?0:r},{register:R,handleSubmit:Pe,watch:Fe,setValue:w,reset:ce,formState:{errors:j}}=Re({resolver:Ge(st),defaultValues:{templateId:void 0,projectId:0,vendorId:0,orderDate:new Date().toISOString().split("T")[0],deliveryDate:"",notes:"",items:l,customFields:{}}}),{data:de}=C({queryKey:["/api/vendors"]});C({queryKey:["/api/projects"]});const{data:A,isLoading:G}=C({queryKey:["/api/orders",x],enabled:!!x}),Y=pe({mutationFn:async t=>await K("POST","/api/orders",t),onSuccess:async t=>{const a=t?.id;if(I.length>0&&a)try{const r=new FormData;I.forEach(i=>{r.append("files",i)}),await K("POST",`/api/orders/${a}/attachments`,r)}catch(r){console.error("Error uploading files:",r)}Z.invalidateQueries({queryKey:["/api/orders"]}),m({title:"ì„±ê³µ",description:"ë°œì£¼ì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),te?.()},onError:t=>{if(xe(t)){m({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}m({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),J=pe({mutationFn:async t=>{const{items:a,...r}=t;if(await K("PUT",`/api/orders/${x}`,{...r,items:a.map(i=>({...i,totalAmount:(i.quantity||0)*(i.unitPrice||0)}))}),I.length>0){const i=new FormData;I.forEach(o=>{i.append("files",o)}),await K("POST",`/api/orders/${x}/attachments`,i)}},onSuccess:()=>{Z.invalidateQueries({queryKey:["/api/orders"]}),Z.invalidateQueries({queryKey:["/api/orders",x]}),m({title:"ì„±ê³µ",description:"ë°œì£¼ì„œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),te?.()},onError:t=>{if(xe(t)){m({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}m({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});d.useEffect(()=>{if(A&&!G&&typeof A=="object"){const t=A,a=(t.items||[]).map(r=>({itemId:r.itemId||0,itemName:r.itemName,specification:r.specification||"",majorCategory:r.majorCategory||"",middleCategory:r.middleCategory||"",minorCategory:r.minorCategory||"",quantity:r.quantity,unitPrice:r.unitPrice,notes:r.notes||""}));ce({vendorId:t.vendorId,orderDate:new Date(t.orderDate).toISOString().split("T")[0],deliveryDate:t.deliveryDate?new Date(t.deliveryDate).toISOString().split("T")[0]:"",notes:t.notes||"",items:a}),S(a)}},[A,G,ce]);const _e=()=>{const t=l.length>0?l[l.length-1]:null,a=u.length>0?u[u.length-1]:"",r=t?{itemId:t.itemId,itemName:t.itemName,specification:t.specification,majorCategory:t.majorCategory,middleCategory:t.middleCategory,minorCategory:t.minorCategory,quantity:t.quantity,unitPrice:t.unitPrice,notes:t.notes}:{itemId:0,itemName:"",specification:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unitPrice:0,notes:""},i=[...l,r];S(i),w("items",i),P([...u,a])},qe=t=>{const a=l[t],r=u[t]||"",i={itemId:a.itemId,itemName:a.itemName,specification:a.specification,majorCategory:a.majorCategory,middleCategory:a.middleCategory,minorCategory:a.minorCategory,quantity:a.quantity,unitPrice:a.unitPrice,notes:a.notes},o=[...l,i];S(o),w("items",o),P([...u,r])},Ee=t=>{if(l.length===1)return;const a=l.filter((i,o)=>o!==t),r=u.filter((i,o)=>o!==t);S(a),w("items",a),P(r)},b=(t,a,r)=>{const i=[...l];i[t]={...i[t],[a]:r},a==="majorCategory"?(i[t].middleCategory="",i[t].minorCategory=""):a==="middleCategory"&&(i[t].minorCategory=""),S(i),w("items",i)},ke=t=>{if(console.log("ğŸ” getMiddleCategoriesForMajor called with:",t),console.log("ğŸ” Major categories available:",D?.length),console.log("ğŸ” Middle categories available:",z?.length),!t)return console.log("âŒ No major category name provided"),[];const a=D.find(i=>i.categoryName===t);if(console.log("ğŸ” Found major category:",a),!a)return console.log("âŒ Major category not found"),console.log("Available major categories:",D?.map(i=>i.categoryName)),[];const r=z.filter(i=>i.parentId===a.id);return console.log("ğŸ” Filtered middle categories:",r),r},Oe=t=>{if(!t)return[];const a=z.find(r=>r.categoryName===t);return a?se.filter(r=>r.parentId===a.id):[]},W=t=>(t.quantity||0)*(t.unitPrice||0),me=()=>l.reduce((t,a)=>t+W(a),0),ge=t=>{const a=t.filter(r=>["application/pdf","image/jpeg","image/png","image/gif","application/dwg","application/x-dwg"].includes(r.type)?r.size>10485760?(m({title:"íŒŒì¼ í¬ê¸° ì˜¤ë¥˜",description:`${r.name}ì€(ëŠ”) íŒŒì¼ í¬ê¸°ê°€ 10MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤.`,variant:"destructive"}),!1):!0:(m({title:"íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜",description:`${r.name}ì€(ëŠ”) ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.`,variant:"destructive"}),!1));a.length>0&&(oe(r=>[...r,...a]),m({title:"íŒŒì¼ ì—…ë¡œë“œ",description:`${a.length}ê°œì˜ íŒŒì¼ì´ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.`}))},Ve=t=>{const a=Array.from(t.target.files||[]);ge(a),t.target&&(t.target.value="")},Le=t=>{t.preventDefault(),t.stopPropagation(),H(!0)},Me=t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget.contains(t.relatedTarget)||H(!1)},ze=t=>{t.preventDefault(),t.stopPropagation()},Ae=t=>{t.preventDefault(),t.stopPropagation(),H(!1);const a=Array.from(t.dataTransfer.files);a.length>0&&ge(a)},Ke=t=>{oe(a=>a.filter((r,i)=>i!==t))},Ue=()=>{if(!v?.fieldsConfig)return null;try{const t=typeof v.fieldsConfig=="string"?JSON.parse(v.fieldsConfig):v.fieldsConfig,a=[];if(v.templateType==="material_extrusion")t.basic_fields&&a.push({key:"basic_fields",name:"ê¸°ë³¸ ì •ë³´",fields:t.basic_fields}),t.extrusion_list&&a.push({key:"extrusion_list",name:"ì••ì¶œ ëª©ë¡",fields:t.extrusion_list}),t.schedule_fields&&a.push({key:"schedule_fields",name:"ì¼ì • ì •ë³´",fields:t.schedule_fields}),t.specification_fields&&a.push({key:"specification_fields",name:"ì‚¬ì–‘ ì •ë³´",fields:t.specification_fields});else if(v.templateType==="panel_manufacturing")t.basic_fields&&a.push({key:"basic_fields",name:"ê¸°ë³¸ ì •ë³´",fields:t.basic_fields}),t.color_breakdown&&a.push({key:"color_breakdown",name:"ìƒ‰ìƒ ë¶„ë¥˜",fields:t.color_breakdown}),t.material_fields&&a.push({key:"material_fields",name:"ì¬ë£Œ ì •ë³´",fields:t.material_fields}),t.panel_breakdown&&a.push({key:"panel_breakdown",name:"íŒë„¬ ë¶„ë¥˜",fields:t.panel_breakdown}),t.delivery_schedule&&a.push({key:"delivery_schedule",name:"ë°°ì†¡ ì¼ì •",fields:t.delivery_schedule}),t.insulation_details&&a.push({key:"insulation_details",name:"ë‹¨ì—´ì¬ ìƒì„¸",fields:t.insulation_details});else if(t.fields&&Array.isArray(t.fields)){const r=t.fields.reduce((i,o)=>{const f=o.sectionName||"ê¸°ë³¸ ì •ë³´";return i[f]||(i[f]=[]),i[f].push(o),i},{});Object.entries(r).forEach(([i,o])=>{a.push({key:i,name:i,fields:o})})}return a.length===0?null:a.map(r=>e.jsxs(F,{className:`mb-4 transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(_,{className:"pb-2",children:e.jsx(q,{className:`text-lg transition-colors ${s?"text-white":"text-gray-900"}`,children:r.name})}),e.jsx(E,{className:"pt-2",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:Array.isArray(r.fields)?r.fields.map(i=>ye(i)):Object.entries(r.fields).map(([i,o])=>ye({fieldName:i,label:o,fieldType:i.includes("date")?"date":i.includes("amount")||i.includes("price")||i.includes("quantity")||i.includes("count")||i.includes("weight")||i.includes("kg")||i.includes("area")||i==="quantity"?"number":"text"}))})})]},r.key))}catch(t){return console.error("Error rendering dynamic template fields:",t),null}},ye=t=>{const a=t.fieldName||t.id,r=t.label,i=t.fieldType||"text";return e.jsxs("div",{children:[e.jsx(k,{htmlFor:a,className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:r}),e.jsx(h,{id:a,type:i,placeholder:`${r}ì„ ì…ë ¥í•˜ì„¸ìš”`,className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,onChange:o=>{const f=Fe("customFields")||{};w("customFields",{...f,[a]:o.target.value})}})]},a)},Be=t=>{const a=Number(t.vendorId);if(!a||a===0){m({title:"ì˜¤ë¥˜",description:"ê±°ë˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}const r={...t,vendorId:a,projectId:t.projectId?Number(t.projectId):void 0,templateId:void 0,orderDate:t.orderDate,deliveryDate:t.deliveryDate||void 0,items:l.map(i=>({...i,itemId:Number(i.itemId),quantity:Number(i.quantity),unitPrice:Number(i.unitPrice),totalAmount:W(i)})),totalAmount:me(),isDirectSubmit:!x};x?J.mutate(r):Y.mutate(r)};return G&&x?e.jsx("div",{className:"p-6",children:"Loading..."}):e.jsx("div",{className:`max-w-[1366px] mx-auto compact-form space-y-3 pb-20 transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("form",{onSubmit:Pe(Be),className:"space-y-3",children:[e.jsxs(F,{className:`transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(_,{className:"pb-2",children:e.jsx(q,{className:`text-lg transition-colors ${s?"text-white":"text-gray-900"}`,children:"ê¸°ë³¸ ì •ë³´"})}),e.jsxs(E,{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"projectId",className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"í˜„ì¥ *"}),e.jsxs(O,{onValueChange:t=>{const a=parseInt(t);w("projectId",a);const r=ie?.find(i=>i.id===a);r&&De(r)},children:[e.jsx(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(L,{placeholder:"í˜„ì¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(M,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:Te?e.jsx($,{value:"loading",disabled:!0,children:"ë¡œë”© ì¤‘..."}):ie?.map(t=>e.jsxs($,{value:t.id.toString(),children:[t.projectName," (",t.projectCode,")"]},t.id))||e.jsx($,{value:"no-projects",disabled:!0,children:"í˜„ì¥ì´ ì—†ìŠµë‹ˆë‹¤"})})]}),j.projectId&&e.jsx("p",{className:`text-sm mt-1 transition-colors ${s?"text-red-400":"text-red-500"}`,children:j.projectId.message})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"vendorId",className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"ê±°ë˜ì²˜ *"}),e.jsxs(O,{onValueChange:t=>{const a=parseInt(t);w("vendorId",a);const r=de?.find(i=>i.id===a);r&&Se(r)},children:[e.jsx(V,{className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(L,{placeholder:"ê±°ë˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(M,{className:`z-[100] dropdown-high-priority transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,style:{position:"fixed",zIndex:9999},children:de?.map(t=>e.jsx($,{value:t.id.toString(),children:t.name},t.id))})]}),j.vendorId&&e.jsx("p",{className:`text-sm mt-1 transition-colors ${s?"text-red-400":"text-red-500"}`,children:j.vendorId.message})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"orderDate",className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"ë°œì£¼ì„œ ì‘ì„±ì¼ *"}),e.jsx(h,{id:"orderDate",type:"date",className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,...R("orderDate")}),j.orderDate&&e.jsx("p",{className:`text-sm mt-1 transition-colors ${s?"text-red-400":"text-red-500"}`,children:j.orderDate.message})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"deliveryDate",className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"ë‚©í’ˆ í¬ë§ì¼"}),e.jsx(h,{id:"deliveryDate",type:"date",className:`transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,...R("deliveryDate")})]})]}),(g||y)&&e.jsx("div",{className:`mt-4 pt-4 border-t transition-colors ${s?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g&&e.jsxs("div",{className:`p-3 rounded-lg transition-colors ${s?"bg-blue-900/20 border border-blue-800":"bg-blue-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${s?"text-blue-300":"text-blue-900"}`,children:"í˜„ì¥ ì •ë³´"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"í˜„ì¥ëª…:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:g.projectName})]}),g.location&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ì£¼ì†Œ:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:g.location})]}),g.projectManager&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"í˜„ì¥ ê´€ë¦¬ì:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:g.projectManager})]}),g.managerPhone&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ì „í™”ë²ˆí˜¸:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:g.managerPhone})]}),g.managerEmail&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ì´ë©”ì¼:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:g.managerEmail})]})]})]}),y&&e.jsxs("div",{className:`p-3 rounded-lg transition-colors ${s?"bg-green-900/20 border border-green-800":"bg-green-50"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors ${s?"text-green-300":"text-green-900"}`,children:"ê±°ë˜ì²˜ ì •ë³´"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ê±°ë˜ì²˜ëª…:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:y.name})]}),y.contactPerson&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ë‹´ë‹¹ì:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:y.contactPerson})]}),y.phone&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ì—°ë½ì²˜:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:y.phone})]}),y.email&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ì´ë©”ì¼:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:y.email})]}),y.address&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"ì£¼ì†Œ:"}),e.jsx("span",{className:`ml-2 transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:y.address})]})]})]})]})})]})]}),v&&Ue(),e.jsxs(F,{className:`transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(_,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(q,{className:`text-lg transition-colors ${s?"text-white":"text-gray-900"}`,children:"ë°œì£¼ í’ˆëª©"}),e.jsxs(N,{type:"button",variant:"outline",size:"sm",onClick:_e,children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"í’ˆëª© ì¶”ê°€"]})]})}),e.jsxs(E,{className:"pt-2",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ze,{children:[e.jsx(et,{children:e.jsxs(ee,{children:[e.jsx(p,{className:"py-2",children:"í’ˆëª©ëª…"}),e.jsx(p,{className:"py-2",children:"ê·œê²©"}),e.jsx(p,{className:"py-2",children:"ëŒ€ë¶„ë¥˜"}),e.jsx(p,{className:"py-2",children:"ì¤‘ë¶„ë¥˜"}),e.jsx(p,{className:"py-2",children:"ì†Œë¶„ë¥˜"}),e.jsx(p,{className:"py-2",children:"ìˆ˜ëŸ‰"}),e.jsx(p,{className:"py-2",children:"ë‹¨ê°€"}),e.jsx(p,{className:"py-2",children:"ê¸ˆì•¡"}),e.jsx(p,{className:"py-2",children:"ë¹„ê³ "}),e.jsx(p,{className:"py-2 text-center",children:"ë³µì‚¬"}),e.jsx(p,{className:"py-2 text-center",children:"ì‚­ì œ"})]})}),e.jsx(tt,{children:l.map((t,a)=>e.jsxs(ee,{children:[e.jsx(c,{className:"py-1",children:e.jsx("div",{className:"min-w-[180px]",children:e.jsx(h,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,placeholder:"í’ˆëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”",value:t.itemName,onChange:r=>b(a,"itemName",r.target.value)})})}),e.jsx(c,{className:"py-1",children:e.jsx(h,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,placeholder:"ê·œê²©",value:t.specification,onChange:r=>b(a,"specification",r.target.value)})}),e.jsx(c,{className:"py-1",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsxs(O,{value:t.majorCategory,onValueChange:r=>b(a,"majorCategory",r),children:[e.jsx(V,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(L,{placeholder:"ëŒ€ë¶„ë¥˜ ì„ íƒ"})}),e.jsx(M,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:D?.map(r=>e.jsx($,{value:r.categoryName,children:r.categoryName},r.id))})]})})}),e.jsx(c,{className:"py-1",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsxs(O,{value:t.middleCategory,onValueChange:r=>b(a,"middleCategory",r),disabled:!t.majorCategory,children:[e.jsx(V,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(L,{placeholder:"ì¤‘ë¶„ë¥˜ ì„ íƒ"})}),e.jsx(M,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:ke(t.majorCategory)?.map(r=>e.jsx($,{value:r.categoryName,children:r.categoryName},r.id))})]})})}),e.jsx(c,{className:"py-1",children:e.jsx("div",{className:"min-w-[120px]",children:e.jsxs(O,{value:t.minorCategory,onValueChange:r=>b(a,"minorCategory",r),disabled:!t.middleCategory,children:[e.jsx(V,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:e.jsx(L,{placeholder:"ì†Œë¶„ë¥˜ ì„ íƒ"})}),e.jsx(M,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:Oe(t.middleCategory)?.map(r=>e.jsx($,{value:r.categoryName,children:r.categoryName},r.id))})]})})}),e.jsx(c,{className:"py-1",children:e.jsx(h,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,type:"number",placeholder:"ìˆ˜ëŸ‰",value:t.quantity||"",onChange:r=>b(a,"quantity",parseFloat(r.target.value)||0)})}),e.jsx(c,{className:"py-1",children:e.jsx(h,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,type:"text",placeholder:"â‚©0",value:u[a]||ne(t.unitPrice),onChange:r=>{const i=[...u];i[a]=r.target.value,P(i);const o=le(r.target.value);b(a,"unitPrice",o)},onBlur:r=>{const i=le(r.target.value),o=ne(i),f=[...u];f[a]=o,P(f)}})}),e.jsx(c,{className:"py-1",children:e.jsx(h,{className:`h-8 transition-colors ${s?"bg-gray-700":"bg-gray-50"}`,readOnly:!0,value:X(W(t))})}),e.jsx(c,{className:"py-1",children:e.jsx(h,{className:`h-8 transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,placeholder:"ë¹„ê³ ",value:t.notes,onChange:r=>b(a,"notes",r.target.value)})}),e.jsx(c,{className:"py-1 text-center",children:e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>qe(a),className:"h-6 w-6 p-0",children:e.jsx(Je,{className:"h-3 w-3 text-blue-500"})})}),e.jsx(c,{className:"py-1 text-center",children:e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>Ee(a),disabled:l.length===1,className:"h-6 w-6 p-0",children:e.jsx(ue,{className:"h-3 w-3 text-red-500"})})})]},a))}),e.jsx("tfoot",{className:`transition-colors ${s?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs(ee,{children:[e.jsx(c,{colSpan:7,className:`py-2 text-right font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"ì´ ê¸ˆì•¡:"}),e.jsx(c,{className:`py-2 font-bold text-lg transition-colors ${s?"text-white":"text-gray-900"}`,children:X(me())}),e.jsx(c,{colSpan:3,className:"py-2"})]})})]})}),j.items&&e.jsx("p",{className:`text-sm mt-2 transition-colors ${s?"text-red-400":"text-red-500"}`,children:j.items.message})]})]}),e.jsxs(F,{className:`transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(_,{className:"pb-2",children:e.jsx(q,{className:`text-lg transition-colors ${s?"text-white":"text-gray-900"}`,children:"íŒŒì¼ ì²¨ë¶€"})}),e.jsxs(E,{className:"pt-2",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 cursor-pointer ${T?s?"border-blue-400 bg-blue-900/20 scale-[1.02]":"border-blue-500 bg-blue-50 scale-[1.02]":s?"border-gray-600 hover:border-blue-400/50 hover:bg-gray-700/50":"border-gray-300 hover:border-blue-400/50 hover:bg-gray-50"}`,onDragEnter:Le,onDragLeave:Me,onDragOver:ze,onDrop:Ae,onClick:()=>document.getElementById("fileUpload")?.click(),children:[e.jsx(at,{className:`mx-auto h-8 w-8 mb-3 transition-all duration-200 ${T?s?"text-blue-400 scale-110":"text-blue-500 scale-110":s?"text-gray-500":"text-gray-400"}`}),e.jsx("p",{className:`text-base mb-2 font-medium transition-colors ${T?s?"text-blue-400":"text-blue-600":s?"text-gray-300":"text-gray-700"}`,children:T?"íŒŒì¼ì„ ë†“ì•„ì£¼ì„¸ìš”":"íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"}),e.jsx("p",{className:`text-sm mb-4 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:"ëª¨ë“  íŒŒì¼ í˜•ì‹ ì§€ì› (ìµœëŒ€ 10MB)"}),e.jsx("input",{type:"file",multiple:!0,accept:"*",onChange:Ve,className:"hidden",id:"fileUpload"}),e.jsx(N,{type:"button",variant:T?"default":"outline",size:"sm",className:`transition-all duration-200 ${T?"scale-105":""}`,onClick:t=>{t.stopPropagation(),document.getElementById("fileUpload")?.click()},children:"íŒŒì¼ ì„ íƒ"})]}),I.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("h4",{className:`text-sm font-medium transition-colors ${s?"text-white":"text-gray-900"}`,children:"ì²¨ë¶€ëœ íŒŒì¼"}),I.map((t,a)=>e.jsxs("div",{className:`flex items-center justify-between p-1 rounded text-xs transition-colors ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(We,{className:`h-3 w-3 transition-colors ${s?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:t.name}),e.jsxs("span",{className:`transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:["(",(t.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx(N,{type:"button",variant:"ghost",size:"sm",className:"h-4 w-4 p-0",onClick:()=>Ke(a),children:e.jsx(ue,{className:"h-3 w-3 text-red-500"})})]},a))]})]})]}),e.jsxs(F,{className:`transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(_,{className:"pb-2",children:e.jsx(q,{className:`text-lg transition-colors ${s?"text-white":"text-gray-900"}`,children:"íŠ¹ì´ì‚¬í•­"})}),e.jsx(E,{className:"pt-2",children:e.jsx(Xe,{...R("notes"),placeholder:"ë°œì£¼ ê´€ë ¨ íŠ¹ì´ì‚¬í•­ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”",rows:3,className:`text-sm transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})})]}),e.jsx("div",{className:"sticky bottom-0 z-10 mt-6",children:e.jsx("div",{className:`p-4 border-t shadow-lg transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto flex flex-col sm:flex-row justify-end gap-3",children:[e.jsx(N,{type:"button",variant:"outline",className:"w-full sm:w-auto px-6 py-3 text-base font-medium",onClick:he,children:"ì·¨ì†Œ"}),e.jsx(N,{type:"button",variant:"secondary",className:"w-full sm:w-auto px-6 py-3 text-base font-medium",onClick:()=>{m({title:"ì„ì‹œ ì €ì¥",description:"ì„ì‹œ ì €ì¥ ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤."})},children:"ì„ì‹œ ì €ì¥"}),e.jsx(N,{type:"submit",className:"w-full sm:w-auto px-6 py-3 text-base font-medium",disabled:Y.isPending||J.isPending,children:Y.isPending||J.isPending?"ì €ì¥ ì¤‘...":x?"ìˆ˜ì •":"ë°œì£¼ì„œ ìƒì„±"})]})})})]})},`general-${U}`)}export{pt as OrderForm};
