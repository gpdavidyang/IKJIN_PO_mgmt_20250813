import{d as k,e as C,u as T,g as E,h as P,aP as S,q as y,s as M,r as q,j as e,B as o,V as j,l as v,o as N,T as z,_ as B,Z as K,M as R,c9 as F,bd as U}from"./index-F0V4iaOu-1757246496717.js";import{A as H,f as I,a as Q,b as O,c as V,d as _,e as Y,g as Z,h as G}from"./alert-dialog-Cmn9oN8L-1757246496717.js";import{i as J}from"./authUtils-CcDzk6i0-1757246496717.js";import{S as W}from"./square-pen-DzUKhdq2-1757246496717.js";import{H as h}from"./hash-BrOAGcWQ-1757246496717.js";import{P as p}from"./phone-Dd6aqrC7-1757246496717.js";import{M as X}from"./map-pin-BPcwsStM-1757246496717.js";import"./index-C5c6Cl-0-1757246496717.js";function ce(){const{user:l,isAuthenticated:b,isLoading:x}=k(),{toast:n}=C(),[,a]=T(),$=E(),{theme:f}=P(),s=f==="dark",[ee,u]=S("/vendors/:id"),i=u?.id?parseInt(u.id):0,{data:t,isLoading:w}=y({queryKey:[`/api/vendors/${i}`],enabled:!!l}),{data:A,isLoading:D}=y({queryKey:[`/api/orders/vendor/${i}`],queryFn:async()=>{const r=new URLSearchParams;r.append("vendorId",i.toString()),r.append("limit","1000");const g=`/api/orders?${r.toString()}`,d=await fetch(g,{credentials:"include"});if(!d.ok)throw new Error(`${d.status}: ${d.statusText}`);return await d.json()},enabled:!!l}),m=M({mutationFn:async()=>{const r=await fetch(`/api/vendors/${i}`,{method:"DELETE"});if(!r.ok)throw new Error(`${r.status}: ${r.statusText}`);return r.json()},onSuccess:()=>{n({title:"성공",description:"거래처가 삭제되었습니다."}),$.invalidateQueries({queryKey:["/api/vendors"]}),a("/vendors")},onError:r=>{if(J(r)){n({title:"권한 없음",description:"로그인이 필요합니다.",variant:"destructive"}),setTimeout(()=>{a("/login")},500);return}n({title:"오류",description:"거래처 삭제에 실패했습니다. 연결된 발주서가 있는지 확인해주세요.",variant:"destructive"})}});q.useEffect(()=>{if(!x&&!b){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{a("/login")},500);return}},[b,x,n]);const L=()=>{m.mutate()};if(x||!l)return e.jsx("div",{className:`min-h-screen transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsx("div",{className:"max-w-[1366px] mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`animate-spin rounded-full h-8 w-8 border-b-2 mx-auto mb-4 transition-colors ${s?"border-blue-400":"border-blue-600"}`}),e.jsx("p",{className:`transition-colors ${s?"text-gray-300":"text-gray-600"}`,children:"로딩 중..."})]})})})});if(w)return e.jsx("div",{className:`min-h-screen transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsx("div",{className:"max-w-[1366px] mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`animate-spin rounded-full h-8 w-8 border-b-2 mx-auto mb-4 transition-colors ${s?"border-blue-400":"border-blue-600"}`}),e.jsx("p",{className:`transition-colors ${s?"text-gray-300":"text-gray-600"}`,children:"거래처 정보를 불러오는 중..."})]})})})});if(!t)return e.jsx("div",{className:`min-h-screen transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsx("div",{className:"max-w-[1366px] mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:`text-xl font-semibold mb-2 transition-colors ${s?"text-white":"text-gray-900"}`,children:"거래처를 찾을 수 없습니다"}),e.jsx("p",{className:`mb-4 transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"요청하신 거래처가 존재하지 않거나 삭제되었습니다."}),e.jsxs(o,{onClick:()=>a("/vendors"),className:`shadow-md hover:shadow-lg transition-all duration-200 ${s?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"거래처 목록으로 돌아가기"]})]})})})});const c=A?.orders||[];return t?e.jsx("div",{className:`min-h-screen transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>a("/vendors"),className:`transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"목록"]}),e.jsx("div",{className:`p-2 rounded-lg transition-colors ${s?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(v,{className:`h-6 w-6 transition-colors ${s?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${s?"text-white":"text-gray-900"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"거래처 상세 정보"})]}),e.jsx(N,{variant:t.isActive?"default":"secondary",children:t.isActive?"활성":"비활성"})]}),e.jsx("div",{className:"flex space-x-2",children:l?.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>a(`/vendors/${i}/edit`),className:`transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(W,{className:"h-3 w-3 mr-1"}),"수정"]}),e.jsxs(H,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(o,{variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"삭제"]})}),e.jsxs(Q,{className:`transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs(O,{children:[e.jsx(V,{className:`transition-colors ${s?"text-white":"text-gray-900"}`,children:"거래처 삭제"}),e.jsxs(_,{className:`transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:['정말로 "',t.name,'" 거래처를 삭제하시겠습니까?',e.jsx("br",{}),"이 작업은 되돌릴 수 없으며, 연결된 발주서가 있는 경우 삭제할 수 없습니다."]})]}),e.jsxs(Y,{children:[e.jsx(Z,{className:`transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"취소"}),e.jsx(G,{onClick:L,disabled:m.isPending,className:"bg-red-600 hover:bg-red-700 text-white shadow-md hover:shadow-lg transition-all duration-200",children:m.isPending?"삭제 중...":"삭제"})]})]})]})]})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`p-6 border-b transition-colors ${s?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 transition-colors ${s?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(B,{className:`h-5 w-5 transition-colors ${s?"text-blue-400":"text-blue-600"}`})}),e.jsx("h3",{className:`text-lg font-semibold transition-colors ${s?"text-white":"text-gray-900"}`,children:"기본 정보"})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(h,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"거래처명"]}),e.jsx("p",{className:`text-sm font-semibold transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.name})]}),t.businessNumber&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(h,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"사업자번호"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.businessNumber})]}),t.industry&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(v,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"업종"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.industry})]}),t.contactPerson&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(K,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"담당자"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.contactPerson})]})]})]}),e.jsxs("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`p-6 border-b transition-colors ${s?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 transition-colors ${s?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(p,{className:`h-5 w-5 transition-colors ${s?"text-blue-400":"text-blue-600"}`})}),e.jsx("h3",{className:`text-lg font-semibold transition-colors ${s?"text-white":"text-gray-900"}`,children:"연락처 정보"})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[t.phone&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(p,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"전화번호"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.phone})]}),t.email&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(R,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"이메일"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.email})]}),t.address&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(X,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"주소"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.address})]}),t.memo&&e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center text-sm font-medium mb-1 transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx(h,{className:`h-4 w-4 mr-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`}),"메모"]}),e.jsx("p",{className:`text-sm transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:t.memo})]})]})]}),e.jsxs("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`p-6 border-b transition-colors ${s?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 transition-colors ${s?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(F,{className:`h-5 w-5 transition-colors ${s?"text-blue-400":"text-blue-600"}`})}),e.jsx("h3",{className:`text-lg font-semibold transition-colors ${s?"text-white":"text-gray-900"}`,children:"최근 발주서"})]})}),e.jsx("div",{className:"p-6",children:D?e.jsx("div",{className:"animate-pulse space-y-3",children:[...Array(3)].map((r,g)=>e.jsx("div",{className:`h-12 rounded transition-colors ${s?"bg-gray-700":"bg-gray-200"}`},g))}):c.length>0?e.jsxs("div",{className:"space-y-3",children:[c.slice(0,5).map(r=>e.jsx("div",{className:`flex items-center justify-between p-3 border rounded-lg cursor-pointer transition-all hover:shadow-md ${s?"border-gray-600 bg-gray-700/50 hover:bg-gray-700":"border-gray-200 bg-gray-50/50 hover:bg-gray-100"}`,onClick:()=>a(`/orders/${r.id}`),children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium transition-colors ${s?"text-gray-200":"text-gray-900"}`,children:r.orderNumber}),e.jsx("p",{className:"text-xs transition-colors text-gray-500",children:new Date(r.orderDate).toLocaleDateString("ko-KR")})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(N,{variant:r.status==="approved"?"default":"secondary",className:"text-xs",children:U(r.status)}),e.jsxs("p",{className:`text-sm font-medium transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:["₩",Math.round(r.totalAmount||0).toLocaleString("ko-KR")]})]})]})})},r.id)),c.length>5&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>a(`/orders?vendor=${i}`),className:`shadow-md hover:shadow-lg transition-all duration-200 ${s?"text-blue-400 border-blue-600 hover:bg-blue-900/20":"text-blue-600 border-blue-600 hover:bg-blue-50"}`,children:["모든 발주서 보기 (",c.length,"개)"]})})]}):e.jsx("p",{className:"text-sm text-center py-6 transition-colors text-gray-500",children:"발주서가 없습니다."})})]})]})]})}):null}export{ce as default};
