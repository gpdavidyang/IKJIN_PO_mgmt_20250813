import{j as e,d as ye,e as be,u as ue,V as ve,h as fe,r as b,q as A,s as Ne,B as u,a0 as $e,f as X,F as we,a3 as O,a as Ce,a4 as Z,M as De,w as F,L as K,N as V,x as G,O as g,S as v,z as f,A as N,D as $,G as l,y as S,P as Se,o as Ae,T as _e,k as w,K as R}from"./index-DLP8JcZw-1757302139144.js";import{T as Ie}from"./textarea-BDakkE6G-1757302139144.js";import{i as ke}from"./authUtils-CcDzk6i0-1757302139144.js";import{A as Pe}from"./attached-files-info-C5uuxPkG-1757302139144.js";import{D as ze,a as Fe,b as Te,c as qe}from"./dialog-DPibAFB6-1757302139144.js";import{f as C}from"./format-Bez8pVjy-1757302139144.js";import{A as Me,a as Be,b as Ee,c as Le,d as Oe,e as Ke,f as Ve,g as Ge}from"./alert-dialog-BFsuMkfy-1757302139144.js";import{S as Re}from"./square-pen-BXf-F14W-1757302139144.js";import{D as We}from"./dollar-sign-TJfY8UaW-1757302139144.js";import{P as He}from"./package-Dbj1svw6-1757302139144.js";import{C as Ue}from"./calendar-BMTyGjHo-1757302139144.js";import{P as Qe}from"./phone-3C45Htq3-1757302139144.js";import{M as ee}from"./map-pin-CTgU7Ycl-1757302139144.js";import{S as Ye}from"./save-C3xjEnDP-1757302139144.js";import"./download-CbP4FXK2-1757302139144.js";import"./index-D5NHMbj2-1757302139144.js";function Je({order:o}){const _=d=>`₩${Math.round(d).toLocaleString("ko-KR")}`,h=d=>C(new Date(d),"yyyy년 MM월 dd일"),I=()=>!o.items||o.items.length===0?0:o.items.reduce((d,j)=>{const t=parseFloat(j.quantity)||0,k=parseFloat(j.unitPrice)||0,T=j.totalAmount||t*k,P=parseFloat(T)||0;return d+P},0);return e.jsxs("div",{style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsx("table",{style:{width:"100%",marginBottom:"15px",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{textAlign:"left",borderBottom:"2px solid #333",paddingBottom:"8px"},children:e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"발주서 Purchase Order"})}),e.jsxs("td",{style:{textAlign:"right",borderBottom:"2px solid #333",paddingBottom:"8px",fontSize:"10px",color:"#666"},children:["발주번호: ",o.orderNumber||"PO-2025-0612-001"]})]})})}),e.jsx("table",{style:{width:"100%",marginBottom:"15px",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingRight:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"발주자 정보"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"8px",fontSize:"10px"},children:[e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"회사명:"})," ",o.company?.companyName||"(주)익진엔지니어링"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"담당자:"})," ",o.user?.name||o.createdBy||"시스템"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"이메일:"})," ",o.user?.email||"-"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"연락처:"})," ",o.user?.phone||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"주소:"})," ",o.company?.address||"-"]})]})})})]})}),e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingLeft:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"거래처 정보"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"8px",fontSize:"10px"},children:[e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"회사명:"})," ",o.vendor?.name||"거래처명"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"사업자:"})," ",o.vendor?.businessNumber||"-"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"담당자:"})," ",o.vendor?.contactPerson||"-"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"연락처:"})," ",o.vendor?.phone||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"주소:"})," ",o.vendor?.address||"-"]})]})})})]})})]})})}),e.jsxs("table",{style:{width:"100%",marginBottom:"15px",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"발주 정보"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{border:"1px solid #666",padding:"8px"},children:e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsxs("td",{style:{width:"33%",fontSize:"10px",padding:"2px"},children:[e.jsx("strong",{children:"발주번호:"})," ",o.orderNumber||"PO-2025-0612-001"]}),e.jsxs("td",{style:{width:"33%",fontSize:"10px",padding:"2px"},children:[e.jsx("strong",{children:"발주일자:"})," ",o.orderDate?h(o.orderDate):"2025년 06월 12일"]}),e.jsxs("td",{style:{width:"33%",fontSize:"10px",padding:"2px"},children:[e.jsx("strong",{children:"납기일자:"})," ",o.deliveryDate?h(o.deliveryDate):"2025년 06월 30일"]})]})})})})})})]}),e.jsxs("table",{style:{width:"100%",marginBottom:"15px",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"발주 항목"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{border:"1px solid #666",padding:"0"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8f8f8"},children:[e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"8%"},children:"순번"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"25%"},children:"품목명"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"15%"},children:"규격"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"8%"},children:"수량"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"12%"},children:"단가"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"12%"},children:"금액"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"20%"},children:"비고"})]})}),e.jsxs("tbody",{children:[o.items&&o.items.length>0?o.items.map((d,j)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:j+1}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px"},children:d.itemName}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:d.specification||"-"}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:Math.round(parseFloat(d.quantity)).toLocaleString("ko-KR")}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"right"},children:_(d.unitPrice)}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"right",fontWeight:"bold"},children:_(d.totalAmount)}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:d.notes||"-"})]},d.id||j)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{border:"1px solid #666",padding:"20px",fontSize:"10px",textAlign:"center",color:"#666"},children:"발주 항목이 없습니다."})}),e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("td",{colSpan:6,style:{border:"1px solid #666",padding:"6px",fontSize:"11px",textAlign:"right",fontWeight:"bold"},children:"총 금액:"}),e.jsxs("td",{style:{border:"1px solid #666",padding:"6px",fontSize:"11px",textAlign:"right",fontWeight:"bold"},children:[_(I())," (VAT 포함)"]})]})]})]})})})})]}),e.jsxs("table",{style:{width:"100%",marginBottom:"15px",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"특이사항"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{border:"1px solid #666",padding:"10px",fontSize:"10px",minHeight:"40px"},children:o.notes||"본 발주서는 정기 발주에 따른 발생 건으로, 품질 및 납기일정을 준수하여 주시기 바랍니다."})})})]}),e.jsx("table",{style:{width:"100%",marginBottom:"20px",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingRight:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"발주자"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"15px",fontSize:"10px",textAlign:"center"},children:[e.jsxs("div",{style:{marginBottom:"10px"},children:["날짜: ",o.orderDate?h(o.orderDate):"2025년 06월 12일"]}),e.jsx("div",{children:"서명: _______________"})]})})})]})}),e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingLeft:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"승인자"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"15px",fontSize:"10px",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"10px"},children:"날짜: _______________"}),e.jsx("div",{children:"서명: _______________"})]})})})]})})]})})}),e.jsx("div",{style:{marginTop:"20px",paddingTop:"10px",borderTop:"1px solid #999",fontSize:"9px",color:"#666"},children:e.jsx("table",{style:{width:"100%"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsxs("td",{style:{textAlign:"left"},children:["본 발주서는 자재 발주 관리 시스템에서 자동 생성되었습니다. 생성일시: ",C(new Date,"yyyy년 MM월 dd일 HH:mm")]}),e.jsx("td",{style:{textAlign:"right"},children:"페이지 1"})]})})})})]})}function mt(){ye();const{toast:o}=be(),[_,h]=ue(),I=ve(),d=I.id,{theme:j}=fe(),t=j==="dark",[k,T]=b.useState(!1),[P,W]=b.useState(!1),[te,q]=b.useState(!1),[H,se]=b.useState(null);console.log("OrderEdit params:",I),console.log("OrderEdit orderId:",d,typeof d);const[U,re]=b.useState(!1),[c,p]=b.useState({projectId:"",vendorId:"",orderDate:"",deliveryDate:"",notes:"",templateId:"",items:[]}),{data:i,isLoading:Q,error:M}=A({queryKey:[`/api/orders/${d}`],queryFn:()=>w("GET",`/api/orders/${d}`),enabled:!!d});console.log("OrderEdit Debug:",{orderId:d,order:i,orderLoading:Q,orderError:M,enabled:!!d});const{data:ae}=A({queryKey:["/api/vendors"],queryFn:()=>w("GET","/api/vendors")}),{data:ie}=A({queryKey:["/api/projects"],queryFn:()=>w("GET","/api/projects")}),{data:B}=A({queryKey:["/api/categories"],queryFn:()=>w("GET","/api/categories")}),le=B?.categories||[],D=B?.flatCategories||[];console.log("Categories data:",B),console.log("Categories (hierarchical):",le),console.log("Flat categories:",D);const{data:ne}=A({queryKey:["/api/items"],queryFn:()=>w("GET","/api/items")}),y=ne?.items||[];b.useEffect(()=>{if(i&&!U){if(y.length>0){const s=(i.items||[]).map(a=>{let r=null;return r=y.find(n=>n.name===a.itemName),r||(r=y.find(n=>n.name.includes(a.itemName)||a.itemName.includes(n.name))),!r&&a.itemId&&(r=y.find(n=>n.id===a.itemId)),{itemId:r?.id||null,itemName:a.itemName||"",quantity:parseFloat(a.quantity)||1,unitPrice:parseFloat(a.unitPrice)||0,specification:a.specification||"",notes:a.notes||"",unit:a.unit||"EA",majorCategory:a.majorCategory||"",middleCategory:a.middleCategory||"",minorCategory:a.minorCategory||""}});p({projectId:i.projectId?.toString()||"",vendorId:i.vendorId?.toString()||"",orderDate:i.orderDate?new Date(i.orderDate).toISOString().split("T")[0]:"",deliveryDate:i.deliveryDate?new Date(i.deliveryDate).toISOString().split("T")[0]:"",notes:i.notes||"",templateId:i.templateId?.toString()||"",items:s})}else p({projectId:i.projectId?.toString()||"",vendorId:i.vendorId?.toString()||"",orderDate:i.orderDate?new Date(i.orderDate).toISOString().split("T")[0]:"",deliveryDate:i.deliveryDate?new Date(i.deliveryDate).toISOString().split("T")[0]:"",notes:i.notes||"",templateId:i.templateId?.toString()||"",items:i.items||[]});re(!0)}},[i,y,U]);const E=Ne({mutationFn:async s=>await w("PUT",`/api/orders/${d}`,s),onSuccess:()=>{o({title:"성공",description:"발주서가 수정되었습니다."}),R.invalidateQueries({queryKey:[`/api/orders/${d}`]}),R.invalidateQueries({queryKey:["/api/orders"]});const s=i?.orderStatus;s==="draft"||s==="created"?(se(Number(d)),q(!0)):h(`/orders/${d}`)},onError:s=>{if(ke(s)){o({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{h("/login")},500);return}o({title:"오류",description:"발주서 수정에 실패했습니다.",variant:"destructive"})}}),oe=async s=>{W(!0),o({title:"PDF 생성 시작",description:"수정된 발주서 데이터를 준비하고 있습니다..."});try{setTimeout(()=>{o({title:"PDF 생성 중",description:"ProfessionalPDFGenerationService를 사용하여 PDF를 생성하고 있습니다..."})},1e3);const a=await w("POST",`/api/orders/${s}/regenerate-pdf`);if(a.success)o({title:"데이터베이스 저장 완료",description:"생성된 PDF가 첨부파일로 저장되었습니다."}),R.invalidateQueries({queryKey:[`/api/orders/${s}`]}),setTimeout(()=>{o({title:"✅ PDF 발주서 생성 완료",description:"변경사항이 반영된 PDF 발주서가 성공적으로 생성되었습니다.",duration:5e3})},500),setTimeout(()=>{h(`/orders/${s}`)},1500);else throw new Error(a.message||"PDF 생성 실패")}catch(a){o({title:"❌ PDF 생성 실패",description:a.message||"PDF 생성 중 오류가 발생했습니다.",variant:"destructive"})}finally{W(!1),q(!1)}},de=s=>{if(s.preventDefault(),!c.vendorId||!c.orderDate||c.items.length===0){o({title:"오류",description:"모든 필수 필드를 입력해주세요.",variant:"destructive"});return}const a={projectId:c.projectId?parseInt(c.projectId):null,vendorId:parseInt(c.vendorId),orderDate:new Date(c.orderDate),deliveryDate:c.deliveryDate?new Date(c.deliveryDate):null,notes:c.notes,templateId:c.templateId?parseInt(c.templateId):null,items:c.items.map(r=>({itemId:r.itemId,itemName:r.itemName,quantity:Number(r.quantity),unitPrice:Number(r.unitPrice),specification:r.specification||"",notes:r.notes||"",unit:r.unit||"EA",majorCategory:r.majorCategory||"",middleCategory:r.middleCategory||"",minorCategory:r.minorCategory||""}))};E.mutate(a)},ce=()=>{p(s=>({...s,items:[...s.items,{itemId:null,itemName:"",quantity:1,unitPrice:0,specification:"",notes:"",unit:"EA",majorCategory:"",middleCategory:"",minorCategory:""}]}))},xe=s=>{p(a=>({...a,items:a.items.filter((r,n)=>n!==s)}))},m=(s,a,r)=>{p(n=>({...n,items:n.items.map((x,z)=>z===s?{...x,[a]:r}:x)}))},ge=(s,a)=>{const r=y.find(n=>n.id.toString()===a);r&&(m(s,"itemId",r.id),m(s,"itemName",r.name),m(s,"unitPrice",r.unitPrice||0),m(s,"specification",r.specification||""))},he=()=>{const s=D.filter(a=>a.categoryType==="major");return console.log("getMajorCategories result:",s),s},me=s=>{if(!s||s==="none")return[];const a=D.find(n=>n.categoryType==="major"&&n.categoryName===s);if(!a)return console.log(`Major category not found: ${s}`),[];const r=D.filter(n=>n.categoryType==="middle"&&n.parentId===a.id);return console.log(`Middle categories for ${s}:`,r),r},pe=s=>{if(!s||s==="none")return[];const a=D.find(n=>n.categoryType==="middle"&&n.categoryName===s);if(!a)return console.log(`Middle category not found: ${s}`),[];const r=D.filter(n=>n.categoryType==="minor"&&n.parentId===a.id);return console.log(`Minor categories for ${s}:`,r),r},L=(s,a,r)=>{console.log(`Category change: index=${s}, type=${a}, value=${r}`);const n={},x=r==="__CLEAR__"?"":r;console.log(`Actual value after conversion: ${x}`),a==="major"?(n.majorCategory=x,n.middleCategory="",n.minorCategory=""):a==="middle"?(n.middleCategory=x,n.minorCategory=""):a==="minor"&&(n.minorCategory=x),console.log("Updates to apply:",n),p(z=>{const Y=z.items.map((J,je)=>je===s?{...J,...n}:J);return console.log(`Updated item ${s}:`,Y[s]),{...z,items:Y}})};return Q?e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded"})]})}):M?e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"발주서 로드 중 오류가 발생했습니다"}),e.jsx("p",{className:"mb-4 text-red-600",children:M.message}),e.jsx(u,{onClick:()=>h("/orders"),children:"발주서 목록으로 돌아가기"})]})}):i?e.jsxs("div",{className:`min-h-screen transition-colors ${t?"bg-gray-900":"bg-gray-50"}`,children:[e.jsx("div",{className:"max-w-[1366px] mx-auto",children:e.jsx("div",{className:`shadow-sm border-b transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>h(`/orders/${d}`),className:`no-print h-8 px-2 transition-colors ${t?"text-gray-300 hover:text-gray-100 hover:bg-gray-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,"aria-label":"발주서 상세로 돌아가기",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(Re,{className:`h-5 w-5 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-lg font-bold transition-colors ${t?"text-white":"text-gray-900"}`,children:"발주서 수정"}),e.jsxs("p",{className:`text-sm transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:[i?.vendor?.name," • ",i?.orderDate?C(new Date(i.orderDate),"MM.dd"):"날짜 미정"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-sm transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"총 발주금액"}),e.jsx("p",{className:`text-lg font-bold transition-colors ${t?"text-white":"text-gray-900"}`,children:X(c.items.reduce((s,a)=>{const r=(Number(a.quantity)||0)*(Number(a.unitPrice)||0);return s+r},0))})]})})]})})})}),e.jsx("div",{className:"px-6 py-4 space-y-4",children:e.jsxs("form",{onSubmit:de,children:[i&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"p-3",children:[e.jsx("span",{className:`text-xs block mb-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"진행 상태"}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium transition-colors ${i.status==="draft"?t?"bg-yellow-900/20 text-yellow-400":"bg-yellow-100 text-yellow-800":i.status==="pending_approval"?t?"bg-orange-900/20 text-orange-400":"bg-orange-100 text-orange-800":i.status==="approved"?t?"bg-blue-900/20 text-blue-400":"bg-blue-100 text-blue-800":i.status==="sent"?t?"bg-green-900/20 text-green-400":"bg-green-100 text-green-800":t?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}`,children:i.status||"N/A"})]})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block mb-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"발주 금액"}),e.jsx("span",{className:`text-lg font-bold transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:X(c.items.reduce((s,a)=>{const r=(Number(a.quantity)||0)*(Number(a.unitPrice)||0);return s+r},0))})]}),e.jsx(We,{className:`h-4 w-4 mt-0.5 transition-colors ${t?"text-gray-500":"text-gray-400"}`})]})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block mb-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"품목 수"}),e.jsxs("span",{className:`text-lg font-bold transition-colors ${t?"text-white":"text-gray-900"}`,children:[c.items.length,"개"]})]}),e.jsx(He,{className:`h-4 w-4 mt-0.5 transition-colors ${t?"text-gray-500":"text-gray-400"}`})]})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block mb-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"납기일"}),e.jsx("span",{className:`text-lg font-bold transition-colors ${t?"text-white":"text-gray-900"}`,children:i.deliveryDate?C(new Date(i.deliveryDate),"MM.dd"):"미정"})]}),e.jsx(Ue,{className:`h-4 w-4 mt-0.5 transition-colors ${t?"text-gray-500":"text-gray-400"}`})]})})})]}),i&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`p-4 border-b transition-colors ${t?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(we,{className:`h-5 w-5 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsx("h3",{className:`text-lg font-semibold transition-colors ${t?"text-white":"text-gray-900"}`,children:"발주서 정보"})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"발주번호"}),e.jsx("span",{className:`font-semibold transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.orderNumber})]}),e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"발주일"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.orderDate?C(new Date(i.orderDate),"yyyy.MM.dd"):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs transition-colors text-gray-500",children:"시스템 등록일"}),e.jsx("span",{className:`text-xs transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:i.createdAt?C(new Date(i.createdAt),"yyyy.MM.dd HH:mm"):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"담당자"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:`h-4 w-4 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.user?.firstName&&i.user?.lastName?`${i.user.lastName}${i.user.firstName}`:i.user?.email||"알 수 없음"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"납기일"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:`h-4 w-4 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.deliveryDate?C(new Date(i.deliveryDate),"yyyy.MM.dd"):"-"})]})]})]}),i.notes&&e.jsxs("div",{className:`pt-4 border-t transition-colors ${t?"border-gray-700":"border-gray-100"}`,children:[e.jsx("span",{className:`text-sm block mb-2 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"비고"}),e.jsx("div",{className:`text-sm p-3 rounded transition-colors ${t?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-700"}`,children:i.notes})]})]})]}),i.vendor&&e.jsxs("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`p-4 border-b transition-colors ${t?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(Z,{className:`h-5 w-5 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsx("h3",{className:`text-lg font-semibold transition-colors ${t?"text-white":"text-gray-900"}`,children:"거래처 정보"})]})}),e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"업체명"}),e.jsx("span",{className:`text-sm font-medium transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.vendor.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"담당자"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:`h-3 w-3 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.vendor.contact||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"전화번호"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:`h-3 w-3 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.vendor.phone||"-"})]})]})]}),i.vendor.email&&e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"이메일"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{className:`h-3 w-3 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`text-xs transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.vendor.email})]})]}),i.vendor.address&&e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"주소"}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(ee,{className:`h-3 w-3 mt-0.5 flex-shrink-0 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`text-xs transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.vendor.address})]})]})]})})]}),i.project&&e.jsxs("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`p-4 border-b transition-colors ${t?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(Z,{className:`h-5 w-5 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsx("h3",{className:`text-lg font-semibold transition-colors ${t?"text-white":"text-gray-900"}`,children:"현장 정보"})]})}),e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"현장명"}),e.jsx("span",{className:`text-sm font-medium transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.project.projectName}),e.jsxs("span",{className:`text-xs block transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:["(",i.project.projectCode,")"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"담당자"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:`h-3 w-3 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.project.projectManager||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`block transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"위치"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:`h-3 w-3 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-200":"text-gray-900"}`,children:i.project.location||"-"})]})]})]}),i.project.description&&e.jsxs("div",{children:[e.jsx("span",{className:`text-xs block mb-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"설명"}),e.jsx("div",{className:`text-xs p-2 rounded transition-colors ${t?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-700"}`,children:i.project.description})]})]})})]})]}),e.jsxs(F,{className:`mb-6 transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(K,{children:e.jsx(V,{className:`transition-colors ${t?"text-white":"text-gray-900"}`,children:"기본 정보"})}),e.jsxs(G,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"project",children:"프로젝트"}),e.jsxs(v,{value:c.projectId,onValueChange:s=>p(a=>({...a,projectId:s})),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"프로젝트를 선택하세요"})}),e.jsx($,{children:ie?.map(s=>e.jsx(l,{value:s.id.toString(),children:s.projectName},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"vendor",children:"거래처 *"}),e.jsxs(v,{value:c.vendorId,onValueChange:s=>p(a=>({...a,vendorId:s})),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"거래처를 선택하세요"})}),e.jsx($,{children:ae?.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"orderDate",children:"발주일자 *"}),e.jsx(S,{id:"orderDate",type:"date",value:c.orderDate,onChange:s=>p(a=>({...a,orderDate:s.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"deliveryDate",children:"납품희망일"}),e.jsx(S,{id:"deliveryDate",type:"date",value:c.deliveryDate,onChange:s=>p(a=>({...a,deliveryDate:s.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"notes",children:"비고"}),e.jsx(Ie,{id:"notes",placeholder:"추가 정보나 요청사항을 입력하세요",value:c.notes,onChange:s=>p(a=>({...a,notes:s.target.value})),rows:3})]})]})]}),e.jsxs(F,{className:`mb-6 transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{className:`transition-colors ${t?"text-white":"text-gray-900"}`,children:"발주 품목"}),e.jsxs(u,{type:"button",onClick:ce,className:`transition-colors ${t?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"품목 추가"]})]})}),e.jsxs(G,{children:[c.items.length===0?e.jsx("div",{className:`text-center py-8 transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"발주할 품목을 추가해주세요"}):e.jsx("div",{className:"space-y-4",children:c.items.map((s,a)=>e.jsxs(F,{className:`p-4 border transition-all ${t?"bg-gradient-to-br from-gray-700 to-gray-800 hover:shadow-lg border-gray-600":"bg-gradient-to-br from-gray-50 to-white hover:shadow-md border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ae,{variant:"outline",className:`text-sm transition-colors ${t?"bg-blue-900/20 text-blue-300 border-blue-700":"bg-blue-50 text-blue-700 border-blue-200"}`,children:["품목 #",a+1]}),e.jsx("span",{className:`text-xs transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:s.itemName?`• ${s.itemName}`:""})]}),e.jsx(u,{type:"button",variant:"ghost",size:"icon",onClick:()=>xe(a),className:`h-8 w-8 transition-colors ${t?"text-gray-400 hover:text-red-400 hover:bg-red-950":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,children:e.jsx(_e,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3 mb-3",children:[e.jsxs("div",{className:"col-span-2 sm:col-span-3 md:col-span-2",children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"품목명 *"}),e.jsxs(v,{value:s.itemId?.toString()||"",onValueChange:r=>ge(a,r),children:[e.jsx(f,{children:e.jsx(N,{placeholder:s.itemName||"품목 선택"})}),e.jsx($,{children:y.map(r=>e.jsx(l,{value:r.id.toString(),children:r.name},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"수량 *"}),e.jsx(S,{type:"number",value:s.quantity||0,onChange:r=>{const n=r.target.value;if(n===""||n==="0")m(a,"quantity",0);else{const x=parseFloat(n);!isNaN(x)&&x>=0&&m(a,"quantity",x)}},onBlur:r=>{const n=parseFloat(r.target.value);(isNaN(n)||n<=0)&&m(a,"quantity",1)},min:"0.01",step:"0.01",required:!0,className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"단위"}),e.jsxs(v,{value:s.unit||"EA",onValueChange:r=>{console.log(`Unit selected: ${r}`),m(a,"unit",r)},children:[e.jsx(f,{children:e.jsx(N,{placeholder:"단위 선택"})}),e.jsxs($,{children:[e.jsx(l,{value:"EA",children:"EA"}),e.jsx(l,{value:"개",children:"개"}),e.jsx(l,{value:"박스",children:"박스"}),e.jsx(l,{value:"세트",children:"세트"}),e.jsx(l,{value:"kg",children:"kg"}),e.jsx(l,{value:"g",children:"g"}),e.jsx(l,{value:"L",children:"L"}),e.jsx(l,{value:"mL",children:"mL"}),e.jsx(l,{value:"m",children:"m"}),e.jsx(l,{value:"cm",children:"cm"}),e.jsx(l,{value:"mm",children:"mm"}),e.jsx(l,{value:"㎡",children:"㎡"}),e.jsx(l,{value:"㎥",children:"㎥"}),e.jsx(l,{value:"매",children:"매"}),e.jsx(l,{value:"장",children:"장"}),e.jsx(l,{value:"권",children:"권"}),e.jsx(l,{value:"부",children:"부"}),e.jsx(l,{value:"대",children:"대"}),e.jsx(l,{value:"식",children:"식"}),e.jsx(l,{value:"조",children:"조"}),e.jsx(l,{value:"타",children:"타"}),e.jsx(l,{value:"켤레",children:"켤레"}),e.jsx(l,{value:"통",children:"통"}),e.jsx(l,{value:"병",children:"병"}),e.jsx(l,{value:"캔",children:"캔"}),e.jsx(l,{value:"포",children:"포"}),e.jsx(l,{value:"봉",children:"봉"}),e.jsx(l,{value:"팩",children:"팩"}),e.jsx(l,{value:"롤",children:"롤"}),e.jsx(l,{value:"쌍",children:"쌍"}),e.jsx(l,{value:"톤",children:"톤"}),e.jsx(l,{value:"되",children:"되"}),e.jsx(l,{value:"말",children:"말"}),e.jsx(l,{value:"자루",children:"자루"}),e.jsx(l,{value:"마리",children:"마리"}),e.jsx(l,{value:"모",children:"모"}),e.jsx(l,{value:"평",children:"평"}),e.jsx(l,{value:"보루",children:"보루"}),e.jsx(l,{value:"묶음",children:"묶음"}),e.jsx(l,{value:"다스",children:"다스"}),e.jsx(l,{value:"갑",children:"갑"}),e.jsx(l,{value:"곽",children:"곽"}),e.jsx(l,{value:"판",children:"판"}),e.jsx(l,{value:"그루",children:"그루"}),e.jsx(l,{value:"주",children:"주"}),e.jsx(l,{value:"본",children:"본"}),e.jsx(l,{value:"줄",children:"줄"})]})]})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"단가"}),e.jsx(S,{type:"number",value:s.unitPrice||0,onChange:r=>{const n=r.target.value;if(n===""||n==="0")m(a,"unitPrice",0);else{const x=parseFloat(n);!isNaN(x)&&x>=0&&m(a,"unitPrice",x)}},min:"0",step:"0.01",className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"총액"}),e.jsxs("div",{className:`h-10 px-3 py-2 border rounded-md flex items-center font-semibold transition-colors ${t?"bg-blue-900/20 border-blue-700 text-blue-300":"bg-blue-50 border-blue-200 text-blue-700"}`,children:["₩",(Number(s.quantity)*Number(s.unitPrice)).toLocaleString("ko-KR")]})]})]}),e.jsxs("div",{className:`grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3 border-t pt-3 mt-3 transition-colors ${t?"border-gray-600":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"대분류"}),e.jsxs(v,{value:s.majorCategory||"",onValueChange:r=>{console.log(`Major category selected: ${r}`),L(a,"major",r)},children:[e.jsx(f,{className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`,children:e.jsx(N,{placeholder:"대분류 선택"})}),e.jsxs($,{children:[e.jsx(l,{value:"__CLEAR__",children:"선택 해제"}),he().map(r=>e.jsx(l,{value:r.categoryName,children:r.categoryName},`major-${r.id}`))]})]})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"중분류"}),e.jsxs(v,{value:s.middleCategory||"",onValueChange:r=>{console.log(`Middle category selected: ${r}`),L(a,"middle",r)},disabled:!s.majorCategory,children:[e.jsx(f,{className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`,children:e.jsx(N,{placeholder:s.majorCategory?"중분류 선택":"대분류 먼저 선택"})}),e.jsxs($,{children:[e.jsx(l,{value:"__CLEAR__",children:"선택 해제"}),me(s.majorCategory||"").map(r=>e.jsx(l,{value:r.categoryName,children:r.categoryName},`middle-${r.id}`))]})]})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"소분류"}),e.jsxs(v,{value:s.minorCategory||"",onValueChange:r=>{console.log(`Minor category selected: ${r}`),L(a,"minor",r)},disabled:!s.middleCategory,children:[e.jsx(f,{className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`,children:e.jsx(N,{placeholder:s.middleCategory?"소분류 선택":"중분류 먼저 선택"})}),e.jsxs($,{children:[e.jsx(l,{value:"__CLEAR__",children:"선택 해제"}),pe(s.middleCategory||"").map(r=>e.jsx(l,{value:r.categoryName,children:r.categoryName},`minor-${r.id}`))]})]})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"규격"}),e.jsx(S,{value:s.specification,onChange:r=>m(a,"specification",r.target.value),placeholder:"규격 입력",className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx(g,{className:`text-xs font-medium mb-1 block transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"비고"}),e.jsx(S,{value:s.notes,onChange:r=>m(a,"notes",r.target.value),placeholder:"비고 입력",className:`transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"}`})]})]})]},a))}),c.items.length>0&&e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t?"bg-blue-900/20 border border-blue-700":"bg-blue-50"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t?"text-blue-400":"text-blue-600"}`,children:"총 품목 수"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t?"text-blue-300":"text-blue-700"}`,children:[c.items.length,"개"]})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t?"bg-green-900/20 border border-green-700":"bg-green-50"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t?"text-green-400":"text-green-600"}`,children:"총 수량"}),e.jsx("div",{className:`text-xl font-bold transition-colors ${t?"text-green-300":"text-green-700"}`,children:c.items.reduce((s,a)=>s+(Number(a.quantity)||0),0)})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t?"bg-purple-900/20 border border-purple-700":"bg-purple-50"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t?"text-purple-400":"text-purple-600"}`,children:"대분류 수"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t?"text-purple-300":"text-purple-700"}`,children:[new Set(c.items.map(s=>s.majorCategory).filter(s=>s)).size,"개"]})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t?"bg-orange-900/20 border border-orange-700":"bg-orange-50"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t?"text-orange-400":"text-orange-600"}`,children:"총 합계 금액"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t?"text-orange-300":"text-orange-700"}`,children:["₩",c.items.reduce((s,a)=>{const r=(Number(a.quantity)||0)*(Number(a.unitPrice)||0);return s+r},0).toLocaleString()]})]})]})})]})]}),i?.attachments&&i.attachments.length>0&&e.jsxs(F,{className:`mb-6 transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(K,{children:e.jsx(V,{className:`transition-colors ${t?"text-white":"text-gray-900"}`,children:"첨부파일"})}),e.jsx(G,{children:e.jsx(Pe,{attachments:i.attachments,orderId:i.id,isDarkMode:t})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>h(`/orders/${d}`),className:`transition-colors ${t?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"취소"}),e.jsxs(u,{type:"submit",disabled:E.isPending,className:`transition-colors ${t?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),E.isPending?"저장 중...":"저장"]})]})]})}),k&&i&&e.jsx(ze,{open:k,onOpenChange:T,children:e.jsxs(Fe,{className:"max-w-4xl max-h-[90vh]",children:[e.jsx(Te,{children:e.jsx(qe,{children:"발주서 미리보기"})}),e.jsx(Je,{order:i})]})}),e.jsx(Me,{open:te,onOpenChange:q,children:e.jsxs(Be,{children:[e.jsxs(Ee,{children:[e.jsx(Le,{children:"PDF 발주서 생성"}),e.jsx(Oe,{children:"변경된 정보가 반영된 PDF 발주서를 지금 생성하시겠습니까? 생성된 PDF는 첨부파일로 저장되며 언제든지 다운로드할 수 있습니다."})]}),e.jsxs(Ke,{children:[e.jsx(Ve,{onClick:()=>h(`/orders/${d}`),children:"나중에"}),e.jsx(Ge,{onClick:async()=>{H&&await oe(H)},disabled:P,children:P?"생성 중...":"생성"})]})]})})]}):e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"발주서를 찾을 수 없습니다"}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["OrderID: ",d]}),e.jsx(u,{onClick:()=>h("/orders"),children:"발주서 목록으로 돌아가기"})]})})}export{mt as default};
