import{d as I,e as O,u as Q,r as i,bO as U,q as R,k as G,w as P,j as e,l as w,n as K,B as n,P as _,I as Y,aM as E,U as J}from"./index-DnIyYAML-1757169457219.js";import{T as W,a as X,b as g,c,d as Z,e as a}from"./table-BZaGgpU0-1757169457219.js";import{VendorForm as ee}from"./vendor-form-CrVtuaP2-1757169457219.js";import{S as se}from"./search-BroyDSZQ-1757169457219.js";import{L as ae}from"./list-DiMoJDuR-1757169457219.js";import{G as te}from"./grid-3x3-DXE6ePLC-1757169457219.js";import{S as q}from"./square-pen-0wjo6GqY-1757169457219.js";import{T as z}from"./trash-2-BHlG1eEI-1757169457219.js";import{H as re}from"./hash-CsWpnkET-1757169457219.js";import{P as le}from"./phone-Cjgh6g3d-1757169457219.js";import{C as ie}from"./chevron-up-BYIxTs8P-1757169457219.js";import{C as ne}from"./chevron-down-CN6udSiq-1757169457219.js";import"./dialog-DAM0aVO2-1757169457219.js";import"./index-Dxg3duIT-1757169457219.js";import"./textarea-CVvVLHHn-1757169457219.js";import"./info-DodfkYbT-1757169457219.js";import"./circle-check-BONRn5zb-1757169457219.js";import"./select-CLhu4K0F-1757169457219.js";import"./index-qvUVkmUX-1757169457219.js";import"./authUtils-CcDzk6i0-1757169457219.js";function Le(){I();const{toast:y}=O(),[,b]=Q(),[C,j]=i.useState(!1),[F,f]=i.useState(null),[d,D]=i.useState(""),[m,M]=i.useState(null),[N,S]=i.useState("asc"),[v,k]=i.useState("table"),{data:u,isLoading:A,error:L}=U(),p=i.useMemo(()=>{if(!u||!Array.isArray(u))return[];let s=u;if(d.trim()){const t=d.toLowerCase();s=u.filter(r=>r.name?.toLowerCase().includes(t)||r.businessNumber?.includes(t)||r.industry?.toLowerCase().includes(t)||r.contactPerson?.toLowerCase().includes(t)||r.phone?.includes(t)||r.email?.toLowerCase().includes(t)||r.aliases&&Array.isArray(r.aliases)&&r.aliases.some(l=>l.toLowerCase().includes(t)))}return m&&(s=[...s].sort((t,r)=>{let l=t[m],h=r[m];return l==null&&(l=""),h==null&&(h=""),l=String(l).toLowerCase(),h=String(h).toLowerCase(),N==="asc"?l.localeCompare(h):h.localeCompare(l)})),s},[u,d,m,N]),B=R({mutationFn:async s=>{await G("DELETE",`/api/vendors/${s}`)},onSuccess:()=>{y({title:"성공",description:"거래처가 삭제되었습니다."}),P.invalidateQueries({queryKey:["/api/vendors"]})},onError:s=>{if(s.status===401){y({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}y({title:"오류",description:"거래처 삭제에 실패했습니다.",variant:"destructive"})}}),o=s=>{m===s?S(N==="asc"?"desc":"asc"):(M(s),S("asc"))},x=s=>m!==s?null:N==="asc"?e.jsx(ie,{className:"h-4 w-4"}):e.jsx(ne,{className:"h-4 w-4"}),$=()=>{f(null),j(!0)},V=s=>{f(s),j(!0)},T=s=>{confirm("정말로 이 거래처를 삭제하시겠습니까?")&&B.mutate(s)},H=()=>{j(!1),f(null),P.invalidateQueries({queryKey:["/api/vendors"]})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"shadow-sm rounded-lg border bg-white border-gray-200",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-50",children:e.jsx(w,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"거래처 관리"}),e.jsx("p",{className:"text-sm mt-1 text-gray-600",children:"거래처 정보를 조회하고 관리하세요"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{variant:"outline",className:"text-sm border-gray-300 text-gray-700",children:["총 ",p.length,"개"]}),e.jsxs(n,{onClick:$,className:"shadow-md hover:shadow-lg transition-all duration-200 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"거래처 추가"]})]})]})})}),e.jsx("div",{className:"shadow-sm rounded-lg border bg-white border-gray-200",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium block mb-2 text-gray-700",children:"검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Y,{placeholder:"거래처명, 사업자번호로 검색...",value:d,onChange:s=>D(s.target.value),className:`pl-10 h-11 text-sm rounded-lg bg-white border-gray-300 ${d?"border-blue-500 bg-blue-50":""}`})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center rounded-lg p-1 bg-gray-100",children:[e.jsx(n,{variant:v==="table"?"default":"ghost",size:"sm",onClick:()=>k("table"),className:"h-8 w-8 p-0",title:"목록 보기",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(n,{variant:v==="cards"?"default":"ghost",size:"sm",onClick:()=>k("cards"),className:"h-8 w-8 p-0",title:"카드 보기",children:e.jsx(te,{className:"h-4 w-4"})})]})})]})})}),v==="table"?e.jsx("div",{className:"shadow-sm rounded-lg border bg-white border-gray-200",children:e.jsx("div",{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(g,{className:"border-b border-gray-200",children:[e.jsx(c,{className:"px-6 py-3 text-sm font-medium cursor-pointer select-none text-gray-600 hover:bg-gray-50",onClick:()=>o("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"거래처명"}),x("name")]})}),e.jsx(c,{className:"px-6 py-3 text-sm font-medium cursor-pointer select-none text-gray-600 hover:bg-gray-50",onClick:()=>o("businessNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"사업자번호"}),x("businessNumber")]})}),e.jsx(c,{className:"px-6 py-3 text-sm font-medium cursor-pointer select-none text-gray-600 hover:bg-gray-50",onClick:()=>o("industry"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"업종"}),x("industry")]})}),e.jsx(c,{className:"px-6 py-3 text-sm font-medium cursor-pointer select-none text-gray-600 hover:bg-gray-50",onClick:()=>o("contactPerson"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"담당자"}),x("contactPerson")]})}),e.jsx(c,{className:"px-6 py-3 text-sm font-medium cursor-pointer select-none text-gray-600 hover:bg-gray-50",onClick:()=>o("phone"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"연락처"}),x("phone")]})}),e.jsx(c,{className:"px-6 py-3 text-sm font-medium cursor-pointer select-none text-gray-600 hover:bg-gray-50",onClick:()=>o("createdAt"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"등록일"}),x("createdAt")]})}),e.jsx(c,{className:"px-6 py-3 text-sm font-medium text-right text-gray-600",children:"관리"})]})}),e.jsx(Z,{children:A?[...Array(5)].map((s,t)=>e.jsxs(g,{children:[e.jsx(a,{children:e.jsx("div",{className:"h-3 rounded animate-pulse bg-gray-200"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 rounded animate-pulse bg-gray-200"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 rounded animate-pulse bg-gray-200"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 rounded animate-pulse bg-gray-200"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 rounded animate-pulse bg-gray-200"})}),e.jsx(a,{children:e.jsx("div",{className:"h-3 rounded animate-pulse bg-gray-200"})}),e.jsx(a,{})]},t)):L?e.jsx(g,{children:e.jsxs(a,{colSpan:7,className:"text-center py-6 text-sm text-red-500",children:["오류: ",L?.message||"거래처 데이터를 불러올 수 없습니다"]})}):p.length===0?e.jsx(g,{children:e.jsx(a,{colSpan:7,className:"text-center py-6 text-sm text-gray-500",children:d?"검색 결과가 없습니다":"등록된 거래처가 없습니다"})}):p.map(s=>e.jsxs(g,{className:"border-b hover:bg-gray-50 border-gray-100",children:[e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm font-medium cursor-pointer overflow-hidden text-ellipsis whitespace-nowrap text-blue-600 hover:text-blue-700",onClick:()=>b(`/vendors/${s.id}`),title:s.name,children:s.name})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.businessNumber||"-"})}),e.jsx(a,{className:"py-4 px-6",children:s.industry?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-800",children:s.industry}):e.jsx("span",{className:"text-sm text-gray-900",children:"-"})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.contactPerson||"-"})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.phone||"-"})}),e.jsx(a,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:E(s.createdAt)})}),e.jsx(a,{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>V(s),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"수정",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>T(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"삭제",children:e.jsx(z,{className:"h-4 w-4"})})]})})]},s.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2",children:A?[...Array(6)].map((s,t)=>e.jsx("div",{className:"shadow-sm rounded-lg border bg-white border-gray-200",children:e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 rounded animate-pulse bg-gray-200"}),e.jsx("div",{className:"h-3 rounded animate-pulse w-3/4 bg-gray-200"}),e.jsx("div",{className:"h-3 rounded animate-pulse w-1/2 bg-gray-200"})]})})},t)):p.length===0?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx(w,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"text-xs mt-2 text-gray-500",children:"등록된 거래처가 없습니다."})]}):p.map(s=>e.jsxs("div",{className:"p-3 hover:shadow-md transition-shadow shadow-sm rounded-lg border bg-white border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-blue-100",children:e.jsx(w,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold cursor-pointer text-gray-900 hover:text-blue-600",onClick:()=>b(`/vendors/${s.id}`),children:s.name}),s.industry&&e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs mt-1 bg-gray-100 text-gray-800",children:s.industry})]})]}),e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs ${s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.isActive?"활성":"비활성"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-xs gap-2 text-gray-600",children:[e.jsx(re,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"사업자번호:"}),e.jsx("span",{className:"ml-1",children:s.businessNumber||"-"})]}),s.contactPerson&&e.jsxs("div",{className:"flex items-center text-xs gap-2 text-gray-600",children:[e.jsx(J,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"담당자:"}),e.jsx("span",{className:"ml-1",children:s.contactPerson})]}),s.phone&&e.jsxs("div",{className:"flex items-center text-xs gap-2 text-gray-600",children:[e.jsx(le,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"전화번호:"}),e.jsx("span",{className:"ml-1",children:s.phone})]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs mb-3 text-gray-500",children:e.jsxs("span",{children:["등록일: ",E(s.createdAt)]})}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>V(s),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"수정",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>T(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"삭제",children:e.jsx(z,{className:"h-4 w-4"})})]})]},s.id))}),C&&e.jsx(ee,{isOpen:C,vendor:F,onClose:()=>j(!1),onSuccess:H})]})})}export{Le as default};
