import{c as ce,r as d,e as Se,p as J,q as P,ar as ps,j as e,F as js,J as y,B as l,k as Q,w as W,g as as,s as E,t as D,G as z,H as V,O as us,ao as Ee,P as Oe,I as w,n as te,m as gs,ap as ts,aK as u,aD as Ne,L as ke,aL as fe,d as ys,u as vs,h as Ns,l as Je,aE as Ae,aF as L,aG as M,aH as U,aI as R,aJ as K,X as fs,aP as Be,aQ as Ge}from"./index-BfDc6Omt-1757213250784.js";import{T as bs,a as ws,b as xe,c as me}from"./tabs-BQBrwsH2-1757213250784.js";import{S as Y,a as Z,b as ee,c as se,d as I}from"./select-BLTlOVj9-1757213250784.js";import{S as je}from"./switch-CoIrwUgO-1757213250784.js";import{D as re,f as be,a as ie,b as ne,c as le,d as Pe,e as Ss}from"./dialog-Bo48vr0k-1757213250784.js";import{T as Cs,a as ks,b as We,c as he,d as As,e as pe}from"./table-DhBDkVL0-1757213250784.js";import{A as qe,a as Le,b as Me,c as Ue,d as Re,e as Ke,f as rs,g as is,h as ns}from"./alert-dialog-R_OUj-uF-1757213250784.js";import{T as $s}from"./triangle-alert-CrwRroiq-1757213250784.js";import{U as ye}from"./users-DFvByWQM-1757213250784.js";import{T as De}from"./textarea-qWNYibjv-1757213250784.js";import{C as ls}from"./chevron-down-C_SK49in-1757213250784.js";import{S as ue}from"./square-pen-GqWEBVfi-1757213250784.js";import{T as we}from"./trash-2-Vt9HzQc1-1757213250784.js";import{D as Ts}from"./dollar-sign-CphQbANq-1757213250784.js";import{A as $e,a as Te}from"./alert-COSiiwC3-1757213250784.js";import{M as ge}from"./mail-CWuNivJ3-1757213250784.js";import{S as cs}from"./save-D-19p1G_-1757213250784.js";import{R as Xe,a as Fs}from"./role-display-CvvYGaPd-1757213250784.js";import{L as Es}from"./list-FiavMc-U-1757213250784.js";import{G as Ps}from"./grid-3x3-B90QpvZT-1757213250784.js";import{S as Ds}from"./search-DmjV-y6s-1757213250784.js";import{P as Os}from"./phone-Dgk1GJyV-1757213250784.js";import{C as qs}from"./calendar-Bk7TvZtk-1757213250784.js";import{C as Ls}from"./chevron-up-DBeMyJPH-1757213250784.js";import"./index-38EM6Lo0-1757213250784.js";import"./index-Bkwo1L4z-1757213250784.js";import"./use-ui-terms-DkgFt6yO-1757213250784.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=ce("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=ce("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=ce("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=ce("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=ce("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ce("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);function Ze({user:x,isOpen:S,onClose:v,onSuccess:C}){const[N,f]=d.useState("checking"),[t,h]=d.useState(""),{toast:p}=Se(),{data:o,isLoading:$}=J({queryKey:[`/api/users/${x.id}/references`],enabled:S,retry:!1}),{data:k}=J({queryKey:["/api/users"],enabled:N==="reassign"}),g=P({mutationFn:async c=>await Q("POST",`/api/users/${x.id}/reassign`,{toUserId:c}),onSuccess:()=>{f("confirm"),p({title:"현장 재배정 완료",description:"현장 담당자가 성공적으로 변경되었습니다."})},onError:c=>{p({title:"재배정 실패",description:c.message||"현장 재배정에 실패했습니다.",variant:"destructive"})}}),q=P({mutationFn:async()=>await Q("DELETE",`/api/users/${x.id}`),onSuccess:()=>{W.invalidateQueries({queryKey:["/api/users"]}),C(),v(),p({title:"사용자 삭제 완료",description:"사용자가 성공적으로 삭제되었습니다."})},onError:c=>{p({title:"삭제 실패",description:c.message||"사용자 삭제에 실패했습니다.",variant:"destructive"})}});ps.useEffect(()=>{o&&!$&&(o.canDelete?f("confirm"):(o.references.orders.length>0,f("warning")))},[o,$]);const T=()=>{if(!t){p({title:"담당자 선택 필요",description:"새로운 담당자를 선택해주세요.",variant:"destructive"});return}g.mutate(t)},j=()=>{q.mutate()},O=k?.filter(c=>c.id!==x.id&&c.isActive)||[];return e.jsx(qe,{open:S,onOpenChange:v,children:e.jsxs(Le,{className:"max-w-2xl",children:[e.jsxs(Me,{children:[e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-amber-500"}),"사용자 삭제"]}),e.jsx(Re,{asChild:!0,children:e.jsxs("div",{className:"space-y-4",children:[N==="checking"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"사용자 참조 관계를 확인하고 있습니다..."})]}),N==="warning"&&o&&e.jsx("div",{className:"space-y-4",children:o.references.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[x.name||x.email," 사용자는 삭제할 수 없습니다."]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(js,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"font-medium text-red-800",children:["생성한 발주서 (",o.references.orders.length,"개)"]})]}),e.jsx("p",{className:"text-sm text-red-700 mb-2",children:"발주서 기록은 회계 및 감사를 위해 생성자 정보를 보존해야 합니다."}),e.jsxs("div",{className:"bg-red-100 p-2 rounded text-xs text-red-800",children:[e.jsx("strong",{children:"대안:"})," 사용자 계정을 비활성화하거나 역할을 변경하여 시스템 접근을 제한하세요."]})]}),o.references.projects.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["연결된 현장 (",o.references.projects.length,"개)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:o.references.projects.map(c=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:c.name}),e.jsx("span",{className:"text-blue-500",children:c.type==="project_manager"?"현장 관리자":"현장 멤버"})]},c.id))})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-amber-600 font-medium",children:[x.name||x.email," 사용자는 다음 현장과 연결되어 있어 바로 삭제할 수 없습니다:"]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["연결된 현장 (",o.references.projects.length,"개)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:o.references.projects.map(c=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:c.name}),e.jsx("span",{className:"text-blue-500",children:c.type==="project_manager"?"현장 관리자":"현장 멤버"})]},c.id))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"계속 진행하려면 먼저 현장 담당자를 다른 사용자에게 재배정해야 합니다."})]})}),N==="reassign"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"현장 담당자를 재배정할 새로운 사용자를 선택해주세요:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"replacement-user",children:"새로운 담당자"}),e.jsxs(Y,{value:t,onValueChange:h,children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"담당자를 선택해주세요"})}),e.jsx(se,{children:O.map(c=>e.jsxs(I,{value:c.id,children:[c.name," (",c.email,") - ",c.role==="admin"?"관리자":c.role==="order_manager"?"발주 담당자":"사용자"]},c.id))})]})]})]}),N==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[x.name||x.email," 사용자를 삭제하시겠습니까?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"이 작업은 되돌릴 수 없습니다. 사용자의 모든 정보가 영구적으로 삭제됩니다."})]})]})})]}),e.jsxs(Ke,{children:[N==="warning"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:v,children:"취소"}),o&&o.references.orders.length===0&&e.jsx(l,{onClick:()=>f("reassign"),children:"재배정 진행"})]}),N==="reassign"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:v,children:"취소"}),e.jsx(l,{onClick:T,disabled:!t||g.isPending,children:g.isPending?"재배정 중...":"재배정 후 삭제"})]}),N==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:v,children:"취소"}),e.jsx(l,{variant:"destructive",onClick:j,disabled:q.isPending,children:q.isPending?"삭제 중...":"삭제"})]})]})]})})}const Is={admin:"관리자",executive:"임원",hq_management:"본사 관리자",project_manager:"프로젝트 매니저",field_worker:"현장 작업자"},es=[{value:"admin",label:"관리자"},{value:"executive",label:"임원"},{value:"hq_management",label:"본사 관리자"},{value:"project_manager",label:"프로젝트 매니저"},{value:"field_worker",label:"현장 작업자"}];function zs(){const{toast:x}=Se(),S=as(),[v]=d.useState(1),[C,N]=d.useState(!1),[f,t]=d.useState(null),[h,p]=d.useState([]),[o,$]=d.useState({approvalMode:"direct",directApprovalRoles:[],skipLowerStages:!1}),[k,g]=d.useState({templateName:"",stepOrder:"",requiredRole:"",minAmount:"",maxAmount:"",canSkip:!1,isOptional:!1,description:""}),{data:q,isLoading:T}=J({queryKey:["workflow-settings",v],queryFn:async()=>{const s=await fetch(`/api/approval-settings/workflow-settings/${v}`,{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch workflow settings");return(await s.json()).data}}),{data:j=[],isLoading:O}=J({queryKey:["step-templates",v],queryFn:async()=>{const s=await fetch(`/api/approval-settings/step-templates/${v}`,{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch step templates");return(await s.json()).data}}),c=P({mutationFn:async s=>{const i=await fetch("/api/approval-settings/workflow-settings",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(!i.ok){const m=await i.json();throw new Error(m.error||"Failed to update workflow settings")}return i.json()},onSuccess:()=>{S.invalidateQueries({queryKey:["workflow-settings"]}),x({title:"성공",description:"워크플로 설정이 저장되었습니다."})},onError:s=>{x({title:"오류",description:s.message,variant:"destructive"})}}),r=P({mutationFn:async s=>{const i=s.id?`/api/approval-settings/step-templates/${s.id}`:"/api/approval-settings/step-templates",m=s.id?"PUT":"POST",de=await fetch(i,{method:m,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...s,stepOrder:parseInt(s.stepOrder),minAmount:s.minAmount,maxAmount:s.maxAmount||null})});if(!de.ok){const Ce=await de.json();throw new Error(Ce.error||"Failed to save template")}return de.json()},onSuccess:()=>{S.invalidateQueries({queryKey:["step-templates"]}),N(!1),t(null),b(),x({title:"성공",description:f?"템플릿이 수정되었습니다.":"템플릿이 생성되었습니다."})},onError:s=>{x({title:"오류",description:s.message,variant:"destructive"})}}),n=P({mutationFn:async s=>{const i=await fetch(`/api/approval-settings/step-templates/${s}`,{method:"DELETE",credentials:"include"});if(!i.ok){const m=await i.json();throw new Error(m.error||"Failed to delete template")}return i.json()},onSuccess:()=>{S.invalidateQueries({queryKey:["step-templates"]}),x({title:"성공",description:"템플릿이 삭제되었습니다."})},onError:s=>{x({title:"오류",description:s.message,variant:"destructive"})}}),b=()=>{g({templateName:"",stepOrder:"",requiredRole:"",minAmount:"",maxAmount:"",canSkip:!1,isOptional:!1,description:""})},oe=s=>{t(s),g({templateName:s.templateName,stepOrder:s.stepOrder.toString(),requiredRole:s.requiredRole,minAmount:s.minAmount,maxAmount:s.maxAmount||"",canSkip:s.canSkip,isOptional:s.isOptional,description:s.description||""}),N(!0)},ve=s=>{$(i=>({...i,directApprovalRoles:i.directApprovalRoles.includes(s)?i.directApprovalRoles.filter(m=>m!==s):[...i.directApprovalRoles,s]}))},X=s=>{p(i=>i.includes(s)?i.filter(m=>m!==s):[...i,s])},ae=j.reduce((s,i)=>(s[i.templateName]||(s[i.templateName]=[]),s[i.templateName].push(i),s),{});return Object.keys(ae).forEach(s=>{ae[s].sort((i,m)=>i.stepOrder-m.stepOrder)}),T||O?e.jsx(E,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(E,{className:"bg-blue-50 border-blue-200",children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center space-x-2 text-blue-800",children:[e.jsx(Ye,{className:"w-5 h-5"}),e.jsx("span",{children:"승인 워크플로우란?"})]})}),e.jsxs(D,{className:"text-sm text-blue-700 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"• 승인 방식 선택:"})}),e.jsxs("ul",{className:"ml-4 space-y-1",children:[e.jsxs("li",{children:["- ",e.jsx("strong",{children:"직접 승인:"})," 발주서 생성 시 승인절차 없이 바로 발주서가 생성되는 방식"]}),e.jsxs("li",{children:["- ",e.jsx("strong",{children:"단계별 승인:"})," 현장 작업자 → 프로젝트 매니저 → 임원 등 순차적으로 승인하는 방식"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"• 승인 단계 템플릿:"})}),e.jsxs("ul",{className:"ml-4 space-y-1",children:[e.jsx("li",{children:"- 발주 금액에 따라 다른 승인 경로를 설정할 수 있습니다"}),e.jsx("li",{children:"- 예: 100만원 미만은 프로젝트 매니저 승인, 100만원 이상은 임원 승인"}),e.jsx("li",{children:"- 각 단계별로 건너뛰기 허용 여부, 선택적 단계 여부를 설정 가능"})]})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsxs("p",{children:[e.jsx("strong",{children:"💡 사용 팁:"})," 먼저 기본 워크플로 설정을 선택하고, 필요에 따라 상세한 승인 단계 템플릿을 추가하세요. 템플릿은 발주서 작성 시 자동으로 적용되어 적절한 승인자에게 전달됩니다."]})})]})]}),e.jsxs(E,{children:[e.jsxs(z,{children:[e.jsxs(V,{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"w-5 h-5"}),e.jsx("span",{children:"기본 워크플로우 설정"})]}),e.jsx(Ee,{children:"회사의 기본 승인 워크플로우 방식을 설정합니다."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(y,{className:"text-base font-semibold",children:"승인 모드"}),e.jsxs(Y,{value:o.approvalMode,onValueChange:s=>$(i=>({...i,approvalMode:s})),children:[e.jsx(Z,{children:e.jsx(ee,{})}),e.jsxs(se,{children:[e.jsx(I,{value:"direct",children:"직접 승인"}),e.jsx(I,{value:"staged",children:"단계별 승인"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:o.approvalMode==="direct"?"직접승인 모드는 발주서 생성 시, 승인절차 없이 바로 발주서가 생성이 됩니다.":"여러 단계를 거쳐 순차적으로 승인하는 방식입니다."})]}),o.approvalMode==="direct"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(y,{className:"text-base font-semibold",children:"직접 승인 가능 역할"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:es.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:s.value,checked:o.directApprovalRoles.includes(s.value),onChange:()=>ve(s.value),className:"rounded border-gray-300"}),e.jsx(y,{htmlFor:s.value,className:"text-sm",children:s.label})]},s.value))})]}),o.approvalMode==="staged"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{className:"text-base font-semibold",children:"하위 단계 건너뛰기 허용"}),e.jsx(je,{checked:o.skipLowerStages,onCheckedChange:s=>$(i=>({...i,skipLowerStages:s}))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"상위 권한자가 하위 승인 단계를 건너뛸 수 있도록 허용합니다."})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(l,{onClick:()=>c.mutate({...o,companyId:v}),disabled:c.isPending,children:c.isPending?"저장 중...":"설정 저장"})})]})]}),e.jsxs(E,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(V,{children:"승인 단계 템플릿"}),e.jsx(Ee,{children:"단계별 승인을 위한 템플릿을 관리합니다."})]}),e.jsxs(re,{open:C,onOpenChange:N,children:[e.jsx(be,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>{b(),t(null)},children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"새 템플릿 단계 추가"]})}),e.jsxs(ie,{className:"max-w-2xl",children:[e.jsxs(ne,{children:[e.jsx(le,{children:f?"승인 단계 수정":"새 승인 단계 추가"}),e.jsx(Pe,{children:"승인 단계의 상세 정보를 설정합니다."})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),r.mutate({...k,companyId:v,id:f?.id})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"templateName",children:"템플릿 이름"}),e.jsx(w,{id:"templateName",value:k.templateName,onChange:s=>g(i=>({...i,templateName:s.target.value})),placeholder:"예: 일반발주, 고액발주"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"stepOrder",children:"단계 순서"}),e.jsx(w,{id:"stepOrder",type:"number",value:k.stepOrder,onChange:s=>g(i=>({...i,stepOrder:s.target.value})),placeholder:"1, 2, 3..."})]})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"requiredRole",children:"필요 역할"}),e.jsxs(Y,{value:k.requiredRole,onValueChange:s=>g(i=>({...i,requiredRole:s})),children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"역할을 선택하세요"})}),e.jsx(se,{children:es.map(s=>e.jsx(I,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"minAmount",children:"최소 금액 (원)"}),e.jsx(w,{id:"minAmount",type:"number",value:k.minAmount,onChange:s=>g(i=>({...i,minAmount:s.target.value})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"maxAmount",children:"최대 금액 (원, 선택사항)"}),e.jsx(w,{id:"maxAmount",type:"number",value:k.maxAmount,onChange:s=>g(i=>({...i,maxAmount:s.target.value})),placeholder:"제한 없음"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{checked:k.canSkip,onCheckedChange:s=>g(i=>({...i,canSkip:s}))}),e.jsx(y,{children:"건너뛰기 허용"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{checked:k.isOptional,onCheckedChange:s=>g(i=>({...i,isOptional:s}))}),e.jsx(y,{children:"선택적 단계"})]})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"description",children:"설명 (선택사항)"}),e.jsx(De,{id:"description",value:k.description,onChange:s=>g(i=>({...i,description:s.target.value})),placeholder:"이 승인 단계에 대한 설명",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>N(!1),children:"취소"}),e.jsx(l,{type:"submit",disabled:r.isPending,children:r.isPending?f?"수정 중...":"생성 중...":f?"수정":"생성"})]})]})]})]})]})}),e.jsx(D,{children:Object.keys(ae).length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"설정된 승인 단계 템플릿이 없습니다. 새 템플릿을 추가해보세요."}):e.jsx("div",{className:"space-y-4",children:Object.entries(ae).map(([s,i])=>e.jsxs(E,{children:[e.jsx(z,{className:"cursor-pointer pb-3",onClick:()=>X(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center space-x-2 text-base",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{children:s}),e.jsxs(te,{variant:"secondary",className:"text-xs",children:[i.length,"단계"]})]}),h.includes(s)?e.jsx(ls,{className:"w-4 h-4"}):e.jsx(gs,{className:"w-4 h-4"})]})}),h.includes(s)&&e.jsx(D,{className:"pt-0",children:e.jsx("div",{className:"space-y-3",children:i.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(te,{variant:"outline",className:"text-xs",children:["단계 ",m.stepOrder]}),e.jsx("span",{className:"font-medium text-sm",children:Is[m.requiredRole]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[parseFloat(m.minAmount).toLocaleString(),"원",m.maxAmount&&` ~ ${parseFloat(m.maxAmount).toLocaleString()}원`]}),m.canSkip&&e.jsx(te,{variant:"secondary",className:"text-xs",children:"건너뛰기 가능"}),m.isOptional&&e.jsx(te,{variant:"secondary",className:"text-xs",children:"선택적"})]}),m.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:m.description})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>oe(m),children:e.jsx(ue,{className:"w-3 h-3"})}),e.jsxs(qe,{children:[e.jsx(rs,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(we,{className:"w-3 h-3"})})}),e.jsxs(Le,{children:[e.jsxs(Me,{children:[e.jsx(Ue,{children:"템플릿 단계 삭제"}),e.jsx(Re,{children:"이 승인 단계를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."})]}),e.jsxs(Ke,{children:[e.jsx(is,{children:"취소"}),e.jsx(ns,{onClick:()=>n.mutate(m.id),disabled:n.isPending,className:"bg-red-600 hover:bg-red-700",children:n.isPending?"삭제 중...":"삭제"})]})]})]})]})]},m.id))})})]},s))})})]})]})}const Fe={admin:"관리자",executive:"임원",hq_management:"본사 관리자",project_manager:"프로젝트 매니저",field_worker:"현장 작업자"},ss=[{value:"admin",label:"관리자"},{value:"executive",label:"임원"},{value:"hq_management",label:"본사 관리자"},{value:"project_manager",label:"프로젝트 매니저"},{value:"field_worker",label:"현장 작업자"}];function Vs({companyId:x}){const{toast:S}=Se(),v=as(),[C,N]=d.useState(!1),[f,t]=d.useState(null),[h,p]=d.useState({role:"",maxAmount:"",description:""}),{data:o=[],isLoading:$,error:k}=J({queryKey:["approval-authorities"],queryFn:async()=>{const r=await fetch("/api/approval-authorities",{credentials:"include"});if(!r.ok)throw new Error("Failed to fetch approval authorities");return r.json()}}),g=P({mutationFn:async r=>{const n=await fetch("/api/approval-authorities",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({role:r.role,maxAmount:r.maxAmount,description:r.description,isActive:!0})});if(!n.ok){const b=await n.json();throw new Error(b.message||"Failed to create approval authority")}return n.json()},onSuccess:()=>{v.invalidateQueries({queryKey:["approval-authorities"]}),N(!1),j(),S({title:"성공",description:"승인 권한이 생성되었습니다."})},onError:r=>{S({title:"오류",description:r.message,variant:"destructive"})}}),q=P({mutationFn:async r=>{const n=await fetch(`/api/approval-authorities/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({role:r.role,maxAmount:r.maxAmount,description:r.description,isActive:!0})});if(!n.ok){const b=await n.json();throw new Error(b.message||"Failed to update approval authority")}return n.json()},onSuccess:()=>{v.invalidateQueries({queryKey:["approval-authorities"]}),t(null),j(),S({title:"성공",description:"승인 권한이 수정되었습니다."})},onError:r=>{S({title:"오류",description:r.message,variant:"destructive"})}}),T=P({mutationFn:async r=>{const n=await fetch(`/api/approval-authorities/${r}`,{method:"DELETE",credentials:"include"});if(!n.ok){const b=await n.json();throw new Error(b.message||"Failed to delete approval authority")}return n.json()},onSuccess:()=>{v.invalidateQueries({queryKey:["approval-authorities"]}),S({title:"성공",description:"승인 권한이 삭제되었습니다."})},onError:r=>{S({title:"오류",description:r.message,variant:"destructive"})}}),j=()=>{p({role:"",maxAmount:"",description:""})},O=r=>{t(r),p({role:r.role,maxAmount:r.maxAmount.toString(),description:r.description||""})},c=r=>{if(r.preventDefault(),!h.role||!h.maxAmount){S({title:"오류",description:"역할과 승인 한도를 입력해주세요.",variant:"destructive"});return}f?q.mutate({id:f.id,...h}):g.mutate(h)};return $?e.jsx(E,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})}):k?e.jsx(E,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"text-center text-red-600",children:"승인 권한 데이터를 불러오는 중 오류가 발생했습니다."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"승인 권한 관리"}),e.jsx("p",{className:"text-sm text-gray-600",children:"사용자 역할별 승인 권한과 한도를 관리합니다"})]}),e.jsxs(re,{open:C,onOpenChange:N,children:[e.jsx(be,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>{j(),t(null)},children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"새 권한 추가"]})}),e.jsxs(ie,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"승인 권한 추가"}),e.jsx(Pe,{children:"새로운 역할의 승인 권한을 설정합니다."})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"role",children:"역할"}),e.jsxs(Y,{value:h.role,onValueChange:r=>p(n=>({...n,role:r})),children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"역할을 선택하세요"})}),e.jsx(se,{children:ss.map(r=>e.jsx(I,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"maxAmount",children:"승인 한도 (원)"}),e.jsx(w,{id:"maxAmount",type:"number",value:h.maxAmount,onChange:r=>p(n=>({...n,maxAmount:r.target.value})),placeholder:"승인 가능한 최대 금액"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"description",children:"설명 (선택사항)"}),e.jsx(De,{id:"description",value:h.description,onChange:r=>p(n=>({...n,description:r.target.value})),placeholder:"승인 권한에 대한 설명",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>N(!1),children:"취소"}),e.jsx(l,{type:"submit",disabled:g.isPending,children:g.isPending?"생성 중...":"생성"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"총 권한 수"}),e.jsx(ts,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.length})})]}),e.jsxs(E,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"활성 권한"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.filter(r=>r.isActive).length})})]}),e.jsxs(E,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"최고 한도"}),e.jsx(Ts,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.length>0?`${Math.max(...o.map(r=>r.maxAmount)).toLocaleString()}원`:"0원"})})]})]}),e.jsxs(E,{children:[e.jsxs(z,{children:[e.jsx(V,{className:"text-base",children:"승인 권한 목록"}),e.jsx(Ee,{className:"text-sm",children:"각 역할별로 설정된 승인 권한과 한도를 확인할 수 있습니다."})]}),e.jsx(D,{children:o.length>0?e.jsx("div",{className:"space-y-3",children:o.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(te,{variant:r.isActive?"default":"secondary",children:Fe[r.role]||r.role}),e.jsxs("div",{className:"font-semibold",children:[r.maxAmount.toLocaleString(),"원"]}),!r.isActive&&e.jsx(te,{variant:"outline",children:"비활성"})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["생성일: ",new Date(r.createdAt).toLocaleDateString("ko-KR")]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(re,{children:[e.jsx(be,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",onClick:()=>O(r),children:e.jsx(ue,{className:"w-4 h-4"})})}),e.jsxs(ie,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"승인 권한 수정"}),e.jsxs(Pe,{children:[Fe[r.role]," 역할의 승인 권한을 수정합니다."]})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"edit-role",children:"역할"}),e.jsxs(Y,{value:h.role,onValueChange:n=>p(b=>({...b,role:n})),children:[e.jsx(Z,{children:e.jsx(ee,{})}),e.jsx(se,{children:ss.map(n=>e.jsx(I,{value:n.value,children:n.label},n.value))})]})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"edit-maxAmount",children:"승인 한도 (원)"}),e.jsx(w,{id:"edit-maxAmount",type:"number",value:h.maxAmount,onChange:n=>p(b=>({...b,maxAmount:n.target.value}))})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"edit-description",children:"설명"}),e.jsx(De,{id:"edit-description",value:h.description,onChange:n=>p(b=>({...b,description:n.target.value})),rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(be,{asChild:!0,children:e.jsx(l,{type:"button",variant:"outline",children:"취소"})}),e.jsx(l,{type:"submit",disabled:q.isPending,children:q.isPending?"수정 중...":"수정"})]})]})]})]}),e.jsxs(qe,{children:[e.jsx(rs,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(we,{className:"w-4 h-4"})})}),e.jsxs(Le,{children:[e.jsxs(Me,{children:[e.jsx(Ue,{children:"승인 권한 삭제"}),e.jsxs(Re,{children:[Fe[r.role]," 역할의 승인 권한을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."]})]}),e.jsxs(Ke,{children:[e.jsx(is,{children:"취소"}),e.jsx(ns,{onClick:()=>T.mutate(r.id),disabled:T.isPending,className:"bg-red-600 hover:bg-red-700",children:T.isPending?"삭제 중...":"삭제"})]})]})]})]})]},r.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"설정된 승인 권한이 없습니다. 새 권한을 추가해보세요."})})]})]})}const Qs=u.object({smtpHost:u.string().min(1,"SMTP 호스트는 필수입니다"),smtpPort:u.string().regex(/^\d+$/,"포트는 숫자여야 합니다"),smtpUser:u.string().email("올바른 이메일 형식이 아닙니다"),smtpPass:u.string().min(1,"비밀번호는 필수입니다")});function Hs(){const[x,S]=d.useState(!1),[v,C]=d.useState(""),[N,f]=d.useState(""),[t,h]=d.useState(""),{register:p,handleSubmit:o,formState:{errors:$},reset:k}=Ne({resolver:fe(Qs)}),{data:g,isLoading:q}=J({queryKey:["emailSettings"],queryFn:async()=>{const r=await fetch("/api/email-settings",{credentials:"include"});if(!r.ok)throw new Error("설정을 가져오는데 실패했습니다");return(await r.json()).data}}),T=P({mutationFn:async r=>{const n=await fetch("/api/email-settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});if(!n.ok){const b=await n.json();throw new Error(b.message||"설정 업데이트에 실패했습니다")}return n.json()},onSuccess:r=>{f(r.message||"설정이 업데이트되었습니다"),h(""),setTimeout(()=>f(""),5e3)},onError:r=>{h(r.message),f("")}}),j=P({mutationFn:async r=>{const n=await fetch("/api/email-settings/test",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({testEmail:r})});if(!n.ok){const b=await n.json();throw new Error(b.message||"테스트 이메일 발송에 실패했습니다")}return n.json()},onSuccess:()=>{S(!1),f("테스트 이메일이 발송되었습니다"),C(""),setTimeout(()=>f(""),5e3)},onError:r=>{h(r.message)}});d.useEffect(()=>{g&&k(g)},[g,k]);const O=r=>{T.mutate(r)},c=()=>{if(!v||!u.string().email().safeParse(v).success){h("유효한 이메일 주소를 입력해주세요");return}j.mutate(v)};return q?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(ke,{className:"h-8 w-8 animate-spin"})}):e.jsxs(E,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5"}),"이메일 발송 설정"]})}),e.jsxs(D,{children:[e.jsxs("form",{onSubmit:o(O),className:"space-y-4",children:[N&&e.jsx($e,{className:"bg-green-50 border-green-200",children:e.jsx(Te,{className:"text-green-800",children:N})}),t&&e.jsx($e,{className:"bg-red-50 border-red-200",children:e.jsx(Te,{className:"text-red-800",children:t})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{htmlFor:"smtpHost",children:[e.jsx(Us,{className:"inline h-4 w-4 mr-1"}),"SMTP 서버"]}),e.jsx(w,{id:"smtpHost",...p("smtpHost"),placeholder:"smtp.naver.com"}),$.smtpHost&&e.jsx("span",{className:"text-red-500 text-sm",children:$.smtpHost.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"smtpPort",children:"포트"}),e.jsx(w,{id:"smtpPort",...p("smtpPort"),placeholder:"587"}),$.smtpPort&&e.jsx("span",{className:"text-red-500 text-sm",children:$.smtpPort.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{htmlFor:"smtpUser",children:[e.jsx(ge,{className:"inline h-4 w-4 mr-1"}),"발송자 이메일"]}),e.jsx(w,{id:"smtpUser",type:"email",...p("smtpUser"),placeholder:"example@naver.com"}),$.smtpUser&&e.jsx("span",{className:"text-red-500 text-sm",children:$.smtpUser.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{htmlFor:"smtpPass",children:[e.jsx(Ms,{className:"inline h-4 w-4 mr-1"}),"앱 비밀번호"]}),e.jsx(w,{id:"smtpPass",type:"password",...p("smtpPass"),placeholder:"앱 비밀번호 입력"}),$.smtpPass&&e.jsx("span",{className:"text-red-500 text-sm",children:$.smtpPass.message})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"설정 안내"}),e.jsxs("ul",{className:"space-y-1 text-sm text-blue-800",children:[e.jsx("li",{children:"• Naver 메일: smtp.naver.com (포트 587)"}),e.jsx("li",{children:"• Gmail: smtp.gmail.com (포트 587)"}),e.jsx("li",{children:"• 앱 비밀번호는 2단계 인증 후 생성 필요"}),e.jsx("li",{children:"• Naver: 메일 설정에서 POP3/SMTP 사용 활성화 필요"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(l,{type:"button",variant:"outline",onClick:()=>S(!0),disabled:T.isPending,children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),"테스트"]}),e.jsxs(l,{type:"submit",disabled:T.isPending,children:[T.isPending?e.jsx(ke,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(cs,{className:"h-4 w-4 mr-2"}),"저장"]})]})]}),e.jsx(re,{open:x,onOpenChange:S,children:e.jsxs(ie,{children:[e.jsx(ne,{children:e.jsx(le,{children:"이메일 발송 테스트"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"testEmail",children:"테스트 수신 이메일"}),e.jsx(w,{id:"testEmail",type:"email",value:v,onChange:r=>C(r.target.value),placeholder:"test@example.com"})]}),t&&e.jsx($e,{className:"bg-red-50 border-red-200",children:e.jsx(Te,{className:"text-red-800",children:t})})]}),e.jsxs(Ss,{children:[e.jsx(l,{variant:"outline",onClick:()=>S(!1),disabled:j.isPending,children:"취소"}),e.jsxs(l,{onClick:c,disabled:j.isPending,children:[j.isPending?e.jsx(ke,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ge,{className:"h-4 w-4 mr-2"}),"발송"]})]})]})})]})]})}const Js=u.object({companyName:u.string().min(1,"회사명을 입력해주세요"),businessNumber:u.string().min(1,"사업자등록번호를 입력해주세요"),address:u.string().min(1,"주소를 입력해주세요"),phone:u.string().min(1,"전화번호를 입력해주세요"),fax:u.string().optional(),email:u.string().email("올바른 이메일 형식을 입력해주세요").optional().or(u.literal("")),website:u.string().optional(),representative:u.string().min(1,"대표자명을 입력해주세요")}),Bs=u.object({name:u.string().min(1,"이름을 입력해주세요"),email:u.string().email("올바른 이메일 형식을 입력해주세요"),phoneNumber:u.string().min(1,"전화번호를 입력해주세요"),role:u.enum(["field_worker","project_manager","hq_management","executive","admin"])}),Gs=u.object({role:u.enum(["field_worker","project_manager","hq_management","executive"]),maxAmount:u.number().min(0,"금액은 0 이상이어야 합니다"),description:u.string().optional()});function Sa(){const{user:x,isAuthenticated:S,isLoading:v}=ys(),{toast:C}=Se(),[,N]=vs(),{theme:f}=Ns(),t=f==="dark",[h,p]=d.useState(!1);d.useState(null);const[o,$]=d.useState("company"),[k,g]=d.useState(""),[q,T]=d.useState(!1),[j,O]=d.useState(null),[c,r]=d.useState(!1),[n,b]=d.useState(null);d.useState(null);const[oe,ve]=d.useState("list"),[X,ae]=d.useState(null),[s,i]=d.useState("asc"),{data:m=[],isLoading:de}=J({queryKey:["/api/users"],enabled:!!x&&x.role==="admin"}),{data:Ce=[],isLoading:Ws}=J({queryKey:["/api/companies"],enabled:!!x&&x.role==="admin"});J({queryKey:["/api/approval-authorities"],enabled:!!x&&x.role==="admin"});const A=Ce[0],H=Ne({resolver:fe(Js),defaultValues:{companyName:"",businessNumber:"",address:"",phone:"",fax:"",email:"",website:"",representative:""}}),_=Ne({resolver:fe(Bs),defaultValues:{name:"",email:"",phoneNumber:"",role:"field_worker"}}),B=Ne({resolver:fe(Gs),defaultValues:{role:"field_worker",maxAmount:0,description:""}});if(d.useEffect(()=>{A&&!h&&(console.log("🔄 Resetting company form with data:",A),H.reset({companyName:A.companyName||"",businessNumber:A.businessNumber||"",address:A.address||"",phone:A.phone||"",fax:A.fax||"",email:A.email||"",website:A.website||"",representative:A.representative||""}))},[A,H,h]),d.useEffect(()=>{j&&_.reset({name:j.name||"",email:j.email||"",phoneNumber:j.phoneNumber||"",role:j.role||"field_worker"})},[j,_]),v)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:"로딩 중..."});if(!S||!x||x.role!=="admin")return N("/login"),null;const _e=m.filter(a=>(a.name?.toLowerCase()||"").includes(k.toLowerCase())||(a.email?.toLowerCase()||"").includes(k.toLowerCase())||(a.phoneNumber?.toLowerCase()||"").includes(k.toLowerCase())).sort((a,F)=>{if(!X)return 0;const G=a[X]??"",He=F[X]??"";return s==="asc"?String(G).localeCompare(String(He)):String(He).localeCompare(String(G))}),Ie=P({mutationFn:a=>(console.log("🚀 Saving company data:",a),A?(console.log("📝 Updating existing company ID:",A.id),Q("PUT",`/api/companies/${A.id}`,a)):(console.log("➕ Creating new company"),Q("POST","/api/companies",a))),onSuccess:a=>{console.log("✅ Company save successful:",a),C({title:"성공",description:"회사 정보가 저장되었습니다."}),p(!1),setTimeout(()=>{W.invalidateQueries({queryKey:["/api/companies"]})},100)},onError:a=>{console.error("❌ Company save failed:",a),C({title:"오류",description:"회사 정보 저장에 실패했습니다.",variant:"destructive"})}}),ze=P({mutationFn:a=>j?Q("PUT",`/api/users/${j.id}`,a):Q("POST","/api/users",a),onSuccess:()=>{C({title:"성공",description:j?"사용자가 수정되었습니다.":"사용자가 추가되었습니다."}),W.invalidateQueries({queryKey:["/api/users"]}),T(!1),O(null),_.reset()},onError:()=>{C({title:"오류",description:"사용자 저장에 실패했습니다.",variant:"destructive"})}}),Ve=P({mutationFn:({userId:a,isActive:F})=>Q("PATCH",`/api/users/${a}/toggle-active`,{isActive:F}),onSuccess:()=>{C({title:"성공",description:"사용자 상태가 변경되었습니다."}),W.invalidateQueries({queryKey:["/api/users"]})},onError:()=>{C({title:"오류",description:"사용자 상태 변경에 실패했습니다.",variant:"destructive"})}}),Qe=P({mutationFn:a=>a.id?Q("PUT",`/api/approval-authorities/${a.id}`,a):Q("POST","/api/approval-authorities",a),onSuccess:()=>{C({title:"성공",description:n?"승인 권한이 수정되었습니다.":"승인 권한이 추가되었습니다."}),W.invalidateQueries({queryKey:["/api/approval-authorities"]}),r(!1),b(null),B.reset()},onError:()=>{C({title:"오류",description:"승인 권한 저장에 실패했습니다.",variant:"destructive"})}});P({mutationFn:a=>Q("DELETE",`/api/approval-authorities/${a}`),onSuccess:()=>{C({title:"성공",description:"승인 권한이 삭제되었습니다."}),W.invalidateQueries({queryKey:["/api/approval-authorities"]})},onError:()=>{C({title:"오류",description:"승인 권한 삭제에 실패했습니다.",variant:"destructive"})}});const os=a=>{Ie.mutate(a)},ds=a=>{ze.mutate(a)},xs=a=>{const F=n?{...a,id:n.id}:a;Qe.mutate(F)},ms=a=>{X===a?i(s==="asc"?"desc":"asc"):(ae(a),i("asc"))},hs=(a,F,G)=>F!==a?null:G==="asc"?e.jsx(Ls,{className:"h-3 w-3"}):e.jsx(ls,{className:"h-3 w-3"});return e.jsx("div",{className:"min-h-screen",style:{backgroundColor:t?"#111827":"#f9fafb"},children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${t?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(ts,{className:`h-6 w-6 transition-colors ${t?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${t?"text-white":"text-gray-900"}`,children:"시스템 관리"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"사용자 및 시스템 설정을 관리하세요"})]})]})})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs(bs,{value:o,onValueChange:$,className:"w-full",children:[e.jsxs(ws,{className:`grid w-full grid-cols-6 transition-colors ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsxs(xe,{value:"company",className:"flex items-center gap-2 text-sm",children:[e.jsx(Je,{className:"h-4 w-4"}),"회사 정보"]}),e.jsxs(xe,{value:"users",className:"flex items-center gap-2 text-sm",children:[e.jsx(ye,{className:"h-4 w-4"}),"사용자 관리"]}),e.jsxs(xe,{value:"approval",className:"flex items-center gap-2 text-sm",children:[e.jsx(_s,{className:"h-4 w-4"}),"승인 권한"]}),e.jsxs(xe,{value:"workflow",className:"flex items-center gap-2 text-sm",children:[e.jsx(Rs,{className:"h-4 w-4"}),"승인 워크플로우"]}),e.jsxs(xe,{value:"email",className:"flex items-center gap-2 text-sm",children:[e.jsx(ge,{className:"h-4 w-4"}),"이메일 설정"]})]}),e.jsx(me,{value:"company",className:"mt-2",children:e.jsxs(E,{className:`shadow-sm transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(z,{className:"pb-1",children:e.jsxs(V,{className:`flex items-center justify-between text-sm transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Je,{className:`h-4 w-4 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"회사 정보"})]}),!h&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{console.log("✏️ Starting company edit mode"),p(!0)},className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(ue,{className:"h-3 w-3"}),"수정"]})]})}),e.jsx(D,{className:"pt-1",children:h?e.jsx(Ae,{...H,children:e.jsxs("form",{onSubmit:H.handleSubmit(os),className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(L,{control:H.control,name:"companyName",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{className:`text-xs transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"회사명"}),e.jsx(R,{children:e.jsx(w,{...a,className:`h-7 text-xs transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:H.control,name:"businessNumber",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{className:`text-xs transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"사업자등록번호"}),e.jsx(R,{children:e.jsx(w,{...a,className:`h-7 text-xs transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:H.control,name:"representative",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{className:`text-xs transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"대표자"}),e.jsx(R,{children:e.jsx(w,{...a,className:`h-7 text-xs transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:H.control,name:"phone",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{className:`text-xs transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"전화번호"}),e.jsx(R,{children:e.jsx(w,{...a,className:`h-7 text-xs transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})}),e.jsx(L,{control:H.control,name:"address",render:({field:a})=>e.jsxs(M,{className:"col-span-2",children:[e.jsx(U,{className:`text-xs transition-colors ${t?"text-gray-300":"text-gray-700"}`,children:"주소"}),e.jsx(R,{children:e.jsx(w,{...a,className:`h-7 text-xs transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(K,{className:"text-xs"})]})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(l,{type:"submit",size:"sm",disabled:Ie.isPending,className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(cs,{className:"h-3 w-3"}),"저장"]}),e.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:()=>p(!1),className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(fs,{className:"h-3 w-3"}),"취소"]})]})]})}):e.jsx("div",{className:"space-y-3",children:A?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"회사명:"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:A.companyName})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[80px] transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"사업자번호:"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:A.businessNumber})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"대표자:"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:A.representative})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"전화번호:"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:A.phone})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded col-span-2 transition-colors ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[40px] transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"주소:"}),e.jsx("span",{className:`transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:A.address})]})]}):e.jsx("div",{className:`text-xs text-center py-4 transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:"회사 정보가 없습니다. 추가해주세요."})})})]})}),e.jsx(me,{value:"users",className:"mt-2",children:e.jsxs(E,{className:`shadow-sm transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(z,{className:"pb-1",children:e.jsxs(V,{className:`flex items-center justify-between text-sm transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:`h-4 w-4 transition-colors ${t?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"사용자 관리"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center rounded p-1 transition-colors ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx(l,{variant:oe==="list"?"default":"ghost",size:"sm",onClick:()=>ve("list"),className:"h-8 w-8 p-0",title:"리스트 보기",children:e.jsx(Es,{className:"h-4 w-4"})}),e.jsx(l,{variant:oe==="card"?"default":"ghost",size:"sm",onClick:()=>ve("card"),className:"h-8 w-8 p-0",title:"카드 보기",children:e.jsx(Ps,{className:"h-4 w-4"})})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>T(!0),className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(Oe,{className:"h-3 w-3"}),"사용자 추가"]})]})]})}),e.jsx(D,{className:"pt-1",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ds,{className:`absolute left-2 top-1/2 transform -translate-y-1/2 h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx(w,{placeholder:"사용자 검색...",value:k,onChange:a=>g(a.target.value),className:`h-7 text-xs pl-7 transition-colors ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})]})}),de?e.jsx("div",{className:`text-xs text-center py-4 transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"사용자 정보를 불러오는 중..."}):oe==="list"?e.jsxs(Cs,{children:[e.jsx(ks,{children:e.jsxs(We,{children:[e.jsx(he,{className:`px-3 py-3 text-xs cursor-pointer transition-colors ${t?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>ms("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["이름",hs("name",X,s)]})}),e.jsx(he,{className:`px-3 py-3 text-xs transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"역할"}),e.jsx(he,{className:`px-3 py-3 text-xs transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"연락처"}),e.jsx(he,{className:`px-3 py-3 text-xs transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"상태"}),e.jsx(he,{className:`px-3 py-3 text-xs text-center transition-colors ${t?"text-gray-400":"text-gray-600"}`,children:"작업"})]})}),e.jsx(As,{children:_e.map(a=>e.jsxs(We,{className:`transition-colors ${t?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsx(pe,{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-6 w-6",children:e.jsx(Ge,{className:"text-xs",children:a.name?.[0]||"U"})}),e.jsxs("div",{children:[e.jsx("div",{className:`font-medium text-xs transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:a.name}),e.jsx("div",{className:`text-xs transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:a.email})]})]})}),e.jsx(pe,{className:"px-3 py-3",children:e.jsx(Xe,{role:a.role})}),e.jsx(pe,{className:`px-3 py-3 text-xs transition-colors ${t?"text-gray-300":"text-gray-900"}`,children:a.phoneNumber}),e.jsx(pe,{className:"px-3 py-3",children:e.jsx(je,{checked:a.isActive??!0,onCheckedChange:F=>Ve.mutate({userId:a.id,isActive:F}),className:"h-4 w-7"})}),e.jsx(pe,{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>O(a),className:`h-6 w-6 p-0 transition-colors ${t?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,title:"수정",children:e.jsx(ue,{className:"h-3 w-3"})}),e.jsx(Ze,{user:a,onDeleteSuccess:()=>{W.invalidateQueries({queryKey:["/api/users"]}),C({title:"성공",description:"사용자가 삭제되었습니다."})},trigger:e.jsx(l,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 transition-colors ${t?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"삭제",children:e.jsx(we,{className:"h-3 w-3"})})})]})})]},a.id))})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:_e.map(a=>e.jsxs(E,{className:`p-3 shadow-sm transition-colors ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Be,{className:"h-8 w-8",children:e.jsx(Ge,{className:"text-sm",children:a.name?.[0]||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium text-sm transition-colors ${t?"text-gray-100":"text-gray-900"}`,children:a.name}),e.jsx(Xe,{role:a.role})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-300":"text-gray-600"}`,children:a.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-300":"text-gray-600"}`,children:a.phoneNumber})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qs,{className:`h-3 w-3 transition-colors ${t?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${t?"text-gray-300":"text-gray-600"}`,children:new Date(a.createdAt).toLocaleDateString("ko-KR")})]})]}),e.jsxs("div",{className:`flex items-center justify-between mt-3 pt-3 border-t transition-colors ${t?"border-gray-600":"border-gray-200"}`,children:[e.jsx(je,{checked:a.isActive??!0,onCheckedChange:F=>Ve.mutate({userId:a.id,isActive:F}),className:"h-4 w-7"}),e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>O(a),className:`h-8 w-8 p-0 transition-colors ${t?"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:"수정",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(Ze,{user:a,onDeleteSuccess:()=>{W.invalidateQueries({queryKey:["/api/users"]}),C({title:"성공",description:"사용자가 삭제되었습니다."})},trigger:e.jsx(l,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 transition-colors ${t?"hover:bg-red-900/20":"hover:bg-red-50"}`,title:"삭제",children:e.jsx(we,{className:`h-4 w-4 transition-colors ${t?"text-red-400":"text-red-600"}`})})})]})]})]},a.id))}),e.jsxs("div",{className:`text-xs pt-1 transition-colors ${t?"text-gray-400":"text-gray-500"}`,children:["총 ",m.length,"명의 사용자가 등록되어 있습니다."]})]})})]})}),e.jsx(me,{value:"approval",className:"mt-2",children:e.jsx(Vs,{companyId:1})}),e.jsx(me,{value:"workflow",className:"mt-2",children:e.jsx(zs,{})}),e.jsx(me,{value:"email",className:"mt-2",children:e.jsx(Hs,{})})]})}),(q||j)&&e.jsx(re,{open:!0,onOpenChange:()=>{T(!1),O(null),_.reset()},children:e.jsxs(ie,{children:[e.jsx(ne,{children:e.jsx(le,{children:j?"사용자 수정":"사용자 추가"})}),e.jsx(Ae,{..._,children:e.jsxs("form",{onSubmit:_.handleSubmit(ds),className:"space-y-4",children:[e.jsx(L,{control:_.control,name:"name",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"이름"}),e.jsx(R,{children:e.jsx(w,{...a})}),e.jsx(K,{})]})}),e.jsx(L,{control:_.control,name:"email",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"이메일"}),e.jsx(R,{children:e.jsx(w,{...a,type:"email"})}),e.jsx(K,{})]})}),e.jsx(L,{control:_.control,name:"phoneNumber",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"전화번호"}),e.jsx(R,{children:e.jsx(w,{...a})}),e.jsx(K,{})]})}),e.jsx(L,{control:_.control,name:"role",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"역할"}),e.jsxs(Y,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(R,{children:e.jsx(Z,{children:e.jsx(ee,{placeholder:"역할을 선택하세요"})})}),e.jsx(se,{children:e.jsx(Fs,{children:F=>F.map(G=>e.jsx(I,{value:G.value,children:G.label},G.value))})})]}),e.jsx(K,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{T(!1),O(null),_.reset()},children:"취소"}),e.jsx(l,{type:"submit",disabled:ze.isPending,children:j?"수정":"추가"})]})]})})]})}),(c||n)&&e.jsx(re,{open:!0,onOpenChange:()=>{r(!1),b(null),B.reset()},children:e.jsxs(ie,{children:[e.jsx(ne,{children:e.jsx(le,{children:n?"승인 권한 수정":"승인 권한 추가"})}),e.jsx(Ae,{...B,children:e.jsxs("form",{onSubmit:B.handleSubmit(xs),className:"space-y-4",children:[e.jsx(L,{control:B.control,name:"role",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"역할"}),e.jsxs(Y,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(R,{children:e.jsx(Z,{children:e.jsx(ee,{placeholder:"역할을 선택하세요"})})}),e.jsxs(se,{children:[e.jsx(I,{value:"field_worker",children:"현장 실무자"}),e.jsx(I,{value:"project_manager",children:"현장 관리자"}),e.jsx(I,{value:"hq_management",children:"본사 관리부"}),e.jsx(I,{value:"executive",children:"임원/대표"})]})]}),e.jsx(K,{})]})}),e.jsx(L,{control:B.control,name:"maxAmount",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"최대 승인 한도 (원)"}),e.jsx(R,{children:e.jsx(w,{...a,type:"number",placeholder:"0",onChange:F=>a.onChange(parseInt(F.target.value)||0)})}),e.jsx(K,{})]})}),e.jsx(L,{control:B.control,name:"description",render:({field:a})=>e.jsxs(M,{children:[e.jsx(U,{children:"설명 (선택사항)"}),e.jsx(R,{children:e.jsx(w,{...a,placeholder:"권한에 대한 설명을 입력하세요"})}),e.jsx(K,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{r(!1),b(null),B.reset()},children:"취소"}),e.jsx(l,{type:"submit",disabled:Qe.isPending,children:n?"수정":"추가"})]})]})})]})})]})})}export{Sa as default};
