const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/chunk-Cr5d6gIV.js","assets/js/chunk-DAcG3qgG.js","assets/js/chunk-BMfkKc_W.js","assets/js/chunk-BnRVfYRf.js","assets/js/chunk-Bl4FTDB_.js","assets/js/chunk-Y7LyzWA5.js","assets/js/chunk-D213HQco.js","assets/js/chunk-Cvhu-Kjd.js","assets/js/chunk-ywR6XLdY.js","assets/js/orders-professional-Be-mUwdl.js","assets/js/chunk-BzLfXDBg.js","assets/js/chunk-Dvp0srGf.js"])))=>i.map(i=>d[i]);
import{m as us,r as d,u as se,j as e,ag as dl,ah as ol,ai as xl,aj as ml,X as ys,ak as hl,al as ul,am as $i,an as pl,ao as Ri,ap as Li,aq as zi,a as Ce,ar as jl,as as gl,at as qi,au as Vi,av as Ki,aw as fl,a3 as mt,ax as Nl,ay as Ui,az as yl,aA as vl,aB as bl,aC as wl,x as ps,aD as Cl,aE as Sl,aF as kl,aG as _l,aH as Bi,aI as Qi,A as Re,aJ as ka,aK as _a,E as Dl,v as ls,aL as Na,aM as Hi,aN as Hs,aO as Wi,aP as Gi,aQ as Ji,C as Be,aR as Da,af as $s,aS as Yi,aT as Al,l as Zs,aU as Zi,P as we,F as ye,a9 as pe,t as cs,B as Ws,a2 as Xi,a0 as ar,aV as dr,a7 as fs,aW as Tl,aX as Pl,aY as El,aZ as Il,a_ as ks,a$ as ec,b0 as sc,b1 as tc,b2 as ac,b3 as rc,b4 as Ol,b5 as lc,b6 as Fl,k as zt,b7 as Ml,b8 as nc,b9 as $l,ba as ic,bb as Rl,bc as Ll,bd as cc,be as dc,bf as zl,bg as oc,bh as xc,bi as ql,bj as Vl,bk as mc,bl as Kl,bm as Ul,bn as hc,bo as Bl,bp as uc,M as Ns,ae as it,ac as qt,bq as pc,br as Ql,bs as Hl,bt as Wl,bu as Gl,bv as jc,bw as gc,bx as Jl,by as fc,bz as Yl,R as lt,$ as Rs,bA as Pr,ab as ya,bB as Qt,bC as Nc,bD as yc,a8 as Vs,bE as Ka,bF as Er,i as _s,D as Xs,a1 as Es,bG as vc,T as Qe,bH as ns,f as ds,h as Ot,bI as St,bJ as Aa,K as Ts,bK as Vt,I as Ms,ad as dt,g as yt,L as Xt,G as gt,bL as Ct,bM as bc,bN as wc,bO as Zl,bP as Xl,bQ as en,bR as sn,bS as tn,bT as an,bU as Cc,bV as rn,bW as Sc,bX as kc,bY as _c,bZ as Dc,b_ as ln,c as or,b$ as nn,a6 as xr,c0 as Ir,c1 as cn,c2 as Ac,U as ot,c3 as dn,c4 as on,c5 as xn,b as Ks,c6 as sa,c7 as Tc,y as na,c8 as Pc,Z as ia,c9 as mr,ca as va,cb as hr,cc as Ec,cd as ut,ce as ft,cf as mn,cg as Ua,ch as hn,ci as un,cj as Ic,ck as pn,cl as jn,cm as gn,cn as fn,co as Nn,cp as yn,cq as vn,cr as Oc,cs as Fc,ct as Mc,cu as $c,q as Or,cv as Rc,cw as Lc,cx as zc,cy as qc,cz as Fr,cA as Vc,cB as Kc,cC as bn,cD as ma,cE as ha,cF as Uc,S as ur,cG as Bc,cH as Qc,cI as Mr,W as rr,cJ as $r,cK as wn,cL as Cn,cM as Hc,cN as Wc,cO as Gc,a4 as Jc,a5 as Yc,cP as Zc,cQ as Xc,cR as ed}from"./chunk-DAcG3qgG.js";import{u as Je,L as Pt,S as sd,R as Ne,a as ht,b as Sn}from"./chunk-Bl4FTDB_.js";import{c as ea,L as td,i as Ht}from"./chunk-ywR6XLdY.js";import{t as ad,c as rd,f as Le,k as Js}from"./chunk-BnRVfYRf.js";import{V as ld,O as nd,I as id}from"./chunk-D213HQco.js";import{Q as cd,_ as Us,B as dd,C as od,F as xd,G as md,H as Rr,J as Ye,K as ae,L as Cs,M as ue,N as ss,O as Xe,P as ms,R as He,S as Kt,T as xt,U as ba,V as be,W as kn,X as hd,Y as ud}from"./chunk-BMfkKc_W.js";import{r as pr,u as Wt}from"./chunk-BzLfXDBg.js";import{z as ve,t as pd,c as es}from"./chunk-Cvhu-Kjd.js";import{R as Ba,P as jd,e as gd,f as fd,T as ua,B as Qa,C as Ha,X as Wa,Y as Ga,a as Ja,c as Ya}from"./chunk-Y7LyzWA5.js";import"./index-PBDfA8Em.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=t(l);fetch(l.href,i)}})();var Yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zu(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const Nd="modulepreload",yd=function(s){return"/"+s},Lr={},he=function(a,t,r){let l=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),c=n?.nonce||n?.getAttribute("nonce");l=Promise.allSettled(t.map(g=>{if(g=yd(g),g in Lr)return;Lr[g]=!0;const o=g.endsWith(".css"),w=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${w}`))return;const p=document.createElement("link");if(p.rel=o?"stylesheet":Nd,o||(p.as="script"),p.crossOrigin="",p.href=g,c&&p.setAttribute("nonce",c),document.head.appendChild(p),o)return new Promise((m,f)=>{p.addEventListener("load",m),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${g}`)))})}))}function i(n){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=n,window.dispatchEvent(c),!c.defaultPrevented)throw n}return l.then(n=>{for(const c of n||[])c.status==="rejected"&&i(c.reason);return a().catch(i)})},wt={STATIC:{staleTime:30*60*1e3,gcTime:2*60*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1},MASTER:{staleTime:10*60*1e3,gcTime:30*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0},DYNAMIC:{staleTime:2*60*1e3,gcTime:5*60*1e3,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0},LIVE:{staleTime:30*1e3,gcTime:2*60*1e3,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0,refetchInterval:60*1e3},SEARCH:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1}},Ue={auth:{user:()=>["/api/auth/me"],permissions:s=>["/api/auth/permissions",s]},dashboard:{unified:()=>["/api/dashboard/unified"],stats:s=>["/api/dashboard/stats",s],charts:(s,a)=>["/api/dashboard/charts",s,a]},orders:{all:()=>["/api/orders-optimized"],list:s=>["/api/orders-optimized",s],detail:s=>["/api/orders",s],items:s=>["/api/orders",s,"items"],history:s=>["/api/orders",s,"history"],templates:()=>["/api/orders/templates"]},vendors:{all:()=>["/api/vendors"],list:s=>["/api/vendors",s],detail:s=>["/api/vendors",s],search:s=>["/api/vendors/search",s]},projects:{all:()=>["/api/projects"],list:s=>["/api/projects",s],detail:s=>["/api/projects",s],active:()=>["/api/projects/active"]},items:{all:()=>["/api/items"],list:s=>["/api/items",s],detail:s=>["/api/items",s],categories:()=>["/api/items/categories"]},admin:{users:()=>["/api/admin/users"],settings:()=>["/api/admin/settings"],positions:()=>["/api/positions"],uiTerms:()=>["/api/ui-terms"]}};function vd(){return new cd({defaultOptions:{queries:{staleTime:wt.DYNAMIC.staleTime,gcTime:wt.DYNAMIC.gcTime,refetchOnWindowFocus:!1,refetchOnMount:!0,refetchOnReconnect:!0,retry:(s,a)=>a?.status>=400&&a?.status<500&&![408,429].includes(a.status)?!1:s<3,retryDelay:s=>Math.min(1e3*2**s,3e4)},mutations:{retry:(s,a)=>a?.status>=400&&a?.status<500?!1:s<2,retryDelay:s=>Math.min(1e3*2**s,1e4)}}})}function Nt(s,a){const{cacheType:t="DYNAMIC",backgroundSync:r=!1,dependencies:l=[],...i}=a,n=wt[t],c=us();return d.useEffect(()=>{l.length>0&&l.forEach(g=>{c.prefetchQuery({queryKey:g})})},[c,l]),se({queryKey:s,...n,...i,meta:{cacheType:t,backgroundSync:r,...i.meta}})}function bd(s,a=5*60*1e3){const t=us(),r=d.useRef();return d.useEffect(()=>{const i=()=>{s.forEach(n=>{t.invalidateQueries({queryKey:n,exact:!1})})};return r.current=setInterval(i,a),()=>{r.current&&clearInterval(r.current)}},[t,s,a]),d.useCallback(()=>{s.forEach(i=>{t.invalidateQueries({queryKey:i,exact:!1})})},[t,s])}function wd(){const s=us(),a=d.useCallback((r,l)=>{const n={"/dashboard":()=>{s.prefetchQuery({queryKey:Ue.dashboard.unified()}),s.prefetchQuery({queryKey:Ue.orders.all()})},"/orders":()=>{s.prefetchQuery({queryKey:Ue.orders.list()}),s.prefetchQuery({queryKey:Ue.vendors.all()}),s.prefetchQuery({queryKey:Ue.projects.active()})},"/vendors":()=>{s.prefetchQuery({queryKey:Ue.vendors.list()})},"/projects":()=>{s.prefetchQuery({queryKey:Ue.projects.list()})}}[r];n&&n()},[s]),t=d.useCallback((r,l)=>{const n={order:c=>{s.prefetchQuery({queryKey:Ue.orders.detail(c)}),s.prefetchQuery({queryKey:Ue.orders.items(c)}),s.prefetchQuery({queryKey:Ue.orders.history(c)})},vendor:c=>{s.prefetchQuery({queryKey:Ue.vendors.detail(c)})},project:c=>{s.prefetchQuery({queryKey:Ue.projects.detail(c)})}}[r];n&&n(l)},[s]);return{prefetchRoute:a,prefetchDetail:t}}function Cd(){const s=us(),a=d.useCallback(()=>{s.prefetchQuery({queryKey:Ue.admin.positions(),staleTime:wt.STATIC.staleTime}),s.prefetchQuery({queryKey:Ue.admin.uiTerms(),staleTime:wt.STATIC.staleTime}),s.prefetchQuery({queryKey:Ue.items.categories(),staleTime:wt.MASTER.staleTime})},[s]),t=d.useCallback(r=>{s.prefetchQuery({queryKey:Ue.auth.permissions(r),staleTime:wt.MASTER.staleTime}),s.prefetchQuery({queryKey:Ue.dashboard.unified(),staleTime:wt.DYNAMIC.staleTime})},[s]);return{warmEssentialData:a,warmUserSpecificData:t}}function Sd(){const s=us();return d.useEffect(()=>s.getQueryCache().subscribe(l=>{if(l?.type==="queryAdded"){const i=l.query,n=i.meta?.cacheType||"UNKNOWN";console.log(`ðŸ”„ Query added [${n}]: ${JSON.stringify(i.queryKey)}`)}else l?.type==="queryRemoved"&&console.log(`ðŸ—‘ï¸ Query removed: ${JSON.stringify(l.query.queryKey)}`)}),[s]),{getQueryStats:d.useCallback(()=>{const r=s.getQueryCache().getAll(),l=r.reduce((n,c)=>{const g=c.meta?.cacheType||"UNKNOWN";return n[g]||(n[g]={count:0,stale:0,error:0}),n[g].count++,c.isStale()&&n[g].stale++,c.state.status==="error"&&n[g].error++,n},{});return{totalQueries:r.length,activeQueries:r.filter(n=>n.getObserversCount()>0).length,staleQueries:r.filter(n=>n.isStale()).length,errorQueries:r.filter(n=>n.state.status==="error").length,cacheSize:r.reduce((n,c)=>{try{return n+(c.state.data?JSON.stringify(c.state.data).length:0)}catch{return n}},0),cacheTypeStats:l,optimizationSuggestions:kd(r)}},[s])}}function kd(s){const a=[];s.filter(i=>i.isStale()).length/s.length>.5&&a.push("Consider increasing staleTime for frequently accessed data"),s.filter(i=>i.state.status==="error").length/s.length>.1&&a.push("High error rate detected - review retry strategies");const l=s.filter(i=>!i.meta?.cacheType).length;return l>0&&a.push(`${l} queries without cache type optimization`),a}async function _n(s){if(!s.ok){const a=await s.text()||s.statusText;throw new Error(`${s.status}: ${a}`)}}async function me(s,a,t){const r={};t&&!(t instanceof FormData)&&(r["Content-Type"]="application/json");const l=await fetch(a,{method:s,headers:r,body:t instanceof FormData?t:t?JSON.stringify(t):void 0,credentials:"include"});await _n(l);const i=await l.text();try{return i?JSON.parse(i):{}}catch{return i}}const _d=({on401:s})=>async({queryKey:a})=>{const t=await fetch(a[0],{credentials:"include"});return s==="returnNull"&&t.status===401?null:(await _n(t),await t.json())},rs=vd();rs.setDefaultOptions({queries:{queryFn:_d({on401:"throw"})}});const Dd=1,Ad=1e6;let Za=0;function Td(){return Za=(Za+1)%Number.MAX_SAFE_INTEGER,Za.toString()}const Xa=new Map,zr=s=>{if(Xa.has(s))return;const a=setTimeout(()=>{Xa.delete(s),ta({type:"REMOVE_TOAST",toastId:s})},Ad);Xa.set(s,a)},Pd=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Dd)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?zr(t):s.toasts.forEach(r=>{zr(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},ja=[];let ga={toasts:[]};function ta(s){ga=Pd(ga,s),ja.forEach(a=>{a(ga)})}function Ed({...s}){const a=Td(),t=l=>ta({type:"UPDATE_TOAST",toast:{...l,id:a}}),r=()=>ta({type:"DISMISS_TOAST",toastId:a});return ta({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:l=>{l||r()}}}),{id:a,dismiss:r,update:t}}function Ze(){const[s,a]=d.useState(ga);return d.useEffect(()=>(ja.push(a),()=>{const t=ja.indexOf(a);t>-1&&ja.splice(t,1)}),[s]),{...s,toast:Ed,dismiss:t=>ta({type:"DISMISS_TOAST",toastId:t})}}function V(...s){return ad(rd(s))}function Ee(s){if(!s||s===null)return"â‚©0";const a=typeof s=="string"?parseFloat(s.replace(/[^\d.-]/g,"")):s;return isNaN(a)?"â‚©0":new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}function Dn(s){if(!s)return 0;const a=parseFloat(s.replace(/[^\d.-]/g,""));return isNaN(a)?0:a}function Ds(s){const a=new Date(s);return isNaN(a.getTime())?"":new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(a)}const Id=$i,An=d.forwardRef(({className:s,...a},t)=>e.jsx(dl,{ref:t,className:V("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));An.displayName=dl.displayName;const Od=ea("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Tn=d.forwardRef(({className:s,variant:a,...t},r)=>e.jsx(ol,{ref:r,className:V(Od({variant:a}),s),...t}));Tn.displayName=ol.displayName;const Fd=d.forwardRef(({className:s,...a},t)=>e.jsx(xl,{ref:t,className:V("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));Fd.displayName=xl.displayName;const Pn=d.forwardRef(({className:s,...a},t)=>e.jsx(ml,{ref:t,className:V("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(ys,{className:"h-4 w-4"})}));Pn.displayName=ml.displayName;const En=d.forwardRef(({className:s,...a},t)=>e.jsx(hl,{ref:t,className:V("text-sm font-semibold",s),...a}));En.displayName=hl.displayName;const In=d.forwardRef(({className:s,...a},t)=>e.jsx(ul,{ref:t,className:V("text-sm opacity-90",s),...a}));In.displayName=ul.displayName;function Md(){const{toasts:s}=Ze();return e.jsxs(Id,{children:[s.map(function({id:a,title:t,description:r,action:l,...i}){return e.jsxs(Tn,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(En,{children:t}),r&&e.jsx(In,{children:r})]}),l,e.jsx(Pn,{})]},a)}),e.jsx(An,{})]})}const pt=Ri,Bs=Li,Qs=zi,Fs=d.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(pl,{ref:r,sideOffset:a,className:V("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...t}));Fs.displayName=pl.displayName;const On=d.createContext(null);function $d({children:s}){const a=us(),{data:t,error:r,isLoading:l}=se({queryKey:["/api/auth/user"],queryFn:async()=>{const c=await fetch("/api/auth/user",{credentials:"include"});if(!c.ok){if(c.status===401)return null;throw new Error("Failed to get user")}const g=await c.json();return console.log("ðŸ” useAuth - Fetched user data:",g),g},retry:!1,staleTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0,refetchInterval:!1}),i=Ce({mutationFn:async c=>{const g=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!g.ok){const o=await g.json();throw new Error(o.message||"Login failed")}return await g.json()},onSuccess:c=>{a.setQueryData(["/api/auth/user"],c),a.invalidateQueries({queryKey:["/api/auth/user"]})}}),n=Ce({mutationFn:async()=>{if(!(await fetch("/api/auth/logout",{method:"POST",credentials:"include"})).ok)throw new Error("Logout failed")},onSuccess:()=>{a.setQueryData(["/api/auth/user"],null),a.clear()},onError:()=>{a.setQueryData(["/api/auth/user"],null),a.clear()}});return e.jsx(On.Provider,{value:{user:t??null,isLoading:l,isAuthenticated:!!t,error:r,loginMutation:i,logoutMutation:n},children:s})}function os(){const s=d.useContext(On);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}const ca=ea("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-500",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-red-600 dark:text-white dark:hover:bg-red-500",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground dark:border-slate-600 dark:bg-slate-800/50 dark:text-slate-100 dark:hover:bg-slate-700 dark:hover:text-slate-50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600",ghost:"hover:bg-accent hover:text-accent-foreground dark:text-slate-200 dark:hover:bg-slate-700 dark:hover:text-slate-50",link:"text-primary underline-offset-4 hover:underline dark:text-blue-400 dark:hover:text-blue-300"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),b=d.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...l},i)=>{const n=r?jl:"button";return e.jsx(n,{className:V(ca({variant:a,size:t,className:s})),ref:i,...l})});b.displayName="Button";const U=d.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:V("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm transition-colors hover:border-ring/50 dark:bg-slate-950 dark:border-slate-600 dark:text-white dark:placeholder:text-slate-400 dark:hover:border-blue-400/60 dark:focus-visible:border-blue-400 dark:focus-visible:ring-blue-400/20 dark:focus-visible:ring-offset-slate-950",s),ref:r,...t}));U.displayName="Input";const L=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800/50 dark:border-slate-700 dark:shadow-lg",s),...a}));L.displayName="Card";const H=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("flex flex-col space-y-1.5 p-6",s),...a}));H.displayName="CardHeader";const W=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("text-2xl font-semibold leading-none tracking-tight",s),...a}));W.displayName="CardTitle";const jt=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("text-sm text-muted-foreground dark:text-slate-400",s),...a}));jt.displayName="CardDescription";const q=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("p-6 pt-0",s),...a}));q.displayName="CardContent";const Rd=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("flex items-center p-6 pt-0",s),...a}));Rd.displayName="CardFooter";const Ld=ea("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-white"),P=d.forwardRef(({className:s,...a},t)=>e.jsx(gl,{ref:t,className:V(Ld(),s),...a}));P.displayName=gl.displayName;const jr=Vi,Fn=d.createContext({}),Oe=({...s})=>e.jsx(Fn.Provider,{value:{name:s.name},children:e.jsx(Ki,{...s})}),Ta=()=>{const s=d.useContext(Fn),a=d.useContext(Mn),{getFieldState:t,formState:r}=qi(),l=t(s.name,r);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:i}=a;return{id:i,name:s.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...l}},Mn=d.createContext({}),De=d.forwardRef(({className:s,...a},t)=>{const r=d.useId();return e.jsx(Mn.Provider,{value:{id:r},children:e.jsx("div",{ref:t,className:V("space-y-2",s),...a})})});De.displayName="FormItem";const Ae=d.forwardRef(({className:s,...a},t)=>{const{error:r,formItemId:l}=Ta();return e.jsx(P,{ref:t,className:V(r&&"text-destructive",s),htmlFor:l,...a})});Ae.displayName="FormLabel";const Te=d.forwardRef(({...s},a)=>{const{error:t,formItemId:r,formDescriptionId:l,formMessageId:i}=Ta();return e.jsx(jl,{ref:a,id:r,"aria-describedby":t?`${l} ${i}`:`${l}`,"aria-invalid":!!t,...s})});Te.displayName="FormControl";const zd=d.forwardRef(({className:s,...a},t)=>{const{formDescriptionId:r}=Ta();return e.jsx("p",{ref:t,id:r,className:V("text-sm text-muted-foreground",s),...a})});zd.displayName="FormDescription";const Pe=d.forwardRef(({className:s,children:a,...t},r)=>{const{error:l,formMessageId:i}=Ta(),n=l?String(l?.message??""):a;return n?e.jsx("p",{ref:r,id:i,className:V("text-sm font-medium text-destructive",s),...t,children:n}):null});Pe.displayName="FormMessage";const qd=d.createContext(void 0);function qr({children:s}){const[a,t]=d.useState(!1);d.useEffect(()=>{localStorage.removeItem("sidebar-collapsed")},[]);const r=()=>{};return e.jsx(qd.Provider,{value:{isCollapsed:!1,setIsCollapsed:t,toggleSidebar:r},children:s})}const $n=Bi,Rn=Qi,Vd=d.forwardRef(({className:s,inset:a,children:t,...r},l)=>e.jsxs(fl,{ref:l,className:V("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",s),...r,children:[t,e.jsx(mt,{className:"ml-auto"})]}));Vd.displayName=fl.displayName;const Kd=d.forwardRef(({className:s,...a},t)=>e.jsx(Nl,{ref:t,className:V("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...a}));Kd.displayName=Nl.displayName;const gr=d.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(Ui,{children:e.jsx(yl,{ref:r,sideOffset:a,className:V("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...t})}));gr.displayName=yl.displayName;const Et=d.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(vl,{ref:r,className:V("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",s),...t}));Et.displayName=vl.displayName;const Ud=d.forwardRef(({className:s,children:a,checked:t,...r},l)=>e.jsxs(bl,{ref:l,className:V("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(wl,{children:e.jsx(ps,{className:"h-4 w-4"})})}),a]}));Ud.displayName=bl.displayName;const Bd=d.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Cl,{ref:r,className:V("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(wl,{children:e.jsx(Sl,{className:"h-2 w-2 fill-current"})})}),a]}));Bd.displayName=Cl.displayName;const wa=d.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(kl,{ref:r,className:V("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));wa.displayName=kl.displayName;const It=d.forwardRef(({className:s,...a},t)=>e.jsx(_l,{ref:t,className:V("-mx-1 my-1 h-px bg-muted",s),...a}));It.displayName=_l.displayName;const Ln=d.createContext(null);function zn({children:s}){const[a,t]=d.useState(!1),[r,l]=d.useState("normal");d.useEffect(()=>{const n=localStorage.getItem("high-contrast"),c=localStorage.getItem("contrast-level");n==="true"&&t(!0),c?l(c):window.matchMedia("(prefers-contrast: high)").matches&&(t(!0),l("high"))},[]),d.useEffect(()=>{const n=document.documentElement;a?(n.classList.add("high-contrast"),n.classList.add(`contrast-${r}`)):(n.classList.remove("high-contrast"),n.classList.remove("contrast-normal","contrast-high","contrast-maximum")),localStorage.setItem("high-contrast",a.toString()),localStorage.setItem("contrast-level",r)},[a,r]);const i=()=>{t(!a),!a&&r==="normal"&&l("high")};return e.jsx(Ln.Provider,{value:{isHighContrast:a,toggleHighContrast:i,contrastLevel:r,setContrastLevel:l},children:s})}function fr(){const s=d.useContext(Ln);if(!s)throw new Error("useContrast must be used within ContrastProvider");return s}function Qd({variant:s="full",className:a}){const{isHighContrast:t,toggleHighContrast:r,contrastLevel:l,setContrastLevel:i}=fr();return s==="icon"?e.jsx("button",{onClick:r,className:V("p-2 rounded-md transition-colors","focus:outline-none focus:ring-2 focus:ring-primary-500",t?"bg-gray-900 text-white hover:bg-gray-800":"bg-gray-100 text-gray-700 hover:bg-gray-200",a),"aria-label":t?"ê³ ëŒ€ë¹„ ëª¨ë“œ ë„ê¸°":"ê³ ëŒ€ë¹„ ëª¨ë“œ ì¼œê¸°",title:t?"ê³ ëŒ€ë¹„ ëª¨ë“œ ë„ê¸°":"ê³ ëŒ€ë¹„ ëª¨ë“œ ì¼œê¸°",children:e.jsx(Hd,{className:"h-5 w-5"})}):s==="text"?e.jsx("button",{onClick:r,className:V("text-sm underline transition-colors","focus:outline-none focus:ring-2 focus:ring-primary-500 rounded",t?"text-white":"text-gray-600 hover:text-gray-900",a),children:t?"ê³ ëŒ€ë¹„ ëª¨ë“œ ë„ê¸°":"ê³ ëŒ€ë¹„ ëª¨ë“œ ì¼œê¸°"}):e.jsxs("div",{className:V("space-y-2",a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ê³ ëŒ€ë¹„ ëª¨ë“œ"}),e.jsx("button",{onClick:r,className:V("relative inline-flex h-6 w-11 items-center rounded-full transition-colors","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",t?"bg-primary-600":"bg-gray-200"),role:"switch","aria-checked":t,"aria-labelledby":"contrast-label",children:e.jsx("span",{className:V("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",t?"translate-x-6":"translate-x-1")})})]}),t&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"ëŒ€ë¹„ ìˆ˜ì¤€"}),e.jsx("div",{className:"flex gap-2",children:["normal","high","maximum"].map(n=>e.jsxs("button",{onClick:()=>i(n),className:V("px-3 py-1 text-xs rounded border transition-colors","focus:outline-none focus:ring-2 focus:ring-primary-500",l===n?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:[n==="normal"&&"ë³´í†µ",n==="high"&&"ë†’ìŒ",n==="maximum"&&"ìµœëŒ€"]},n))})]})]})}function Hd({className:s}){return e.jsxs("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v8"})]})}function Wd({children:s,enabled:a=!0,restoreFocus:t=!0,className:r}){const l=d.useRef(null),i=d.useRef(null);return d.useEffect(()=>{if(!a)return;i.current=document.activeElement;const n=l.current;if(!n)return;const c=Vr(n);c.length>0&&c[0].focus();const g=o=>{if(o.key!=="Tab")return;const w=Vr(n);if(w.length===0)return;const p=w[0],m=w[w.length-1];o.shiftKey?document.activeElement===p&&(o.preventDefault(),m.focus()):document.activeElement===m&&(o.preventDefault(),p.focus())};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g),t&&i.current&&i.current.focus()}},[a,t]),e.jsx("div",{ref:l,className:r,children:s})}const qn=V("focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2","focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900");function Gd(){return e.jsx("a",{href:"#main-content",className:V("sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 z-50","bg-primary-600 text-white px-4 py-2 rounded-md text-sm font-medium",qn),children:"ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°"})}const Jd=d.createContext(null);function Vn({children:s}){const a=d.useRef(null),t=r=>{a.current&&(a.current.textContent=r,setTimeout(()=>{a.current&&(a.current.textContent="")},1e3))};return e.jsxs(Jd.Provider,{value:{announceFocus:t},children:[s,e.jsx("div",{ref:a,className:"sr-only","aria-live":"polite","aria-atomic":"true"})]})}function Vr(s){const a=["button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","a[href]",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(", ");return Array.from(s.querySelectorAll(a))}function Kn(s){d.useEffect(()=>{const a=t=>{const r=t.target;r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.contentEditable==="true"||s.forEach(l=>{const i=t.key.toLowerCase()===l.key.toLowerCase(),n=!!l.ctrlKey===t.ctrlKey,c=!!l.altKey===t.altKey,g=!!l.shiftKey===t.shiftKey,o=!!l.metaKey===t.metaKey;i&&n&&c&&g&&o&&(t.preventDefault(),l.action(t))})};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[s])}function Yd({children:s,onNavigate:a,onSelect:t,onEscape:r,className:l}){const i=n=>{switch(n.key){case"ArrowUp":n.preventDefault(),a?.("up");break;case"ArrowDown":n.preventDefault(),a?.("down");break;case"ArrowLeft":n.preventDefault(),a?.("left");break;case"ArrowRight":n.preventDefault(),a?.("right");break;case"Enter":case" ":n.preventDefault(),t?.();break;case"Escape":n.preventDefault(),r?.();break}};return e.jsx("div",{className:V("focus:outline-none",l),onKeyDown:i,tabIndex:0,children:s})}function Zd({tabs:s,activeTab:a,onTabChange:t,className:r}){const l=Re.useRef([]);s.findIndex(n=>n.id===a);const i=(n,c)=>{switch(n.key){case"ArrowLeft":n.preventDefault();const g=c===0?s.length-1:c-1,o=s[g];o.disabled||(t(o.id),l.current[g]?.focus());break;case"ArrowRight":n.preventDefault();const w=(c+1)%s.length,p=s[w];p.disabled||(t(p.id),l.current[w]?.focus());break;case"Home":n.preventDefault();const m=s[0];m.disabled||(t(m.id),l.current[0]?.focus());break;case"End":n.preventDefault();const f=s.length-1,T=s[f];T.disabled||(t(T.id),l.current[f]?.focus());break}};return e.jsxs("div",{className:V("space-y-4",r),children:[e.jsx("div",{role:"tablist",className:"flex border-b border-gray-200",children:s.map((n,c)=>e.jsx("button",{ref:g=>l.current[c]=g,role:"tab","aria-selected":n.id===a,"aria-controls":`panel-${n.id}`,tabIndex:n.id===a?0:-1,disabled:n.disabled,className:V("px-4 py-2 text-sm font-medium border-b-2 transition-colors","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",n.id===a?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>!n.disabled&&t(n.id),onKeyDown:g=>i(g,c),children:n.label},n.id))}),s.map(n=>e.jsx("div",{role:"tabpanel",id:`panel-${n.id}`,"aria-labelledby":`tab-${n.id}`,hidden:n.id!==a,className:"focus:outline-none",tabIndex:0,children:n.content},n.id))]})}function Xd({shortcuts:s,isOpen:a,onClose:t}){return a?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤"}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.map((r,l)=>e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:r.description}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:[r.ctrlKey&&"Ctrl",r.altKey&&"Alt",r.shiftKey&&"Shift",r.metaKey&&"Cmd",r.key].filter(Boolean).join(" + ")})]},l))}),e.jsx("button",{onClick:t,className:"mt-4 w-full bg-primary-600 text-white py-2 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",children:"ë‹«ê¸°"})]})}):null}const eo={theme:"system",setTheme:()=>null,actualTheme:"light"},Un=Re.createContext(eo);function Bn({children:s,defaultTheme:a="system",storageKey:t="po-management-theme",enableSystem:r=!0,...l}){const[i,n]=Re.useState(()=>localStorage.getItem(t)||a),[c,g]=Re.useState("light");Re.useEffect(()=>{const w=window.document.documentElement;w.classList.remove("light","dark");let p;i==="system"&&r?p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":p=i,w.classList.add(p),g(p)},[i,r]),Re.useEffect(()=>{if(i!=="system"||!r)return;const w=window.matchMedia("(prefers-color-scheme: dark)"),p=()=>{const m=w.matches?"dark":"light",f=window.document.documentElement;f.classList.remove("light","dark"),f.classList.add(m),g(m)};return w.addEventListener("change",p),()=>w.removeEventListener("change",p)},[i,r]);const o=Re.useMemo(()=>({theme:i,setTheme:w=>{localStorage.setItem(t,w),n(w)},actualTheme:c}),[i,c,t]);return e.jsx(Un.Provider,{...l,value:o,children:s})}const Pa=()=>{const s=Re.useContext(Un);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s};function Qn({className:s,size:a="md",variant:t="button",showLabel:r=!1}){const{theme:l,setTheme:i,actualTheme:n}=Pa(),c={sm:"h-8 w-8 text-xs",md:"h-9 w-9 text-sm",lg:"h-10 w-10 text-base"};return t==="switch"?e.jsxs("div",{className:V("flex items-center space-x-2",s),children:[r&&e.jsx("span",{className:"text-sm font-medium",children:n==="dark"?"ë‹¤í¬ ëª¨ë“œ":"ë¼ì´íŠ¸ ëª¨ë“œ"}),e.jsx("button",{onClick:()=>i(n==="dark"?"light":"dark"),className:V("relative inline-flex items-center rounded-full transition-colors","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",n==="dark"?"bg-blue-600":"bg-gray-200",c[a]),"aria-label":`${n==="dark"?"ë¼ì´íŠ¸":"ë‹¤í¬"} ëª¨ë“œë¡œ ì „í™˜`,children:e.jsx("span",{className:V("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",n==="dark"?"translate-x-4":"translate-x-0")})})]}):t==="dropdown"?e.jsxs("div",{className:V("relative",s),children:[e.jsxs("select",{value:l,onChange:g=>i(g.target.value),className:V("appearance-none bg-background border border-input rounded-md px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",c[a]),children:[e.jsx("option",{value:"light",children:"ë¼ì´íŠ¸ ëª¨ë“œ"}),e.jsx("option",{value:"dark",children:"ë‹¤í¬ ëª¨ë“œ"}),e.jsx("option",{value:"system",children:"ì‹œìŠ¤í…œ ì„¤ì •"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}):e.jsxs("button",{onClick:()=>i(n==="dark"?"light":"dark"),className:V("inline-flex items-center justify-center rounded-md border border-input bg-background","hover:bg-accent hover:text-accent-foreground transition-colors","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",c[a],s),"aria-label":`${n==="dark"?"ë¼ì´íŠ¸":"ë‹¤í¬"} ëª¨ë“œë¡œ ì „í™˜`,children:[n==="dark"?e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),r&&e.jsx("span",{className:"ml-2 text-sm",children:n==="dark"?"ë¼ì´íŠ¸":"ë‹¤í¬"})]})}function Hn({className:s}){const{theme:a,setTheme:t,actualTheme:r}=Pa(),l=[{value:"light",label:"ë¼ì´íŠ¸ ëª¨ë“œ",description:"ë°ì€ í…Œë§ˆ",icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})},{value:"dark",label:"ë‹¤í¬ ëª¨ë“œ",description:"ì–´ë‘ìš´ í…Œë§ˆ",icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})},{value:"system",label:"ì‹œìŠ¤í…œ ì„¤ì •",description:"ì‹œìŠ¤í…œ ì„¤ì •ì„ ë”°ë¦„",icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}];return e.jsxs("div",{className:V("space-y-2",s),children:[e.jsx("h3",{className:"text-sm font-medium",children:"í…Œë§ˆ ì„¤ì •"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:l.map(i=>e.jsxs("button",{onClick:()=>t(i.value),className:V("flex items-center space-x-3 p-3 rounded-lg border text-left transition-colors","hover:bg-accent hover:text-accent-foreground","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",a===i.value?"border-primary bg-primary/10 text-primary":"border-input"),children:[e.jsx("div",{className:V("flex items-center justify-center w-8 h-8 rounded-full",a===i.value?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:i.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:i.label}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.description,i.value==="system"&&` (í˜„ìž¬: ${r==="dark"?"ë‹¤í¬":"ë¼ì´íŠ¸"})`]})]}),a===i.value&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary"})]},i.value))})]})}function so({className:s}){const{theme:a,actualTheme:t}=Pa();return e.jsxs("div",{className:V("flex items-center space-x-2 text-xs text-muted-foreground",s),children:[e.jsx("div",{className:V("w-2 h-2 rounded-full",t==="dark"?"bg-slate-400":"bg-yellow-400")}),e.jsx("span",{children:a==="system"?`ì‹œìŠ¤í…œ (${t==="dark"?"ë‹¤í¬":"ë¼ì´íŠ¸"})`:a==="dark"?"ë‹¤í¬ ëª¨ë“œ":"ë¼ì´íŠ¸ ëª¨ë“œ"})]})}const to=Object.freeze(Object.defineProperty({__proto__:null,ThemeProvider:Bn,ThemeSelector:Hn,ThemeStatus:so,ThemeToggle:Qn,useTheme:Pa},Symbol.toStringTag,{value:"Module"})),Wn=Re.createContext(null);function Gn({children:s}){const[a,t]=d.useState("normal"),[r,l]=d.useState(16),i={small:14,normal:16,large:18,"extra-large":24};Re.useEffect(()=>{const g=localStorage.getItem("text-size");g&&i[g]&&(t(g),l(i[g]))},[]),Re.useEffect(()=>{l(i[a]),document.documentElement.style.fontSize=`${i[a]}px`,document.documentElement.className=document.documentElement.className.replace(/text-size-\w+/g,"")+` text-size-${a}`,localStorage.setItem("text-size",a)},[a]);const n=()=>{const g=["small","normal","large","extra-large"],o=g.indexOf(a);o<g.length-1&&t(g[o+1])},c=()=>{const g=["small","normal","large","extra-large"],o=g.indexOf(a);o>0&&t(g[o-1])};return e.jsx(Wn.Provider,{value:{textSize:a,setTextSize:t,fontSize:r,increaseFontSize:n,decreaseFontSize:c},children:s})}function Ca(){const s=Re.useContext(Wn);if(!s)throw new Error("useTextSize must be used within TextSizeProvider");return s}const Jn=Re.createContext(null);function Yn({children:s}){const[a,t]=d.useState(!1);Re.useEffect(()=>{const l=window.matchMedia("(prefers-reduced-motion: reduce)");t(l.matches);const i=localStorage.getItem("reduced-motion");i!==null&&t(i==="true");const n=c=>{localStorage.getItem("reduced-motion")===null&&t(c.matches)};return l.addEventListener("change",n),()=>l.removeEventListener("change",n)},[]),Re.useEffect(()=>{a?document.documentElement.classList.add("reduce-motion"):document.documentElement.classList.remove("reduce-motion"),localStorage.setItem("reduced-motion",a.toString())},[a]);const r=()=>{t(!a)};return e.jsx(Jn.Provider,{value:{prefersReducedMotion:a,toggleReducedMotion:r},children:s})}function Nr(){const s=Re.useContext(Jn);if(!s)throw new Error("useMotion must be used within MotionProvider");return s}function yr({className:s,position:a="top"}){const[t,r]=d.useState(!1),[l,i]=d.useState(!1),{textSize:n,increaseFontSize:c,decreaseFontSize:g}=Ca(),{isHighContrast:o,toggleHighContrast:w}=fr(),{prefersReducedMotion:p,toggleReducedMotion:m}=Nr(),f=[{key:"h",altKey:!0,action:()=>w(),description:"ê³ ëŒ€ë¹„ ëª¨ë“œ í† ê¸€"},{key:"+",ctrlKey:!0,action:()=>c(),description:"ê¸€ìž í¬ê¸° í™•ëŒ€"},{key:"-",ctrlKey:!0,action:()=>g(),description:"ê¸€ìž í¬ê¸° ì¶•ì†Œ"},{key:"?",altKey:!0,action:()=>r(!0),description:"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë³´ê¸°"}];Kn(f);const T={top:"top-0",bottom:"bottom-0",fixed:"fixed top-4 right-4"};return e.jsxs(e.Fragment,{children:[e.jsx(Gd,{}),e.jsx("div",{className:V("bg-background border-b border-border px-4 py-2 z-40",a==="fixed"&&"fixed top-4 right-4 border rounded-lg shadow-lg",a!=="fixed"&&T[a],s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground hidden sm:inline",children:"ì ‘ê·¼ì„± ë„êµ¬"}),l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:g,disabled:n==="small",className:"h-8 w-8 p-0","aria-label":"ê¸€ìž í¬ê¸° ì¶•ì†Œ",children:e.jsx(ka,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-xs text-muted-foreground min-w-[60px] text-center",children:[n==="small"&&"ìž‘ê²Œ",n==="normal"&&"ë³´í†µ",n==="large"&&"í¬ê²Œ",n==="extra-large"&&"ë§¤ìš° í¬ê²Œ"]}),e.jsx(b,{variant:"ghost",size:"sm",onClick:c,disabled:n==="extra-large",className:"h-8 w-8 p-0","aria-label":"ê¸€ìž í¬ê¸° í™•ëŒ€",children:e.jsx(_a,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300"}),e.jsx(Qd,{variant:"icon"}),e.jsx("div",{className:"w-px h-6 bg-gray-300"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:m,className:V("h-8 w-8 p-0",p&&"bg-primary-100 text-primary-700"),"aria-label":p?"ì• ë‹ˆë©”ì´ì…˜ ì¼œê¸°":"ì• ë‹ˆë©”ì´ì…˜ ë„ê¸°",title:p?"ì• ë‹ˆë©”ì´ì…˜ ì¼œê¸°":"ì• ë‹ˆë©”ì´ì…˜ ë„ê¸°",children:p?e.jsx(Dl,{className:"h-4 w-4"}):e.jsx(ls,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-6 bg-gray-300"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>r(!0),className:"h-8 w-8 p-0","aria-label":"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë³´ê¸°",title:"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë³´ê¸°",children:e.jsx(Na,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>i(!l),className:"h-8 w-8 p-0","aria-label":l?"ì ‘ê·¼ì„± ë„êµ¬ ìˆ¨ê¸°ê¸°":"ì ‘ê·¼ì„± ë„êµ¬ ë³´ê¸°",title:l?"ì ‘ê·¼ì„± ë„êµ¬ ìˆ¨ê¸°ê¸°":"ì ‘ê·¼ì„± ë„êµ¬ ë³´ê¸°",children:e.jsx(Hi,{className:"h-4 w-4"})}),e.jsxs($n,{children:[e.jsx(Rn,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0","aria-label":"ì ‘ê·¼ì„± ì„¤ì •",children:e.jsx(Hs,{className:"h-4 w-4"})})}),e.jsxs(gr,{align:"end",className:"w-56",children:[e.jsx(wa,{children:"ì ‘ê·¼ì„± ì„¤ì •"}),e.jsx(It,{}),e.jsxs(Et,{onClick:()=>r(!0),children:[e.jsx(Na,{className:"mr-2 h-4 w-4"}),"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤"]}),e.jsxs(Et,{onClick:w,children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),o?"ê³ ëŒ€ë¹„ ëª¨ë“œ ë„ê¸°":"ê³ ëŒ€ë¹„ ëª¨ë“œ ì¼œê¸°"]}),e.jsxs(Et,{onClick:m,children:[p?e.jsx(Wi,{className:"mr-2 h-4 w-4"}):e.jsx(Gi,{className:"mr-2 h-4 w-4"}),p?"ì• ë‹ˆë©”ì´ì…˜ ì¼œê¸°":"ì• ë‹ˆë©”ì´ì…˜ ë„ê¸°"]}),e.jsx(It,{}),e.jsx("div",{className:"px-2 py-2",children:e.jsx(Hn,{})}),e.jsx(It,{}),e.jsx(wa,{children:"ê¸€ìž í¬ê¸°"}),["small","normal","large","extra-large"].map(O=>e.jsxs(Et,{onClick:()=>Ca().setTextSize(O),className:n===O?"bg-primary-50":"",children:[e.jsx(Ji,{className:"mr-2 h-4 w-4"}),O==="small"&&"ìž‘ê²Œ",O==="normal"&&"ë³´í†µ",O==="large"&&"í¬ê²Œ",O==="extra-large"&&"ë§¤ìš° í¬ê²Œ"]},O))]})]})]})]})}),e.jsx(Xd,{shortcuts:f,isOpen:t,onClose:()=>r(!1)})]})}function vr({children:s}){return e.jsx(Gn,{children:e.jsx(Yn,{children:s})})}const ao=Object.freeze(Object.defineProperty({__proto__:null,AccessibilityProvider:vr,AccessibilityToolbar:yr,MotionProvider:Yn,TextSizeProvider:Gn,useMotion:Nr,useTextSize:Ca},Symbol.toStringTag,{value:"Module"}));function ro(s,a){const[t,r]=d.useState(s);return d.useEffect(()=>{const l=setTimeout(()=>{r(s)},a);return()=>{clearTimeout(l)}},[s,a]),t}function lo(s,a){const t=d.useRef(Date.now());return d.useCallback((...r)=>{Date.now()-t.current>=a&&(s(...r),t.current=Date.now())},[s,a])}function no(s,a){return d.useCallback(s,a)}function io(s){const a=d.useRef();return d.useEffect(()=>{a.current=s}),a.current}function co(s,a){const t=d.useRef();return(!t.current||!ti(t.current.deps,a))&&(t.current={deps:a,value:s()}),t.current.value}function Zn(){const s=d.useRef(!1),a=d.useCallback(()=>s.current,[]);return d.useEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),a}function oo(){const[s,a]=d.useState(!1),[t,r]=d.useState(null),l=Zn();return{execute:d.useCallback(async n=>{if(l()){a(!0),r(null);try{const c=await n();return l()&&a(!1),c}catch(c){l()&&(r(c instanceof Error?c:new Error("Unknown error")),a(!1));return}}},[l]),loading:s,error:t}}function xo(s){const[a]=d.useState(s);return a}function mo(){const[,s]=d.useState(0);return d.useCallback(()=>{s(t=>t+1)},[])}function Xn(s,a){const[t,r]=d.useState(!1);return d.useEffect(()=>{if(!s.current)return;const l=new IntersectionObserver(([i])=>{r(i.isIntersecting)},a);return l.observe(s.current),()=>{l.disconnect()}},[s,a]),t}function br(){const[s,a]=d.useState({width:typeof window<"u"?window.innerWidth:0,height:typeof window<"u"?window.innerHeight:0});return d.useEffect(()=>{function t(){a({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),s}function ho(s,a){const[t,r]=d.useState(()=>{if(typeof window>"u")return a;try{const i=window.localStorage.getItem(s);return i?JSON.parse(i):a}catch(i){return console.error(`Error reading localStorage key "${s}":`,i),a}}),l=d.useCallback(i=>{try{const n=i instanceof Function?i(t):i;r(n),typeof window<"u"&&window.localStorage.setItem(s,JSON.stringify(n))}catch(n){console.error(`Error setting localStorage key "${s}":`,n)}},[s,t]);return[t,l]}function Ea(s){const a=d.useRef(),t=d.useRef(0);return d.useEffect(()=>(a.current=performance.now(),t.current+=1,()=>{if(a.current){const l=performance.now()-a.current;l>16&&console.warn(`Slow render detected in ${s}: ${l.toFixed(2)}ms`),t.current>10&&console.warn(`Excessive re-renders in ${s}: ${t.current} renders`)}})),{renderCount:t.current}}function uo(){const[s,a]=d.useState({});return d.useEffect(()=>{const t=()=>{if("memory"in performance){const l=performance.memory;a({usedJSMemory:l.usedJSHeapSize,totalJSMemory:l.totalJSHeapSize,memoryLimit:l.jsHeapSizeLimit})}};t();const r=setInterval(t,5e3);return()=>clearInterval(r)},[]),s}function ei(){const[s,a]=d.useState({});return d.useEffect(()=>{const t=new PerformanceObserver(r=>{r.getEntries().forEach(i=>{i.entryType==="paint"&&i.name==="first-contentful-paint"&&a(n=>({...n,fcp:i.startTime})),i.entryType==="largest-contentful-paint"&&a(n=>({...n,lcp:i.startTime}))})});return t.observe({entryTypes:["paint","largest-contentful-paint"]}),()=>t.disconnect()},[]),s}function po(s){const[a,t]=d.useState({width:0,height:0});return d.useEffect(()=>{if(!s.current)return;const r=new ResizeObserver(l=>{for(const i of l){const{width:n,height:c}=i.contentRect;t({width:n,height:c})}});return r.observe(s.current),()=>r.disconnect()},[s]),a}function si(){d.useEffect(()=>{},[])}function ti(s,a){if(s===a)return!0;if(s===null||a===null||typeof s!=typeof a||typeof s!="object")return!1;const t=Object.keys(s),r=Object.keys(a);if(t.length!==r.length)return!1;for(let l of t)if(!r.includes(l)||!ti(s[l],a[l]))return!1;return!0}const jo=Object.freeze(Object.defineProperty({__proto__:null,useAsyncOperation:oo,useBundleAnalytics:si,useComponentSize:po,useDebounce:ro,useDeepMemo:co,useForceUpdate:mo,useIntersectionObserver:Xn,useLazyInit:xo,useLocalStorage:ho,useMemoryMonitor:uo,useMountedState:Zn,usePageLoadMetrics:ei,usePerformanceMonitor:Ea,usePrevious:io,useStableCallback:no,useThrottle:lo,useWindowSize:br},Symbol.toStringTag,{value:"Module"}));function rt({className:s,width:a,height:t,variant:r="rectangular",animate:l=!0,...i}){const n={rectangular:"rounded-none",circular:"rounded-full",text:"rounded-sm",rounded:"rounded-md"},c={};return a&&(c.width=typeof a=="number"?`${a}px`:a),t&&(c.height=typeof t=="number"?`${t}px`:t),e.jsx("div",{className:V("bg-muted",l&&"animate-pulse",n[r],s),style:c,...i})}function Kr({height:s=300}){return e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(rt,{className:"h-6 w-32"}),e.jsx(rt,{className:"h-4 w-20"})]}),e.jsx("div",{className:"flex items-end justify-between space-x-2",style:{height:`${s}px`},children:Array.from({length:7}).map((a,t)=>e.jsxs("div",{className:"flex flex-col justify-end space-y-1 flex-1",children:[e.jsx(rt,{className:"w-full bg-gradient-to-t from-primary/20 to-primary/5",style:{height:`${Math.random()*80+20}%`}}),e.jsx(rt,{className:"h-3 w-8 mx-auto"})]},t))})]})}function go(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(rt,{className:"h-8 w-32"}),e.jsx(rt,{className:"h-4 w-48"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4",children:Array.from({length:4}).map((s,a)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[e.jsx(rt,{className:"h-4 w-20"}),e.jsx(rt,{className:"h-8 w-16"}),e.jsx(rt,{className:"h-3 w-24"})]},a))}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(Kr,{height:300}),e.jsx(Kr,{height:300})]})]})}function fo({items:s,itemHeight:a,containerHeight:t,renderItem:r,className:l=""}){const[i,n]=d.useState(0),c=Math.floor(i/a),g=Math.min(c+Math.ceil(t/a)+1,s.length),o=s.slice(c,g),w=s.length*a,p=c*a;return e.jsx("div",{className:`overflow-auto ${l}`,style:{height:t},onScroll:m=>n(m.currentTarget.scrollTop),children:e.jsx("div",{style:{height:w,position:"relative"},children:e.jsx("div",{style:{transform:`translateY(${p}px)`,position:"absolute",top:0,left:0,right:0},children:o.map((m,f)=>e.jsx("div",{style:{height:a},className:"flex items-center",children:r(m,c+f)},c+f))})})})}function No(){return Nt(Ue.auth.user(),{queryFn:()=>me("GET","/api/auth/me"),cacheType:"MASTER",backgroundSync:!0})}function yo(s){return Nt(Ue.auth.permissions(s),{queryFn:()=>me("GET",`/api/auth/permissions/${s}`),cacheType:"MASTER",enabled:!!s})}function Xu(){return Nt(Ue.dashboard.unified(),{queryFn:()=>me("GET","/api/dashboard/unified"),cacheType:"DYNAMIC",backgroundSync:!0})}function vo(){return Nt(Ue.items.categories(),{queryFn:()=>me("GET","/api/items/categories"),cacheType:"STATIC"})}function bo(){return Nt(Ue.admin.positions(),{queryFn:()=>me("GET","/api/positions"),cacheType:"STATIC"})}function wo(){return Nt(Ue.admin.uiTerms(),{queryFn:()=>me("GET","/api/ui-terms"),cacheType:"STATIC"})}function Co(){const{prefetchRoute:s,prefetchDetail:a}=wd(),t=bd([Ue.dashboard.unified(),Ue.orders.all(),Ue.vendors.all(),Ue.projects.active()]),r=d.useCallback((i,n)=>{s(i,n)},[s]),l=d.useCallback((i,n)=>{a(i,n)},[a]);return{syncNow:t,prefetchForRoute:r,prefetchDetails:l}}function So(){const{data:s}=No();bo(),wo(),vo();const{data:a}=yo(s?.id);return{user:s,permissions:a,isInitialized:!!s&&!!a}}function ko({position:s="bottom-right",initialOpen:a=!1}){const[t,r]=d.useState(a);d.useState(!1);const[l,i]=d.useState(null),[n,c]=d.useState([]),g=us(),{getQueryStats:o}=Sd();return d.useEffect(()=>{if(!t)return;const w=()=>{const m=o();i(m);const T=g.getQueryCache().getAll().map(O=>({queryKey:O.queryKey,state:O.state.status,isStale:O.isStale(),observers:O.getObserversCount(),dataSize:O.state.data?JSON.stringify(O.state.data).length:0,lastUpdated:O.state.dataUpdatedAt,fetchStatus:O.state.fetchStatus,errorCount:O.state.failureCount||0}));c(T)};w();const p=setInterval(w,1e3);return()=>clearInterval(p)},[t,g,o]),null}function _o(){const[s,a]=d.useState(!1);return d.useEffect(()=>{const t=r=>{(r.ctrlKey||r.metaKey)&&r.shiftKey&&r.key==="Q"&&a(l=>!l)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]),s}function Do(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(L,{className:"w-full max-w-md mx-4",children:e.jsxs(q,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(Be,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function Fe(s,a="Component",t=3){return d.lazy(async()=>{let r;for(let l=0;l<t;l++)try{return await s()}catch(i){r=i,l<t-1&&await new Promise(n=>setTimeout(n,Math.pow(2,l)*1e3))}throw console.error(`âŒ Failed to load ${a} after ${t} attempts:`,r),r})}function oa(s,a="Component"){return d.lazy(async()=>{const t=navigator.connection,r=t&&(t.effectiveType==="slow-2g"||t.effectiveType==="2g"||t.saveData);try{return await s()}catch(l){throw console.error(`âŒ Failed to load ${a}:`,l),l}})}class Ao{constructor(){this.preloadQueue=[],this.preloadedComponents=new Set}add(a,t){this.preloadedComponents.has(a)||this.preloadQueue.push({name:a,importFn:t})}async preloadAll(){const a=this.preloadQueue.map(async({name:t,importFn:r})=>{try{await r(),this.preloadedComponents.add(t)}catch{}});await Promise.allSettled(a),this.preloadQueue=[]}async preloadOnIdle(){return"requestIdleCallback"in window?new Promise(a=>{requestIdleCallback(()=>{this.preloadAll().then(a)})}):new Promise(a=>{setTimeout(()=>{this.preloadAll().then(a)},100)})}}const xs={loadDashboard:()=>he(()=>import("./chunk-Cr5d6gIV.js").then(s=>s.b),__vite__mapDeps([0,1,2,3,4,5])),loadDashboardCharts:()=>he(()=>import("./chunk-Cr5d6gIV.js").then(s=>s.a),__vite__mapDeps([0,1,2,3,4,5])),loadDashboardWidgets:()=>he(()=>import("./chunk-Cr5d6gIV.js").then(s=>s.d),__vite__mapDeps([0,1,2,3,4,5])),loadOrderForm:()=>he(()=>import("./chunk-D213HQco.js").then(s=>s.o),__vite__mapDeps([6,1,2,3,7,8,4])),loadOrderList:()=>he(()=>import("./orders-professional-Be-mUwdl.js"),__vite__mapDeps([9,1,2,3,4,8,7,6,10,5])),loadOrderDetail:()=>he(()=>Promise.resolve().then(()=>wx),void 0),loadVendorForm:()=>he(()=>import("./chunk-D213HQco.js").then(s=>s.v),__vite__mapDeps([6,1,2,3,7,8,4])),loadVendorList:()=>he(()=>Promise.resolve().then(()=>Sx),void 0),loadVendorDetail:()=>he(()=>Promise.resolve().then(()=>Dx),void 0),loadExcelUpload:()=>he(()=>import("./chunk-BzLfXDBg.js").then(s=>s.e),__vite__mapDeps([10,1,2,3])),loadExcelWizard:()=>he(()=>import("./chunk-BzLfXDBg.js").then(s=>s.a),__vite__mapDeps([10,1,2,3])),loadExcelPage:()=>he(()=>Promise.resolve().then(()=>Tx),void 0),loadProjectList:()=>he(()=>Promise.resolve().then(()=>Ox),void 0),loadProjectDetail:()=>he(()=>Promise.resolve().then(()=>Mx),void 0),loadAdminPanel:()=>he(()=>import("./chunk-Dvp0srGf.js").then(s=>s.a),__vite__mapDeps([11,1,2,3,4,7])),loadUserManagement:()=>he(()=>import("./chunk-Dvp0srGf.js").then(s=>s.u),__vite__mapDeps([11,1,2,3,4,7])),loadTemplateManagement:()=>he(()=>Promise.resolve().then(()=>Bx),void 0),loadVirtualTable:()=>he(()=>Promise.resolve().then(()=>Wx),void 0),loadVirtualList:()=>he(()=>Promise.resolve().then(()=>Yx),void 0),loadVirtualOrders:()=>he(()=>Promise.resolve().then(()=>tm),void 0),loadPerformanceHooks:()=>he(()=>Promise.resolve().then(()=>jo),void 0),loadThemeProvider:()=>he(()=>Promise.resolve().then(()=>to),void 0),loadAccessibilityFeatures:()=>he(()=>Promise.resolve().then(()=>ao),void 0)},Bt=new Ao;function To(){Bt.add("Dashboard",xs.loadDashboard),Bt.add("OrderForm",xs.loadOrderForm),Bt.add("VendorForm",xs.loadVendorForm),Bt.preloadOnIdle()}function Po(s){const t={"/dashboard":[xs.loadDashboardCharts,xs.loadDashboardWidgets],"/orders":[xs.loadOrderList,xs.loadVirtualTable],"/vendors":[xs.loadVendorList,xs.loadVirtualTable],"/create-order":[xs.loadOrderForm],"/admin":[xs.loadAdminPanel,xs.loadUserManagement]}[s];t&&(t.forEach((r,l)=>{Bt.add(`Route-${s}-${l}`,r)}),Bt.preloadOnIdle())}class Eo{constructor(){this.chunks=new Map,this.startTime=performance.now()}analyzeBundle(){this.scanChunks();const a=Array.from(this.chunks.values()),t=a.reduce((n,c)=>n+c.size,0),r=this.estimateGzippedSize(t),l=this.generateRecommendations(a),i=performance.now()-this.startTime;return{totalSize:t,gzippedSize:r,chunkCount:a.length,chunks:a,recommendations:l,loadTime:i}}scanChunks(){Array.from(document.querySelectorAll("script[src]")).forEach(t=>{const r=t.getAttribute("src");if(!r||!this.isAppChunk(r))return;const l=this.extractChunkName(r),i=this.determineChunkType(l,r),n=this.estimateChunkSize(r);this.chunks.set(l,{name:l,size:n,type:i,isLoaded:!0,loadTime:this.getChunkLoadTime(r)})})}isAppChunk(a){return a.includes("/assets/")||a.includes("chunk")||a.includes("vendor")||a.includes("main")}extractChunkName(a){return(a.split("/").pop()?.split("?")[0]||"unknown").replace(/\.[^.]+$/,"")}determineChunkType(a,t){return a.includes("vendor")||a.includes("react")||a.includes("ui-vendor")?"vendor":a.includes("main")||a.includes("index")?"main":a.includes("chunk")&&t.includes("async")?"async":"feature"}estimateChunkSize(a){const t=a.split("/").pop()||"";return t.includes("vendor")?15e4:t.includes("react")?1e5:t.includes("chart")?8e4:t.includes("main")?5e4:3e4}getChunkLoadTime(a){if(!performance.getEntriesByType)return;const r=performance.getEntriesByType("resource").find(l=>l.name.includes(a.split("/").pop()||""));return r?Math.round(r.responseEnd-r.requestStart):void 0}estimateGzippedSize(a){return Math.round(a*.35)}generateRecommendations(a){const t=[],r=a.reduce((c,g)=>c+g.size,0),l=a.filter(c=>c.type==="vendor"),i=a.filter(c=>c.type==="feature");r>1e6&&t.push("ðŸš¨ Bundle size is large (>1MB). Consider lazy loading more components."),l.length>5&&t.push("ðŸ“¦ Many vendor chunks detected. Consider consolidating similar libraries."),i.some(c=>c.size>2e5)&&t.push("âœ‚ï¸ Large feature chunks detected. Split them into smaller modules.");const n=a.filter(c=>c.loadTime&&c.loadTime>1e3);return n.length>0&&t.push(`â±ï¸ ${n.length} chunks are loading slowly (>1s). Consider preloading critical chunks.`),a.filter(c=>c.type==="async").length<3&&t.push("ðŸ”„ Consider implementing more async chunks for better load performance."),t.length===0&&t.push("âœ… Bundle optimization looks good!"),t}startMonitoring(){}hasSignificantChanges(a){const t=a.chunkCount,r=this.chunks.size;return Math.abs(t-r)>0}logAnalysis(a){}groupChunksByType(a){return a.reduce((t,r)=>{const l=r.type;return t[l]||(t[l]=[]),t[l].push(r),t},{})}getTypeEmoji(a){return{vendor:"ðŸ“š",feature:"ðŸ§©",async:"ðŸ”„",main:"ðŸ "}[a]||"ðŸ“¦"}formatBytes(a){if(a===0)return"0 B";const t=1024,r=["B","KB","MB","GB"],l=Math.floor(Math.log(a)/Math.log(t));return`${parseFloat((a/Math.pow(t,l)).toFixed(1))} ${r[l]}`}}new Eo;function ai({src:s,alt:a,className:t,lazy:r=!0,threshold:l=.1,rootMargin:i="50px",quality:n=75,format:c="auto",sizes:g,responsive:o=!1,aspectRatio:w,fallback:p,placeholder:m="skeleton",blurDataURL:f,showLoadingIndicator:T=!0,loadingComponent:O,errorComponent:E,priority:v=!1,preload:F=!1,onLoad:_,onError:k,onLoadStart:A,containerClassName:x,containerStyle:D,...u}){const[N,j]=d.useState("idle"),[h,I]=d.useState(""),[S,z]=d.useState(0),Q=d.useRef(null),K=d.useRef(null),ne=Xn(K,{threshold:l,rootMargin:i}),Se=!r||v||ne,je=d.useCallback((te,le)=>{const ce=new URL(te,window.location.origin);return n!==75&&ce.searchParams.set("quality",n.toString()),le&&le!=="auto"&&ce.searchParams.set("format",le),ce.toString()},[n]),y=d.useCallback(te=>o?[640,768,1024,1280,1536].map(ce=>`${je(te)}${te.includes("?")?"&":"?"}w=${ce} ${ce}w`).join(", "):void 0,[o,je]),$=d.useCallback(te=>{if(!F)return;const le=document.createElement("link");le.rel="preload",le.as="image",le.href=te,g&&le.setAttribute("imagesizes",g),document.head.appendChild(le)},[F,g]),J=d.useCallback(te=>{if(N==="loading")return;j("loading"),A?.();const le=new Image;le.onload=_e=>{I(te),j("loaded"),_?.(_e)},le.onerror=()=>{const _e=new Error(`Failed to load image: ${te}`);j("error"),k?.(_e)};const ce=y(te);ce&&(le.srcset=ce),g&&(le.sizes=g),le.src=je(te)},[N,_,k,A,y,je,g]),ie=d.useCallback(()=>{if(S<3){z(le=>le+1),j("idle");const te=S===0&&p?p:s;setTimeout(()=>J(te),1e3*S)}},[S,p,s,J]);d.useEffect(()=>{Se&&N==="idle"&&(J(s),$(s))},[Se,N,s,J,$]);const xe=()=>m==="none"?null:typeof m=="string"&&m!=="skeleton"&&m!=="blur"?e.jsx("img",{src:m,alt:"",className:V("w-full h-full object-cover",t),"aria-hidden":"true"}):m==="blur"&&f?e.jsx("img",{src:f,alt:"",className:V("w-full h-full object-cover filter blur-sm scale-110",t),"aria-hidden":"true"}):e.jsx("div",{className:V("w-full h-full bg-gray-200 animate-pulse flex items-center justify-center",t),children:e.jsx(Da,{className:"w-8 h-8 text-gray-400","aria-hidden":"true"})}),vs=()=>!T||N!=="loading"?null:O?e.jsx(O,{}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20",children:e.jsx($s,{className:"w-6 h-6 text-white animate-spin"})}),C=()=>N!=="error"?null:E?e.jsx(E,{retry:ie}):e.jsxs("div",{className:V("w-full h-full bg-gray-100 flex flex-col items-center justify-center text-gray-500",t),children:[e.jsx(Be,{className:"w-8 h-8 mb-2"}),e.jsx("p",{className:"text-sm text-center mb-2",children:"ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),S<3&&e.jsx("button",{onClick:ie,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"ë‹¤ì‹œ ì‹œë„"})]}),M={...D,...w&&{aspectRatio:w,width:"100%"}};return e.jsxs("div",{ref:K,className:V("relative overflow-hidden",o&&"w-full",x),style:M,children:[(N==="idle"||N==="loading")&&xe(),N==="loaded"&&e.jsx("img",{ref:Q,src:h,srcSet:y(s),sizes:g,alt:a,className:V("w-full h-full object-cover transition-opacity duration-300",N==="loaded"?"opacity-100":"opacity-0",t),...u}),vs(),C()]})}const Io={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"},Oo={circle:"rounded-full",square:"rounded-none",rounded:"rounded-lg"};function Ur({size:s="md",shape:a="circle",initials:t,className:r,containerClassName:l,...i}){const n=Io[s],c=Oo[a];return e.jsx(ai,{...i,aspectRatio:"1/1",className:V("object-cover",c,r),containerClassName:V(n,c,l),errorComponent:({retry:g})=>e.jsx("div",{className:V("w-full h-full bg-gray-300 flex items-center justify-center text-gray-600 font-medium",c),children:t?t.slice(0,2).toUpperCase():"?"})})}const Br=[{title:"í•µì‹¬ ì—…ë¬´",items:[{name:"ëŒ€ì‹œë³´ë“œ",href:"/",icon:Zi},{name:"ë°œì£¼ì„œ ìž‘ì„±",href:"/create-order",icon:we,highlight:!0,subItems:[{name:"ðŸš€ í†µí•© ì›Œí¬í”Œë¡œìš°",href:"/create-order/unified",highlight:!0},{name:"ðŸ†• í†µí•© ì›Œí¬í”Œë¡œìš° V2",href:"/create-order/unified-v2",highlight:!0,badge:"NEW"},{name:"í‘œì¤€ ë°œì£¼ì„œ",href:"/create-order/standard"},{name:"ì—‘ì…€ ë°œì£¼ì„œ",href:"/create-order/excel"}]},{name:"ë°œì£¼ì„œ ê´€ë¦¬",href:"/orders",icon:ye},{name:"ìŠ¹ì¸ ê´€ë¦¬",href:"/approvals",icon:pe}]},{title:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",items:[{name:"í˜„ìž¥ ê´€ë¦¬",href:"/projects",icon:cs},{name:"ê±°ëž˜ì²˜ ê´€ë¦¬",href:"/vendors",icon:Ws},{name:"ë¶„ë¥˜ ê´€ë¦¬",href:"/category-management",icon:Xi}]},{title:"ë¶„ì„ ë° ë„êµ¬",items:[{name:"ë³´ê³ ì„œ ë° ë¶„ì„",href:"/reports",icon:ar},{name:"ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°",href:"/import-export",icon:dr},{name:"í…œí”Œë¦¿ ê´€ë¦¬",href:"/templates",icon:fs}]},{title:"ì‹œìŠ¤í…œ ì„¤ì •",items:[{name:"ì‹œìŠ¤í…œ ê´€ë¦¬",href:"/admin",icon:Hs,adminOnly:!0}]}];function Fo(){const{user:s}=os(),[a,t]=Je(),[r,l]=d.useState(!1),[i,n]=d.useState([]),{prefetchForRoute:c}=Co(),{data:g}=Nt(["/api/companies"],{queryFn:()=>me("GET","/api/companies"),cacheType:"STATIC",enabled:!!s}),o=g?.[0],w=f=>f==="/"?a==="/":a.startsWith(f),p=f=>{n(T=>T.includes(f)?T.filter(O=>O!==f):[...T,f])},m=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center h-16 px-4 bg-sidebar-primary",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-8 w-8 bg-sidebar-primary-foreground rounded-lg flex items-center justify-center",children:e.jsx(Al,{className:"h-5 w-5 text-sidebar-primary"})}),e.jsx("span",{className:"text-xl font-bold text-sidebar-primary-foreground",children:"ë°œì£¼ì‹œìŠ¤í…œ"})]})}),e.jsxs("nav",{className:"mt-6 px-4 space-y-6",children:[Br.map((f,T)=>e.jsxs("div",{children:[e.jsx("div",{className:"px-2 mb-3",children:e.jsx("h3",{className:"text-xs font-semibold text-sidebar-muted-foreground uppercase tracking-wider",children:f.title})}),e.jsx("div",{className:"space-y-1",children:f.items.map(O=>O.adminOnly&&s?.role!=="admin"?null:e.jsxs("div",{children:[e.jsxs(b,{variant:w(O.href)?"secondary":"ghost",className:V("w-full nav-item justify-start transition-all duration-200",w(O.href)&&"active bg-sidebar-accent text-sidebar-accent-foreground",O.highlight&&"font-medium border border-primary/20 hover:border-primary/40"),onClick:()=>{O.subItems?p(O.name):(t(O.href),l(!1))},onMouseEnter:()=>{c(O.href)},children:[e.jsx(O.icon,{className:V("h-4 w-4 mr-3",O.highlight&&"text-primary")}),e.jsx("span",{className:"flex-1 text-left",children:O.name}),O.highlight&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-pulse"}),O.subItems&&(i.includes(O.name)?e.jsx(Zs,{className:"h-4 w-4"}):e.jsx(mt,{className:"h-4 w-4"}))]}),O.subItems&&i.includes(O.name)&&e.jsx("div",{className:"ml-6 mt-2 space-y-1 border-l border-sidebar-border pl-3",children:O.subItems.map(E=>e.jsx(b,{variant:w(E.href)?"secondary":"ghost",className:V("w-full justify-start text-sm nav-item transition-all duration-200",w(E.href)&&"active bg-sidebar-accent text-sidebar-accent-foreground",E.highlight&&"font-medium text-primary hover:bg-primary/10"),onClick:()=>{t(E.href),l(!1)},children:e.jsxs("span",{className:"flex items-center justify-between w-full",children:[e.jsxs("span",{children:[E.highlight&&"â­ ",E.name]}),E.badge&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-semibold bg-blue-500 text-white rounded",children:E.badge})]})},E.name))})]},O.name))}),T<Br.length-1&&e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"border-t border-sidebar-border"})})]},f.title)),s?.role==="admin"&&e.jsx(e.Fragment,{children:o?.logoUrl&&e.jsx("div",{className:"mt-4 px-0",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ai,{src:o.logoUrl,alt:o.companyName,className:"h-16 w-auto object-contain pl-[60px] pr-[60px]",priority:!0,quality:85,lazy:!1,fallback:"/images/default-company-logo.png",placeholder:"skeleton"})})})})]})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"xl:hidden fixed top-4 left-4 z-50",children:e.jsx(b,{variant:"outline",size:"sm",onClick:()=>l(!r),children:r?e.jsx(ys,{className:"h-4 w-4"}):e.jsx(Yi,{className:"h-4 w-4"})})}),e.jsx("div",{className:"hidden xl:fixed xl:inset-y-0 xl:left-0 xl:z-50 xl:block xl:w-64 xl:bg-sidebar-background xl:shadow-lg transition-all duration-300 border-r border-sidebar-border",children:e.jsx(m,{})}),r&&e.jsxs("div",{className:"xl:hidden fixed inset-0 z-40",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70",onClick:()=>l(!1)}),e.jsx("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-sidebar-background shadow-lg transform transition-transform duration-300 ease-in-out border-r border-sidebar-border",children:e.jsx(m,{})})]})]})}const wr=d.forwardRef(({className:s,...a},t)=>e.jsx(Tl,{ref:t,className:V("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));wr.displayName=Tl.displayName;const Mo=d.forwardRef(({className:s,...a},t)=>e.jsx(Pl,{ref:t,className:V("aspect-square h-full w-full",s),...a}));Mo.displayName=Pl.displayName;const Cr=d.forwardRef(({className:s,...a},t)=>e.jsx(El,{ref:t,className:V("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Cr.displayName=El.displayName;const $o=ea("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-500",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80 dark:bg-red-600 dark:text-white dark:hover:bg-red-500",outline:"text-foreground border-border dark:text-slate-200 dark:border-slate-600"}},defaultVariants:{variant:"default"}});function B({className:s,variant:a,...t}){return e.jsx("div",{className:V($o({variant:a}),s),...t})}const ri=s=>{switch(s){case"draft":return"ìž„ì‹œì €ìž¥";case"pending":return"ìŠ¹ì¸ëŒ€ê¸°";case"approved":return"ìŠ¹ì¸ì™„ë£Œ";case"sent":return"ë°œì†¡ë¨";case"completed":return"ë°œì£¼ì™„ë£Œ";case"rejected":return"ë°˜ë ¤";default:return s}},li=s=>s?.name?s.name.substring(0,2):s?.firstName?s.firstName.substring(0,2):s?.email?.[0]?.toUpperCase()||"U",lr=s=>s?.name?s.name:s?.firstName||s?.lastName?`${s.lastName||""} ${s.firstName||""}`.trim():s?.email||"",aa=s=>({admin:"ê´€ë¦¬ìž",orderer:"ë°œì£¼ìž",manager:"ê´€ë¦¬ìž",user:"ì‚¬ìš©ìž",order_manager:"ë°œì£¼ê´€ë¦¬ìž"})[s]||s,er={"/":{title:"ëŒ€ì‹œë³´ë“œ",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ëŒ€ì‹œë³´ë“œ",href:"/"}],actions:[]},"/create-order":{title:"ë°œì£¼ì„œ ìž‘ì„±",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ìž‘ì„±",href:"/create-order"}],actions:[]},"/create-order/unified":{title:"í†µí•© ì›Œí¬í”Œë¡œìš°",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ìž‘ì„±",href:"/create-order"},{label:"í†µí•© ì›Œí¬í”Œë¡œìš°",href:"/create-order/unified"}],actions:[]},"/create-order/unified-v2":{title:"í†µí•© ì›Œí¬í”Œë¡œìš° V2",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ìž‘ì„±",href:"/create-order"},{label:"í†µí•© ì›Œí¬í”Œë¡œìš° V2",href:"/create-order/unified-v2"}],actions:[]},"/create-order/standard":{title:"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„±",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ìž‘ì„±",href:"/create-order"},{label:"í‘œì¤€ ë°œì£¼ì„œ",href:"/create-order/standard"}],actions:[]},"/create-order/excel":{title:"ì—‘ì…€ ë°œì£¼ì„œ ìž‘ì„±",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ìž‘ì„±",href:"/create-order"},{label:"ì—‘ì…€ ë°œì£¼ì„œ",href:"/create-order/excel"}],actions:[]},"/orders":{title:"ë°œì£¼ì„œ ê´€ë¦¬",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ê´€ë¦¬",href:"/orders"}],actions:[{label:"ìƒˆ ë°œì£¼ì„œ",href:"/create-order/unified"}]},"/approvals":{title:"ìŠ¹ì¸ ê´€ë¦¬",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ìŠ¹ì¸ ê´€ë¦¬",href:"/approvals"}],actions:[]},"/projects":{title:"í˜„ìž¥ ê´€ë¦¬",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"í˜„ìž¥ ê´€ë¦¬",href:"/projects"}],actions:[{label:"ìƒˆ í˜„ìž¥",href:"/projects/new"}]},"/vendors":{title:"ê±°ëž˜ì²˜ ê´€ë¦¬",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"ê±°ëž˜ì²˜ ê´€ë¦¬",href:"/vendors"}],actions:[{label:"ìƒˆ ê±°ëž˜ì²˜",href:"/vendors/new"}]},"/category-management":{title:"ë¶„ë¥˜ ê´€ë¦¬",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"ë¶„ë¥˜ ê´€ë¦¬",href:"/category-management"}],actions:[]},"/items":{title:"í’ˆëª© ê´€ë¦¬",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"í’ˆëª© ê´€ë¦¬",href:"/items"}],actions:[{label:"ìƒˆ í’ˆëª©",href:"/items/new"}]},"/reports":{title:"ë³´ê³ ì„œ ë° ë¶„ì„",section:"ë¶„ì„ ë° ë„êµ¬",breadcrumb:[{label:"ë³´ê³ ì„œ ë° ë¶„ì„",href:"/reports"}],actions:[]},"/import-export":{title:"ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°",section:"ë¶„ì„ ë° ë„êµ¬",breadcrumb:[{label:"ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°",href:"/import-export"}],actions:[]},"/templates":{title:"í…œí”Œë¦¿ ê´€ë¦¬",section:"ë¶„ì„ ë° ë„êµ¬",breadcrumb:[{label:"í…œí”Œë¦¿ ê´€ë¦¬",href:"/templates"}],actions:[{label:"ìƒˆ í…œí”Œë¦¿",href:"/templates/new"}]},"/admin":{title:"ì‹œìŠ¤í…œ ê´€ë¦¬",section:"ì‹œìŠ¤í…œ ì„¤ì •",breadcrumb:[{label:"ì‹œìŠ¤í…œ ê´€ë¦¬",href:"/admin"}],actions:[]},"/profile":{title:"í”„ë¡œí•„ ì„¤ì •",section:"ì‚¬ìš©ìž",breadcrumb:[{label:"í”„ë¡œí•„ ì„¤ì •",href:"/profile"}],actions:[]}};function Ro(){const{user:s}=os(),[a]=Je(),r=er[a]?er[a]:a.startsWith("/orders/")?{title:"ë°œì£¼ì„œ ìƒì„¸",section:"í•µì‹¬ ì—…ë¬´",breadcrumb:[{label:"ë°œì£¼ì„œ ê´€ë¦¬",href:"/orders"},{label:"ìƒì„¸ë³´ê¸°",href:a}],actions:[{label:"íŽ¸ì§‘",href:`${a}/edit`}]}:a.startsWith("/projects/")?{title:"í˜„ìž¥ ìƒì„¸",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"í˜„ìž¥ ê´€ë¦¬",href:"/projects"},{label:"ìƒì„¸ë³´ê¸°",href:a}],actions:[{label:"íŽ¸ì§‘",href:`${a}/edit`}]}:a.startsWith("/vendors/")?{title:"ê±°ëž˜ì²˜ ìƒì„¸",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"ê±°ëž˜ì²˜ ê´€ë¦¬",href:"/vendors"},{label:"ìƒì„¸ë³´ê¸°",href:a}],actions:[{label:"íŽ¸ì§‘",href:`${a}/edit`}]}:a.startsWith("/items/")?{title:"í’ˆëª© ìƒì„¸",section:"ê¸°ì´ˆ ë°ì´í„° ê´€ë¦¬",breadcrumb:[{label:"í’ˆëª© ê´€ë¦¬",href:"/items"},{label:"ìƒì„¸ë³´ê¸°",href:a}],actions:[{label:"íŽ¸ì§‘",href:`${a}/edit`}]}:a.startsWith("/templates/")?{title:"í…œí”Œë¦¿ ìƒì„¸",section:"ë¶„ì„ ë° ë„êµ¬",breadcrumb:[{label:"í…œí”Œë¦¿ ê´€ë¦¬",href:"/templates"},{label:"ìƒì„¸ë³´ê¸°",href:a}],actions:[{label:"íŽ¸ì§‘",href:`${a}/edit`}]}:a.startsWith("/admin/")?{title:"ì‹œìŠ¤í…œ ê´€ë¦¬",section:"ì‹œìŠ¤í…œ ì„¤ì •",breadcrumb:[{label:"ì‹œìŠ¤í…œ ê´€ë¦¬",href:"/admin"}],actions:[]}:er["/"],{logoutMutation:l}=os(),i=()=>{l.mutate()};return e.jsx("header",{className:"bg-background shadow-sm border-b border-border relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-foreground",children:r.title}),e.jsx("nav",{className:"flex items-center space-x-1 text-sm text-muted-foreground",children:r.breadcrumb.map((n,c)=>e.jsxs("div",{className:"flex items-center",children:[c>0&&e.jsx(mt,{className:"h-3 w-3 mx-1 text-muted-foreground/50"}),c===r.breadcrumb.length-1?e.jsx("span",{className:"text-foreground font-medium",children:n.label}):e.jsx(Pt,{href:n.href,className:"hover:text-foreground transition-colors duration-200 cursor-pointer",children:n.label})]},c))})]}),r.actions&&r.actions.length>0&&e.jsx("div",{className:"flex items-center space-x-2 ml-8",children:r.actions.map((n,c)=>e.jsx(b,{asChild:!0,size:"sm",variant:"outline",className:"text-xs",children:e.jsxs(Pt,{href:n.href,children:[e.jsx(we,{className:"h-3 w-3 mr-1"}),n.label]})},c))})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Qn,{size:"sm"}),e.jsxs(b,{variant:"ghost",size:"sm",className:"relative",children:[e.jsx(Il,{className:"h-5 w-5"}),e.jsx(B,{className:"absolute -top-1 -right-1 h-2 w-2 p-0 bg-red-500"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs($n,{children:[e.jsx(Rn,{asChild:!0,children:e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer hover:bg-accent rounded-lg p-2 transition-colors",children:[e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:lr(s)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:aa(s?.role||"")})]}),e.jsx(wr,{children:e.jsx(Cr,{className:"bg-primary text-primary-foreground",children:li(s)})})]})}),e.jsxs(gr,{align:"end",className:"w-56",children:[e.jsx(wa,{children:"ì‚¬ìš©ìž ì •ë³´"}),e.jsx(It,{}),e.jsxs("div",{className:"px-2 py-2",children:[e.jsx("div",{className:"text-sm font-medium",children:lr(s)}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:s?.email}),e.jsx("div",{className:"text-xs text-muted-foreground",children:aa(s?.role||"")}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ì‚¬ìš©ìž ID: ",s?.id]})]}),e.jsx(It,{}),e.jsx(Et,{asChild:!0,className:"cursor-pointer",children:e.jsxs(Pt,{href:"/profile",children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"í”„ë¡œí•„ ì„¤ì •"]})}),e.jsx(It,{}),e.jsxs(Et,{onClick:i,className:"cursor-pointer text-red-600",children:[e.jsx(ec,{className:"mr-2 h-4 w-4"}),"ë¡œê·¸ì•„ì›ƒ"]})]})]})})]})]})})}const sr=oa(()=>he(()=>import("./chunk-Cr5d6gIV.js").then(s=>s.c),__vite__mapDeps([0,1,2,3,4,5])),"Dashboard"),Lo=Fe(()=>he(()=>import("./orders-professional-Be-mUwdl.js"),__vite__mapDeps([9,1,2,3,4,8,7,6,10,5])),"Orders"),zo=Fe(()=>he(()=>Promise.resolve().then(()=>rm),void 0),"OrderDetail"),qo=Fe(()=>he(()=>Promise.resolve().then(()=>nm),void 0),"OrderDetailStandard"),Vo=Fe(()=>he(()=>Promise.resolve().then(()=>cm),void 0),"OrderEdit"),Qr=Fe(()=>he(()=>Promise.resolve().then(()=>om),void 0),"OrderPreview"),Hr=oa(()=>he(()=>Promise.resolve().then(()=>mm),void 0),"CreateOrder"),Wr=Fe(()=>he(()=>Promise.resolve().then(()=>pm),void 0),"CreateExtrusionOrder"),Gr=Fe(()=>he(()=>Promise.resolve().then(()=>Nm),void 0),"CreatePanelOrder"),Jr=Fe(()=>he(()=>Promise.resolve().then(()=>wm),void 0),"CreateAccessoriesOrder"),Ko=Fe(()=>he(()=>import("./chunk-Dvp0srGf.js").then(s=>s.c),__vite__mapDeps([11,1,2,3,4,7])),"CategoryManagement"),Yr=Fe(()=>he(()=>Promise.resolve().then(()=>Pm),void 0),"CreateStandardOrder"),Uo=Fe(()=>he(()=>Promise.resolve().then(()=>Lm),void 0),"CreateStandardOrderRefactored"),Zr=Fe(()=>he(()=>Promise.resolve().then(()=>qm),void 0),"CreateMaterialsOrder"),Bo=Fe(()=>xs.loadExcelPage(),"CreateOrderExcel"),Qo=Fe(()=>he(()=>Promise.resolve().then(()=>Dh),void 0),"CreateOrderUnified"),Ho=Fe(()=>he(()=>Promise.resolve().then(()=>Fh),void 0),"CreateOrderUnifiedV2"),Wo=oa(()=>xs.loadVendorList(),"Vendors"),Go=Fe(()=>xs.loadVendorDetail(),"VendorDetail"),Jo=Fe(()=>he(()=>Promise.resolve().then(()=>Rh),void 0),"VendorEdit");Fe(()=>he(()=>Promise.resolve().then(()=>nu),void 0),"Items");Fe(()=>he(()=>Promise.resolve().then(()=>cu),void 0),"ItemDetail");const Yo=oa(()=>xs.loadProjectList(),"Projects"),Zo=Fe(()=>xs.loadProjectDetail(),"ProjectDetail"),Xo=Fe(()=>he(()=>Promise.resolve().then(()=>ou),void 0),"ProjectEdit"),ex=Fe(()=>he(()=>Promise.resolve().then(()=>mu),void 0),"UserDetail"),sx=Fe(()=>xs.loadAdminPanel(),"Admin"),tx=Fe(()=>he(()=>Promise.resolve().then(()=>uu),void 0),"Users"),ax=Fe(()=>xs.loadUserManagement(),"UserManagement"),rx=Fe(()=>he(()=>Promise.resolve().then(()=>ju),void 0),"Profile"),lx=Fe(()=>he(()=>Promise.resolve().then(()=>Nu),void 0),"Reports"),Xr=oa(()=>xs.loadTemplateManagement(),"TemplateManagement"),el=Fe(()=>he(()=>Promise.resolve().then(()=>vu),void 0),"TemplateEdit"),nx=Fe(()=>he(()=>Promise.resolve().then(()=>_u),void 0),"Positions"),ix=Fe(()=>he(()=>Promise.resolve().then(()=>Eu),void 0),"Approvals"),cx=Fe(()=>he(()=>import("./chunk-BzLfXDBg.js").then(s=>s.b),__vite__mapDeps([10,1,2,3])),"ExcelAutomationTest"),dx=Fe(()=>he(()=>Promise.resolve().then(()=>Fu),void 0),"ImportExport"),ox=Fe(()=>he(()=>Promise.resolve().then(()=>zu),void 0).then(s=>({default:s.AccessibilityExample})),"AccessibilityExample");function xx(){return e.jsx(go,{})}function ts(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-8 w-32 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-48 bg-muted rounded animate-pulse"})]}),e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,a)=>e.jsx("div",{className:"h-16 bg-muted rounded animate-pulse"},a))})]})}function as(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"h-8 w-32 bg-muted rounded animate-pulse"}),e.jsxs("div",{className:"space-y-4",children:[Array.from({length:6}).map((s,a)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-full bg-muted rounded animate-pulse"})]},a)),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("div",{className:"h-10 w-20 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-20 bg-muted rounded animate-pulse"})]})]})]})}function sl(){const[s]=Je();Ea("Layout"),si();const a=ei(),{user:t,isInitialized:r}=So(),{warmEssentialData:l,warmUserSpecificData:i}=Cd(),n=_o();return d.useEffect(()=>{l(),t&&"id"in t&&typeof t.id=="number"&&i(t.id)},[l,i,t]),d.useEffect(()=>{Po(s)},[s]),d.useEffect(()=>{},[a]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"hidden",children:e.jsx(yr,{})}),e.jsx(Fo,{}),e.jsxs("div",{className:"transition-all duration-300 sidebar-transition xl:ml-64",children:[e.jsx(Ro,{}),e.jsx("main",{id:"main-content",children:e.jsx(d.Suspense,{fallback:e.jsx(xx,{}),children:e.jsxs(sd,{children:[e.jsx(Ne,{path:"/",component:sr}),e.jsx(Ne,{path:"/login",component:sr}),e.jsx(Ne,{path:"/dashboard",component:sr}),e.jsx(Ne,{path:"/orders/new",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Hr,{})})}),e.jsx(Ne,{path:"/orders/:id/preview",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Qr,{})})}),e.jsx(Ne,{path:"/order-preview/:id",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Qr,{})})}),e.jsx(Ne,{path:"/orders/:id/edit",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Vo,{})})}),e.jsx(Ne,{path:"/orders/:id/standard",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(qo,{})})}),e.jsx(Ne,{path:"/orders/:id",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(zo,{})})}),e.jsx(Ne,{path:"/orders",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Lo,{})})}),e.jsx(Ne,{path:"/create-order",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Hr,{})})}),e.jsx(Ne,{path:"/create-order/extrusion",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Wr,{})})}),e.jsx(Ne,{path:"/create-order-extrusion",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Wr,{})})}),e.jsx(Ne,{path:"/create-order/panel",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Gr,{})})}),e.jsx(Ne,{path:"/create-order-panel",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Gr,{})})}),e.jsx(Ne,{path:"/create-order/accessories",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Jr,{})})}),e.jsx(Ne,{path:"/create-order-accessories",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Jr,{})})}),e.jsx(Ne,{path:"/create-order/standard",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Yr,{})})}),e.jsx(Ne,{path:"/create-order-standard",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Yr,{})})}),e.jsx(Ne,{path:"/create-order/standard-new",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Uo,{})})}),e.jsx(Ne,{path:"/create-order/materials",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Zr,{})})}),e.jsx(Ne,{path:"/create-order-materials",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Zr,{})})}),e.jsx(Ne,{path:"/create-order/excel",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Bo,{})})}),e.jsx(Ne,{path:"/create-order/unified",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Qo,{})})}),e.jsx(Ne,{path:"/create-order/unified-v2",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Ho,{})})}),e.jsx(Ne,{path:"/vendors/:id/edit",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Jo,{})})}),e.jsx(Ne,{path:"/vendors/:id",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Go,{})})}),e.jsx(Ne,{path:"/vendors",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Wo,{})})}),e.jsx(Ne,{path:"/category-management",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Ko,{})})}),e.jsx(Ne,{path:"/projects/:id/edit",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Xo,{})})}),e.jsx(Ne,{path:"/projects/:id",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Zo,{})})}),e.jsx(Ne,{path:"/projects",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Yo,{})})}),e.jsx(Ne,{path:"/users/:id",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(ex,{})})}),e.jsx(Ne,{path:"/users",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(tx,{})})}),e.jsx(Ne,{path:"/user-management",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(ax,{})})}),e.jsx(Ne,{path:"/admin",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(sx,{})})}),e.jsx(Ne,{path:"/profile",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(rx,{})})}),e.jsx(Ne,{path:"/reports",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(lx,{})})}),e.jsx(Ne,{path:"/templates/edit/:id",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(el,{})})}),e.jsx(Ne,{path:"/templates/new",children:e.jsx(d.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(el,{})})}),e.jsx(Ne,{path:"/templates",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Xr,{})})}),e.jsx(Ne,{path:"/template-management",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(Xr,{})})}),e.jsx(Ne,{path:"/positions",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(nx,{})})}),e.jsx(Ne,{path:"/approvals",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(ix,{})})}),e.jsx(Ne,{path:"/excel-automation-test",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(cx,{})})}),e.jsx(Ne,{path:"/import-export",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(dx,{})})}),e.jsx(Ne,{path:"/accessibility-example",children:e.jsx(d.Suspense,{fallback:e.jsx(ts,{}),children:e.jsx(ox,{})})}),e.jsx(Ne,{component:Do})]})})})]}),n&&e.jsx(ko,{})]})}function mx(){const{user:s,isLoading:a}=os(),[t]=Je();return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]})}):s?t==="/login"||t==="/"?e.jsx(qr,{children:e.jsx(sl,{})}):e.jsx(qr,{children:e.jsx(sl,{})}):e.jsx(td,{})}function hx(){return d.useEffect(()=>{To()},[]),e.jsx(sc,{client:rs,children:e.jsx(Bn,{defaultTheme:"system",enableSystem:!0,children:e.jsx($d,{children:e.jsx(vr,{children:e.jsx(zn,{children:e.jsx(Vn,{children:e.jsxs(pt,{children:[e.jsx(Md,{}),e.jsx(mx,{})]})})})})})})})}tc(document.getElementById("root")).render(e.jsx(hx,{}));const Ge=d.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:V("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm transition-colors hover:border-ring/50 dark:bg-slate-950 dark:border-slate-600 dark:text-white dark:placeholder:text-slate-400 dark:hover:border-blue-400/60 dark:focus-visible:border-blue-400 dark:focus-visible:ring-blue-400/20 dark:focus-visible:ring-offset-slate-950",s),ref:t,...a}));Ge.displayName="Textarea";const Z=ac,X=rc,Y=d.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ol,{ref:r,className:V("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 transition-colors hover:border-ring/50 dark:bg-slate-950 dark:border-slate-600 dark:text-white dark:data-[placeholder]:text-slate-400 dark:hover:border-blue-400/60 dark:focus:border-blue-400 dark:focus:ring-blue-400/20 dark:focus:ring-offset-slate-950",s),...t,children:[a,e.jsx(lc,{asChild:!0,children:e.jsx(Zs,{className:"h-4 w-4 opacity-50 dark:opacity-70"})})]}));Y.displayName=Ol.displayName;const ni=d.forwardRef(({className:s,...a},t)=>e.jsx(Fl,{ref:t,className:V("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(zt,{className:"h-4 w-4"})}));ni.displayName=Fl.displayName;const ii=d.forwardRef(({className:s,...a},t)=>e.jsx(Ml,{ref:t,className:V("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Zs,{className:"h-4 w-4"})}));ii.displayName=Ml.displayName;const ee=d.forwardRef(({className:s,children:a,position:t="popper",...r},l)=>e.jsx(nc,{children:e.jsxs($l,{ref:l,className:V("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin] dark:bg-slate-950 dark:border-slate-600 dark:text-white dark:shadow-xl",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(ni,{}),e.jsx(ic,{className:V("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(ii,{})]})}));ee.displayName=$l.displayName;const ux=d.forwardRef(({className:s,...a},t)=>e.jsx(Rl,{ref:t,className:V("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a}));ux.displayName=Rl.displayName;const R=d.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ll,{ref:r,className:V("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-white dark:text-white",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(cc,{children:e.jsx(ps,{className:"h-4 w-4"})})}),e.jsx(dc,{children:a})]}));R.displayName=Ll.displayName;const px=d.forwardRef(({className:s,...a},t)=>e.jsx(zl,{ref:t,className:V("-mx-1 my-1 h-px bg-muted",s),...a}));px.displayName=zl.displayName;const et=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:V("w-full caption-bottom text-sm",s),...a})}));et.displayName="Table";const st=d.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:V("[&_tr]:border-b",s),...a}));st.displayName="TableHeader";const tt=d.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:V("[&_tr:last-child]:border-0",s),...a}));tt.displayName="TableBody";const jx=d.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:V("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0 dark:bg-slate-800/50",s),...a}));jx.displayName="TableFooter";const Me=d.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:V("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted dark:border-slate-700 dark:hover:bg-slate-800/50 dark:data-[state=selected]:bg-slate-800",s),...a}));Me.displayName="TableRow";const oe=d.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:V("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 dark:text-slate-300",s),...a}));oe.displayName="TableHead";const G=d.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:V("p-4 align-middle [&:has([role=checkbox])]:pr-0 dark:border-slate-700",s),...a}));G.displayName="TableCell";const gx=d.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:V("mt-4 text-sm text-muted-foreground",s),...a}));gx.displayName="TableCaption";const ze=oc,Ls=xc,fx=hc,ci=d.forwardRef(({className:s,...a},t)=>e.jsx(ql,{ref:t,className:V("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));ci.displayName=ql.displayName;const qe=d.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(fx,{children:[e.jsx(ci,{}),e.jsxs(Vl,{ref:r,className:V("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[a,e.jsxs(mc,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ys,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qe.displayName=Vl.displayName;const Ve=({className:s,...a})=>e.jsx("div",{className:V("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});Ve.displayName="DialogHeader";const Sr=({className:s,...a})=>e.jsx("div",{className:V("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});Sr.displayName="DialogFooter";const Ke=d.forwardRef(({className:s,...a},t)=>e.jsx(Kl,{ref:t,className:V("text-lg font-semibold leading-none tracking-tight",s),...a}));Ke.displayName=Kl.displayName;const Ia=d.forwardRef(({className:s,...a},t)=>e.jsx(Ul,{ref:t,className:V("text-sm text-muted-foreground",s),...a}));Ia.displayName=Ul.displayName;const Nx=ea("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),As=d.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:V(Nx({variant:a}),s),...t}));As.displayName="Alert";const yx=d.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:V("mb-1 font-medium leading-none tracking-tight",s),...a}));yx.displayName="AlertTitle";const Ss=d.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:V("text-sm [&_p]:leading-relaxed",s),...a}));Ss.displayName="AlertDescription";const gs=d.forwardRef(({className:s,...a},t)=>e.jsx(Bl,{ref:t,className:V("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:border-slate-600 dark:bg-slate-950 dark:focus-visible:ring-blue-400/20 dark:focus-visible:ring-offset-slate-950 dark:data-[state=checked]:bg-blue-600 dark:data-[state=checked]:border-blue-600 dark:data-[state=checked]:text-white",s),...a,children:e.jsx(uc,{className:V("flex items-center justify-center text-current"),children:e.jsx(ps,{className:"h-4 w-4"})})}));gs.displayName=Bl.displayName;function ep({open:s,onOpenChange:a,orderData:t,onSendEmail:r}){const[l,i]=d.useState({to:t.vendorEmail?[t.vendorEmail]:[""],cc:[],subject:`ë°œì£¼ì„œ ì „ì†¡ - ${t.orderNumber}`,message:"",attachPDF:!0,attachExcel:!0}),[n,c]=d.useState(!1),[g,o]=d.useState([]),[w,p]=d.useState(""),[m,f]=d.useState(""),T=A=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(A),O=()=>{w&&T(w)?l.to.includes(w)||(i(A=>({...A,to:[...A.to.filter(x=>x!==""),w]})),p(""),o(A=>A.filter(x=>!x.includes("ìˆ˜ì‹ ìž")))):o(A=>[...A,"ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ìž…ë ¥í•˜ì„¸ìš”."])},E=()=>{m&&T(m)&&(l.cc?.includes(m)||(i(A=>({...A,cc:[...A.cc||[],m]})),f("")))},v=(A,x)=>{i(D=>({...D,[x]:D[x]?.filter(u=>u!==A)||[]}))},F=()=>{const A=[];return(!l.to.length||l.to.every(u=>!u.trim()))&&A.push("ìµœì†Œ í•˜ë‚˜ì˜ ìˆ˜ì‹ ìž ì´ë©”ì¼ì„ ìž…ë ¥í•˜ì„¸ìš”."),l.to.filter(u=>u&&!T(u)).length>0&&A.push("ìˆ˜ì‹ ìž ì´ë©”ì¼ ì£¼ì†Œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),(l.cc?.filter(u=>u&&!T(u))||[]).length>0&&A.push("ì°¸ì¡° ì´ë©”ì¼ ì£¼ì†Œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),l.subject.trim()||A.push("ì œëª©ì„ ìž…ë ¥í•˜ì„¸ìš”."),o(A),A.length===0},_=async()=>{if(F()){c(!0);try{await r(l),a(!1)}catch{o(["ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."])}finally{c(!1)}}},k=`ì•ˆë…•í•˜ì„¸ìš”.

${t.vendorName} ë‹´ë‹¹ìžë‹˜ê»˜ ë°œì£¼ì„œë¥¼ ì „ì†¡ë“œë¦½ë‹ˆë‹¤.

â–  ë°œì£¼ ì •ë³´
- ë°œì£¼ë²ˆí˜¸: ${t.orderNumber}
- ë°œì£¼ì¼ìž: ${t.orderDate}
- í˜„ìž¥ëª…: ${t.siteName||"N/A"}
- ë°œì£¼ê¸ˆì•¡: ${t.totalAmount.toLocaleString()}ì›

ì²¨ë¶€ëœ ë°œì£¼ì„œë¥¼ í™•ì¸í•˜ì‹œê³ , ë‚©ê¸°ì¼ì •ì— ë§žì¶° ì§„í–‰ ë¶€íƒë“œë¦½ë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.`;return e.jsx(ze,{open:s,onOpenChange:a,children:e.jsxs(qe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ve,{children:[e.jsxs(Ke,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-5 w-5"}),"ë°œì£¼ì„œ ì´ë©”ì¼ ë°œì†¡"]}),e.jsxs(Ia,{children:[t.vendorName,"ì—ê²Œ ë°œì£¼ì„œ ",t.orderNumber,"ë¥¼ ì´ë©”ì¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤."]})]}),e.jsxs("div",{className:"space-y-4",children:[g.length>0&&e.jsxs(As,{variant:"destructive",children:[e.jsx(it,{className:"h-4 w-4"}),e.jsx(Ss,{children:e.jsx("ul",{className:"list-disc list-inside",children:g.map((A,x)=>e.jsx("li",{children:A},x))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"to-email",children:"ìˆ˜ì‹ ìž *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{id:"to-email",type:"email",placeholder:"example@company.com",value:w,onChange:A=>p(A.target.value),onKeyPress:A=>A.key==="Enter"&&O()}),e.jsx(b,{type:"button",onClick:O,variant:"outline",size:"sm",children:"ì¶”ê°€"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.to.filter(A=>A.trim()).map((A,x)=>e.jsxs(B,{variant:"secondary",className:"flex items-center gap-1",children:[A,e.jsx(ys,{className:"h-3 w-3 cursor-pointer hover:text-red-500",onClick:()=>v(A,"to")})]},x))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"cc-email",children:"ì°¸ì¡° (ì„ íƒ)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{id:"cc-email",type:"email",placeholder:"cc@company.com",value:m,onChange:A=>f(A.target.value),onKeyPress:A=>A.key==="Enter"&&E()}),e.jsx(b,{type:"button",onClick:E,variant:"outline",size:"sm",children:"ì¶”ê°€"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.cc?.map((A,x)=>e.jsxs(B,{variant:"outline",className:"flex items-center gap-1",children:[A,e.jsx(ys,{className:"h-3 w-3 cursor-pointer hover:text-red-500",onClick:()=>v(A,"cc")})]},x))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"subject",children:"ì œëª© *"}),e.jsx(U,{id:"subject",value:l.subject,onChange:A=>i(x=>({...x,subject:A.target.value})),placeholder:"ë°œì£¼ì„œ ì „ì†¡ - PO-XXXX-XXX"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(P,{children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"attach-excel",checked:l.attachExcel,onCheckedChange:A=>i(x=>({...x,attachExcel:A}))}),e.jsx(P,{htmlFor:"attach-excel",children:"Excel íŒŒì¼ (ê°‘ì§€/ì„ì§€)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"attach-pdf",checked:l.attachPDF,onCheckedChange:A=>i(x=>({...x,attachPDF:A}))}),e.jsx(P,{htmlFor:"attach-pdf",children:"PDF íŒŒì¼"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"message",children:"ë©”ì‹œì§€ (ì„ íƒ)"}),e.jsx(Ge,{id:"message",value:l.message||k,onChange:A=>i(x=>({...x,message:A.target.value})),placeholder:"ì¶”ê°€ ë©”ì‹œì§€ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...",rows:8,className:"resize-none"})]})]}),e.jsxs(Sr,{children:[e.jsx(b,{variant:"outline",onClick:()=>a(!1),disabled:n,children:"ì·¨ì†Œ"}),e.jsx(b,{onClick:_,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"ë°œì†¡ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qt,{className:"h-4 w-4 mr-2"}),"ì´ë©”ì¼ ë°œì†¡"]})})]})]})})}const Ar=class Ar{static async sendPurchaseOrderEmailOriginalFormat(a,t){try{const r=await me(`${this.BASE_URL}/send-email-original-format`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:a,...t})});if(!r.ok){const i=await r.json();throw new Error(i.error||"ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨")}return{success:!0,messageId:(await r.json()).data?.messageId}}catch(r){return console.error("ì›ë³¸ í˜•ì‹ ìœ ì§€ ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",r),{success:!1,error:r instanceof Error?r.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}}}static async sendPurchaseOrderEmail(a,t){const r={to:t.to,cc:t.cc,subject:t.subject,additionalMessage:t.message,poData:{orderNumber:a.orderNumber,orderDate:a.orderDate,siteName:a.siteName,vendorName:a.vendorName,totalAmount:a.totalAmount}};if(a.filePath&&(r.attachments=[],t.attachExcel&&r.attachments.push({path:a.filePath,filename:`ë°œì£¼ì„œ_${a.orderNumber}.xlsx`}),t.attachPDF)){const l=a.filePath.replace(".xlsx",".pdf");r.attachments.push({path:l,filename:`ë°œì£¼ì„œ_${a.orderNumber}.pdf`})}try{return await me(`${this.BASE_URL}/send-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(l){throw console.error("Email send error:",l),new Error("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async testEmailConnection(){try{return await me(`${this.BASE_URL}/test-email`)}catch(a){return console.error("Email connection test error:",a),{success:!1,message:"ì´ë©”ì¼ ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"}}}static async extractSheets(a,t=["ê°‘ì§€","ì„ì§€"]){try{return await me(`${this.BASE_URL}/extract-sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:a,sheets:t})})}catch(r){throw console.error("Sheet extraction error:",r),new Error("ì‹œíŠ¸ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async convertToPDF(a,t){try{return await me(`${this.BASE_URL}/convert-to-pdf`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({excelPath:a,sheets:t})})}catch(r){throw console.error("PDF conversion error:",r),new Error("PDF ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}static async processComplete(a,t){const r=new FormData;r.append("file",a),Object.entries(t).forEach(([l,i])=>{i!==void 0&&(Array.isArray(i)?r.append(l,i.join(",")):r.append(l,i.toString()))});try{return await me(`${this.BASE_URL}/process-complete`,{method:"POST",body:r})}catch(l){throw console.error("Complete process error:",l),new Error("í†µí•© ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}};Ar.BASE_URL="/api/po-template";let tl=Ar;const kt=pc,vt=d.forwardRef(({className:s,...a},t)=>e.jsx(Ql,{ref:t,className:V("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a}));vt.displayName=Ql.displayName;const is=d.forwardRef(({className:s,...a},t)=>e.jsx(Hl,{ref:t,className:V("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a}));is.displayName=Hl.displayName;const hs=d.forwardRef(({className:s,...a},t)=>e.jsx(Wl,{ref:t,className:V("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));hs.displayName=Wl.displayName;const ra=d.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Gl,{ref:r,className:V("relative overflow-hidden",s),...t,children:[e.jsx(jc,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(di,{}),e.jsx(gc,{})]}));ra.displayName=Gl.displayName;const di=d.forwardRef(({className:s,orientation:a="vertical",...t},r)=>e.jsx(Jl,{ref:r,orientation:a,className:V("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(fc,{className:"relative flex-1 rounded-full bg-border"})}));di.displayName=Jl.displayName;const nt=d.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...r},l)=>e.jsx(Yl,{ref:l,decorative:t,orientation:a,className:V("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));nt.displayName=Yl.displayName;function vx(s){return se({queryKey:["/api/orders",s,"email-history"],queryFn:()=>me("GET",`/api/orders/${s}/email-history`),enabled:!!s,staleTime:30*1e3})}function sp({orderId:s,orderNumber:a,isOpen:t,onClose:r,onResend:l}){const{data:i,isLoading:n}=vx(s),c=o=>{switch(o){case"sent":return e.jsx(qt,{className:"h-4 w-4"});case"opened":return e.jsx(yc,{className:"h-4 w-4"});case"clicked":return e.jsx(Pr,{className:"h-4 w-4"});case"failed":return e.jsx(Nc,{className:"h-4 w-4"});case"bounced":return e.jsx(ya,{className:"h-4 w-4"});default:return e.jsx(Ns,{className:"h-4 w-4"})}},g=o=>{const w={sent:{variant:"default",label:"ë°œì†¡ë¨"},opened:{variant:"success",label:"ì—´ëžŒë¨"},clicked:{variant:"secondary",label:"í´ë¦­ë¨"},failed:{variant:"destructive",label:"ì‹¤íŒ¨"},bounced:{variant:"warning",label:"ë°˜ì†¡ë¨"}},p=w[o]||w.sent;return e.jsxs(B,{variant:p.variant,children:[c(o),e.jsx("span",{className:"ml-1",children:p.label})]})};return e.jsx(ze,{open:t,onOpenChange:r,children:e.jsxs(qe,{className:"max-w-4xl max-h-[90vh]",children:[e.jsxs(Ve,{children:[e.jsx(Ke,{children:"ì´ë©”ì¼ ë°œì†¡ ì´ë ¥"}),e.jsxs(Ia,{children:["ë°œì£¼ì„œ ",a,"ì˜ ì´ë©”ì¼ ë°œì†¡ ë‚´ì—­ìž…ë‹ˆë‹¤."]})]}),n?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(lt,{className:"h-6 w-6 animate-spin text-gray-400"})}):i&&i.length>0?e.jsxs(kt,{defaultValue:"0",className:"w-full",children:[e.jsxs(vt,{className:"grid w-full",style:{gridTemplateColumns:`repeat(${Math.min(i.length,5)}, 1fr)`},children:[i.slice(0,5).map((o,w)=>e.jsx(is,{value:w.toString(),children:Le(new Date(o.sentAt),"MM/dd HH:mm")},o.id)),i.length>5&&e.jsxs(is,{value:"more",disabled:!0,children:["+",i.length-5," more"]})]}),i.map((o,w)=>e.jsxs(hs,{value:w.toString(),className:"space-y-4",children:[e.jsxs(L,{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Rs,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ë°œì†¡ ì‹œê°„:"}),e.jsx("span",{className:"font-medium",children:Le(new Date(o.sentAt),"yyyyë…„ MMì›” ddì¼ HH:mm:ss",{locale:Js})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ks,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ë°œì†¡ìž:"}),e.jsxs("span",{className:"font-medium",children:[o.sentByName," (",o.sentByEmail,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ns,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ìˆ˜ì‹ ìž:"}),e.jsx("span",{className:"font-medium",children:o.recipientName?`${o.recipientName} <${o.recipientEmail}>`:o.recipientEmail})]}),o.ccEmails&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ns,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ì°¸ì¡°:"}),e.jsx("span",{className:"font-medium",children:o.ccEmails})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ìƒíƒœ:"}),g(o.status)]}),o.openedAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ls,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-gray-600",children:"ì—´ëžŒ ì‹œê°„:"}),e.jsx("span",{className:"font-medium",children:Le(new Date(o.openedAt),"yyyyë…„ MMì›” ddì¼ HH:mm:ss",{locale:Js})})]}),o.clickedAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Pr,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"text-gray-600",children:"í´ë¦­ ì‹œê°„:"}),e.jsx("span",{className:"font-medium",children:Le(new Date(o.clickedAt),"yyyyë…„ MMì›” ddì¼ HH:mm:ss",{locale:Js})})]}),o.errorMessage&&e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(ya,{className:"h-4 w-4 text-red-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì˜¤ë¥˜ ë©”ì‹œì§€:"}),e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.errorMessage})]})]})]})]}),o.attachments&&o.attachments.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Qt,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ì²¨ë¶€ íŒŒì¼:"})]}),e.jsx("div",{className:"space-y-1",children:o.attachments.map((p,m)=>e.jsxs("div",{className:"text-sm text-gray-700",children:[p.filename," (",(p.size/1024/1024).toFixed(2)," MB)"]},m))})]})]}),e.jsxs(L,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"ì œëª©"}),e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:o.subject}),e.jsx(nt,{}),e.jsx("h4",{className:"font-medium mt-4 mb-2",children:"ë‚´ìš©"}),e.jsx(ra,{className:"h-[300px] w-full rounded-md border p-4",children:e.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:o.body}})})]}),l&&o.status==="failed"&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>l(o.id),children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"ìž¬ë°œì†¡"]})})]},o.id))]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ns,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"ì´ë©”ì¼ ë°œì†¡ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."})]})]})})}function oi({orderId:s}){const{toast:a}=Ze(),t=us(),[r,l]=d.useState(!1),[i,n]=d.useState(null),{data:c=[],isLoading:g}=se({queryKey:["/api/invoices",s],queryFn:async()=>await(await me("GET",`/api/invoices?orderId=${s}`)).json()}),{data:o=[]}=se({queryKey:["/api/verification-logs",s],queryFn:async()=>await(await me("GET",`/api/verification-logs?orderId=${s}`)).json()}),w=Ce({mutationFn:async v=>{const F=await fetch("/api/invoices",{method:"POST",body:v});if(!F.ok)throw new Error("Failed to upload invoice");return F.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["/api/invoices",s]}),t.invalidateQueries({queryKey:["/api/verification-logs",s]}),l(!1),n(null),a({title:"ì„±ê³µ",description:"ì²­êµ¬ì„œê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{a({title:"ì˜¤ë¥˜",description:"ì²­êµ¬ì„œ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),p=Ce({mutationFn:async v=>await(await me("POST",`/api/invoices/${v}/verify`)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/invoices",s]}),t.invalidateQueries({queryKey:["/api/verification-logs",s]}),a({title:"ì„±ê³µ",description:"ì²­êµ¬ì„œê°€ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{a({title:"ì˜¤ë¥˜",description:"ì²­êµ¬ì„œ ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),m=Ce({mutationFn:async v=>await(await me("POST",`/api/invoices/${v}/issue-tax`)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/invoices",s]}),a({title:"ì„±ê³µ",description:"ì„¸ê¸ˆê³„ì‚°ì„œê°€ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{a({title:"ì˜¤ë¥˜",description:"ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),f=Ce({mutationFn:async v=>await(await me("POST",`/api/invoices/${v}/cancel-tax`)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/invoices",s]}),a({title:"ì„±ê³µ",description:"ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{a({title:"ì˜¤ë¥˜",description:"ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),T=v=>{v.preventDefault();const F=new FormData(v.currentTarget);F.set("orderId",s.toString()),i&&F.set("file",i),w.mutate(F)},O=v=>{switch(v){case"pending":return e.jsx(B,{variant:"secondary",children:"ê²€í† ì¤‘"});case"verified":return e.jsx(B,{variant:"default",children:"ê²€ì¦ì™„ë£Œ"});case"paid":return e.jsx(B,{variant:"outline",children:"ì§€ê¸‰ì™„ë£Œ"});default:return e.jsx(B,{variant:"secondary",children:v})}},E=v=>{switch(v){case"invoice":return e.jsx(B,{variant:"outline",children:"ì²­êµ¬ì„œ"});case"tax_invoice":return e.jsx(B,{variant:"outline",children:"ì„¸ê¸ˆê³„ì‚°ì„œ"});default:return e.jsx(B,{variant:"outline",children:v})}};return g?e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"ì²­êµ¬ì„œ ê´€ë¦¬"]})}),e.jsx(q,{children:e.jsx("div",{className:"text-center py-4",children:"ë¡œë”© ì¤‘..."})})]}):e.jsxs(L,{children:[e.jsx(H,{className:"pb-2",children:e.jsxs(W,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ye,{className:"h-4 w-4"}),"ì²­êµ¬ì„œ ê´€ë¦¬"]}),e.jsxs(ze,{open:r,onOpenChange:l,children:[e.jsx(Ls,{asChild:!0,children:e.jsxs(b,{size:"sm",children:[e.jsx(Vs,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"ì²­êµ¬ì„œ ì—…ë¡œë“œ"})]})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ì²­êµ¬ì„œ ì—…ë¡œë“œ"})}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"invoiceNumber",children:"ì²­êµ¬ì„œ ë²ˆí˜¸"}),e.jsx(U,{id:"invoiceNumber",name:"invoiceNumber",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"invoiceType",children:"ìœ í˜•"}),e.jsxs(Z,{name:"invoiceType",defaultValue:"invoice",children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"invoice",children:"ì²­êµ¬ì„œ"}),e.jsx(R,{value:"tax_invoice",children:"ì„¸ê¸ˆê³„ì‚°ì„œ"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"issueDate",children:"ë°œí–‰ì¼"}),e.jsx(U,{id:"issueDate",name:"issueDate",type:"date",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"dueDate",children:"ë§ˆê°ì¼"}),e.jsx(U,{id:"dueDate",name:"dueDate",type:"date"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"totalAmount",children:"ì´ê¸ˆì•¡"}),e.jsx(U,{id:"totalAmount",name:"totalAmount",type:"number",step:"0.01",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"vatAmount",children:"ë¶€ê°€ì„¸"}),e.jsx(U,{id:"vatAmount",name:"vatAmount",type:"number",step:"0.01",defaultValue:"0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"file",children:"ì²¨ë¶€íŒŒì¼"}),e.jsx(U,{id:"file",type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:v=>n(v.target.files?.[0]||null)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"notes",children:"ë©”ëª¨"}),e.jsx(Ge,{id:"notes",name:"notes",rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",disabled:w.isPending,children:w.isPending?"ì—…ë¡œë“œ ì¤‘...":"ì—…ë¡œë“œ"})]})]})]})]})]})}),e.jsxs(q,{className:"p-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"border-2 border-blue-200 rounded-lg p-3 bg-blue-50 dark:bg-blue-900/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ka,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-semibold text-blue-800 dark:text-blue-200",children:"ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ê´€ë¦¬"}),c.length===0?e.jsx(B,{variant:"outline",className:"text-xs border-blue-300 text-blue-700",children:"ì²­êµ¬ì„œ ì—…ë¡œë“œ í•„ìš”"}):c.some(v=>v.taxInvoiceIssued)?e.jsxs(B,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(Er,{className:"h-2 w-2 mr-1"}),"ë°œí–‰ì™„ë£Œ"]}):e.jsx(B,{variant:"secondary",className:"text-xs",children:"ë¯¸ë°œí–‰"})]}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-300",children:c.length===0?"ì²­êµ¬ì„œë¥¼ ë¨¼ì € ì—…ë¡œë“œí•˜ê³  ê²€ì¦í•´ì£¼ì„¸ìš”":c.some(v=>v.status==="verified")?"ë°œí–‰ ì¤€ë¹„ ì™„ë£Œ":"ì²­êµ¬ì„œ ê²€ì¦ í•„ìš”"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600",children:c.length===0?"ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ê´€ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” ì²­êµ¬ì„œë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.":c.some(v=>v.taxInvoiceIssued)?"ì„¸ê¸ˆê³„ì‚°ì„œê°€ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤.":"ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤."}),e.jsx("div",{className:"flex gap-2",children:c.length>0&&c.some(v=>v.status==="verified")?e.jsx(e.Fragment,{children:c.some(v=>v.taxInvoiceIssued)?e.jsxs(b,{size:"sm",variant:"destructive",onClick:()=>{const v=c.find(F=>F.taxInvoiceIssued);v&&f.mutate(v.id)},disabled:f.isPending,children:[e.jsx(ys,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"ë¯¸í™•ì¸"})]}):e.jsxs(b,{size:"sm",variant:"default",onClick:()=>{const v=c.find(F=>F.status==="verified"&&!F.taxInvoiceIssued);v&&m.mutate(v.id)},disabled:m.isPending,children:[e.jsx(ps,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"í™•ì¸"})]})}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",disabled:!0,children:[e.jsx(ps,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"í™•ì¸"})]}),e.jsxs(b,{size:"sm",variant:"outline",disabled:!0,children:[e.jsx(ys,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"ë¯¸í™•ì¸"})]})]})})]})]}),c.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground text-xs",children:"ì•„ì§ ì—…ë¡œë“œëœ ì²­êµ¬ì„œê°€ ì—†ìŠµë‹ˆë‹¤."}):e.jsx("div",{className:"space-y-2",children:c.map(v=>e.jsxs("div",{className:"border rounded-lg p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("h4",{className:"font-medium text-xs",children:v.invoiceNumber}),E(v.invoiceType),O(v.status)]}),v.status==="pending"&&e.jsxs(b,{size:"sm",onClick:()=>p.mutate(v.id),disabled:p.isPending,children:[e.jsx(ps,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"ê²€ì¦"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_s,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("span",{children:["ë°œí–‰ì¼: ",Le(new Date(v.issueDate),"yyyy-MM-dd",{locale:Js})]})]}),v.dueDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_s,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("span",{children:["ë§ˆê°ì¼: ",Le(new Date(v.dueDate),"yyyy-MM-dd",{locale:Js})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xs,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("span",{children:["ì´ì•¡: â‚©",Math.round(v.totalAmount||0).toLocaleString("ko-KR")]})]}),v.vatAmount>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xs,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("span",{children:["ë¶€ê°€ì„¸: â‚©",Math.round(v.vatAmount||0).toLocaleString("ko-KR")]})]})]}),v.notes&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded",children:v.notes}),e.jsxs("div",{className:"border-t pt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ka,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium",children:"ì„¸ê¸ˆê³„ì‚°ì„œ"}),v.taxInvoiceIssued?e.jsxs(B,{variant:"default",className:"text-xs",children:[e.jsx(Er,{className:"h-2 w-2 mr-1"}),"ë°œí–‰ì™„ë£Œ"]}):e.jsx(B,{variant:"secondary",className:"text-xs",children:"ë¯¸ë°œí–‰"})]}),e.jsxs("div",{className:"flex gap-1",children:[v.status==="verified"&&e.jsx(e.Fragment,{children:v.taxInvoiceIssued?e.jsxs(b,{size:"sm",variant:"destructive",onClick:()=>f.mutate(v.id),disabled:f.isPending,children:[e.jsx(ys,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:f.isPending?"ì·¨ì†Œ ì¤‘...":"ë°œí–‰ ì·¨ì†Œ"})]}):e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>m.mutate(v.id),disabled:m.isPending,children:[e.jsx(Ka,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:m.isPending?"ì²˜ë¦¬ ì¤‘...":"ë°œí–‰ í™•ì¸"})]})}),v.status!=="verified"&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"ì²­êµ¬ì„œ ê²€ì¦ í›„ ë°œí–‰ ê°€ëŠ¥"})]})]}),v.status==="verified"&&v.taxInvoiceIssued&&v.taxInvoiceIssuedDate&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-green-50 dark:bg-green-900/20 p-2 rounded",children:["ë°œí–‰ì¼: ",Le(new Date(v.taxInvoiceIssuedDate),"yyyy-MM-dd HH:mm",{locale:Js}),v.taxInvoiceIssuedBy&&` | ë°œí–‰ìž: ${v.taxInvoiceIssuedBy}`]})]}),v.verifiedBy&&v.verifiedAt&&e.jsxs("div",{className:"text-xs text-muted-foreground border-t pt-1",children:["ê²€ì¦ìž: ",v.verifiedBy," | ê²€ì¦ì¼: ",Le(new Date(v.verifiedAt),"yyyy-MM-dd HH:mm",{locale:Js})]})]},v.id))})]}),o.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"font-medium mb-2 text-xs",children:"ê²€ì¦ ë¡œê·¸"}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:o.map(v=>e.jsxs("div",{className:"text-xs p-2 bg-muted rounded",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{children:v.details}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Le(new Date(v.createdAt),"MM-dd HH:mm",{locale:Js})})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:v.performedBy})]},v.id))})]})]})]})}function xi({orderItems:s,orderId:a}){const{toast:t}=Ze(),r=us(),[l,i]=d.useState(!1),[n,c]=d.useState(null),[g,o]=d.useState(!1),[w,p]=d.useState(null),[,m]=d.useState(0),f=Nt(["/api/item-receipts",a],{queryFn:async()=>{const j=await me("GET","/api/item-receipts"),h=s.map(S=>S.id);return j.filter(S=>h.includes(S.orderItemId))},cacheType:"DYNAMIC",enabled:s.length>0}),{data:T=[]}=Nt(["/api/invoices",a],{queryFn:()=>me("GET",`/api/invoices?orderId=${a}`),cacheType:"MASTER",enabled:!!a}),O=Ce({mutationFn:async j=>{console.log("Sending receipt data to API:",j);try{const h=await me("POST","/api/item-receipts",j);return console.log("API response:",h),h}catch(h){throw console.error("API request failed:",h),h}},onSuccess:async j=>{console.log("ðŸ’¥ Receipt creation successful, forcing refetch:",j),r.resetQueries({queryKey:["/api/item-receipts",a]}),r.invalidateQueries({queryKey:["/api/item-receipts"]}),await f.refetch(),m(h=>h+1),r.invalidateQueries({queryKey:["/api/verification-logs",a]}),i(!1),c(null),t({title:"ì„±ê³µ",description:"ìˆ˜ë ¹ í™•ì¸ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:j=>{console.error("Receipt creation mutation error:",j);const h=j?.message||"ìˆ˜ë ¹ í™•ì¸ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";t({title:"ì˜¤ë¥˜",description:h,variant:"destructive"})}}),E=Ce({mutationFn:async j=>{const{id:h,...I}=j;return await(await me("PATCH",`/api/item-receipts/${h}`,I)).json()},onSuccess:async j=>{console.log("ðŸ’¥ Receipt update successful:",j),r.resetQueries({queryKey:["/api/item-receipts",a]}),r.invalidateQueries({queryKey:["/api/item-receipts"]}),await f.refetch(),m(h=>h+1),r.invalidateQueries({queryKey:["/api/verification-logs",a]}),o(!1),p(null),t({title:"ìˆ˜ë ¹ ì •ë³´ ìˆ˜ì • ì™„ë£Œ",description:"ìˆ˜ë ¹ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:j=>{t({title:"ìˆ˜ì • ì‹¤íŒ¨",description:j.message||"ìˆ˜ë ¹ ì •ë³´ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),v=Ce({mutationFn:async j=>await me("DELETE",`/api/item-receipts/${j}`),onSuccess:async()=>{console.log("ðŸ’¥ Receipt deletion successful"),r.resetQueries({queryKey:["/api/item-receipts",a]}),r.invalidateQueries({queryKey:["/api/item-receipts"]}),await f.refetch(),m(j=>j+1),r.invalidateQueries({queryKey:["/api/verification-logs",a]}),t({title:"ìˆ˜ë ¹ ì •ë³´ ì‚­ì œ ì™„ë£Œ",description:"ìˆ˜ë ¹ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:j=>{t({title:"ì‚­ì œ ì‹¤íŒ¨",description:j.message||"ìˆ˜ë ¹ ì •ë³´ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),F=Ce({mutationFn:async j=>{const h=j.map(I=>me("POST","/api/item-receipts",I));return await Promise.all(h)},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/item-receipts"]}),r.invalidateQueries({queryKey:["/api/verification-logs",a]}),t({title:"ì„±ê³µ",description:"ì¼ê´„ ìˆ˜ë ¹ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{t({title:"ì˜¤ë¥˜",description:"ì¼ê´„ ìˆ˜ë ¹ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),_=j=>{j.preventDefault();const h=new FormData(j.currentTarget),I={orderItemId:n.id,invoiceId:h.get("invoiceId")?parseInt(h.get("invoiceId")):void 0,receivedQuantity:parseFloat(h.get("receivedQuantity")),receivedDate:h.get("receivedDate"),qualityCheck:h.get("qualityCheck")==="on",qualityNotes:h.get("qualityNotes")||"",status:h.get("status")||"approved",notes:h.get("notes")||""};console.log("Submitting receipt data:",I),O.mutate(I)},k=j=>{if(j.preventDefault(),!w){t({title:"ì˜¤ë¥˜",description:"ì„ íƒëœ ìˆ˜ë ¹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.",variant:"destructive"});return}const h=new FormData(j.currentTarget),I={id:w.id,receivedQuantity:parseFloat(h.get("receivedQuantity")),receivedDate:h.get("receivedDate"),qualityCheck:h.get("qualityCheck")==="on",qualityNotes:h.get("qualityNotes")||"",status:h.get("status")||"pending",notes:h.get("notes")||""};console.log("Submitting updated receipt data:",I),E.mutate(I)},A=()=>{const j=new Date().toISOString().split("T")[0],h=s.filter(S=>D(S.id)<S.quantity);if(h.length===0){t({title:"ì•Œë¦¼",description:"ëª¨ë“  í•­ëª©ì´ ì´ë¯¸ ìˆ˜ë ¹ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."});return}const I=h.map(S=>({orderItemId:S.id,receivedQuantity:S.quantity-D(S.id),receivedDate:j,qualityCheck:!0,status:"approved",notes:"ì¼ê´„ ìˆ˜ë ¹ ë“±ë¡"}));F.mutate(I)},x=j=>{if(f.status==="error")return console.log(`âŒ Query in error state for item ${j}, triggering fresh fetch`),f.refetch(),[];const h=f.data||[];console.log(`ðŸ” Looking for receipts for item ${j}`),console.log(`ðŸ” Current query data length: ${h.length}`),console.log(`ðŸ” Query status: ${f.status}, isFetching: ${f.isFetching}`);const I=h.filter(S=>S.orderItemId===j);return console.log(`ðŸ“‹ Found ${I.length} receipts for item ${j}:`,I),I},D=j=>{const I=x(j).reduce((S,z)=>{const Q=typeof z.receivedQuantity=="string"?parseFloat(z.receivedQuantity):z.receivedQuantity;return S+(Q||0)},0);return console.log(`ðŸ’¯ Total received for item ${j}: ${I}`),I},u=j=>{const S=(f.data||[]).filter(Q=>Q.orderItemId===j.id).reduce((Q,K)=>{const ne=typeof K.receivedQuantity=="string"?parseFloat(K.receivedQuantity):K.receivedQuantity;return Q+(ne||0)},0),z=j.quantity;return S===0?{status:"pending",label:"ë¯¸ìˆ˜ë ¹",icon:Rs,color:"secondary"}:S<z?{status:"partial",label:"ë¶€ë¶„ìˆ˜ë ¹",icon:it,color:"warning"}:{status:"complete",label:"ìˆ˜ë ¹ì™„ë£Œ",icon:ps,color:"default"}},N=j=>{switch(j){case"pending":return e.jsx(B,{variant:"secondary",children:"ëŒ€ê¸°ì¤‘"});case"approved":return e.jsx(B,{variant:"default",children:"ìŠ¹ì¸ë¨"});case"rejected":return e.jsx(B,{variant:"destructive",children:"ë°˜ë ¤ë¨"});default:return e.jsx(B,{variant:"secondary",children:j})}};return e.jsxs(L,{children:[e.jsx(H,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"flex items-center gap-1 text-sm",children:[e.jsx(Es,{className:"h-4 w-4"}),"ìžìž¬ ìˆ˜ë ¹ í™•ì¸"]}),e.jsxs(b,{onClick:A,disabled:F.isPending,className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[e.jsx(Es,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"ì¼ê´„ ìˆ˜ë ¹ ë“±ë¡"})]})]})}),e.jsxs(q,{className:"p-3",children:[e.jsx("div",{className:"space-y-2",children:s.map(j=>{const h=x(j.id),I=D(j.id),S=u(j),z=S.icon;return e.jsxs("div",{className:"border rounded-lg p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("h4",{className:"font-medium text-xs",children:j.itemName}),e.jsxs(B,{variant:S.color,className:"flex items-center gap-1 text-xs",children:[e.jsx(z,{className:"h-3 w-3"}),S.label]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{children:["ë°œì£¼ìˆ˜ëŸ‰: ",j.quantity.toLocaleString(),j.unit]}),e.jsxs("div",{children:["ìˆ˜ë ¹ìˆ˜ëŸ‰: ",I.toLocaleString(),j.unit]}),e.jsxs("div",{children:["ë¯¸ìˆ˜ë ¹: ",(j.quantity-I).toLocaleString(),j.unit]}),e.jsxs("div",{children:["ë‹¨ê°€: â‚©",Math.round(j.unitPrice||0).toLocaleString("ko-KR")]})]}),j.notes&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:j.notes})]}),e.jsxs(b,{size:"sm",onClick:()=>{c(j),i(!0)},disabled:I>=j.quantity,children:[e.jsx(we,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"ìˆ˜ë ¹ë“±ë¡"})]})]}),h.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("h5",{className:"text-xs font-medium mb-1",children:"ìˆ˜ë ¹ ì´ë ¥"}),e.jsx("div",{className:"space-y-1",children:h.map(Q=>e.jsx("div",{className:"bg-muted p-2 rounded text-xs",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"font-medium text-xs",children:[(typeof Q.receivedQuantity=="string"?parseFloat(Q.receivedQuantity):Q.receivedQuantity).toLocaleString(),j.unit," ìˆ˜ë ¹"]}),N(Q.status),Q.qualityCheck&&e.jsxs(B,{variant:"outline",className:"text-xs",children:[e.jsx(ps,{className:"h-2 w-2 mr-1"}),"í’ˆì§ˆê²€ì‚¬"]})]}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:["ìˆ˜ë ¹ì¼: ",Le(new Date(Q.receivedDate),"yyyy-MM-dd",{locale:Js})]}),Q.qualityNotes&&e.jsxs("div",{className:"text-muted-foreground text-xs",children:["í’ˆì§ˆë©”ëª¨: ",Q.qualityNotes]}),Q.notes&&e.jsxs("div",{className:"text-muted-foreground text-xs",children:["ë©”ëª¨: ",Q.notes]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{size:"sm",variant:"ghost",onClick:()=>{p(Q),o(!0)},className:"h-6 w-6 p-0 hover:bg-blue-50",children:e.jsx(vc,{className:"h-3 w-3 text-blue-600"})}),e.jsx(b,{size:"sm",variant:"ghost",onClick:()=>{confirm("ì´ ìˆ˜ë ¹ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&v.mutate(Q.id)},className:"h-6 w-6 p-0 hover:bg-red-50",disabled:v.isPending,children:e.jsx(Qe,{className:"h-3 w-3 text-red-600"})})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[e.jsxs("div",{children:["ë“±ë¡ìž: ",Q.verifiedBy]}),e.jsx("div",{children:Le(new Date(Q.createdAt),"MM-dd HH:mm",{locale:Js})})]})]})]})},Q.id))})]})]},j.id)})}),e.jsx(ze,{open:l,onOpenChange:i,children:e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìžìž¬ ìˆ˜ë ¹ ë“±ë¡"})}),n&&e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted p-3 rounded",children:[e.jsx("div",{className:"font-medium",children:n.itemName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ë°œì£¼ìˆ˜ëŸ‰: ",n.quantity.toLocaleString(),n.unit," | ìˆ˜ë ¹ê°€ëŠ¥: ",(n.quantity-D(n.id)).toLocaleString(),n.unit]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"receivedQuantity",children:"ìˆ˜ë ¹ ìˆ˜ëŸ‰"}),e.jsx(U,{id:"receivedQuantity",name:"receivedQuantity",type:"number",step:"0.01",max:n.quantity-D(n.id),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"receivedDate",children:"ìˆ˜ë ¹ ì¼ìž"}),e.jsx(U,{id:"receivedDate",name:"receivedDate",type:"date",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"invoiceId",children:"ì—°ê²°ëœ ì²­êµ¬ì„œ (ì„ íƒ)"}),e.jsxs(Z,{name:"invoiceId",children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ì²­êµ¬ì„œ ì„ íƒ"})}),e.jsx(ee,{children:T.map(j=>e.jsxs(R,{value:j.id.toString(),children:[j.invoiceNumber," - â‚©",j.totalAmount.toLocaleString()]},j.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"status",children:"ìƒíƒœ"}),e.jsxs(Z,{name:"status",defaultValue:"pending",children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"pending",children:"ëŒ€ê¸°ì¤‘"}),e.jsx(R,{value:"approved",children:"ìŠ¹ì¸ë¨"}),e.jsx(R,{value:"rejected",children:"ë°˜ë ¤ë¨"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"qualityCheck",name:"qualityCheck"}),e.jsx(P,{htmlFor:"qualityCheck",className:"text-sm",children:"í’ˆì§ˆ ê²€ì‚¬ ì™„ë£Œ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"qualityNotes",children:"í’ˆì§ˆ ê²€ì‚¬ ë©”ëª¨"}),e.jsx(Ge,{id:"qualityNotes",name:"qualityNotes",rows:2,placeholder:"í’ˆì§ˆ ê²€ì‚¬ ê²°ê³¼ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"notes",children:"ì¶”ê°€ ë©”ëª¨"}),e.jsx(Ge,{id:"notes",name:"notes",rows:2,placeholder:"ê¸°íƒ€ ë©”ëª¨ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>i(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",disabled:O.isPending,children:O.isPending?"ë“±ë¡ ì¤‘...":"ë“±ë¡"})]})]})]})}),e.jsx(ze,{open:g,onOpenChange:o,children:e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìˆ˜ë ¹ ì •ë³´ ìˆ˜ì •"})}),w&&e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-3 rounded",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ìˆ˜ë ¹ ê¸°ë¡ ID: ",w.id]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"edit-receivedQuantity",children:"ìˆ˜ë ¹ ìˆ˜ëŸ‰"}),e.jsx(U,{id:"edit-receivedQuantity",name:"receivedQuantity",type:"number",step:"0.01",defaultValue:w.receivedQuantity,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"edit-receivedDate",children:"ìˆ˜ë ¹ ì¼ìž"}),e.jsx(U,{id:"edit-receivedDate",name:"receivedDate",type:"date",defaultValue:new Date(w.receivedDate).toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"edit-status",children:"ìƒíƒœ"}),e.jsxs(Z,{name:"status",defaultValue:w.status,children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"pending",children:"ëŒ€ê¸°ì¤‘"}),e.jsx(R,{value:"approved",children:"ìŠ¹ì¸ë¨"}),e.jsx(R,{value:"rejected",children:"ë°˜ë ¤ë¨"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"edit-qualityCheck",name:"qualityCheck",defaultChecked:w.qualityCheck}),e.jsx(P,{htmlFor:"edit-qualityCheck",className:"text-sm",children:"í’ˆì§ˆ ê²€ì‚¬ ì™„ë£Œ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"edit-qualityNotes",children:"í’ˆì§ˆ ê²€ì‚¬ ë©”ëª¨"}),e.jsx(Ge,{id:"edit-qualityNotes",name:"qualityNotes",rows:2,defaultValue:w.qualityNotes,placeholder:"í’ˆì§ˆ ê²€ì‚¬ ê²°ê³¼ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"edit-notes",children:"ì¶”ê°€ ë©”ëª¨"}),e.jsx(Ge,{id:"edit-notes",name:"notes",rows:2,defaultValue:w.notes,placeholder:"ê¸°íƒ€ ë©”ëª¨ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>o(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",disabled:E.isPending,children:E.isPending?"ìˆ˜ì • ì¤‘...":"ìˆ˜ì • ì™„ë£Œ"})]})]})]})})]})]})}function mi({order:s}){const a=l=>`â‚©${Math.round(l).toLocaleString("ko-KR")}`,t=l=>Le(new Date(l),"yyyyë…„ MMì›” ddì¼"),r=()=>!s.items||s.items.length===0?0:s.items.reduce((l,i)=>{const n=parseFloat(i.quantity)||0,c=parseFloat(i.unitPrice)||0,g=i.totalAmount||n*c,o=parseFloat(g)||0;return l+o},0);return e.jsxs("div",{style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsx("table",{style:{width:"100%",marginBottom:"15px",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{textAlign:"left",borderBottom:"2px solid #333",paddingBottom:"8px"},children:e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"ë°œì£¼ì„œ Purchase Order"})}),e.jsxs("td",{style:{textAlign:"right",borderBottom:"2px solid #333",paddingBottom:"8px",fontSize:"10px",color:"#666"},children:["ë°œì£¼ë²ˆí˜¸: ",s.orderNumber||"PO-2025-0612-001"]})]})})}),e.jsx("table",{style:{width:"100%",marginBottom:"15px",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingRight:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"ë°œì£¼ìž ì •ë³´"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"8px",fontSize:"10px"},children:[e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"íšŒì‚¬ëª…:"})," ë°œì£¼ ì‹œìŠ¤í…œ"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"ë‹´ë‹¹ìž:"})," David Yang"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"ì´ë©”ì¼:"})," davidswyang@gmail.com"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"ì—°ë½ì²˜:"})," 031-000-0000"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ì£¼ì†Œ:"})," ê²½ê¸°ë„ ì„±ë‚¨ì‹œ ë¶„ë‹¹êµ¬"]})]})})})]})}),e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingLeft:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"ê±°ëž˜ì²˜ ì •ë³´"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"8px",fontSize:"10px"},children:[e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"íšŒì‚¬ëª…:"})," ",s.vendor?.name||"ìµì§„íŒŒíŠ¸ë„ˆìŠ¤"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"ì‚¬ì—…ìž:"})," ",s.vendor?.businessNumber||"123-45-67890"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"ë‹´ë‹¹ìž:"})," í™ê¸¸ë™"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[e.jsx("strong",{children:"ì—°ë½ì²˜:"})," 031-000-0000"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ì£¼ì†Œ:"})," ê²½ê¸°ë„ ì„±ë‚¨ì‹œ ë¶„ë‹¹êµ¬"]})]})})})]})})]})})}),e.jsxs("table",{style:{width:"100%",marginBottom:"15px",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"ë°œì£¼ ì •ë³´"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{border:"1px solid #666",padding:"8px"},children:e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsxs("td",{style:{width:"33%",fontSize:"10px",padding:"2px"},children:[e.jsx("strong",{children:"ë°œì£¼ë²ˆí˜¸:"})," ",s.orderNumber||"PO-2025-0612-001"]}),e.jsxs("td",{style:{width:"33%",fontSize:"10px",padding:"2px"},children:[e.jsx("strong",{children:"ë°œì£¼ì¼ìž:"})," ",s.orderDate?t(s.orderDate):"2025ë…„ 06ì›” 12ì¼"]}),e.jsxs("td",{style:{width:"33%",fontSize:"10px",padding:"2px"},children:[e.jsx("strong",{children:"ë‚©ê¸°ì¼ìž:"})," ",s.deliveryDate?t(s.deliveryDate):"2025ë…„ 06ì›” 30ì¼"]})]})})})})})})]}),e.jsxs("table",{style:{width:"100%",marginBottom:"15px",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"ë°œì£¼ í•­ëª©"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{border:"1px solid #666",padding:"0"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8f8f8"},children:[e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"8%"},children:"ìˆœë²ˆ"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"25%"},children:"í’ˆëª©ëª…"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"15%"},children:"ê·œê²©"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"8%"},children:"ìˆ˜ëŸ‰"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"12%"},children:"ë‹¨ê°€"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"12%"},children:"ê¸ˆì•¡"}),e.jsx("th",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center",width:"20%"},children:"ë¹„ê³ "})]})}),e.jsxs("tbody",{children:[s.items&&s.items.length>0?s.items.map((l,i)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:i+1}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px"},children:l.itemName}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:l.specification||"-"}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:parseFloat(l.quantity).toLocaleString()}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"right"},children:a(l.unitPrice)}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"right",fontWeight:"bold"},children:a(l.totalAmount)}),e.jsx("td",{style:{border:"1px solid #666",padding:"4px",fontSize:"10px",textAlign:"center"},children:l.notes||"-"})]},l.id||i)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{border:"1px solid #666",padding:"20px",fontSize:"10px",textAlign:"center",color:"#666"},children:"ë°œì£¼ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤."})}),e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("td",{colSpan:6,style:{border:"1px solid #666",padding:"6px",fontSize:"11px",textAlign:"right",fontWeight:"bold"},children:"ì´ ê¸ˆì•¡:"}),e.jsxs("td",{style:{border:"1px solid #666",padding:"6px",fontSize:"11px",textAlign:"right",fontWeight:"bold"},children:[a(r())," (VAT í¬í•¨)"]})]})]})]})})})})]}),e.jsxs("table",{style:{width:"100%",marginBottom:"15px",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"íŠ¹ì´ì‚¬í•­"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{style:{border:"1px solid #666",padding:"10px",fontSize:"10px",minHeight:"40px"},children:s.notes||"ë³¸ ë°œì£¼ì„œëŠ” ì •ê¸° ë°œì£¼ì— ë”°ë¥¸ ë°œìƒ ê±´ìœ¼ë¡œ, í’ˆì§ˆ ë° ë‚©ê¸°ì¼ì •ì„ ì¤€ìˆ˜í•˜ì—¬ ì£¼ì‹œê¸° ë°”ëžë‹ˆë‹¤."})})})]}),e.jsx("table",{style:{width:"100%",marginBottom:"20px",borderCollapse:"collapse"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingRight:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"ë°œì£¼ìž"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"15px",fontSize:"10px",textAlign:"center"},children:[e.jsxs("div",{style:{marginBottom:"10px"},children:["ë‚ ì§œ: ",s.orderDate?t(s.orderDate):"2025ë…„ 06ì›” 12ì¼"]}),e.jsx("div",{children:"ì„œëª…: _______________"})]})})})]})}),e.jsx("td",{style:{width:"50%",verticalAlign:"top",paddingLeft:"10px"},children:e.jsxs("table",{style:{width:"100%",border:"1px solid #666",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{backgroundColor:"#f0f0f0",border:"1px solid #666",padding:"5px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"ìŠ¹ì¸ìž"})})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsxs("td",{style:{border:"1px solid #666",padding:"15px",fontSize:"10px",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"10px"},children:"ë‚ ì§œ: _______________"}),e.jsx("div",{children:"ì„œëª…: _______________"})]})})})]})})]})})}),e.jsx("div",{style:{marginTop:"20px",paddingTop:"10px",borderTop:"1px solid #999",fontSize:"9px",color:"#666"},children:e.jsx("table",{style:{width:"100%"},children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsxs("td",{style:{textAlign:"left"},children:["ë³¸ ë°œì£¼ì„œëŠ” ìžìž¬ ë°œì£¼ ê´€ë¦¬ ì‹œìŠ¤í…œì—ì„œ ìžë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒì„±ì¼ì‹œ: ",Le(new Date,"yyyyë…„ MMì›” ddì¼ HH:mm")]}),e.jsx("td",{style:{textAlign:"right"},children:"íŽ˜ì´ì§€ 1"})]})})})})]})}function bx(){const{user:s}=os(),{toast:a}=Ze(),[,t]=Je(),r=ht(),[l,i]=d.useState(!1),n=parseInt(r.id),{data:c,isLoading:g}=se({queryKey:[`/api/orders/${n}`],queryFn:()=>me("GET",`/api/orders/${n}`)});console.log("Order detail - full order data:",c),console.log("Order detail - items:",c?.items);const{data:o}=se({queryKey:["/api/order-statuses"]}),w=Ce({mutationFn:async()=>{await me("POST",`/api/orders/${n}/approve`)},onSuccess:()=>{a({title:"ë°œì£¼ì„œ ìŠ¹ì¸",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/orders"]})},onError:F=>{a({title:"ìŠ¹ì¸ ì‹¤íŒ¨",description:F.message,variant:"destructive"})}}),p=Ce({mutationFn:async()=>{await me("POST",`/api/orders/${n}/send`)},onSuccess:()=>{a({title:"ë°œì£¼ì„œ ë°œì†¡",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/orders"]})},onError:F=>{a({title:"ë°œì†¡ ì‹¤íŒ¨",description:F.message,variant:"destructive"})}}),m=F=>{const _=o?.find(x=>x.code===F),k=_?_.name:F,A=x=>{switch(x){case"pending_approval":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"sent":return"bg-blue-100 text-blue-800 border-blue-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium border ${A(F)}`,children:k})},f=()=>{confirm("ì´ ë°œì£¼ì„œë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&w.mutate()},T=()=>{confirm("ì´ ë°œì£¼ì„œë¥¼ ê±°ëž˜ì²˜ì— ë°œì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&p.mutate()};if(g)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-3 py-3",children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})}),e.jsx("div",{className:"px-3 py-3 space-y-2",children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2",children:[...Array(4)].map((F,_)=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},_))}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-48 bg-gray-200 rounded"})]})})]});if(!c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded border border-gray-200 p-6 text-center max-w-md",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 mb-2",children:"ë°œì£¼ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"ìš”ì²­í•˜ì‹  ë°œì£¼ì„œê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."}),e.jsx(b,{onClick:()=>t("/orders"),className:"h-9 px-4 text-sm",children:"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})});const O=s?.role==="admin"&&c.status==="pending_approval",E=c.status==="approved",v=c.status!=="sent"&&c.status!=="received";return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>t("/orders"),className:"no-print h-8 px-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100","aria-label":"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°",children:e.jsx(ns,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:c.orderNumber}),e.jsxs("p",{className:"text-sm text-gray-500",children:[c.vendor?.name," â€¢ ",c.orderDate?Le(new Date(c.orderDate),"MM.dd"):"ë‚ ì§œ ë¯¸ì •"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[m(c.status),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Ee(c.totalAmount)})]})]})]}),e.jsxs("div",{className:"flex gap-1 mt-2 no-print",children:[v&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>t(`/orders/${n}/edit`),className:"h-8 px-2 text-xs",children:[e.jsx(ds,{className:"h-4 w-4 mr-1"}),"ìˆ˜ì •"]}),O&&e.jsxs(b,{size:"sm",onClick:f,disabled:w.isPending,className:"h-8 px-2 text-xs bg-blue-600 hover:bg-blue-700",children:[e.jsx(ps,{className:"h-4 w-4 mr-1"}),"ìŠ¹ì¸"]}),E&&e.jsxs(b,{size:"sm",onClick:T,disabled:p.isPending,className:"h-8 px-2 text-xs bg-blue-600 hover:bg-blue-700",children:[e.jsx(qt,{className:"h-4 w-4 mr-1"}),"ë°œì†¡"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>i(!0),className:"h-8 px-2 text-xs",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),"ë¯¸ë¦¬ë³´ê¸°"]})]})]})}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-4 space-y-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600 block",children:"ì§„í–‰ ìƒíƒœ"}),e.jsx("div",{className:"mt-1",children:m(c.status)})]})})})}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-4 space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600 block",children:"ë°œì£¼ ê¸ˆì•¡"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:Ee(c.totalAmount)})]}),e.jsx(Xs,{className:"h-5 w-5 text-gray-400"})]})})}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-4 space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600 block",children:"í’ˆëª© ìˆ˜"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[c.items?.length||0,"ê°œ"]})]}),e.jsx(Es,{className:"h-5 w-5 text-gray-400"})]})})}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-4 space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600 block",children:"ë‚©ê¸°ì¼"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:c.deliveryDate?Le(new Date(c.deliveryDate),"MM.dd"):"ë¯¸ì •"})]}),e.jsx(_s,{className:"h-5 w-5 text-gray-400"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ì„œ ì •ë³´"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx("span",{className:"font-semibold text-gray-900",children:c.orderNumber})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ë°œì£¼ì¼"}),e.jsx("span",{className:"text-gray-900",children:c.orderDate?Le(new Date(c.orderDate),"yyyy.MM.dd"):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ks,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:c.user?.firstName&&c.user?.lastName?`${c.user.lastName}${c.user.firstName}`:c.user?.email||"ì•Œ ìˆ˜ ì—†ìŒ"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ë‚©ê¸°ì¼"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Rs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:c.deliveryDate?Le(new Date(c.deliveryDate),"yyyy.MM.dd"):"-"})]})]})]}),c.notes&&e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("span",{className:"text-sm text-gray-600 block mb-2",children:"ë¹„ê³ "}),e.jsx("div",{className:"text-sm p-3 bg-gray-50 rounded text-gray-700",children:c.notes})]})]})}),c.vendor&&e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ê±°ëž˜ì²˜ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600 block",children:"ì—…ì²´ëª…"}),e.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-700 cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 rounded transition-all text-left",onClick:()=>c.vendor?.id&&t(`/vendors/${c.vendor.id}`),title:"ê±°ëž˜ì²˜ ìƒì„¸ë³´ê¸°","aria-label":`ê±°ëž˜ì²˜ ${c.vendor.name} ìƒì„¸ë³´ê¸°`,tabIndex:0,onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&(F.preventDefault(),c.vendor?.id&&t(`/vendors/${c.vendor.id}`))},children:c.vendor.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ks,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:c.vendor.contact||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ì „í™”ë²ˆí˜¸"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:c.vendor.phone||"-"})]})]})]}),c.vendor.email&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600 block",children:"ì´ë©”ì¼"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ns,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-900",children:c.vendor.email})]})]}),c.vendor.address&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600 block",children:"ì£¼ì†Œ"}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(St,{className:"h-3 w-3 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-900",children:c.vendor.address})]})]})]})]})}),c.project&&e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"í˜„ìž¥ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600 block",children:"í˜„ìž¥ëª…"}),e.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-700 cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 rounded transition-all text-left",onClick:()=>t(`/projects/${c.project.id}`),title:"í˜„ìž¥ ìƒì„¸ë³´ê¸°","aria-label":`í˜„ìž¥ ${c.project.projectName} ìƒì„¸ë³´ê¸°`,tabIndex:0,onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&(F.preventDefault(),t(`/projects/${c.project.id}`))},children:c.project.projectName}),e.jsxs("span",{className:"text-xs text-gray-500 block",children:["(",c.project.projectCode,")"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ks,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:c.project.projectManager||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block",children:"ìœ„ì¹˜"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(St,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:c.project.location||"-"})]})]})]}),c.project.description&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600 block mb-1",children:"ì„¤ëª…"}),e.jsx("div",{className:"text-xs p-2 bg-gray-50 rounded text-gray-700",children:c.project.description})]})]})]})})]}),e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["ì´ ",c.items?.length||0,"ê°œ í’ˆëª©"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xs text-gray-500 block",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:Ee(c.totalAmount)})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"border-b border-blue-100",children:[e.jsx(oe,{className:"text-xs py-2 px-2 font-medium text-gray-600",children:"í’ˆëª©ëª…"}),e.jsx(oe,{className:"text-xs py-2 px-2 font-medium text-gray-600",children:"ê·œê²©"}),e.jsx(oe,{className:"text-xs text-center py-2 px-2 font-medium text-gray-600",children:"ìˆ˜ëŸ‰"}),e.jsx(oe,{className:"text-xs text-right py-2 px-2 font-medium text-gray-600",children:"ë‹¨ê°€"}),e.jsx(oe,{className:"text-xs text-right py-2 px-2 font-medium text-gray-600",children:"ê¸ˆì•¡"}),e.jsx(oe,{className:"text-xs py-2 px-2 font-medium text-gray-600",children:"ë¹„ê³ "})]})}),e.jsx(tt,{children:c.items?.map((F,_)=>e.jsxs(Me,{className:"border-b border-blue-100 hover:bg-blue-50/30 transition-colors",children:[e.jsx(G,{className:"py-2 px-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Es,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-xs text-gray-900 block",children:F.itemName}),F.specification&&e.jsx("span",{className:"text-xs text-gray-500",children:F.specification})]})]})}),e.jsx(G,{className:"py-2 px-2 text-xs text-gray-700",children:F.specification||"-"}),e.jsx(G,{className:"text-center py-2 px-2",children:e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:typeof F.quantity=="number"?F.quantity.toLocaleString():F.quantity||"-"})}),e.jsx(G,{className:"text-right py-2 px-2 font-medium text-xs text-blue-600",children:Ee(F.unitPrice)}),e.jsx(G,{className:"text-right py-2 px-2",children:e.jsx("span",{className:"font-semibold text-xs text-blue-600",children:Ee(F.totalAmount)})}),e.jsx(G,{className:"py-2 px-2 text-xs text-gray-700",children:F.notes||"-"})]},_))})]})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"bg-gray-50 rounded p-2 min-w-[140px]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:Ee(c.totalAmount)})]})})})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx(oi,{orderId:n})}),c.items&&c.items.length>0&&e.jsx("div",{children:e.jsx(xi,{orderItems:c.items,orderId:n})})]}),c.attachments&&c.attachments.length>0&&e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Aa,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["ì´ ",c.attachments.length,"ê°œ íŒŒì¼"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:c.attachments.map(F=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded hover:border-gray-300 hover:bg-gray-50 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx(ye,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-900 truncate block",title:F.filename,children:F.filename}),e.jsx("span",{className:"text-xs text-gray-500",children:"ì²¨ë¶€íŒŒì¼"})]})]}),e.jsxs(b,{variant:"outline",size:"sm",className:"ml-2 flex-shrink-0 h-7 px-2 text-xs",children:[e.jsx(Ts,{className:"h-3 w-3 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]})]},F.id))})]})}),e.jsx(ze,{open:l,onOpenChange:i,children:e.jsxs(qe,{className:"max-w-[1366px] max-h-[90vh] overflow-y-auto",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-gray-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx("span",{className:"text-xs text-gray-500 block",children:c?.orderNumber})]})]}),e.jsx("div",{className:"flex space-x-1",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const F=window.open("","_blank");F&&(F.document.write(`
                          <html>
                            <head>
                              <title>ë°œì£¼ì„œ - ${c?.orderNumber}</title>
                              <style>
                                body { margin: 0; font-family: Arial, sans-serif; }
                                @media print {
                                  body { margin: 0; }
                                  .no-print { display: none !important; }
                                }
                              </style>
                            </head>
                            <body>
                              ${document.querySelector(".order-preview-content")?.innerHTML||""}
                            </body>
                          </html>
                        `),F.document.close(),F.print())},className:"h-8 px-2 text-xs",children:[e.jsx(Vt,{className:"h-4 w-4 mr-1"}),"PDF ì¶œë ¥"]})})]})}),e.jsx("div",{className:"order-preview-content mt-2",children:c&&e.jsx(mi,{order:c})})]})})]})]})})}const wx=Object.freeze(Object.defineProperty({__proto__:null,default:bx},Symbol.toStringTag,{value:"Module"}));function tp({label:s,name:a,value:t="",onChange:r,onBlur:l,type:i="text",placeholder:n,required:c=!1,disabled:g=!1,readOnly:o=!1,error:w,success:p,helperText:m,tooltip:f,autoComplete:T,maxLength:O,rows:E=3,validating:v=!1,autoSave:F=!1,onAutoSave:_,className:k,labelClassName:A,inputClassName:x}){const[D,u]=d.useState(!1),[N,j]=d.useState(null),[h,I]=d.useState(!1),S=`field-${a}`,z=!!w,Q=p&&!z;d.useEffect(()=>{if(F&&t&&_){N&&clearTimeout(N);const ne=setTimeout(async()=>{I(!0),await _(),I(!1)},1500);j(ne)}return()=>{N&&clearTimeout(N)}},[t,F,_]);const K=()=>{const ne={id:S,name:a,value:t,onChange:Se=>r?.(Se.target.value),onBlur:l,placeholder:n,required:c,disabled:g,readOnly:o,autoComplete:T,maxLength:O,className:V("transition-all duration-200",z&&"border-red-500 focus:border-red-500 focus:ring-red-500",Q&&"border-green-500 focus:border-green-500 focus:ring-green-500",x),"aria-invalid":z,"aria-describedby":z?`${S}-error`:m?`${S}-helper`:void 0};return i==="textarea"?e.jsx(Ge,{...ne,rows:E,className:V(ne.className,"resize-none")}):i==="password"?e.jsxs("div",{className:"relative",children:[e.jsx(U,{...ne,type:D?"text":"password",className:V(ne.className,"pr-10")}),e.jsx("button",{type:"button",onClick:()=>u(!D),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors",tabIndex:-1,children:D?e.jsx(Dl,{className:"h-4 w-4"}):e.jsx(ls,{className:"h-4 w-4"})})]}):e.jsx(U,{...ne,type:i})};return e.jsxs("div",{className:V("space-y-2",k),children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(P,{htmlFor:S,className:V("text-sm font-medium",z&&"text-red-600",Q&&"text-green-600",A),children:[s,c&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),f&&e.jsx(pt,{children:e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(Ms,{className:"h-3.5 w-3.5 text-gray-400 cursor-help"})}),e.jsx(Fs,{children:e.jsx("p",{className:"max-w-xs text-sm",children:f})})]})}),F&&h&&e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-xs text-gray-500",children:[e.jsx($s,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"ì €ìž¥ ì¤‘..."})]})]}),e.jsxs("div",{className:"relative",children:[K(),(v||z||Q)&&i!=="password"&&e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:[v&&e.jsx($s,{className:"h-4 w-4 animate-spin text-gray-400"}),z&&!v&&e.jsx(Be,{className:"h-4 w-4 text-red-500"}),Q&&!v&&e.jsx(dt,{className:"h-4 w-4 text-green-500"})]})]}),(m||z)&&e.jsx("div",{id:z?`${S}-error`:`${S}-helper`,className:V("text-sm",z?"text-red-600":"text-gray-500"),role:z?"alert":void 0,children:z?w:m}),i==="textarea"&&O&&e.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[t.length," / ",O]})]})}function ap({label:s,name:a,value:t="",onChange:r,onBlur:l,options:i,placeholder:n="ì„ íƒí•˜ì„¸ìš”",required:c=!1,disabled:g=!1,error:o,success:w,helperText:p,tooltip:m,validating:f=!1,className:T,labelClassName:O,selectClassName:E}){const v=`field-${a}`,F=!!o,_=w&&!F;return e.jsxs("div",{className:V("space-y-2",T),children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(P,{htmlFor:v,className:V("text-sm font-medium",F&&"text-red-600",_&&"text-green-600",O),children:[s,c&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),m&&e.jsx(pt,{children:e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(Ms,{className:"h-3.5 w-3.5 text-gray-400 cursor-help"})}),e.jsx(Fs,{children:e.jsx("p",{className:"max-w-xs text-sm",children:m})})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(Z,{value:t,onValueChange:r,disabled:g,required:c,children:[e.jsx(Y,{id:v,onBlur:l,className:V("transition-all duration-200",F&&"border-red-500 focus:border-red-500 focus:ring-red-500",_&&"border-green-500 focus:border-green-500 focus:ring-green-500",E),"aria-invalid":F,"aria-describedby":F?`${v}-error`:p?`${v}-helper`:void 0,children:e.jsx(X,{placeholder:n})}),e.jsx(ee,{children:i.map(k=>e.jsx(R,{value:k.value,disabled:k.disabled,children:k.label},k.value))})]}),(f||F||_)&&e.jsxs("div",{className:"absolute right-10 top-1/2 -translate-y-1/2 pointer-events-none",children:[f&&e.jsx($s,{className:"h-4 w-4 animate-spin text-gray-400"}),F&&!f&&e.jsx(Be,{className:"h-4 w-4 text-red-500"}),_&&!f&&e.jsx(dt,{className:"h-4 w-4 text-green-500"})]})]}),(p||F)&&e.jsx("div",{id:F?`${v}-error`:`${v}-helper`,className:V("text-sm",F?"text-red-600":"text-gray-500"),role:F?"alert":void 0,children:F?o:p})]})}function Cx(){const{user:s}=os(),{toast:a}=Ze(),[,t]=Je(),[r,l]=d.useState(!1),[i,n]=d.useState(null),[c,g]=d.useState(""),[o,w]=d.useState(null),[p,m]=d.useState("asc"),[f,T]=d.useState("table"),{data:O,isLoading:E}=se({queryKey:["/api/vendors"]}),v=d.useMemo(()=>{if(!O||!Array.isArray(O))return[];let N=O;if(c.trim()){const j=c.toLowerCase();N=O.filter(h=>h.name?.toLowerCase().includes(j)||h.businessNumber?.includes(j)||h.industry?.toLowerCase().includes(j)||h.contactPerson?.toLowerCase().includes(j)||h.phone?.includes(j)||h.email?.toLowerCase().includes(j)||h.aliases&&Array.isArray(h.aliases)&&h.aliases.some(I=>I.toLowerCase().includes(j)))}return o&&(N=[...N].sort((j,h)=>{let I=j[o],S=h[o];return I==null&&(I=""),S==null&&(S=""),I=String(I).toLowerCase(),S=String(S).toLowerCase(),p==="asc"?I.localeCompare(S):S.localeCompare(I)})),N},[O,c,o,p]),F=Ce({mutationFn:async N=>{await me("DELETE",`/api/vendors/${N}`)},onSuccess:()=>{a({title:"ì„±ê³µ",description:"ê±°ëž˜ì²˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/vendors"]})},onError:N=>{if(N.status===401){a({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{t("/login")},500);return}a({title:"ì˜¤ë¥˜",description:"ê±°ëž˜ì²˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),_=N=>{o===N?m(p==="asc"?"desc":"asc"):(w(N),m("asc"))},k=N=>o!==N?null:p==="asc"?e.jsx(zt,{className:"h-4 w-4"}):e.jsx(Zs,{className:"h-4 w-4"}),A=()=>{n(null),l(!0)},x=N=>{n(N),l(!0)},D=N=>{confirm("ì •ë§ë¡œ ì´ ê±°ëž˜ì²˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&F.mutate(N)},u=()=>{l(!1),n(null),rs.invalidateQueries({queryKey:["/api/vendors"]})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ê±°ëž˜ì²˜ ê´€ë¦¬"}),s?.role==="admin"&&e.jsxs(b,{onClick:A,className:"bg-blue-600 hover:bg-blue-700 text-white shadow-sm",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"ê±°ëž˜ì²˜ ì¶”ê°€"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê±°ëž˜ì²˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"ê²€ìƒ‰"}),e.jsxs("div",{className:"relative",children:[e.jsx(yt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(U,{placeholder:"ê±°ëž˜ì²˜ëª…, ì‚¬ì—…ìžë²ˆí˜¸ë¡œ ê²€ìƒ‰...",value:c,onChange:N=>g(N.target.value),className:`pl-8 h-10 text-sm ${c?"border-blue-500 bg-blue-50":""}`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[v.length,"ê°œ ê±°ëž˜ì²˜"]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(b,{variant:f==="table"?"default":"ghost",size:"sm",onClick:()=>T("table"),className:"h-8 w-8 p-0",title:"ëª©ë¡ ë³´ê¸°",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx(b,{variant:f==="cards"?"default":"ghost",size:"sm",onClick:()=>T("cards"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(gt,{className:"h-4 w-4"})})]})]})]})})})}),f==="table"?e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"border-b border-gray-200",children:[e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>_("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ê±°ëž˜ì²˜ëª…"}),k("name")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>_("businessNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ì‚¬ì—…ìžë²ˆí˜¸"}),k("businessNumber")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>_("industry"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ì—…ì¢…"}),k("industry")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>_("contactPerson"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ë‹´ë‹¹ìž"}),k("contactPerson")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>_("phone"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ì—°ë½ì²˜"}),k("phone")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>_("createdAt"),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"ë“±ë¡ì¼"}),k("createdAt")]})}),s?.role==="admin"&&e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 text-right",children:"ê´€ë¦¬"})]})}),e.jsx(tt,{children:E?[...Array(5)].map((N,j)=>e.jsxs(Me,{children:[e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),s?.role==="admin"&&e.jsx(G,{})]},j)):v.length===0?e.jsx(Me,{children:e.jsx(G,{colSpan:s?.role==="admin"?7:6,className:"text-center py-6 text-sm text-gray-500",children:c?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ ê±°ëž˜ì²˜ê°€ ì—†ìŠµë‹ˆë‹¤"})}):v.map(N=>e.jsxs(Me,{className:"hover:bg-gray-50 border-b border-gray-100",children:[e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-700 overflow-hidden text-ellipsis whitespace-nowrap",onClick:()=>t(`/vendors/${N.id}`),title:N.name,children:N.name})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:N.businessNumber||"-"})}),e.jsx(G,{className:"py-4 px-6",children:N.industry?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-800",children:N.industry}):e.jsx("span",{className:"text-sm text-gray-900",children:"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:N.contactPerson||"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:N.phone||"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:Ds(N.createdAt)})}),s?.role==="admin"&&e.jsx(G,{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>x(N),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>D(N.id),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})})]},N.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2",children:E?[...Array(6)].map((N,j)=>e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-1/2"})]})})},j)):v.length===0?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx(Ws,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ë“±ë¡ëœ ê±°ëž˜ì²˜ê°€ ì—†ìŠµë‹ˆë‹¤."})]}):v.map(N=>e.jsxs(L,{className:"p-3 hover:shadow-md transition-shadow shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ws,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 cursor-pointer hover:text-blue-600",onClick:()=>t(`/vendors/${N.id}`),children:N.name}),N.industry&&e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-800 mt-1",children:N.industry})]})]}),e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs ${N.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:N.isActive?"í™œì„±":"ë¹„í™œì„±"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(Ct,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{className:"ml-1",children:N.businessNumber||"-"})]}),N.contactPerson&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(ks,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ë‹´ë‹¹ìž:"}),e.jsx("span",{className:"ml-1",children:N.contactPerson})]}),N.phone&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(Ot,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ì „í™”ë²ˆí˜¸:"}),e.jsx("span",{className:"ml-1",children:N.phone})]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:e.jsxs("span",{children:["ë“±ë¡ì¼: ",Ds(N.createdAt)]})}),s?.role==="admin"&&e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>x(N),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>D(N.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})]},N.id))}),r&&e.jsx(ld,{isOpen:r,vendor:i,onClose:()=>l(!1),onSuccess:u})]})})}const Sx=Object.freeze(Object.defineProperty({__proto__:null,default:Cx},Symbol.toStringTag,{value:"Module"})),Gt=bc,da=wc,kx=Cc,hi=d.forwardRef(({className:s,...a},t)=>e.jsx(Zl,{className:V("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));hi.displayName=Zl.displayName;const Ft=d.forwardRef(({className:s,...a},t)=>e.jsxs(kx,{children:[e.jsx(hi,{}),e.jsx(Xl,{ref:t,className:V("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a})]}));Ft.displayName=Xl.displayName;const Mt=({className:s,...a})=>e.jsx("div",{className:V("flex flex-col space-y-2 text-center sm:text-left",s),...a});Mt.displayName="AlertDialogHeader";const $t=({className:s,...a})=>e.jsx("div",{className:V("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});$t.displayName="AlertDialogFooter";const Rt=d.forwardRef(({className:s,...a},t)=>e.jsx(en,{ref:t,className:V("text-lg font-semibold",s),...a}));Rt.displayName=en.displayName;const Lt=d.forwardRef(({className:s,...a},t)=>e.jsx(sn,{ref:t,className:V("text-sm text-muted-foreground",s),...a}));Lt.displayName=sn.displayName;const Jt=d.forwardRef(({className:s,...a},t)=>e.jsx(tn,{ref:t,className:V(ca(),s),...a}));Jt.displayName=tn.displayName;const Yt=d.forwardRef(({className:s,...a},t)=>e.jsx(an,{ref:t,className:V(ca({variant:"outline"}),"mt-2 sm:mt-0",s),...a}));Yt.displayName=an.displayName;function _x(){const{user:s,isAuthenticated:a,isLoading:t}=os(),{toast:r}=Ze(),[,l]=Je(),i=us(),[n,c]=Sn("/vendors/:id"),g=c?.id?parseInt(c.id):0,{data:o,isLoading:w}=se({queryKey:[`/api/vendors/${g}`],enabled:!!s}),{data:p,isLoading:m}=se({queryKey:[`/api/orders/vendor/${g}`],queryFn:async()=>{const E=new URLSearchParams;E.append("vendorId",g.toString()),E.append("limit","1000");const v=`/api/orders?${E.toString()}`,F=await fetch(v,{credentials:"include"});if(!F.ok)throw new Error(`${F.status}: ${F.statusText}`);return await F.json()},enabled:!!s}),f=Ce({mutationFn:async()=>{const E=await fetch(`/api/vendors/${g}`,{method:"DELETE"});if(!E.ok)throw new Error(`${E.status}: ${E.statusText}`);return E.json()},onSuccess:()=>{r({title:"ì„±ê³µ",description:"ê±°ëž˜ì²˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),i.invalidateQueries({queryKey:["/api/vendors"]}),l("/vendors")},onError:E=>{if(Ht(E)){r({title:"ê¶Œí•œ ì—†ìŒ",description:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",variant:"destructive"}),setTimeout(()=>{l("/login")},500);return}r({title:"ì˜¤ë¥˜",description:"ê±°ëž˜ì²˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì—°ê²°ëœ ë°œì£¼ì„œê°€ ìžˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.",variant:"destructive"})}});d.useEffect(()=>{if(!t&&!a){r({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{l("/login")},500);return}},[a,t,r]);const T=()=>{f.mutate()};if(t||!s)return e.jsx("div",{children:"Loading..."});if(w)return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})});if(!o)return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"ê±°ëž˜ì²˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(b,{onClick:()=>l("/vendors"),children:"ê±°ëž˜ì²˜ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})});const O=p?.orders||[];return o?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>l("/vendors"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëª©ë¡"]}),e.jsx(Ws,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"ê±°ëž˜ì²˜ ìƒì„¸ ì •ë³´"})]}),e.jsx(B,{variant:o.isActive?"default":"secondary",children:o.isActive?"í™œì„±":"ë¹„í™œì„±"})]}),e.jsx("div",{className:"flex space-x-2",children:s?.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>l(`/vendors/${g}/edit`),children:[e.jsx(ds,{className:"h-3 w-3 mr-1"}),"ìˆ˜ì •"]}),e.jsxs(Gt,{children:[e.jsx(da,{asChild:!0,children:e.jsxs(b,{variant:"destructive",size:"sm",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),"ì‚­ì œ"]})}),e.jsxs(Ft,{children:[e.jsxs(Mt,{children:[e.jsx(Rt,{children:"ê±°ëž˜ì²˜ ì‚­ì œ"}),e.jsxs(Lt,{children:['ì •ë§ë¡œ "',o.name,'" ê±°ëž˜ì²˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',e.jsx("br",{}),"ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©°, ì—°ê²°ëœ ë°œì£¼ì„œê°€ ìžˆëŠ” ê²½ìš° ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs($t,{children:[e.jsx(Yt,{children:"ì·¨ì†Œ"}),e.jsx(Jt,{onClick:T,disabled:f.isPending,className:"bg-red-600 hover:bg-red-700",children:f.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-3",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(cs,{className:"h-5 w-5 mr-2 text-blue-600"}),"ê¸°ë³¸ ì •ë³´"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),"ê±°ëž˜ì²˜ëª…"]}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:o.name})]}),o.businessNumber&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),"ì‚¬ì—…ìžë²ˆí˜¸"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.businessNumber})]}),o.industry&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"ì—…ì¢…"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.industry})]}),o.contactPerson&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(ks,{className:"h-4 w-4 mr-1"}),"ë‹´ë‹¹ìž"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.contactPerson})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-3",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(Ot,{className:"h-5 w-5 mr-2 text-blue-600"}),"ì—°ë½ì²˜ ì •ë³´"]})}),e.jsxs(q,{className:"space-y-4",children:[o.phone&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(Ot,{className:"h-4 w-4 mr-1"}),"ì „í™”ë²ˆí˜¸"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.phone})]}),o.email&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(Ns,{className:"h-4 w-4 mr-1"}),"ì´ë©”ì¼"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.email})]}),o.address&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(St,{className:"h-4 w-4 mr-1"}),"ì£¼ì†Œ"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.address})]}),o.memo&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 mb-1",children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),"ë©”ëª¨"]}),e.jsx("p",{className:"text-sm text-gray-900",children:o.memo})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-3",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(Al,{className:"h-5 w-5 mr-2 text-blue-600"}),"ìµœê·¼ ë°œì£¼ì„œ"]})}),e.jsx(q,{children:m?e.jsx("div",{className:"animate-pulse space-y-3",children:[...Array(3)].map((E,v)=>e.jsx("div",{className:"h-12 bg-gray-200 rounded"},v))}):O.length>0?e.jsxs("div",{className:"space-y-3",children:[O.slice(0,5).map(E=>e.jsx("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>l(`/orders/${E.id}`),children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:E.orderNumber}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(E.orderDate).toLocaleDateString("ko-KR")})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{variant:E.status==="approved"?"default":"secondary",className:"text-xs",children:ri(E.status)}),e.jsxs("p",{className:"text-sm font-medium text-blue-600",children:["â‚©",Math.round(E.totalAmount||0).toLocaleString("ko-KR")]})]})]})})},E.id)),O.length>5&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>l(`/orders?vendor=${g}`),className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:["ëª¨ë“  ë°œì£¼ì„œ ë³´ê¸° (",O.length,"ê°œ)"]})})]}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤."})})]})]})]})}):null}const Dx=Object.freeze(Object.defineProperty({__proto__:null,default:_x},Symbol.toStringTag,{value:"Module"}));function rp({isOpen:s,onClose:a,validationData:t,onConfirm:r}){const[l,i]=d.useState(new Map),[n,c]=d.useState(new Map),[g,o]=d.useState("vendors"),w=t.vendorValidations.filter(_=>!_.exists),p=t.deliveryValidations.filter(_=>!_.exists),m=t.emailConflicts.filter(_=>_.type==="conflict"),f=(_,k,A,x)=>{const D=`${k}-${_}`,u={originalName:_,type:k,action:A,existingVendorId:x};i(N=>new Map(N.set(D,u)))},T=(_,k,A)=>{const x=`${k}-${_}`;c(u=>new Map(u.set(x,A)));const D={originalName:_,type:k,action:"create_new",newVendorData:A};i(u=>new Map(u.set(x,D)))},O=()=>{const _=Array.from(l.values());r(_),a()},E=()=>{const _=w.length+p.length;return l.size>=_},v=(_,k)=>{const A=`${k}-${_.vendorName}`,x=l.get(A),D=n.get(A)||{name:_.vendorName,email:"",contactPerson:"",phone:""};return e.jsxs(L,{className:"mb-4",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{className:"text-lg",children:_.vendorName}),e.jsxs(jt,{children:[e.jsx(B,{variant:"outline",children:k}),e.jsx("span",{className:"ml-2",children:"ë“±ë¡ë˜ì§€ ì•Šì€ ì—…ì²´"})]})]}),e.jsx(Be,{className:"h-5 w-5 text-amber-500"})]})}),e.jsxs(q,{children:[_.suggestions.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs(P,{className:"text-sm font-medium",children:["ìœ ì‚¬í•œ ì—…ì²´ (",_.suggestions.length,"ê°œ)"]}),e.jsx("div",{className:"mt-2 space-y-2",children:_.suggestions.map(u=>e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${x?.action==="use_existing"&&x?.existingVendorId===u.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(_.vendorName,k,"use_existing",u.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsx("div",{className:"text-sm text-gray-600",children:u.email}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ë‹´ë‹¹ìž: ",u.contactPerson]})]}),e.jsxs(B,{variant:"secondary",children:[(u.similarity*100).toFixed(0),"% ìœ ì‚¬"]})]})},u.id))})]}),e.jsx(nt,{className:"my-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(b,{variant:x?.action==="create_new"?"default":"outline",size:"sm",onClick:()=>f(_.vendorName,k,"create_new"),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"ì‹ ê·œ ë“±ë¡"]}),e.jsx(b,{variant:x?.action==="skip"?"default":"outline",size:"sm",onClick:()=>f(_.vendorName,k,"skip"),children:"ê±´ë„ˆë›°ê¸°"})]}),x?.action==="create_new"&&e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx(P,{className:"text-sm font-medium mb-3 block",children:"ì‹ ê·œ ì—…ì²´ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:`name-${A}`,children:"ì—…ì²´ëª…"}),e.jsx(U,{id:`name-${A}`,value:D.name,onChange:u=>{const N={...D,name:u.target.value};c(j=>new Map(j.set(A,N))),T(_.vendorName,k,N)}})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:`email-${A}`,children:"ì´ë©”ì¼ *"}),e.jsx(U,{id:`email-${A}`,type:"email",value:D.email,onChange:u=>{const N={...D,email:u.target.value};c(j=>new Map(j.set(A,N))),T(_.vendorName,k,N)},required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:`contact-${A}`,children:"ë‹´ë‹¹ìžëª… *"}),e.jsx(U,{id:`contact-${A}`,value:D.contactPerson,onChange:u=>{const N={...D,contactPerson:u.target.value};c(j=>new Map(j.set(A,N))),T(_.vendorName,k,N)},required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:`phone-${A}`,children:"ì—°ë½ì²˜"}),e.jsx(U,{id:`phone-${A}`,value:D.phone,onChange:u=>{const N={...D,phone:u.target.value};c(j=>new Map(j.set(A,N))),T(_.vendorName,k,N)}})]})]})]})]})]})]},A)},F=_=>e.jsxs(L,{className:"mb-4",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{className:"text-lg",children:_.vendorName}),e.jsx(jt,{children:"ì´ë©”ì¼ ì£¼ì†Œ ë¶ˆì¼ì¹˜"})]}),e.jsx(Be,{className:"h-5 w-5 text-red-500"})]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium",children:"ì—‘ì…€ íŒŒì¼ì˜ ì´ë©”ì¼"}),e.jsx("div",{className:"p-2 bg-blue-50 rounded border",children:_.excelEmail})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium",children:"ë°ì´í„°ë² ì´ìŠ¤ì˜ ì´ë©”ì¼"}),e.jsx("div",{className:"p-2 bg-gray-50 rounded border",children:_.dbEmail})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{variant:"outline",size:"sm",children:"ì—‘ì…€ ì´ë©”ì¼ ì‚¬ìš©"}),e.jsx(b,{variant:"outline",size:"sm",children:"DB ì´ë©”ì¼ ì‚¬ìš©"})]})]})})]},`conflict-${_.vendorName}`);return e.jsx(ze,{open:s,onOpenChange:a,children:e.jsxs(qe,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ê±°ëž˜ì²˜/ë‚©í’ˆì²˜ ê²€ì¦ ê²°ê³¼"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{className:"text-lg",children:"ê²€ì¦ ìš”ì•½"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:t.summary.unregisteredVendors}),e.jsx("div",{className:"text-sm text-gray-600",children:"ë¯¸ë“±ë¡ ê±°ëž˜ì²˜"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:t.summary.unregisteredDeliveries}),e.jsx("div",{className:"text-sm text-gray-600",children:"ë¯¸ë“±ë¡ ë‚©í’ˆì²˜"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.summary.emailConflicts}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì´ë©”ì¼ ì¶©ëŒ"})]})]})})]}),e.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[e.jsxs(b,{variant:g==="vendors"?"default":"ghost",size:"sm",onClick:()=>o("vendors"),className:"flex-1",children:["ë¯¸ë“±ë¡ ê±°ëž˜ì²˜ (",w.length,")"]}),e.jsxs(b,{variant:g==="deliveries"?"default":"ghost",size:"sm",onClick:()=>o("deliveries"),className:"flex-1",children:["ë¯¸ë“±ë¡ ë‚©í’ˆì²˜ (",p.length,")"]}),e.jsxs(b,{variant:g==="conflicts"?"default":"ghost",size:"sm",onClick:()=>o("conflicts"),className:"flex-1",children:["ì´ë©”ì¼ ì¶©ëŒ (",m.length,")"]})]}),e.jsxs("div",{className:"min-h-[400px]",children:[g==="vendors"&&e.jsx("div",{children:w.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(dt,{className:"h-12 w-12 mx-auto mb-3 text-green-500"}),"ëª¨ë“  ê±°ëž˜ì²˜ê°€ ë“±ë¡ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."]}):w.map(_=>v(_,"ê±°ëž˜ì²˜"))}),g==="deliveries"&&e.jsx("div",{children:p.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(dt,{className:"h-12 w-12 mx-auto mb-3 text-green-500"}),"ëª¨ë“  ë‚©í’ˆì²˜ê°€ ë“±ë¡ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."]}):p.map(_=>v(_,"ë‚©í’ˆì²˜"))}),g==="conflicts"&&e.jsx("div",{children:m.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(dt,{className:"h-12 w-12 mx-auto mb-3 text-green-500"}),"ì´ë©”ì¼ ì¶©ëŒì´ ì—†ìŠµë‹ˆë‹¤."]}):m.map(_=>F(_))})]})]}),e.jsxs(Sr,{children:[e.jsx(b,{variant:"outline",onClick:a,children:"ì·¨ì†Œ"}),e.jsxs(b,{onClick:O,disabled:!E(),children:["í™•ì¸ (",l.size,"/",w.length+p.length,")"]})]})]})})}const Zt=d.forwardRef(({className:s,value:a,...t},r)=>e.jsx(rn,{ref:r,className:V("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...t,children:e.jsx(Sc,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));Zt.displayName=rn.displayName;function Ax(){os();const[s,a]=d.useState(null),[t,r]=d.useState(!1),[l,i]=d.useState(!1),[n,c]=d.useState(null),[g,o]=d.useState("none"),[w,p]=d.useState(null);d.useState([]);const[m,f]=d.useState(null),[T,O]=d.useState([{id:"upload",title:"íŒŒì¼ ì—…ë¡œë“œ",description:"ì—‘ì…€ íŒŒì¼ì„ ì„œë²„ë¡œ ì—…ë¡œë“œ",status:"pending"},{id:"parse",title:"Input ì‹œíŠ¸ íŒŒì‹±",description:"ì—‘ì…€ íŒŒì¼ì˜ Input ì‹œíŠ¸ ë°ì´í„° ë¶„ì„",status:"pending"},{id:"save",title:"ë°ì´í„°ë² ì´ìŠ¤ ì €ìž¥",description:"ë°œì£¼ì„œ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ìž¥",status:"pending"},{id:"extract",title:"ê°‘ì§€/ì„ì§€ ì¶”ì¶œ",description:"ê°‘ì§€/ì„ì§€ ì‹œíŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì¶”ì¶œ",status:"pending"}]),E=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?r(!0):N.type==="dragleave"&&r(!1)},v=N=>{if(N.preventDefault(),N.stopPropagation(),r(!1),N.dataTransfer.files&&N.dataTransfer.files[0]){const j=N.dataTransfer.files[0];j.type.includes("excel")||j.type.includes("spreadsheet")||j.name.endsWith(".xlsx")?(a(j),c(null),_()):alert("ì—‘ì…€ íŒŒì¼(.xlsx)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")}},F=N=>{N.target.files&&N.target.files[0]&&(a(N.target.files[0]),c(null),_())},_=()=>{O(N=>N.map(j=>({...j,status:"pending",message:void 0})))},k=(N,j,h)=>{O(I=>I.map(S=>S.id===N?{...S,status:j,message:h}:S))},A=async()=>{if(s){i(!0);try{k("upload","processing");const N=new FormData;N.append("file",s);const j=await fetch("/api/po-template/upload",{method:"POST",body:N}),h=await j.json();if(!j.ok){k("upload","error",h.error||"íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨"),i(!1);return}k("upload","completed",`${h.data.fileName} ì—…ë¡œë“œ ì™„ë£Œ`),k("parse","completed",`ë°œì£¼ì„œ ${h.data.totalOrders}ê°œ, ì•„ì´í…œ ${h.data.totalItems}ê°œ íŒŒì‹± ì™„ë£Œ`),k("save","processing");const I=await fetch("/api/po-template/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:h.data.orders})}),S=await I.json();if(!I.ok){k("save","error",S.error||"ë°ì´í„°ë² ì´ìŠ¤ ì €ìž¥ ì‹¤íŒ¨"),i(!1);return}k("save","completed",`ë°œì£¼ì„œ ${S.data.savedOrders}ê°œ ì €ìž¥ ì™„ë£Œ`),k("extract","processing");const z=await fetch("/api/po-template/extract-sheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:h.data.filePath})}),Q=await z.json();z.ok?k("extract","completed",`${Q.data.extractedSheets.join(", ")} ì‹œíŠ¸ ì¶”ì¶œ ì™„ë£Œ`):k("extract","error",Q.error||"ì‹œíŠ¸ ì¶”ì¶œ ì‹¤íŒ¨"),c(h),setTimeout(()=>{console.log("ìžë™ ê±°ëž˜ì²˜ í™•ì¸ ì‹œìž‘, filePath:",h.data?.filePath),h.data?.filePath?D(h.data.filePath):console.error("íŒŒì¼ ê²½ë¡œê°€ ì—†ì–´ì„œ ê±°ëž˜ì²˜ í™•ì¸ì„ ì‹œìž‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")},500)}catch(N){console.error("Processing error:",N),k("upload","error","ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{i(!1)}}},x=()=>T.filter(j=>j.status==="completed").length/T.length*100,D=async N=>{o("vendor-validation"),i(!0);try{console.log("ê±°ëž˜ì²˜ ê²€ì¦ API í˜¸ì¶œ ì‹œìž‘, filePath:",N);const h=await(await fetch("/api/excel-automation/validate-vendors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:N})})).json();if(console.log("ê±°ëž˜ì²˜ ê²€ì¦ API ì‘ë‹µ:",h),h.success)p(h.data.vendorValidation),h.data.vendorValidation.needsUserAction?o("vendor-validation"):(o("email-preview"),await u(h.data.vendorValidation.validVendors));else throw new Error(h.error)}catch(j){console.error("ê±°ëž˜ì²˜ ê²€ì¦ ì˜¤ë¥˜:",j),alert("ê±°ëž˜ì²˜ ê²€ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),o("none")}finally{i(!1)}},u=async N=>{if(n?.data?.filePath)try{const h=await(await fetch("/api/excel-automation/update-email-preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:n.data.filePath,selectedVendors:N.map(I=>({originalName:I.vendorName,selectedVendorId:I.vendorId,selectedVendorEmail:I.email}))})})).json();if(h.success)f(h.data.emailPreview),o("email-preview");else throw new Error(h.error)}catch(j){console.error("ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì˜¤ë¥˜:",j),alert("ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fs,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ì—‘ì…€ ë°œì£¼ì„œ ì²˜ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë°œì£¼ì„œë¥¼ ìƒì„±í•˜ì„¸ìš”."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{className:"border-blue-200 bg-blue-50 shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(Ms,{className:"w-5 h-5"}),"ì—‘ì…€ ë°œì£¼ì„œ ìž‘ì„± ê°€ì´ë“œ"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"ðŸ“‹ ì—‘ì…€ íŒŒì¼ ìš”êµ¬ì‚¬í•­"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì‹œíŠ¸ëª…:"})," 'Input' (ëŒ€ì†Œë¬¸ìž êµ¬ë¶„)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì»¬ëŸ¼ êµ¬ì¡°:"})," A~Pì—´ (16ê°œ ì»¬ëŸ¼) í‘œì¤€ êµ¬ì¡°"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í˜•ì‹:"})," .xlsx (Excel 2007 ì´ìƒ)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í¬ê¸°:"})," ìµœëŒ€ 10MB"]})]})]})]}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200",children:[e.jsxs("h4",{className:"font-semibold text-amber-800 mb-3 flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"âš ï¸ ì£¼ì˜ì‚¬í•­"]}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-800",children:[e.jsx("div",{children:"â€¢ í•„ìˆ˜ ì»¬ëŸ¼ (ë°œì£¼ì¼ìž, ê±°ëž˜ì²˜ëª…, ë‚©í’ˆì²˜ëª…, í”„ë¡œì íŠ¸ëª…, ëŒ€ë¶„ë¥˜, í’ˆëª©ëª…, ìˆ˜ëŸ‰, ë‹¨ê°€, ì´ê¸ˆì•¡) ëˆ„ë½ ì‹œ ì²˜ë¦¬ ë¶ˆê°€"}),e.jsx("div",{children:"â€¢ ê±°ëž˜ì²˜ëª…ì´ ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì§€ ì•Šì€ ê²½ìš° ê´€ë¦¬ìžì—ê²Œ ë“±ë¡ ìš”ì²­ í•„ìš”"}),e.jsx("div",{children:"â€¢ ì´ê¸ˆì•¡(Oì—´) = ìˆ˜ëŸ‰(Mì—´) Ã— ë‹¨ê°€(Nì—´) ìˆ˜ì‹ì´ ì •í™•í•´ì•¼ í•¨"}),e.jsx("div",{children:"â€¢ Input ì‹œíŠ¸ ì™¸ ë‹¤ë¥¸ ì‹œíŠ¸(ê°‘ì§€, ì„ì§€ ë“±)ëŠ” ê·¸ëŒ€ë¡œ ë³´ì¡´ë¨"})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"ðŸ“¥ í‘œì¤€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"ì‹œìŠ¤í…œì— ìµœì í™”ëœ 16ê°œ ì»¬ëŸ¼ êµ¬ì¡°ì˜ í‘œì¤€ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”."}),e.jsxs(b,{onClick:async()=>{try{const N=await fetch("/api/excel-template/download",{method:"GET"});if(N.ok){const j=await N.blob(),h=window.URL.createObjectURL(j),I=document.createElement("a");I.href=h,I.download="PO_Excel_Template.xlsx",document.body.appendChild(I),I.click(),document.body.removeChild(I),window.URL.revokeObjectURL(h)}else throw new Error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨")}catch(N){console.error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:",N),alert("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"PO_Excel_Template.xlsx ë‹¤ìš´ë¡œë“œ"]})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsxs(H,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"w-5 h-5"}),"ì—‘ì…€ ë°œì£¼ì„œ ì—…ë¡œë“œ"]}),e.jsx(jt,{children:"16ê°œ ì»¬ëŸ¼ êµ¬ì¡°ì˜ Input ì‹œíŠ¸ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ìžë™ìœ¼ë¡œ ë°œì£¼ì„œê°€ ìƒì„±ë©ë‹ˆë‹¤."})]}),e.jsxs(q,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${t?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:v,children:[e.jsx(Vs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.size/1024/1024).toFixed(2)," MB"]}),e.jsx(B,{variant:"secondary",className:"mt-2",children:"íŒŒì¼ ì¤€ë¹„ ì™„ë£Œ"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"ì—‘ì…€ íŒŒì¼ì„ ë“œëž˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì§€ì› í˜•ì‹: .xlsx (Excel íŒŒì¼)"})]}),e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:F,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"inline-block mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors font-medium",children:"íŒŒì¼ ì„ íƒ"})]}),s&&e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx(b,{onClick:A,disabled:l,className:"flex-1 h-12",size:"lg",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),"ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì‹œìž‘"]})}),e.jsx(b,{variant:"outline",onClick:()=>{a(null),c(null),_()},className:"h-12",size:"lg",children:"ì·¨ì†Œ"})]}),l&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"ì²˜ë¦¬ ì§„í–‰ ìƒí™©"}),e.jsxs("span",{className:"text-sm text-blue-700",children:[Math.round(x()),"%"]})]}),e.jsx(Zt,{value:x(),className:"h-2 mb-3"}),e.jsx("div",{className:"text-sm text-blue-700",children:T.find(N=>N.status==="processing")?.title||"ì²˜ë¦¬ ì¤‘..."})]})]})]}),n&&n.data?.orders&&e.jsxs(L,{className:"mt-6 shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"w-5 h-5 text-blue-600"}),"ë°œì£¼ì„œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°"]})}),e.jsx(q,{children:e.jsx("div",{className:"space-y-6",children:n.data.orders.map((N,j)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:N.orderNumber}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ê±°ëž˜ì²˜: ",N.vendorName," | ë‚©í’ˆì²˜: ",N.deliveryName||N.vendorName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["í˜„ìž¥: ",N.siteName," | ë°œì£¼ì¼: ",N.orderDate," | ë‚©ê¸°ì¼: ",N.dueDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(N.totalAmount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[N.items.length,"ê°œ í’ˆëª©"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ê·œê²©"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ë‹¨ê°€"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ê±°ëž˜ì²˜ëª…"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ë‚©í’ˆì²˜ëª…"})]})}),e.jsx("tbody",{children:N.items.map((h,I)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:h.itemName}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:h.specification}),e.jsx("td",{className:"border border-gray-300 px-2 py-1 text-right",children:new Intl.NumberFormat("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(h.quantity)}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(h.unitPrice),"ì›"]}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(h.totalAmount),"ì›"]}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:h.vendorName||"-"}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:h.deliveryName||h.vendorName||"-"})]},I))})]})})]},j))})})]}),n&&e.jsxs(L,{className:"mt-6 shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-green-600"}),"ì²˜ë¦¬ ê²°ê³¼"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-2 xl:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.data?.totalOrders||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"ìƒì„±ëœ ë°œì£¼ì„œ"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.data?.totalItems||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì²˜ë¦¬ëœ ì•„ì´í…œ"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"2"}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì¶”ì¶œëœ ì‹œíŠ¸"})]}),w&&e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[w.validVendors.length,"/",w.validVendors.length+w.invalidVendors.length]}),e.jsx("div",{className:"text-sm text-gray-600",children:"ë“±ë¡ëœ ê±°ëž˜ì²˜"})]})]}),w?e.jsx(As,{className:w.invalidVendors.length>0?"border-orange-200 bg-orange-50":"border-green-200 bg-green-50",children:w.invalidVendors.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 text-orange-600"}),e.jsxs(Ss,{className:"text-orange-800",children:[e.jsx("strong",{children:"ê±°ëž˜ì²˜ í™•ì¸ ì™„ë£Œ:"})," ",w.invalidVendors.length,"ê°œì˜ ë¯¸ë“±ë¡ ê±°ëž˜ì²˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹œìŠ¤í…œ ê´€ë¦¬ìžë‚˜ ë³¸ì‚¬ ê´€ë¦¬ìžì—ê²Œ ê±°ëž˜ì²˜ ë“±ë¡ì„ ìš”ì²­í•´ ì£¼ì„¸ìš”."]})]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 text-green-600"}),e.jsxs(Ss,{className:"text-green-800",children:[e.jsx("strong",{children:"ê±°ëž˜ì²˜ í™•ì¸ ì™„ë£Œ:"})," ëª¨ë“  ê±°ëž˜ì²˜ê°€ ë“±ë¡ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ ë°œì†¡ì„ ì§„í–‰í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."]})]})}):e.jsxs(As,{children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(Ss,{children:"ì—‘ì…€ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ê±°ëž˜ì²˜ í™•ì¸ì„ ìžë™ìœ¼ë¡œ ì§„í–‰í•˜ê³  ìžˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[w&&w.invalidVendors.length===0&&m&&e.jsxs(b,{onClick:async()=>{if(!m.canProceed){alert("ì´ë©”ì¼ì„ ë°œì†¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ì‹ ìžë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");return}o("sending");try{const j=await(await fetch("/api/excel-automation/send-emails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({processedFilePath:`uploads/${m.attachmentInfo.processedFile}`,recipients:m.recipients,emailOptions:{subject:m.subject,orderNumber:n?.data?.orders?.[0]?.orderNumber||"AUTO",additionalMessage:"ìžë™í™” ì‹œìŠ¤í…œì„ í†µí•´ ë°œì†¡ëœ ë°œì£¼ì„œìž…ë‹ˆë‹¤."}})})).json();if(j.success)o("completed"),alert(`ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ! (ì„±ê³µ: ${j.data.sentEmails}ê°œ)`);else throw new Error(j.error)}catch(N){console.error("ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",N),alert("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),o("email-preview")}},disabled:!m?.canProceed||m?.recipients.length===0,className:"bg-blue-600 hover:bg-blue-700",children:["ì´ë©”ì¼ ë°œì†¡ (",m?.recipients.length||0,"ëª…)"]}),e.jsx(b,{onClick:()=>window.location.href="/orders",children:"ë°œì£¼ì„œ ê´€ë¦¬ë¡œ ì´ë™"}),e.jsx(b,{variant:"outline",onClick:()=>window.location.href="/create-order/excel",children:"ìƒˆ íŒŒì¼ ì—…ë¡œë“œ"})]})]})]}),g==="vendor-validation"&&w&&e.jsxs(L,{className:"mt-6 shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"w-5 h-5 text-orange-600"}),"ê±°ëž˜ì²˜ í™•ì¸ í•„ìš”"]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:w.validVendors.length}),e.jsx("div",{className:"text-sm text-green-600",children:"ë“±ë¡ëœ ê±°ëž˜ì²˜"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:w.invalidVendors.length}),e.jsx("div",{className:"text-sm text-orange-600",children:"í™•ì¸ í•„ìš”í•œ ê±°ëž˜ì²˜"})]})]}),w.invalidVendors.length>0&&e.jsxs(As,{className:"border-orange-200 bg-orange-50",children:[e.jsx(Ms,{className:"h-4 w-4 text-orange-600"}),e.jsx(Ss,{className:"text-orange-800",children:e.jsx("strong",{children:"ë“±ë¡ë˜ì§€ ì•Šì€ ê±°ëž˜ì²˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìžë‚˜ ë³¸ì‚¬ ê´€ë¦¬ìžì—ê²Œ ê±°ëž˜ì²˜ ë“±ë¡ì„ ìš”ì²­í•´ ì£¼ì„¸ìš”."})})]}),w.invalidVendors.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"í™•ì¸ì´ í•„ìš”í•œ ê±°ëž˜ì²˜"}),e.jsx("div",{className:"space-y-3",children:w.invalidVendors.map((N,j)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"font-medium text-red-600 mb-2",children:['"',N.vendorName,'" - ë“±ë¡ë˜ì§€ ì•Šì€ ê±°ëž˜ì²˜']}),N.suggestions.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"ìœ ì‚¬í•œ ê±°ëž˜ì²˜ ì¶”ì²œ:"}),e.jsx("div",{className:"space-y-1",children:N.suggestions.slice(0,3).map((h,I)=>e.jsxs("div",{className:"text-sm p-2 bg-white rounded border",children:[h.name," (",h.email,") - ìœ ì‚¬ë„: ",(h.similarity*100).toFixed(0),"%"]},I))})]})]},j))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{onClick:()=>{u(w.validVendors)},disabled:w.validVendors.length===0,children:"ë“±ë¡ëœ ê±°ëž˜ì²˜ë§Œìœ¼ë¡œ ì´ë©”ì¼ ë°œì†¡ ì§„í–‰"}),e.jsx(b,{variant:"outline",onClick:()=>o("none"),children:"ì·¨ì†Œ"})]})]})})]}),g==="email-preview"&&m&&e.jsxs(L,{className:"mt-6 shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-blue-600"}),"ì´ë©”ì¼ ë°œì†¡ ë¯¸ë¦¬ë³´ê¸°"]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["ìˆ˜ì‹ ìž (",m.recipients.length,"ëª…)"]}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded border min-h-[60px]",children:m.recipients.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:m.recipients.map((N,j)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded",children:N},j))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"ì´ë©”ì¼ ìˆ˜ì‹ ìžê°€ ì—†ìŠµë‹ˆë‹¤."})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"ì œëª©"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:m.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:[m.attachmentInfo.processedFile," (",Math.round(m.attachmentInfo.fileSize/1024),"KB)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:async()=>{if(!m.canProceed){alert("ì´ë©”ì¼ì„ ë°œì†¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ì‹ ìžë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");return}o("sending");try{const j=await(await fetch("/api/excel-automation/send-emails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({processedFilePath:`uploads/${m.attachmentInfo.processedFile}`,recipients:m.recipients,emailOptions:{subject:m.subject,orderNumber:n?.data?.orders?.[0]?.orderNumber||"AUTO",additionalMessage:"ìžë™í™” ì‹œìŠ¤í…œì„ í†µí•´ ë°œì†¡ëœ ë°œì£¼ì„œìž…ë‹ˆë‹¤."}})})).json();if(j.success)o("completed"),alert(`ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ! (ì„±ê³µ: ${j.data.sentEmails}ê°œ)`);else throw new Error(j.error)}catch(N){console.error("ì´ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:",N),alert("ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),o("email-preview")}},disabled:!m.canProceed||m.recipients.length===0,className:"bg-blue-600 hover:bg-blue-700",children:["ì´ë©”ì¼ ë°œì†¡ (",m.recipients.length,"ëª…)"]}),e.jsx(b,{variant:"outline",onClick:()=>o("none"),children:"ì·¨ì†Œ"})]})]})})]}),g==="completed"&&e.jsxs(L,{className:"mt-6 shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-green-600"}),"ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ"]})}),e.jsxs(q,{children:[e.jsxs(As,{children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(Ss,{children:"ëª¨ë“  ê³¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì£¼ì„œê°€ ì €ìž¥ë˜ê³  ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(b,{onClick:()=>window.location.href="/orders",children:"ë°œì£¼ì„œ ê´€ë¦¬ë¡œ ì´ë™"}),e.jsx(b,{variant:"outline",onClick:()=>window.location.reload(),children:"ìƒˆ íŒŒì¼ ì²˜ë¦¬"})]})]})]}),e.jsxs(L,{className:"mt-6 shadow-sm",children:[e.jsx(H,{children:e.jsx(W,{children:"ì‚¬ìš©ë²• ì•ˆë‚´"})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"1. ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Input ì‹œíŠ¸ê°€ í¬í•¨ëœ ë°œì£¼ì„œ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"2. ë°œì£¼ì„œ ë°ì´í„° í™•ì¸"}),e.jsx("p",{className:"text-sm text-gray-600",children:"íŒŒì‹±ëœ ë°œì£¼ì„œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ë³´ê¸°ë¡œ í™•ì¸í•˜ì„¸ìš”."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"3. ê±°ëž˜ì²˜ í™•ì¸ ë° ì´ë©”ì¼ ë°œì†¡"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê±°ëž˜ì²˜ë¥¼ í™•ì¸í•˜ê³  ì´ë©”ì¼ ìˆ˜ì‹ ìžë¥¼ ê²€í† í•œ í›„ ë°œì†¡í•˜ì„¸ìš”."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"4. ì™„ë£Œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"'ë°œì£¼ì„œ ê´€ë¦¬' í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ì—¬ ë°œì£¼ì„œê°€ ì •ìƒ ë“±ë¡ëœ ê²ƒì„ í™•ì¸ í›„, 'ì´ë©”ì¼ ì•„ì´ì½˜'ì„ í´ë¦­í•˜ì—¬ ë°œì†¡í•˜ëŠ” ê²ƒì„ ê¶Œìž¥ë“œë¦½ë‹ˆë‹¤."})]})]})})]})]})]})})}const Tx=Object.freeze(Object.defineProperty({__proto__:null,default:Ax},Symbol.toStringTag,{value:"Module"})),zs=kc,qs=_c,Is=d.forwardRef(({className:s,align:a="center",sideOffset:t=4,...r},l)=>e.jsx(Dc,{children:e.jsx(ln,{ref:l,align:a,sideOffset:t,className:V("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin] dark:bg-slate-950 dark:border-slate-600 dark:text-white dark:shadow-xl",s),...r})}));Is.displayName=ln.displayName;const Oa=d.forwardRef(({className:s,...a},t)=>e.jsx(Us,{ref:t,className:V("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground dark:bg-slate-950 dark:text-white",s),...a}));Oa.displayName=Us.displayName;const Fa=d.forwardRef(({className:s,...a},t)=>e.jsxs("div",{className:"flex items-center border-b px-3 dark:border-slate-600","cmdk-input-wrapper":"",children:[e.jsx(yt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Us.Input,{ref:t,className:V("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 dark:text-white dark:placeholder:text-slate-400",s),...a})]}));Fa.displayName=Us.Input.displayName;const Px=d.forwardRef(({className:s,...a},t)=>e.jsx(Us.List,{ref:t,className:V("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...a}));Px.displayName=Us.List.displayName;const Ma=d.forwardRef((s,a)=>e.jsx(Us.Empty,{ref:a,className:"py-6 text-center text-sm",...s}));Ma.displayName=Us.Empty.displayName;const $a=d.forwardRef(({className:s,...a},t)=>e.jsx(Us.Group,{ref:t,className:V("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground dark:text-white dark:[&_[cmdk-group-heading]]:text-slate-400",s),...a}));$a.displayName=Us.Group.displayName;const Ex=d.forwardRef(({className:s,...a},t)=>e.jsx(Us.Separator,{ref:t,className:V("-mx-1 h-px bg-border",s),...a}));Ex.displayName=Us.Separator.displayName;const Ra=d.forwardRef(({className:s,...a},t)=>e.jsx(Us.Item,{ref:t,className:V("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 dark:text-white dark:data-[selected='true']:bg-slate-800 dark:data-[selected=true]:text-white",s),...a}));Ra.displayName=Us.Item.displayName;const al=s=>{switch(s){case"active":return"default";case"completed":return"secondary";case"on_hold":return"outline";case"cancelled":return"destructive";default:return"outline"}},rl=s=>{switch(s){case"active":return"ì§„í–‰ì¤‘";case"completed":return"ì™„ë£Œ";case"on_hold":return"ë³´ë¥˜";case"cancelled":return"ì·¨ì†Œ";default:return s}};function Ix(){const{user:s}=os(),{toast:a}=Ze();console.log("ðŸ” Projects page - Current user:",s),console.log("ðŸ” User role:",s?.role),console.log("ðŸ” Can add project:",s?.role&&["admin","hq_management","project_manager"].includes(s.role));const[,t]=Je(),r=us(),[l,i]=d.useState(""),[n,c]=d.useState(null),[g,o]=d.useState("asc"),[w,p]=d.useState("table"),[m,f]=d.useState(!1),[T,O]=d.useState(null),[E,v]=d.useState(!1),[F,_]=d.useState("none");d.useEffect(()=>{const $=new URLSearchParams(window.location.search).get("filter");$==="recent"?(_("recent"),i("ìµœê·¼ 1ê°œì›” ì‹œìž‘")):$==="new"&&(_("new"),i("ì´ë²ˆ ë‹¬ ì‹ ê·œ"))},[]);const{data:k=[],isLoading:A}=se({queryKey:["/api/projects"]}),{data:x=[]}=se({queryKey:["/api/users"]}),{data:D=[]}=se({queryKey:["/api/project-members"]}),u=or({defaultValues:{projectName:"",projectCode:"",clientName:"",projectType:"",location:"",status:"active",projectManagerId:"",orderManagerIds:[],description:"",startDate:"",endDate:"",totalBudget:"",isActive:!0}}),N=Ce({mutationFn:async y=>me("POST","/api/projects",y),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/projects"]}),f(!1),u.reset(),a({description:"í˜„ìž¥ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:y=>{a({variant:"destructive",description:y.message||"í˜„ìž¥ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),j=Ce({mutationFn:async y=>me("PUT",`/api/projects/${T?.id}`,y),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/projects"]}),f(!1),O(null),u.reset(),a({description:"í˜„ìž¥ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:y=>{a({variant:"destructive",description:y.message||"í˜„ìž¥ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),h=Ce({mutationFn:async y=>me("DELETE",`/api/projects/${y}`),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/projects"]}),a({description:"í”„ë¡œì íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:y=>{a({variant:"destructive",description:y.message||"í˜„ìž¥ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),I=d.useMemo(()=>{let y=k;if(F==="recent"){const $=new Date,J=new Date;J.setMonth($.getMonth()-1),y=k.filter(ie=>{if(!ie.startDate)return!1;const xe=new Date(ie.startDate);return xe>=J&&xe<=$})}else if(F==="new"){const $=new Date,J=new Date($.getFullYear(),$.getMonth(),1);y=k.filter(ie=>{if(!ie.startDate)return!1;const xe=new Date(ie.startDate);return xe>=J&&xe<=$})}return l&&!l.includes("ìµœê·¼ 1ê°œì›”")&&!l.includes("ì´ë²ˆ ë‹¬")&&(y=y.filter($=>$.projectName.toLowerCase().includes(l.toLowerCase())||$.projectCode&&$.projectCode.toLowerCase().includes(l.toLowerCase())||$.clientName&&$.clientName.toLowerCase().includes(l.toLowerCase()))),y},[k,l,F]),S=async y=>{const $={...y,totalBudget:y.totalBudget?y.totalBudget.toString().replace(/[^\d]/g,""):null,startDate:y.startDate||null,endDate:y.endDate||null};if(T){const J={...$};if(delete J.orderManagerIds,await j.mutateAsync({id:T.id,...J}),y.orderManagerIds){const ie=D.filter(xe=>xe.projectId===T.id);for(const xe of ie)await fetch(`/api/project-members/${xe.id}`,{method:"DELETE"});for(const xe of y.orderManagerIds)await fetch("/api/project-members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:T.id,userId:xe,role:"order_manager"})});r.invalidateQueries({queryKey:["/api/project-members"]}),r.invalidateQueries({queryKey:["/api/projects"]})}}else N.mutate($)},z=y=>{O(y);const $=D.filter(J=>J.projectId===y.id).map(J=>J.userId);u.reset({projectName:y.projectName,projectCode:y.projectCode||"",clientName:y.clientName||"",projectType:y.projectType||"",location:y.location||"",status:y.status,projectManagerId:y.projectManagerId||"",orderManagerIds:$,description:y.description||"",startDate:y.startDate?new Date(y.startDate).toISOString().split("T")[0]:"",endDate:y.endDate?new Date(y.endDate).toISOString().split("T")[0]:"",totalBudget:y.totalBudget||"",isActive:y.isActive}),f(!0)},Q=y=>{confirm("ì •ë§ë¡œ ì´ í˜„ìž¥ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&h.mutate(y)},K=()=>{O(null),u.reset(),f(!0)},ne=y=>{n===y?o(g==="asc"?"desc":"asc"):(c(y),o("asc"))},Se=y=>n!==y?null:g==="asc"?e.jsx(zt,{className:"h-4 w-4"}):e.jsx(Zs,{className:"h-4 w-4"}),je=d.useMemo(()=>n?[...I].sort((y,$)=>{let J=y[n],ie=$[n];return J==null&&(J=""),ie==null&&(ie=""),n==="totalBudget"?(J=parseFloat(J||"0"),ie=parseFloat(ie||"0")):n==="startDate"||n==="endDate"?(J=J?new Date(J).getTime():0,ie=ie?new Date(ie).getTime():0):(J=String(J).toLowerCase(),ie=String(ie).toLowerCase()),g==="asc"?J<ie?-1:J>ie?1:0:ie<J?-1:ie>J?1:0}):I,[I,n,g]);return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"í˜„ìž¥ ê´€ë¦¬"}),e.jsxs(b,{onClick:K,className:"px-4 py-2 text-sm font-medium bg-blue-600 hover:bg-blue-700",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"í˜„ìž¥ ì¶”ê°€"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"í”„ë¡œì íŠ¸ í˜„ìž¥ì„ ì¡°íšŒí•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"ê²€ìƒ‰"}),e.jsxs("div",{className:"relative",children:[e.jsx(yt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(U,{placeholder:"í˜„ìž¥ëª…, ê³ ê°ì‚¬ëª…ìœ¼ë¡œ ê²€ìƒ‰...",value:l,onChange:y=>i(y.target.value),className:`pl-8 h-10 text-sm ${l?"border-blue-500 bg-blue-50":""}`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[I.length,"ê°œ í˜„ìž¥"]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(b,{variant:w==="table"?"default":"ghost",size:"sm",onClick:()=>p("table"),className:"h-8 w-8 p-0",title:"ëª©ë¡ ë³´ê¸°",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx(b,{variant:w==="card"?"default":"ghost",size:"sm",onClick:()=>p("card"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(gt,{className:"h-4 w-4"})})]})]})]})})})}),w==="table"?e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"border-b border-gray-200",children:[e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>ne("projectName"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"í˜„ìž¥ëª…"}),Se("projectName")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>ne("clientName"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ê³ ê°ì‚¬"}),Se("clientName")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>ne("status"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ìƒíƒœ"}),Se("status")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>ne("location"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ìœ„ì¹˜"}),Se("location")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>ne("totalBudget"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ì˜ˆì‚°"}),Se("totalBudget")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>ne("startDate"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ì‹œìž‘ì¼"}),Se("startDate")]})}),e.jsx(oe,{className:"px-6 py-3 text-sm font-medium text-gray-600 text-right",children:"ê´€ë¦¬"})]})}),e.jsx(tt,{children:A?[...Array(5)].map((y,$)=>e.jsxs(Me,{children:[e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{})]},$)):je.length===0?e.jsx(Me,{children:e.jsx(G,{colSpan:7,className:"text-center py-6 text-xs text-gray-500",children:l?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ í˜„ìž¥ì´ ì—†ìŠµë‹ˆë‹¤"})}):je.map(y=>e.jsxs(Me,{className:"hover:bg-gray-50 border-b border-gray-100",children:[e.jsx(G,{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-700 overflow-hidden text-ellipsis whitespace-nowrap",onClick:()=>t(`/projects/${y.id}`),title:y.projectName,children:y.projectName}),e.jsx("div",{className:"text-sm text-gray-500",children:y.projectCode||"-"})]})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:y.clientName||"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx(B,{variant:al(y.status),children:rl(y.status)})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:y.location||"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm font-medium text-blue-600",children:y.totalBudget?Ee(y.totalBudget):"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsx("div",{className:"text-sm text-gray-900",children:y.startDate?Ds(y.startDate):"-"})}),e.jsx(G,{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>z(y),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>Q(y.id),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})})]},y.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2",children:A?[...Array(6)].map((y,$)=>e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-1/2"})]})})},$)):I.map(y=>e.jsxs(L,{className:"p-3 hover:shadow-md transition-shadow shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(nn,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 cursor-pointer hover:text-blue-600",onClick:()=>t(`/projects/${y.id}`),children:y.projectName}),y.projectCode&&e.jsx("span",{className:"text-xs text-gray-500",children:y.projectCode})]})]}),e.jsx(B,{variant:al(y.status),children:rl(y.status)})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(cs,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ê³ ê°ì‚¬:"}),e.jsx("span",{className:"ml-1",children:y.clientName||"-"})]}),y.location&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(St,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ìœ„ì¹˜:"}),e.jsx("span",{className:"ml-1",children:y.location})]}),y.totalBudget&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(Xs,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ì˜ˆì‚°:"}),e.jsx("span",{className:"ml-1 font-medium text-blue-600",children:Ee(y.totalBudget)})]}),y.startDate&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-2",children:[e.jsx(_s,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"ì‹œìž‘ì¼:"}),e.jsx("span",{className:"ml-1",children:Ds(y.startDate)})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>z(y),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>Q(y.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})]},y.id))}),e.jsx(ze,{open:m,onOpenChange:f,children:e.jsxs(qe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ve,{children:e.jsx(Ke,{children:T?"í˜„ìž¥ ìˆ˜ì •":"ìƒˆ í˜„ìž¥ ì¶”ê°€"})}),e.jsx(jr,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(S),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Oe,{control:u.control,name:"projectName",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í˜„ìž¥ëª… *"}),e.jsx(Te,{children:e.jsx(U,{...y})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:u.control,name:"projectCode",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í˜„ìž¥ ì½”ë“œ"}),e.jsx(Te,{children:e.jsx(U,{...y})}),e.jsx(Pe,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Oe,{control:u.control,name:"clientName",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ê³ ê°ì‚¬"}),e.jsx(Te,{children:e.jsx(U,{...y})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:u.control,name:"projectType",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í˜„ìž¥ ìœ í˜•"}),e.jsxs(Z,{onValueChange:y.onChange,defaultValue:y.value,children:[e.jsx(Te,{children:e.jsx(Y,{children:e.jsx(X,{placeholder:"í˜„ìž¥ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsxs(ee,{children:[e.jsx(R,{value:"ì•„íŒŒíŠ¸",children:"ì•„íŒŒíŠ¸"}),e.jsx(R,{value:"ì˜¤í”¼ìŠ¤í…”",children:"ì˜¤í”¼ìŠ¤í…”"}),e.jsx(R,{value:"ë‹¨ë…ì£¼íƒ",children:"ë‹¨ë…ì£¼íƒ"}),e.jsx(R,{value:"ìƒì—…ì‹œì„¤",children:"ìƒì—…ì‹œì„¤"}),e.jsx(R,{value:"ì‚¬ë¬´ì‹¤",children:"ì‚¬ë¬´ì‹¤"}),e.jsx(R,{value:"ì‡¼í•‘ëª°",children:"ì‡¼í•‘ëª°"}),e.jsx(R,{value:"ê³µìž¥",children:"ê³µìž¥"}),e.jsx(R,{value:"ì°½ê³ ",children:"ì°½ê³ "}),e.jsx(R,{value:"ì¸í”„ë¼",children:"ì¸í”„ë¼"})]})]}),e.jsx(Pe,{})]})})]}),e.jsx(Oe,{control:u.control,name:"location",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ìœ„ì¹˜"}),e.jsx(Te,{children:e.jsx(U,{...y})}),e.jsx(Pe,{})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Oe,{control:u.control,name:"status",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ìƒíƒœ"}),e.jsxs(Z,{onValueChange:y.onChange,defaultValue:y.value,children:[e.jsx(Te,{children:e.jsx(Y,{children:e.jsx(X,{})})}),e.jsxs(ee,{children:[e.jsx(R,{value:"active",children:"ì§„í–‰ì¤‘"}),e.jsx(R,{value:"completed",children:"ì™„ë£Œ"}),e.jsx(R,{value:"on_hold",children:"ë³´ë¥˜"}),e.jsx(R,{value:"cancelled",children:"ì·¨ì†Œ"})]})]}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:u.control,name:"projectManagerId",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €"}),e.jsxs(Z,{onValueChange:y.onChange,value:y.value,children:[e.jsx(Te,{children:e.jsx(Y,{children:e.jsx(X,{placeholder:"ì„ íƒí•˜ì„¸ìš”"})})}),e.jsx(ee,{children:x.map($=>e.jsx(R,{value:$.id,children:$.name},$.id))})]}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:u.control,name:"orderManagerIds",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ë°œì£¼ ê´€ë¦¬ìž (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)"}),e.jsx(Te,{children:e.jsxs(zs,{open:E,onOpenChange:v,children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",role:"combobox","aria-expanded":E,className:"w-full justify-between",children:[!y.value||y.value.length===0?"ë°œì£¼ ê´€ë¦¬ìžë¥¼ ì„ íƒí•˜ì„¸ìš”":e.jsxs("div",{className:"flex flex-wrap gap-1",children:[y.value.slice(0,2).map($=>{const J=x.find(ie=>ie.id===$);return e.jsx(B,{variant:"secondary",className:"text-xs",children:J?.name||$},$)}),y.value.length>2&&e.jsxs(B,{variant:"secondary",className:"text-xs",children:["+",y.value.length-2,"ëª… ë”"]})]}),e.jsx(xr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Is,{className:"w-full p-0",children:e.jsxs(Oa,{children:[e.jsx(Fa,{placeholder:"ë‹´ë‹¹ìž ê²€ìƒ‰..."}),e.jsx(Ma,{children:"ë‹´ë‹¹ìžë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx($a,{children:x.map($=>e.jsxs(Ra,{onSelect:()=>{const J=y.value||[];J.includes($.id)?y.onChange(J.filter(xe=>xe!==$.id)):y.onChange([...J,$.id])},children:[e.jsx(ps,{className:V("mr-2 h-4 w-4",y.value?.includes($.id)?"opacity-100":"opacity-0")}),$.name]},$.id))})]})})]})}),e.jsx(Pe,{}),y.value&&y.value.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ì„ íƒëœ ë°œì£¼ ê´€ë¦¬ìž:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:y.value.map($=>{const J=x.find(ie=>ie.id===$);return e.jsxs(B,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[J?.name||$,e.jsx("button",{type:"button",onClick:()=>{const ie=y.value||[];y.onChange(ie.filter(xe=>xe!==$))},className:"ml-1 hover:text-blue-900",children:"Ã—"})]},$)})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Oe,{control:u.control,name:"startDate",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì‹œìž‘ì¼"}),e.jsx(Te,{children:e.jsx(U,{type:"date",...y})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:u.control,name:"endDate",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì¢…ë£Œì¼"}),e.jsx(Te,{children:e.jsx(U,{type:"date",...y})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:u.control,name:"totalBudget",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì´ ì˜ˆì‚°"}),e.jsx(Te,{children:e.jsx(U,{type:"text",placeholder:"â‚©0",value:y.value?Ee(y.value):"",onChange:$=>{const J=Dn($.target.value);y.onChange(J.toString())},onBlur:y.onBlur,name:y.name,ref:y.ref})}),e.jsx(Pe,{})]})})]}),e.jsx(Oe,{control:u.control,name:"description",render:({field:y})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì„¤ëª…"}),e.jsx(Te,{children:e.jsx(Ge,{...y,rows:3})}),e.jsx(Pe,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>f(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",disabled:N.isPending||j.isPending,children:T?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})})]})})}const Ox=Object.freeze(Object.defineProperty({__proto__:null,default:Ix},Symbol.toStringTag,{value:"Module"}));function Fx(){const{id:s}=ht(),[,a]=Je(),{data:t,isLoading:r}=se({queryKey:["/api/projects",s],queryFn:()=>fetch(`/api/projects/${s}`).then(x=>x.json()),enabled:!!s}),{data:l=[]}=se({queryKey:["/api/project-statuses"]}),{data:i=[]}=se({queryKey:["/api/project-types"]}),{data:n=[]}=se({queryKey:["/api/users"]}),{data:c=[]}=se({queryKey:["/api/project-members",{projectId:s}],queryFn:()=>fetch(`/api/project-members?projectId=${s}`).then(x=>x.json()),enabled:!!s}),{data:g,isLoading:o}=se({queryKey:["/api/orders",{projectId:s}],queryFn:()=>fetch(`/api/orders?projectId=${s}&limit=100`).then(x=>x.json()),enabled:!!s}),[w,p]=d.useState({key:"",direction:null}),m=x=>{let D="asc";w.key===x&&w.direction==="asc"&&(D="desc"),p({key:x,direction:D})},f=x=>w.key!==x?e.jsx("div",{className:"w-4 h-4"}):w.direction==="asc"?e.jsx(zt,{className:"w-4 h-4"}):e.jsx(Zs,{className:"w-4 h-4"}),T=g?.orders?[...g.orders].sort((x,D)=>{if(!w.key||!w.direction)return 0;let u=x[w.key],N=D[w.key];return w.key==="vendor"?(u=x.vendor?.name||"",N=D.vendor?.name||""):w.key==="user"&&(u=x.user?.name||x.user?.email||"",N=D.user?.name||D.user?.email||""),u<N?w.direction==="asc"?-1:1:u>N?w.direction==="asc"?1:-1:0}):[],O=x=>{const D=l.find(u=>u.statusCode===x);return D?D.statusName:x},E=x=>{const D=i.find(u=>u.typeCode===x);return D?D.typeName:x},v=x=>{const D=n.find(u=>u.id===x);return D?D.name||D.email:x},F=()=>{if(!c||c.length===0)return"-";const x=c.filter(u=>u.role==="order_manager");return x.length===0?"-":x.map(u=>v(u.userId)).join(", ")},_=x=>{switch(x){case"active":return"bg-green-100 text-green-800";case"standby":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=x=>{switch(x){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"sent":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},A=x=>{switch(x){case"pending":return"ëŒ€ê¸°ì¤‘";case"approved":return"ìŠ¹ì¸ë¨";case"sent":return"ë°œì†¡ë¨";case"completed":return"ì™„ë£Œë¨";default:return x}};return r?e.jsx("div",{className:"p-2 space-y-2",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})]})}):t?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(nn,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.projectName}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.projectCode})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>a("/projects"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëª©ë¡ìœ¼ë¡œ"]}),e.jsx(B,{className:_(t.status),children:O(t.status)}),e.jsxs(b,{size:"sm",onClick:()=>a(`/projects/${s}/edit`),children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"ìˆ˜ì •"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-2",children:[e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-2",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(cs,{className:"h-5 w-5 mr-2 text-blue-600"}),"í˜„ìž¥ ì •ë³´"]})}),e.jsxs(q,{className:"pt-0 pb-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"í´ë¼ì´ì–¸íŠ¸"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.clientName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"í˜„ìž¥ ìœ í˜•"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:E(t.projectType)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ìœ„ì¹˜"}),e.jsxs("p",{className:"text-xs text-gray-900 flex items-center mt-0.5",children:[e.jsx(St,{className:"h-3 w-3 mr-1"}),t.location||"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ì´ ì˜ˆì‚°"}),e.jsxs("p",{className:"text-xs font-semibold text-blue-600 flex items-center mt-0.5",children:[e.jsx(Xs,{className:"h-3 w-3 mr-1"}),t.totalBudget?Ee(t.totalBudget):"-"]})]})]}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"my-2"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"í˜„ìž¥ ì„¤ëª…"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.description})]})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-2",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(_s,{className:"h-5 w-5 mr-2 text-blue-600"}),"ì¼ì • ì •ë³´"]})}),e.jsx(q,{className:"pt-0 pb-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ì‹œìž‘ì¼"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.startDate?Ds(new Date(t.startDate)):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ì¢…ë£Œì¼"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.endDate?Ds(new Date(t.endDate)):"-"})]})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-2",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(ks,{className:"h-5 w-5 mr-2 text-blue-600"}),"ë‹´ë‹¹ìž ì •ë³´"]})}),e.jsxs(q,{className:"pt-0 pb-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"í˜„ìž¥ ê´€ë¦¬ìž"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.projectManagerId?v(t.projectManagerId):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ë°œì£¼ ë‹´ë‹¹ìž"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:F()})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-2",children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(ye,{className:"h-5 w-5 mr-2 text-blue-600"}),"í˜„ìž¥ í†µê³„"]})}),e.jsxs(q,{className:"pt-0 pb-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"í™œì„± ìƒíƒœ"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.isActive?"í™œì„±":"ë¹„í™œì„±"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ìƒì„±ì¼"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.createdAt?Ds(new Date(t.createdAt)):"-"})]}),t.updatedAt&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"ìµœì¢… ìˆ˜ì •ì¼"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:Ds(new Date(t.updatedAt))})]})]})]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(Ir,{className:"h-5 w-5 mr-2 text-blue-600"}),"í”„ë¡œì íŠ¸ ë°œì£¼ì„œ ëª©ë¡",g&&e.jsxs(B,{variant:"secondary",className:"ml-2 text-xs",children:[g.totalCount||g.orders?.length||0,"ê±´"]})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Pt,{to:"/orders/create",children:e.jsxs(b,{size:"sm",className:"text-xs h-7",children:[e.jsx(we,{className:"h-3 w-3 mr-1"}),"ë°œì£¼ì„œ ìƒì„±"]})})})]})}),e.jsx(q,{className:"pt-0 pb-2",children:o?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((x,D)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-8 bg-gray-200 rounded"})},D))}):g?.orders&&g.orders.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"hover:bg-transparent",children:[e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("orderNumber"),children:e.jsxs("div",{className:"flex items-center",children:["ë°œì£¼ë²ˆí˜¸",f("orderNumber")]})}),e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("vendor"),children:e.jsxs("div",{className:"flex items-center",children:["ê±°ëž˜ì²˜",f("vendor")]})}),e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("orderDate"),children:e.jsxs("div",{className:"flex items-center",children:["ë°œì£¼ì¼ìž",f("orderDate")]})}),e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("deliveryDate"),children:e.jsxs("div",{className:"flex items-center",children:["ë‚©ê¸°í¬ë§ì¼",f("deliveryDate")]})}),e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("totalAmount"),children:e.jsxs("div",{className:"flex items-center",children:["ì´ê¸ˆì•¡",f("totalAmount")]})}),e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("status"),children:e.jsxs("div",{className:"flex items-center",children:["ìƒíƒœ",f("status")]})}),e.jsx(oe,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("user"),children:e.jsxs("div",{className:"flex items-center",children:["ìž‘ì„±ìž",f("user")]})}),e.jsx(oe,{className:"text-xs h-8",children:"ì•¡ì…˜"})]})}),e.jsx(tt,{children:T.map(x=>e.jsxs(Me,{className:"h-8",children:[e.jsx(G,{className:"font-medium text-xs py-1",children:x.orderNumber}),e.jsx(G,{className:"text-xs py-1",children:x.vendor?.name||"-"}),e.jsx(G,{className:"text-xs py-1",children:x.orderDate?Ds(new Date(x.orderDate)):"-"}),e.jsx(G,{className:"text-xs py-1",children:x.deliveryDate?Ds(new Date(x.deliveryDate)):"-"}),e.jsx(G,{className:"text-xs py-1 font-semibold text-blue-600",children:x.totalAmount?Ee(x.totalAmount):"-"}),e.jsx(G,{className:"text-xs py-1",children:e.jsx(B,{className:`${k(x.status)} text-xs px-1 py-0`,children:A(x.status)})}),e.jsx(G,{className:"text-xs py-1",children:x.user?.name||x.user?.email||"-"}),e.jsx(G,{className:"text-xs py-1",children:e.jsx(Pt,{to:`/orders/${x.id}`,children:e.jsxs(b,{variant:"outline",size:"sm",className:"h-6 text-xs px-2",children:[e.jsx(ls,{className:"h-3 w-3 mr-0.5"}),"ë³´ê¸°"]})})})]},x.id))})]}),g.totalCount>10&&e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx(Pt,{to:`/orders?projectId=${s}`,children:e.jsxs(b,{variant:"outline",size:"sm",className:"text-xs",children:["ëª¨ë“  ë°œì£¼ì„œ ë³´ê¸° (",g.totalCount,"ê±´)"]})})})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(Ir,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-gray-600 mb-2 text-xs",children:"ì´ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë°œì£¼ì„œê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."}),e.jsx(Pt,{to:"/orders/create",children:e.jsxs(b,{size:"sm",className:"text-xs",children:[e.jsx(we,{className:"h-3 w-3 mr-1"}),"ì²« ë°œì£¼ì„œ ìƒì„±í•˜ê¸°"]})})]})})]})})]})}):e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-gray-600 mb-3 text-sm",children:"ìš”ì²­í•˜ì‹  í”„ë¡œì íŠ¸ê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsxs(b,{size:"sm",onClick:()=>a("/projects"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëª©ë¡ìœ¼ë¡œ"]})]})})}const Mx=Object.freeze(Object.defineProperty({__proto__:null,default:Fx},Symbol.toStringTag,{value:"Module"})),Gs=d.forwardRef(({className:s,...a},t)=>e.jsx(cn,{className:V("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input dark:focus-visible:ring-blue-400/20 dark:focus-visible:ring-offset-slate-950 dark:data-[state=checked]:bg-blue-600 dark:data-[state=unchecked]:bg-slate-700",s),...a,ref:t,children:e.jsx(Ac,{className:V("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0 dark:bg-white")})}));Gs.displayName=cn.displayName;function lp({user:s,isOpen:a,onClose:t,onSuccess:r}){const[l,i]=d.useState("checking"),[n,c]=d.useState(""),{toast:g}=Ze(),{data:o,isLoading:w}=se({queryKey:[`/api/users/${s.id}/references`],enabled:a,retry:!1}),{data:p}=se({queryKey:["/api/users"],enabled:l==="reassign"}),m=Ce({mutationFn:async v=>await me("POST",`/api/users/${s.id}/reassign`,{toUserId:v}),onSuccess:()=>{i("confirm"),g({title:"í˜„ìž¥ ìž¬ë°°ì • ì™„ë£Œ",description:"í˜„ìž¥ ë‹´ë‹¹ìžê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:v=>{g({title:"ìž¬ë°°ì • ì‹¤íŒ¨",description:v.message||"í˜„ìž¥ ìž¬ë°°ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),f=Ce({mutationFn:async()=>await me("DELETE",`/api/users/${s.id}`),onSuccess:()=>{rs.invalidateQueries({queryKey:["/api/users"]}),r(),t(),g({title:"ì‚¬ìš©ìž ì‚­ì œ ì™„ë£Œ",description:"ì‚¬ìš©ìžê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:v=>{g({title:"ì‚­ì œ ì‹¤íŒ¨",description:v.message||"ì‚¬ìš©ìž ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});Re.useEffect(()=>{o&&!w&&(o.canDelete?i("confirm"):(o.references.orders.length>0,i("warning")))},[o,w]);const T=()=>{if(!n){g({title:"ë‹´ë‹¹ìž ì„ íƒ í•„ìš”",description:"ìƒˆë¡œìš´ ë‹´ë‹¹ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}m.mutate(n)},O=()=>{f.mutate()},E=p?.filter(v=>v.id!==s.id&&v.isActive)||[];return e.jsx(Gt,{open:a,onOpenChange:t,children:e.jsxs(Ft,{className:"max-w-2xl",children:[e.jsxs(Mt,{children:[e.jsxs(Rt,{className:"flex items-center gap-2",children:[e.jsx(it,{className:"h-5 w-5 text-amber-500"}),"ì‚¬ìš©ìž ì‚­ì œ"]}),e.jsx(Lt,{asChild:!0,children:e.jsxs("div",{className:"space-y-4",children:[l==="checking"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"ì‚¬ìš©ìž ì°¸ì¡° ê´€ê³„ë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]}),l==="warning"&&o&&e.jsx("div",{className:"space-y-4",children:o.references.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[s.name||s.email," ì‚¬ìš©ìžëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"font-medium text-red-800",children:["ìƒì„±í•œ ë°œì£¼ì„œ (",o.references.orders.length,"ê°œ)"]})]}),e.jsx("p",{className:"text-sm text-red-700 mb-2",children:"ë°œì£¼ì„œ ê¸°ë¡ì€ íšŒê³„ ë° ê°ì‚¬ë¥¼ ìœ„í•´ ìƒì„±ìž ì •ë³´ë¥¼ ë³´ì¡´í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsxs("div",{className:"bg-red-100 p-2 rounded text-xs text-red-800",children:[e.jsx("strong",{children:"ëŒ€ì•ˆ:"})," ì‚¬ìš©ìž ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì—­í• ì„ ë³€ê²½í•˜ì—¬ ì‹œìŠ¤í…œ ì ‘ê·¼ì„ ì œí•œí•˜ì„¸ìš”."]})]}),o.references.projects.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ot,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["ì—°ê²°ëœ í˜„ìž¥ (",o.references.projects.length,"ê°œ)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:o.references.projects.map(v=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:v.name}),e.jsx("span",{className:"text-blue-500",children:v.type==="project_manager"?"í˜„ìž¥ ê´€ë¦¬ìž":"í˜„ìž¥ ë©¤ë²„"})]},v.id))})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-amber-600 font-medium",children:[s.name||s.email," ì‚¬ìš©ìžëŠ” ë‹¤ìŒ í˜„ìž¥ê³¼ ì—°ê²°ë˜ì–´ ìžˆì–´ ë°”ë¡œ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:"]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ot,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["ì—°ê²°ëœ í˜„ìž¥ (",o.references.projects.length,"ê°œ)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:o.references.projects.map(v=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:v.name}),e.jsx("span",{className:"text-blue-500",children:v.type==="project_manager"?"í˜„ìž¥ ê´€ë¦¬ìž":"í˜„ìž¥ ë©¤ë²„"})]},v.id))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê³„ì† ì§„í–‰í•˜ë ¤ë©´ ë¨¼ì € í˜„ìž¥ ë‹´ë‹¹ìžë¥¼ ë‹¤ë¥¸ ì‚¬ìš©ìžì—ê²Œ ìž¬ë°°ì •í•´ì•¼ í•©ë‹ˆë‹¤."})]})}),l==="reassign"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"í˜„ìž¥ ë‹´ë‹¹ìžë¥¼ ìž¬ë°°ì •í•  ìƒˆë¡œìš´ ì‚¬ìš©ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"replacement-user",children:"ìƒˆë¡œìš´ ë‹´ë‹¹ìž"}),e.jsxs(Z,{value:n,onValueChange:c,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ë‹´ë‹¹ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"})}),e.jsx(ee,{children:E.map(v=>e.jsxs(R,{value:v.id,children:[v.name," (",v.email,") - ",v.role==="admin"?"ê´€ë¦¬ìž":v.role==="order_manager"?"ë°œì£¼ ë‹´ë‹¹ìž":"ì‚¬ìš©ìž"]},v.id))})]})]})]}),l==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[s.name||s.email," ì‚¬ìš©ìžë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‚¬ìš©ìžì˜ ëª¨ë“  ì •ë³´ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤."})]})]})})]}),e.jsxs($t,{children:[l==="warning"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:t,children:"ì·¨ì†Œ"}),o&&o.references.orders.length===0&&e.jsx(b,{onClick:()=>i("reassign"),children:"ìž¬ë°°ì • ì§„í–‰"})]}),l==="reassign"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:t,children:"ì·¨ì†Œ"}),e.jsx(b,{onClick:T,disabled:!n||m.isPending,children:m.isPending?"ìž¬ë°°ì • ì¤‘...":"ìž¬ë°°ì • í›„ ì‚­ì œ"})]}),l==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:t,children:"ì·¨ì†Œ"}),e.jsx(b,{variant:"destructive",onClick:O,disabled:f.isPending,children:f.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})})}const js=s=>{const a=typeof s=="string"?parseFloat(s):s;return isNaN(a)?"â‚©0":`â‚©${a.toLocaleString("ko-KR")}`},$x=s=>(typeof s=="string"?new Date(s):s).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"});function ui(s={}){return se({queryKey:["/api/ui-terms",s.category],enabled:!0})}function Rx(s){return se({queryKey:[`/api/ui-terms/${s}`],enabled:!!s})}function Lx(s,a=s){const{data:t}=Rx(s);return t?.termValue||a}function np({role:s,className:a}){const{data:t}=ui({category:"user_roles"}),r=l=>t?.find(n=>n.termKey===l)?.termValue||l;return e.jsx("span",{className:a,children:r(s)})}function ip({children:s}){const{data:a}=ui({category:"user_roles"}),r=[{value:"field_worker",termKey:"field_worker"},{value:"project_manager",termKey:"project_manager"},{value:"hq_management",termKey:"hq_management"},{value:"executive",termKey:"executive"},{value:"admin",termKey:"admin"}].map(l=>{const i=a?.find(n=>n.termKey===l.termKey);return{value:l.value,label:i?.termValue||l.value}});return e.jsx(e.Fragment,{children:s(r)})}const pi=ea("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),zx=d.forwardRef(({className:s,variant:a,size:t,...r},l)=>e.jsx(dn,{ref:l,className:V(pi({variant:a,size:t,className:s})),...r}));zx.displayName=dn.displayName;const ji=d.createContext({size:"default",variant:"default"}),qx=d.forwardRef(({className:s,variant:a,size:t,children:r,...l},i)=>e.jsx(on,{ref:i,className:V("flex items-center justify-center gap-1",s),...l,children:e.jsx(ji.Provider,{value:{variant:a,size:t},children:r})}));qx.displayName=on.displayName;const Vx=d.forwardRef(({className:s,children:a,variant:t,size:r,...l},i)=>{const n=d.useContext(ji);return e.jsx(xn,{ref:i,className:V(pi({variant:n.variant||t,size:n.size||r}),s),...l,children:a})});Vx.displayName=xn.displayName;function Kx({config:s,data:a=[]}){const t=a.length>0?a:Array.from({length:Math.min(s.rowsCount,10)},(l,i)=>Array.from({length:s.columns.length},(n,c)=>{const g=s.columns[c];return g.data==="no"?i+1:g.type==="numeric"?0:g.type==="checkbox"?!1:(g.type==="image","")})),r=(l,i)=>i.type==="numeric"?typeof l=="number"?l.toLocaleString():l||"0":i.type==="checkbox"?l?"â˜‘":"â˜":i.type==="image"?l?"ðŸ“·":"":i.type==="date"?l||"YYYY-MM-DD":l||"";return e.jsxs(L,{className:"p-1",children:[e.jsx("div",{className:"border rounded-lg overflow-auto max-h-96",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 p-2 border border-gray-300 text-center font-medium bg-gray-100",children:"#"}),s.colHeaders.map((l,i)=>e.jsx("th",{className:"p-2 border border-gray-300 text-left font-medium bg-gray-50",style:{width:s.columns[i]?.width||100,minWidth:s.columns[i]?.width||100},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:l}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:s.columns[i]?.type||"text"})]})},i))]})}),e.jsx("tbody",{children:t.map((l,i)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"w-12 p-2 border border-gray-300 text-center text-gray-500 bg-gray-50 font-medium",children:i+1}),s.columns.map((n,c)=>e.jsx("td",{className:`p-2 border border-gray-300 ${n.readOnly?"bg-gray-50":"bg-white"} ${n.type==="numeric"?"text-right":"text-left"}`,style:{width:n.width||100,minWidth:n.width||100},children:e.jsx("div",{className:"truncate",children:r(l[c],n)})},c))]},i))})]})}),e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border-t text-xs text-blue-800",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"ì´ ì»¬ëŸ¼:"})," ",s.columns.length,"ê°œ"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"ì´ í–‰:"})," ",s.rowsCount,"ê°œ"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"í‘œì‹œ:"})," ",Math.min(s.rowsCount,10),"í–‰"]})]}),e.jsx("div",{className:"mt-1 text-blue-600",children:"ðŸ’¡ ì‹¤ì œ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ì„œëŠ” ìˆ˜ì‹, ì´ë¯¸ì§€, ë“œë¡­ë‹¤ìš´ ë“± ëª¨ë“  ê¸°ëŠ¥ì´ ì§€ì›ë©ë‹ˆë‹¤"})]})]})}const We={card:"border border-border/50 shadow-sm",section:"space-y-1",label:"text-xs font-medium text-muted-foreground",input:"h-7 text-xs",button:"h-7 text-xs px-2",textarea:"min-h-[60px] text-xs resize-none",select:"h-7 text-xs"};function gi({templateId:s,onSave:a,onCancel:t}){const{toast:r}=Ze(),[l,i]=d.useState(""),[n,c]=d.useState("handsontable"),[g,o]=d.useState([]),[w,p]=d.useState({colHeaders:["í’ˆëª©ëª…","ìˆ˜ëŸ‰","ë‹¨ê°€","ì´ì•¡","ê·œê²©","ë¹„ê³ "],columns:[{data:"itemName",title:"í’ˆëª©ëª…",type:"text",width:150},{data:"quantity",title:"ìˆ˜ëŸ‰",type:"numeric",width:80},{data:"unitPrice",title:"ë‹¨ê°€",type:"numeric",width:100},{data:"totalAmount",title:"ì´ì•¡",type:"numeric",width:120,readOnly:!0},{data:"specification",title:"ê·œê²©",type:"text",width:120},{data:"notes",title:"ë¹„ê³ ",type:"text",width:150}],rowsCount:10,formulas:{},validationRules:{},customStyles:{},settings:{}}),[m,f]=d.useState(!1),[T,O]=d.useState(!1),{data:E}=se({queryKey:["/api/order-templates",s],queryFn:()=>fetch(`/api/order-templates/${s}`,{credentials:"include"}).then(u=>u.json()),enabled:!!s});d.useEffect(()=>{if(E&&s){console.log("Loading template data:",E),i(E.templateName||"");const u=E.templateType==="material_extrusion"||E.templateType==="panel_manufacturing"?"general":E.templateType;if(c(u||"handsontable"),E.fieldsConfig)try{const N=typeof E.fieldsConfig=="string"?JSON.parse(E.fieldsConfig):E.fieldsConfig;if(console.log("Parsed fieldsConfig:",N),E.templateType==="general"||E.templateType==="material_extrusion"||E.templateType==="panel_manufacturing"){if(N.fields&&Array.isArray(N.fields))o(N.fields),console.log("Loaded fields:",N.fields);else if(N&&Array.isArray(N))o(N),console.log("Loaded fields (direct array):",N);else if(N.item_fields||N.basic_fields||N.extrusion_list||N.schedule_fields||N.specification_fields||N.color_breakdown||N.material_fields||N.panel_breakdown||N.delivery_schedule||N.insulation_details){const j=[];let h=0;[{key:"basic_fields",name:"ê¸°ë³¸ ì •ë³´",data:N.basic_fields},{key:"item_fields",name:"í’ˆëª© ì •ë³´",data:N.item_fields},{key:"extrusion_list",name:"ì••ì¶œ ëª©ë¡",data:N.extrusion_list},{key:"schedule_fields",name:"ì¼ì • ì •ë³´",data:N.schedule_fields},{key:"specification_fields",name:"ì‚¬ì–‘ ì •ë³´",data:N.specification_fields},{key:"color_breakdown",name:"ìƒ‰ìƒ ë¶„ë¥˜",data:N.color_breakdown},{key:"material_fields",name:"ìž¬ë£Œ ì •ë³´",data:N.material_fields},{key:"panel_breakdown",name:"íŒë„¬ ë¶„ë¥˜",data:N.panel_breakdown},{key:"delivery_schedule",name:"ë°°ì†¡ ì¼ì •",data:N.delivery_schedule},{key:"insulation_details",name:"ë‹¨ì—´ìž¬ ìƒì„¸",data:N.insulation_details}].forEach(S=>{S.data&&Object.entries(S.data).forEach(([z,Q])=>{j.push({id:`${S.key}_${z}`,fieldType:z.includes("date")?"date":z.includes("amount")||z.includes("price")||z.includes("quantity")||z.includes("count")||z.includes("weight")||z.includes("kg")||z.includes("area")||z==="quantity"?"number":"text",fieldName:z,label:Q,placeholder:"",required:!0,validation:{},options:[],gridPosition:{row:Math.floor(h/3),col:h%3,span:1},sectionName:S.name,sortOrder:h++})})}),o(j),console.log("Converted legacy fields:",j)}}else E.templateType==="handsontable"&&(N.handsontableConfig?p(N.handsontableConfig):N.columns&&p(N))}catch(N){console.error("Error parsing fieldsConfig:",N)}E.handsontableConfig&&p(E.handsontableConfig)}},[E,s]);const v=()=>{const u={id:`field_${Date.now()}`,fieldType:"text",fieldName:`field_${g.length+1}`,label:`í•„ë“œ ${g.length+1}`,placeholder:"",required:!1,validation:{},options:[],gridPosition:{row:0,col:0,span:1},sectionName:"ê¸°ë³¸",sortOrder:g.length};o([...g,u])},F=u=>{o(g.filter(N=>N.id!==u))},_=(u,N)=>{o(g.map(j=>j.id===u?{...j,...N}:j))},k=()=>{const u={data:`col_${w.columns.length}`,title:`ì»¬ëŸ¼ ${w.columns.length+1}`,type:"text",width:100};p({...w,colHeaders:[...w.colHeaders,u.title],columns:[...w.columns,u]})},A=u=>{const N=w.columns.filter((h,I)=>I!==u),j=w.colHeaders.filter((h,I)=>I!==u);p({...w,colHeaders:j,columns:N})},x=(u,N)=>{const j=w.columns.map((S,z)=>z===u?{...S,...N}:S),h=w.colHeaders.map((S,z)=>z===u&&N.title?N.title:S),I={...w,colHeaders:h,columns:j};console.log("updateColumn called:",{index:u,updates:N,newConfig:I}),p(I)},D=async()=>{if(!l.trim()){r({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ì´ë¦„ì„ ìž…ë ¥í•˜ì„¸ìš”.",variant:"destructive"});return}O(!0);try{const u={templateName:l,templateType:n,fieldsConfig:JSON.stringify(n==="general"?{fields:g}:{handsontableConfig:w}),handsontableConfig:n==="handsontable"?w:void 0,isActive:!0};s?await fetch(`/api/order-templates/${s}`,{method:"PUT",body:JSON.stringify(u),headers:{"Content-Type":"application/json"},credentials:"include"}):await fetch("/api/order-templates",{method:"POST",body:JSON.stringify(u),headers:{"Content-Type":"application/json"},credentials:"include"}),rs.invalidateQueries({queryKey:["/api/order-templates"]}),a&&a(u),r({title:"ì„±ê³µ",description:"í…œí”Œë¦¿ì´ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤."})}catch(u){console.error("Template save error:",u),r({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}finally{O(!1)}};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h2",{className:"text-sm font-semibold",children:"í…œí”Œë¦¿ ë¹Œë”"}),e.jsx(B,{variant:n==="handsontable"?"default":"secondary",className:"text-xs",children:n==="handsontable"?"ì‹œíŠ¸ìœ í˜•":"ì¼ë°˜í¼"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>f(!m),className:We.button,children:[e.jsx(ls,{className:"w-3 h-3 mr-1"}),"ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs(b,{onClick:D,disabled:T,size:"sm",className:We.button,children:[e.jsx(Ks,{className:"w-3 h-3 mr-1"}),"ì €ìž¥"]}),t&&e.jsx(b,{variant:"outline",onClick:t,size:"sm",className:We.button,children:"ì·¨ì†Œ"})]})]}),m?e.jsx("div",{className:"h-[calc(100vh-200px)]",children:e.jsxs(L,{className:"h-full",children:[e.jsx(H,{className:"pb-2",children:e.jsxs(W,{className:"text-sm",children:["í…œí”Œë¦¿ ë¯¸ë¦¬ë³´ê¸° - ",l]})}),e.jsx(q,{children:e.jsx(ra,{className:"h-[calc(100vh-280px)]",children:n==="general"?e.jsx("div",{className:"space-y-4",children:g.length===0?e.jsx("div",{className:"text-center text-muted-foreground text-sm py-8",children:"í•„ë“œë¥¼ ì¶”ê°€í•˜ì—¬ í¼ì„ êµ¬ì„±í•˜ì„¸ìš”"}):e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx("div",{className:"grid grid-cols-3 gap-4",children:g.map(u=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{className:"text-sm font-medium",children:[u.label||u.fieldName,u.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),u.fieldType==="textarea"?e.jsx(Ge,{placeholder:u.placeholder,className:"h-20",disabled:!0}):u.fieldType==="select"?e.jsx(Z,{disabled:!0,children:e.jsx(Y,{children:e.jsx(X,{placeholder:u.placeholder})})}):e.jsx(U,{type:u.fieldType==="number"?"number":u.fieldType==="date"?"date":"text",placeholder:u.placeholder,disabled:!0})]},u.id))})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"ì‹œíŠ¸ìœ í˜• ë¯¸ë¦¬ë³´ê¸°"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ì‹¤ì œ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ êµ¬ì¡° ë° ë°ì´í„° íƒ€ìž…"})]}),e.jsx(Kx,{config:w})]})})})]})}):e.jsxs("div",{className:"grid grid-cols-12 gap-2 h-[calc(100vh-200px)]",children:[e.jsx("div",{className:"col-span-4 border-r pr-2",children:e.jsx(ra,{className:"h-full",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{className:We.card,children:[e.jsx(H,{className:"pb-1",children:e.jsx(W,{className:"text-xs",children:"ê¸°ë³¸ ì„¤ì •"})}),e.jsxs(q,{className:"space-y-1.5",children:[e.jsxs("div",{className:We.section,children:[e.jsx(P,{className:We.label,children:"í…œí”Œë¦¿ ì´ë¦„"}),e.jsx(U,{value:l,onChange:u=>i(u.target.value),placeholder:"í…œí”Œë¦¿ ì´ë¦„ ìž…ë ¥",className:We.input})]}),e.jsxs("div",{className:We.section,children:[e.jsx(P,{className:We.label,children:"í…œí”Œë¦¿ ìœ í˜•"}),e.jsxs(Z,{value:n,onValueChange:u=>c(u),children:[e.jsx(Y,{className:We.input,children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"general",children:"ì¼ë°˜í¼"}),e.jsx(R,{value:"handsontable",children:"ì‹œíŠ¸í¼"})]})]})]})]})]}),e.jsxs(kt,{value:n,className:"w-full",children:[e.jsxs(vt,{className:"grid w-full grid-cols-2 h-7",children:[e.jsx(is,{value:"general",className:"text-xs h-5",children:"ì¼ë°˜í¼"}),e.jsx(is,{value:"handsontable",className:"text-xs h-5",children:"ì‹œíŠ¸í¼"})]}),e.jsx(hs,{value:"general",className:"space-y-2 mt-2",children:e.jsxs(L,{className:We.card,children:[e.jsx(H,{className:"pb-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{className:"text-xs",children:"í•„ë“œ ê´€ë¦¬"}),e.jsxs(b,{size:"sm",onClick:v,className:We.button,children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"ì¶”ê°€"]})]})}),e.jsx(q,{className:"space-y-2",children:g.map((u,N)=>e.jsxs("div",{className:"p-2 border rounded space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(P,{className:"text-xs font-medium",children:["í•„ë“œ ",N+1]}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>F(u.id),className:"h-6 w-6 p-0",children:e.jsx(Qe,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"í•„ë“œëª…"}),e.jsx(U,{value:u.fieldName,onChange:j=>_(u.id,{fieldName:j.target.value}),className:We.input})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"ë¼ë²¨"}),e.jsx(U,{value:u.label,onChange:j=>_(u.id,{label:j.target.value}),className:We.input})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"ìœ í˜•"}),e.jsxs(Z,{value:u.fieldType,onValueChange:j=>_(u.id,{fieldType:j}),children:[e.jsx(Y,{className:We.input,children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"text",children:"í…ìŠ¤íŠ¸"}),e.jsx(R,{value:"number",children:"ìˆ«ìž"}),e.jsx(R,{value:"date",children:"ë‚ ì§œ"}),e.jsx(R,{value:"select",children:"ì„ íƒ"}),e.jsx(R,{value:"textarea",children:"ê¸´í…ìŠ¤íŠ¸"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"í”Œë ˆì´ìŠ¤í™€ë”"}),e.jsx(U,{value:u.placeholder,onChange:j=>_(u.id,{placeholder:j.target.value}),className:We.input})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gs,{checked:u.required,onCheckedChange:j=>_(u.id,{required:j})}),e.jsx(P,{className:"text-xs",children:"í•„ìˆ˜"})]})]},u.id))})]})}),e.jsx(hs,{value:"handsontable",className:"space-y-2 mt-2",children:e.jsxs(L,{className:We.card,children:[e.jsx(H,{className:"pb-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{className:"text-xs",children:"ì»¬ëŸ¼ ê´€ë¦¬"}),e.jsxs(b,{size:"sm",onClick:k,className:We.button,children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"ì¶”ê°€"]})]})}),e.jsx(q,{className:"space-y-2",children:w.columns.map((u,N)=>e.jsxs("div",{className:"p-2 border rounded space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(P,{className:"text-xs font-medium",children:["ì»¬ëŸ¼ ",N+1]}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>A(N),className:"h-6 w-6 p-0",children:e.jsx(Qe,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"ì œëª©"}),e.jsx(U,{value:u.title,onChange:j=>x(N,{title:j.target.value}),className:We.input})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"ë°ì´í„°"}),e.jsx(U,{value:u.data,onChange:j=>x(N,{data:j.target.value}),className:We.input})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"ìœ í˜•"}),e.jsxs(Z,{value:u.type,onValueChange:j=>x(N,{type:j}),children:[e.jsx(Y,{className:We.input,children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"text",children:"í…ìŠ¤íŠ¸"}),e.jsx(R,{value:"numeric",children:"ìˆ«ìž"}),e.jsx(R,{value:"date",children:"ë‚ ì§œ"}),e.jsx(R,{value:"dropdown",children:"ë“œë¡­ë‹¤ìš´"}),e.jsx(R,{value:"checkbox",children:"ì²´í¬ë°•ìŠ¤"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-muted-foreground",children:"ë„ˆë¹„"}),e.jsx(U,{type:"number",value:u.width||100,onChange:j=>x(N,{width:parseInt(j.target.value)}),className:We.input})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gs,{checked:u.readOnly||!1,onCheckedChange:j=>x(N,{readOnly:j})}),e.jsx(P,{className:"text-xs",children:"ì½ê¸°ì „ìš©"})]})]},N))})]})})]})]})})}),e.jsx("div",{className:"col-span-8",children:e.jsxs(L,{className:"h-full",children:[e.jsx(H,{className:"pb-2",children:e.jsx(W,{className:"text-sm",children:"ë¯¸ë¦¬ë³´ê¸°"})}),e.jsx(q,{children:e.jsx(ra,{className:"h-[calc(100vh-300px)]",children:n==="general"?e.jsx("div",{className:"space-y-2",children:g.length===0?e.jsx("div",{className:"text-center text-muted-foreground text-sm py-8",children:"í•„ë“œë¥¼ ì¶”ê°€í•˜ì—¬ í¼ì„ êµ¬ì„±í•˜ì„¸ìš”"}):e.jsx("div",{className:"grid grid-cols-3 gap-2",children:g.map(u=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs(P,{className:We.label,children:[u.label||u.fieldName,u.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),u.fieldType==="textarea"?e.jsx(Ge,{placeholder:u.placeholder,className:"h-16 text-xs",disabled:!0}):u.fieldType==="select"?e.jsx(Z,{disabled:!0,children:e.jsx(Y,{className:We.input,children:e.jsx(X,{placeholder:u.placeholder})})}):e.jsx(U,{type:u.fieldType==="number"?"number":u.fieldType==="date"?"date":"text",placeholder:u.placeholder,className:We.input,disabled:!0})]},u.id))})}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"ì‹œíŠ¸ìœ í˜• ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-8 p-1 border-r text-center font-medium",children:"#"}),w.colHeaders.map((u,N)=>e.jsx("th",{className:"p-1 border-r text-left font-medium",style:{width:w.columns[N]?.width||100},children:u},N))]})}),e.jsx("tbody",{children:Array.from({length:Math.min(w.rowsCount,5)},(u,N)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-1 border-r text-center bg-gray-50 font-medium",children:N+1}),w.columns.map((j,h)=>e.jsx("td",{className:"p-1 border-r",children:e.jsx("div",{className:"text-gray-400 text-xs",children:j.type==="numeric"?"0":j.type==="checkbox"?"â˜":j.type==="date"?"YYYY-MM-DD":j.type==="dropdown"?"ì„ íƒâ–¼":j.type==="image"?"ðŸ“·":`${j.title} ê°’`})},h))]},N))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"font-medium text-blue-800",children:"ì»¬ëŸ¼ ìˆ˜"}),e.jsxs("div",{className:"text-blue-600",children:[w.columns.length,"ê°œ"]})]}),e.jsxs("div",{className:"p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"font-medium text-green-800",children:"í–‰ ìˆ˜"}),e.jsxs("div",{className:"text-green-600",children:[w.rowsCount,"í–‰"]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"ì‹œíŠ¸ìœ í˜• êµ¬ì„± ì™„ë£Œ"}),e.jsxs("div",{className:"text-sm text-blue-800 grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"ì»¬ëŸ¼:"})," ",w.columns.length,"ê°œ"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"í–‰:"})," ",w.rowsCount,"ê°œ"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ìˆ˜ì‹:"})," ",Object.keys(w.formulas).length,"ê°œ"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ê²€ì¦:"})," ",Object.keys(w.validationRules).length,"ê°œ"]})]})]})]})})})]})})]})]})}function Ux(){const{toast:s}=Ze(),a=us(),[t,r]=d.useState(""),[l,i]=d.useState(null),[n,c]=d.useState(!1),[g,o]=d.useState(!1),[w,p]=d.useState("card"),m=Lx("template_type_label","ì‹œíŠ¸í¼"),{data:f=[],isLoading:T}=se({queryKey:["/api/admin/templates"],queryFn:async()=>{const I=await(await fetch("/api/admin/templates",{credentials:"include"})).json();return console.log("ðŸ” Templates API response:",I),Array.isArray(I)?I:[]}}),O=Ce({mutationFn:h=>fetch("/api/admin/templates",{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json"},credentials:"include"}).then(I=>I.json()),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/admin/templates"]}),c(!1),s({title:"ì„±ê³µ",description:"í…œí”Œë¦¿ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{s({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),E=Ce({mutationFn:({id:h,templateData:I})=>fetch(`/api/admin/templates/${h}`,{method:"PUT",body:JSON.stringify(I),headers:{"Content-Type":"application/json"},credentials:"include"}).then(S=>S.json()),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/admin/templates"]}),c(!1),o(!1),i(null),s({title:"ì„±ê³µ",description:"í…œí”Œë¦¿ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{s({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),v=Ce({mutationFn:async h=>{if(!(await fetch(`/api/admin/templates/${h}`,{method:"DELETE",credentials:"include",headers:{"Cache-Control":"no-cache"}})).ok)throw new Error("Failed to delete template");return{id:h}},onSuccess:h=>{a.setQueryData(["/api/order-templates"],I=>I&&I.filter(S=>S.id!==h.id)),a.removeQueries({queryKey:["/api/order-templates"]}),a.invalidateQueries({queryKey:["/api/admin/templates"]}),a.refetchQueries({queryKey:["/api/order-templates"],type:"active",exact:!0}),s({title:"ì„±ê³µ",description:"í…œí”Œë¦¿ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:h=>{console.error("Delete template error:",h),s({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),F=Ce({mutationFn:({id:h,isActive:I})=>fetch(`/api/order-templates/${h}/toggle-status`,{method:"PATCH",body:JSON.stringify({isActive:I}),headers:{"Content-Type":"application/json"},credentials:"include"}).then(S=>S.json()),onSuccess:(h,I)=>{a.invalidateQueries({queryKey:["/api/admin/templates"]}),s({title:"ì„±ê³µ",description:`í…œí”Œë¦¿ì´ ${I.isActive?"í™œì„±í™”":"ë¹„í™œì„±í™”"}ë˜ì—ˆìŠµë‹ˆë‹¤.`})},onError:()=>{s({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ìƒíƒœ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),_=Array.isArray(f)?f.filter(h=>h.templateName.toLowerCase().includes(t.toLowerCase())):[],k=h=>A(h)==="sheet"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800",A=h=>["handsontable","excel_like"].includes(h)?"sheet":"general",x=h=>A(h)==="sheet"?m:"ì¼ë°˜í¼",D=h=>{g&&l?E.mutate({id:l.id,templateData:h}):O.mutate(h)},u=h=>{i(h),o(!0),c(!0)},N=h=>{const I={...h,templateName:`${h.templateName} (ë³µì‚¬ë³¸)`},{id:S,...z}=I;O.mutate(z)},j=()=>{i(null),o(!1),c(!0)};return n?e.jsx(gi,{templateId:l?.id,onSave:D,onCancel:()=>{c(!1),o(!1),i(null)}}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sa,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"í…œí”Œë¦¿ ê´€ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"ë°œì£¼ì„œ í…œí”Œë¦¿ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{variant:"outline",className:"text-sm",children:["ì´ ",_.length,"ê°œ"]}),e.jsxs(b,{onClick:j,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"ìƒˆ í…œí”Œë¦¿"]})]})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(U,{value:t,onChange:h=>r(h.target.value),placeholder:"í…œí”Œë¦¿ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰...",className:"h-10"})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fs,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{children:["ì‹œíŠ¸ ",f.filter(h=>A(h.templateType)==="sheet").length]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gt,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{children:["í¼ ",f.filter(h=>A(h.templateType)==="general").length]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Tc,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{children:["í™œì„± ",f.filter(h=>h.isActive).length]})]})]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(b,{variant:w==="list"?"default":"ghost",size:"sm",onClick:()=>p("list"),className:"h-8 w-8 p-0",title:"ëª©ë¡ ë³´ê¸°",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx(b,{variant:w==="card"?"default":"ghost",size:"sm",onClick:()=>p("card"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(gt,{className:"h-4 w-4"})})]})]})]})}),w==="card"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:T?Array.from({length:6}).map((h,I)=>e.jsx(L,{className:"animate-pulse shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-3"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-2/3"})]})},I)):_.length===0?e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-600",children:t?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤"}),!t&&e.jsxs(b,{onClick:j,variant:"outline",className:"mt-4",size:"sm",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"ì²« í…œí”Œë¦¿ ë§Œë“¤ê¸°"]})]}):_.map(h=>e.jsx(L,{className:"p-4 hover:shadow-md transition-shadow shadow-sm",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"font-semibold text-gray-900 cursor-pointer hover:text-blue-600 truncate",onClick:()=>u(h),children:h.templateName})}),e.jsx(B,{variant:"secondary",className:`text-xs ml-2 flex-shrink-0 ${k(h.templateType)}`,children:x(h.templateType)})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ìƒì„±:"}),e.jsx("span",{children:new Date(h.createdAt).toLocaleDateString("ko-KR")})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ìˆ˜ì •:"}),e.jsx("span",{children:new Date(h.updatedAt).toLocaleDateString("ko-KR")})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"êµ¬ì„±:"}),h.templateType==="handsontable"&&h.fieldsConfig?.handsontable?e.jsxs("span",{className:"text-blue-600",children:["ì»¬ëŸ¼ ",h.fieldsConfig.handsontable.columns?.length||0,"ê°œ"]}):h.fieldsConfig?.fields?e.jsxs("span",{className:"text-green-600",children:["í•„ë“œ ",h.fieldsConfig.fields.length||0,"ê°œ"]}):e.jsx("span",{className:"text-gray-500",children:"ê¸°ë³¸ í…œí”Œë¦¿"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(b,{onClick:()=>u(h),variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{onClick:()=>N(h),variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"ë³µì‚¬",children:e.jsx(na,{className:"h-3 w-3"})}),e.jsxs(Gt,{children:[e.jsx(da,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",disabled:v.isPending,title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})}),e.jsxs(Ft,{children:[e.jsxs(Mt,{children:[e.jsx(Rt,{children:"í…œí”Œë¦¿ ì‚­ì œ"}),e.jsxs(Lt,{children:["'",h.templateName,"' í…œí”Œë¦¿ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs($t,{children:[e.jsx(Yt,{children:"ì·¨ì†Œ"}),e.jsx(Jt,{onClick:()=>v.mutate(h.id),className:"bg-red-600 hover:bg-red-700",children:"ì‚­ì œ"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:h.isActive?"í™œì„±":"ë¹„í™œì„±"}),e.jsx(Gs,{checked:h.isActive,onCheckedChange:I=>F.mutate({id:h.id,isActive:I})})]})]})]})},h.id))}):e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"íƒ€ìž…"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"í…œí”Œë¦¿ëª…"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ìƒì„±ì¼"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ìˆ˜ì •ì¼"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"êµ¬ì„±"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ìƒíƒœ"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ì•¡ì…˜"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:T?Array.from({length:6}).map((h,I)=>e.jsxs("tr",{className:"animate-pulse",children:[e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})})]},I)):_.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-600",children:t?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤"}),!t&&e.jsxs(b,{onClick:j,variant:"outline",className:"mt-4",size:"sm",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"ì²« í…œí”Œë¦¿ ë§Œë“¤ê¸°"]})]})}):_.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-4",children:e.jsx(B,{variant:"secondary",className:`text-xs ${k(h.templateType)}`,children:x(h.templateType)})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("button",{onClick:()=>u(h),className:"text-sm font-medium text-blue-600 hover:text-blue-800 text-left",children:h.templateName})}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:new Date(h.createdAt).toLocaleDateString("ko-KR")}),e.jsx("td",{className:"py-2 px-4 text-sm text-gray-600",children:new Date(h.updatedAt).toLocaleDateString("ko-KR")}),e.jsx("td",{className:"py-2 px-4 text-sm",children:h.templateType==="handsontable"&&h.fieldsConfig?.handsontable?e.jsxs("span",{className:"text-blue-600",children:["ì»¬ëŸ¼ ",h.fieldsConfig.handsontable.columns?.length||0,"ê°œ"]}):h.fieldsConfig?.fields?e.jsxs("span",{className:"text-green-600",children:["í•„ë“œ ",h.fieldsConfig.fields.length||0,"ê°œ"]}):e.jsx("span",{className:"text-gray-500",children:"ê¸°ë³¸"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:h.isActive?"í™œì„±":"ë¹„í™œì„±"}),e.jsx(Gs,{checked:h.isActive,onCheckedChange:I=>F.mutate({id:h.id,isActive:I})})]})}),e.jsx("td",{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(b,{onClick:()=>u(h),variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-50",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"w-4 h-4"})}),e.jsx(b,{onClick:()=>N(h),variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-50",title:"ë³µì‚¬",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsxs(Gt,{children:[e.jsx(da,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:bg-red-50",disabled:v.isPending,title:"ì‚­ì œ",children:e.jsx(Qe,{className:"w-4 h-4"})})}),e.jsxs(Ft,{children:[e.jsxs(Mt,{children:[e.jsx(Rt,{children:"í…œí”Œë¦¿ ì‚­ì œ"}),e.jsxs(Lt,{children:["'",h.templateName,"' í…œí”Œë¦¿ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs($t,{children:[e.jsx(Yt,{children:"ì·¨ì†Œ"}),e.jsx(Jt,{onClick:()=>v.mutate(h.id),className:"bg-red-600 hover:bg-red-700",children:"ì‚­ì œ"})]})]})]})]})})]},h.id))})]})})})]})})}const Bx=Object.freeze(Object.defineProperty({__proto__:null,default:Ux},Symbol.toStringTag,{value:"Module"}));function fi({columns:s,data:a,searchKey:t,searchPlaceholder:r="ê²€ìƒ‰...",filters:l=[],onRowClick:i,className:n,isLoading:c=!1,enablePagination:g=!0,pageSize:o=20,emptyMessage:w="ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤",enableVirtualization:p=!1,virtualItemHeight:m=60,virtualContainerHeight:f=400,virtualizationThreshold:T=100}){const[O,E]=d.useState([]),[v,F]=d.useState([]),[_,k]=d.useState(""),[A,x]=d.useState(!1);Ea("OptimizedDataTable"),br();const D=d.useMemo(()=>s,[s]),u=d.useMemo(()=>a,[a]),N=d.useMemo(()=>p===!1?!1:a.length>=T||p===!0,[a.length,p,T]);d.useEffect(()=>{x(N)},[N]);const j=Pc({data:u,columns:D,getCoreRowModel:dd(),getSortedRowModel:od(),getFilteredRowModel:xd(),getPaginationRowModel:g&&!A?md():void 0,onSortingChange:E,onColumnFiltersChange:F,onGlobalFilterChange:k,state:{sorting:O,columnFilters:v,globalFilter:_},initialState:{pagination:{pageSize:A?a.length:o}}}),h=d.useCallback(S=>{k(S)},[]),I=d.useCallback((S,z)=>{F(Q=>z==="all"?Q.filter(K=>K.id!==S):Q.some(K=>K.id===S)?Q.map(K=>K.id===S?{...K,value:z}:K):[...Q,{id:S,value:z}])},[]);return c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-10 w-80 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-32 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"space-y-2 p-4",children:Array.from({length:5}).map((S,z)=>e.jsx("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},z))})})]}):e.jsxs("div",{className:V("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2",children:[a.length>=T&&e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-50 rounded-md border border-blue-200",children:[e.jsx(ia,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-700",children:"ê°€ìƒí™” í™œì„±"}),e.jsx("button",{onClick:()=>x(!A),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:A?"ë¹„í™œì„±í™”":"í™œì„±í™”"})]}),t&&e.jsxs("div",{className:"relative flex-1 min-w-80",children:[e.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(U,{placeholder:r,value:_,onChange:S=>h(S.target.value),className:"pl-10"})]}),l.map(S=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(mr,{className:"h-4 w-4 text-gray-500"}),e.jsxs("select",{value:v.find(z=>z.id===S.key)?.value||"all",onChange:z=>I(S.key,z.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsxs("option",{value:"all",children:["ëª¨ë“  ",S.label]}),S.options.map(z=>e.jsx("option",{value:z.value,children:z.label},z.value))]})]},S.key)),v.length>0&&e.jsx("div",{className:"flex items-center space-x-2",children:v.map(S=>{const z=l.find(K=>K.key===S.id),Q=z?.options.find(K=>K.value===S.value);return e.jsxs(B,{variant:"secondary",className:"text-xs",children:[z?.label,": ",Q?.label,e.jsx("button",{onClick:()=>I(S.id,"all"),className:"ml-1 hover:bg-gray-300 rounded-full p-0.5",children:"Ã—"})]},S.id)})})]}),e.jsx("div",{className:"rounded-md border",children:A?e.jsx(Qx,{table:j,columns:s,onRowClick:i,itemHeight:m,containerHeight:f,emptyMessage:w}):e.jsxs(et,{children:[e.jsx(st,{children:j.getHeaderGroups().map(S=>e.jsx(Me,{children:S.headers.map(z=>e.jsx(oe,{className:V("font-medium text-gray-700",z.column.getCanSort()&&"cursor-pointer select-none hover:bg-gray-50"),onClick:z.column.getToggleSortingHandler(),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[z.isPlaceholder?null:va(z.column.columnDef.header,z.getContext()),z.column.getCanSort()&&e.jsx("span",{className:"text-gray-400",children:{asc:"â†‘",desc:"â†“"}[z.column.getIsSorted()]??"â†•"})]})},z.id))},S.id))}),e.jsx(tt,{children:j.getRowModel().rows?.length?j.getRowModel().rows.map(S=>e.jsx(Me,{"data-state":S.getIsSelected()&&"selected",className:V("hover:bg-gray-50 transition-colors",i&&"cursor-pointer"),onClick:()=>i?.(S.original),children:S.getVisibleCells().map(z=>e.jsx(G,{className:"py-3 px-4",children:va(z.column.columnDef.cell,z.getContext())},z.id))},S.id)):e.jsx(Me,{children:e.jsx(G,{colSpan:s.length,className:"h-24 text-center text-gray-500",children:w})})})]})}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 py-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 flex items-center space-x-4",children:[e.jsxs("span",{children:["ì´ ",j.getFilteredRowModel().rows.length,"ê°œ",!A&&g&&e.jsxs(e.Fragment,{children:[" ","ì¤‘"," ",j.getState().pagination.pageIndex*j.getState().pagination.pageSize+1,"-",Math.min((j.getState().pagination.pageIndex+1)*j.getState().pagination.pageSize,j.getFilteredRowModel().rows.length),"ê°œ í‘œì‹œ"]})]}),A&&e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[e.jsx(ia,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"ê°€ìƒí™” ë Œë”ë§ í™œì„±"})]})]}),g&&!A&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>j.previousPage(),disabled:!j.getCanPreviousPage(),children:[e.jsx(hr,{className:"h-4 w-4"}),"ì´ì „"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"íŽ˜ì´ì§€"}),e.jsxs("strong",{className:"text-sm",children:[j.getState().pagination.pageIndex+1," / ",j.getPageCount()]})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>j.nextPage(),disabled:!j.getCanNextPage(),children:["ë‹¤ìŒ",e.jsx(mt,{className:"h-4 w-4"})]})]})]})]})}function Qx({table:s,columns:a,onRowClick:t,itemHeight:r,containerHeight:l,emptyMessage:i}){const n=s.getRowModel().rows;return n?.length?e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"border-b bg-gray-50",children:e.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${a.length}, 1fr)`},children:s.getHeaderGroups().map(c=>c.headers.map(g=>e.jsx("div",{className:V("px-4 py-3 text-left font-medium text-gray-700 border-r last:border-r-0",g.column.getCanSort()&&"cursor-pointer select-none hover:bg-gray-100"),onClick:g.column.getToggleSortingHandler(),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[g.isPlaceholder?null:va(g.column.columnDef.header,g.getContext()),g.column.getCanSort()&&e.jsx("span",{className:"text-gray-400",children:{asc:"â†‘",desc:"â†“"}[g.column.getIsSorted()]??"â†•"})]})},g.id)))})}),e.jsx(fo,{items:n,itemHeight:r,containerHeight:l,className:"border-0",renderItem:(c,g)=>e.jsx("div",{className:V("grid border-b hover:bg-gray-50 transition-colors",t&&"cursor-pointer"),style:{gridTemplateColumns:`repeat(${a.length}, 1fr)`},onClick:()=>t?.(c.original),children:c.getVisibleCells().map(o=>e.jsx("div",{className:"px-4 py-3 border-r last:border-r-0 flex items-center",children:va(o.column.columnDef.cell,o.getContext())},o.id))})})]}):e.jsx("div",{className:"h-24 flex items-center justify-center text-gray-500",children:i})}function Hx(s){return e.jsx(fi,{...s,enableVirtualization:!0,enablePagination:!1,virtualizationThreshold:50})}const Wx=Object.freeze(Object.defineProperty({__proto__:null,OptimizedDataTable:fi,VirtualDataTable:Hx},Symbol.toStringTag,{value:"Module"}));function La({items:s,renderItem:a,itemHeight:t,containerHeight:r,overscan:l=5,className:i,onScroll:n,onReachEnd:c,scrollEndThreshold:g=100,enableSmoothScrolling:o=!0,loadingItemsCount:w=3,isLoading:p=!1,emptyMessage:m="í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤",EmptyComponent:f,LoadingComponent:T}){const[O,E]=d.useState(0),[v,F]=d.useState(!1),_=d.useRef(null),k=d.useRef();Ea("VirtualScrollList");const{height:A}=br(),x=r||Math.min(A*.6,500),D=d.useCallback(z=>typeof t=="function"?t(z):t,[t]),{startIndex:u,endIndex:N,totalHeight:j,offsetY:h}=d.useMemo(()=>{if(s.length===0)return{startIndex:0,endIndex:0,totalHeight:0,offsetY:0};let z=0,Q=0,K=0,ne=0;for(let je=0;je<s.length;je++){const y=D(je);if(z+y>O){Q=Math.max(0,je-l),ne=z-(je-Q)*(typeof t=="number"?t:50);break}z+=y}z=0;for(let je=Q;je<s.length;je++)if(z+=D(je),z>x+O){K=Math.min(s.length,je+l);break}K===0&&(K=s.length);let Se=0;for(let je=0;je<s.length;je++)Se+=D(je);return{startIndex:Q,endIndex:K,totalHeight:Se,offsetY:ne}},[s.length,O,x,l,D]),I=d.useMemo(()=>s.slice(u,N).map((z,Q)=>({item:z,index:u+Q,globalIndex:u+Q})),[s,u,N]),S=d.useCallback(z=>{const Q=z.currentTarget.scrollTop;E(Q),F(!0),n?.(Q);const{scrollHeight:K,clientHeight:ne}=z.currentTarget;K-Q-ne<g&&c?.(),k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{F(!1)},150)},[n,c,g]);return d.useEffect(()=>()=>{k.current&&clearTimeout(k.current)},[]),p&&s.length===0?T?e.jsx(T,{count:w}):e.jsx("div",{className:V("space-y-2 p-4",i),style:{height:x},children:Array.from({length:w}).map((z,Q)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(rt,{className:"h-4 w-3/4"}),e.jsx(rt,{className:"h-4 w-1/2"})]},Q))}):s.length===0?f?e.jsx(f,{}):e.jsx("div",{className:V("flex items-center justify-center text-gray-500 bg-gray-50",i),style:{height:x},children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm",children:m})})}):e.jsx("div",{ref:_,className:V("overflow-auto",o&&"scroll-smooth",i),style:{height:x},onScroll:S,children:e.jsx("div",{style:{height:j,position:"relative"},children:e.jsxs("div",{style:{transform:`translateY(${h}px)`,position:"absolute",top:0,left:0,right:0},children:[I.map(({item:z,index:Q,globalIndex:K})=>e.jsx("div",{style:{height:D(K)},className:"flex flex-col justify-center",children:a(z,K,!v)},K)),p&&s.length>0&&e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ë¡œë”© ì¤‘..."})]})]})})})}function Ni({hasNextPage:s,isFetchingNextPage:a,fetchNextPage:t,...r}){const l=d.useCallback(()=>{s&&!a&&t&&t()},[s,a,t]);return e.jsx(La,{...r,onReachEnd:l,isLoading:a})}function Gx({items:s,renderItem:a,columnCount:t,itemHeight:r,itemWidth:l,gap:i=16,containerHeight:n=400,className:c}){const g=Math.ceil(s.length/t),o=r+i;return e.jsx(La,{items:Array.from({length:g},(w,p)=>p),itemHeight:o,containerHeight:n,className:c,renderItem:w=>e.jsx("div",{className:"flex gap-4",style:{gap:i},children:Array.from({length:t},(p,m)=>{const f=w*t+m,T=s[f];return T?e.jsx("div",{style:{width:l,flex:l?"none":"1"},children:a(T,f)},m):e.jsx("div",{style:{width:l,flex:l?"none":"1"}},m)})})})}function Jx({items:s,renderItem:a,itemWidth:t,containerWidth:r=800,containerHeight:l=200,gap:i=12,className:n}){const[c,g]=d.useState(0),o=Math.ceil(r/(t+i))+2,w=Math.max(0,Math.floor(c/(t+i))-1),p=Math.min(s.length,w+o),m=s.length*(t+i),f=s.slice(w,p);return e.jsx("div",{className:V("overflow-x-auto overflow-y-hidden",n),style:{width:r,height:l},onScroll:T=>g(T.currentTarget.scrollLeft),children:e.jsx("div",{style:{width:m,height:"100%",position:"relative"},children:e.jsx("div",{style:{transform:`translateX(${w*(t+i)}px)`,position:"absolute",height:"100%",display:"flex",gap:i},children:f.map((T,O)=>e.jsx("div",{style:{width:t,flexShrink:0},children:a(T,w+O)},w+O))})})})}const Yx=Object.freeze(Object.defineProperty({__proto__:null,HorizontalVirtualList:Jx,InfiniteVirtualList:Ni,VirtualGrid:Gx,VirtualScrollList:La},Symbol.toStringTag,{value:"Module"})),yi={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",approved:"bg-green-100 text-green-800 border-green-200",sent:"bg-blue-100 text-blue-800 border-blue-200",cancelled:"bg-red-100 text-red-800 border-red-200",draft:"bg-gray-100 text-gray-800 border-gray-200"},vi={pending:"ìŠ¹ì¸ëŒ€ê¸°",approved:"ìŠ¹ì¸ì™„ë£Œ",sent:"ë°œì†¡ì™„ë£Œ",cancelled:"ì·¨ì†Œë¨",draft:"ìž„ì‹œì €ìž¥"},Zx={high:"text-red-600",medium:"text-yellow-600",low:"text-green-600"};function Xx({order:s,onClick:a,onAction:t,isVisible:r=!0}){return r?e.jsx("div",{className:"p-4 border-b border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer group",onClick:()=>a?.(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ye,{className:"h-5 w-5 text-blue-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:s.title}),s.priority&&e.jsx("span",{className:`text-xs font-medium ${Zx[s.priority]}`,children:s.priority==="high"?"ê¸´ê¸‰":s.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[s.projectName&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ws,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-32",children:s.projectName})]}),s.vendorName&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ks,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-32",children:s.vendorName})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_s,{className:"h-3 w-3"}),e.jsx("span",{children:Ds(s.createdAt)})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm font-medium text-gray-900",children:[e.jsx(Xs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:Ee(s.amount)})]}),e.jsx(B,{variant:"outline",className:`text-xs mt-1 ${yi[s.status]}`,children:vi[s.status]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[s.status==="pending"&&e.jsx(b,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs",onClick:l=>{l.stopPropagation(),t?.(s,"approve")},children:"ìŠ¹ì¸"}),e.jsx(mt,{className:"h-4 w-4 text-gray-400 group-hover:text-gray-600"})]})]})]})}):e.jsxs("div",{className:"p-4 border-b border-gray-200 animate-pulse",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})]}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})}function em({orders:s,onOrderClick:a,onOrderAction:t,containerHeight:r=600,enableInfiniteScroll:l=!1,hasNextPage:i,isFetchingNextPage:n,fetchNextPage:c,isLoading:g=!1}){const o=(f,T,O=!0)=>e.jsx(Xx,{order:f,onClick:a,onAction:t,isVisible:O},f.id),w="ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤",p=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(ye,{className:"h-12 w-12 text-gray-300 mb-4"}),e.jsx("p",{className:"text-sm",children:w}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ìƒˆ ë°œì£¼ì„œë¥¼ ìƒì„±í•´ë³´ì„¸ìš”"})]}),m=({count:f})=>e.jsx("div",{className:"space-y-1",children:Array.from({length:f}).map((T,O)=>e.jsx("div",{className:"p-4 border-b border-gray-200 animate-pulse",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),e.jsxs("div",{className:"space-y-1 text-right",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-16"})]})]})},O))});return l?e.jsx(Ni,{items:s,renderItem:o,itemHeight:88,containerHeight:r,className:"border rounded-lg bg-white",hasNextPage:i,isFetchingNextPage:n,fetchNextPage:c,emptyMessage:w,EmptyComponent:p,LoadingComponent:m,scrollEndThreshold:200,overscan:3}):e.jsx(La,{items:s,renderItem:o,itemHeight:88,containerHeight:r,className:"border rounded-lg bg-white",isLoading:g,emptyMessage:w,EmptyComponent:p,LoadingComponent:m,overscan:3})}function sm({orders:s,onOrderClick:a,columnCount:t=3,containerHeight:r=600}){const l=(i,n)=>e.jsxs("div",{className:"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>a?.(i),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(B,{variant:"outline",className:`text-xs ${yi[i.status]}`,children:vi[i.status]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["#",i.id]})]}),e.jsx("h3",{className:"font-medium text-sm text-gray-900 mb-2 line-clamp-2",children:i.title}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-500 mb-3",children:[i.projectName&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ws,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:i.projectName})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_s,{className:"h-3 w-3"}),e.jsx("span",{children:Ds(i.createdAt)})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ee(i.amount)}),e.jsx(mt,{className:"h-4 w-4 text-gray-400"})]})]},i.id);return e.jsx("div",{className:"p-4",children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${t}, 1fr)`,gap:"1rem",height:r,overflow:"auto"},children:s.map(l)})})}const tm=Object.freeze(Object.defineProperty({__proto__:null,VirtualOrdersGrid:sm,VirtualOrdersList:em},Symbol.toStringTag,{value:"Module"}));function am(){const{user:s}=os(),{toast:a}=Ze(),[,t]=Je(),r=ht(),[l,i]=d.useState(!1),n=parseInt(r.id),{data:c,isLoading:g}=se({queryKey:[`/api/orders/${n}`],queryFn:()=>me("GET",`/api/orders/${n}`)}),{data:o}=se({queryKey:["/api/order-statuses"]}),w=Ce({mutationFn:async()=>{await me("POST",`/api/orders/${n}/approve`)},onSuccess:()=>{a({title:"ë°œì£¼ì„œ ìŠ¹ì¸",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/orders"]})},onError:_=>{a({title:"ìŠ¹ì¸ ì‹¤íŒ¨",description:_.message,variant:"destructive"})}}),p=Ce({mutationFn:async()=>{await me("POST",`/api/orders/${n}/send`)},onSuccess:()=>{a({title:"ë°œì£¼ì„œ ë°œì†¡",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/orders"]})},onError:_=>{a({title:"ë°œì†¡ ì‹¤íŒ¨",description:_.message,variant:"destructive"})}}),m=_=>{switch(_){case"pending_approval":case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"sent":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-purple-100 text-purple-800 border-purple-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},f=_=>{const k=o?.find(A=>A.code===_);return k?k.name:_},T=()=>{confirm("ì´ ë°œì£¼ì„œë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&w.mutate()},O=()=>{confirm("ì´ ë°œì£¼ì„œë¥¼ ê±°ëž˜ì²˜ì— ë°œì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&p.mutate()};if(g)return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-[1366px] mx-auto p-6",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:[...Array(4)].map((_,k)=>e.jsx("div",{className:"h-24 bg-gray-200 rounded-xl"},k))}),e.jsx("div",{className:"h-64 bg-gray-200 rounded-xl"})]})})});if(!c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(L,{className:"max-w-md shadow-sm",children:e.jsxs(q,{className:"p-8 text-center",children:[e.jsx(Be,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h1",{className:"text-lg font-semibold text-gray-900 mb-2",children:"ë°œì£¼ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"ìš”ì²­í•˜ì‹  ë°œì£¼ì„œê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."}),e.jsx(b,{onClick:()=>t("/orders"),className:"bg-blue-600 hover:bg-blue-700",children:"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})})});const E=s?.role==="admin"&&(c.status==="pending_approval"||c.status==="pending"),v=c.status==="approved",F=c.status!=="sent"&&c.status!=="received";return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>t("/orders"),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:c.orderNumber}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${m(c.status)}`,children:f(c.status)}),e.jsxs("p",{className:"text-sm text-gray-500",children:[c.vendor?.name," â€¢ ",c.orderDate?Le(new Date(c.orderDate),"yyyyë…„ MMì›” ddì¼"):"ë‚ ì§œ ë¯¸ì •"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[F&&e.jsxs(b,{variant:"outline",onClick:()=>t(`/orders/${n}/edit`),className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"ìˆ˜ì •"]}),E&&e.jsxs(b,{onClick:T,disabled:w.isPending,className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"}),"ìŠ¹ì¸"]}),v&&e.jsxs(b,{onClick:O,disabled:p.isPending,className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(qt,{className:"h-4 w-4"}),"ë°œì†¡"]}),e.jsxs(b,{variant:"outline",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),"ë¯¸ë¦¬ë³´ê¸°"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"bg-blue-50/30 rounded-xl shadow-sm p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:Ee(c.totalAmount)})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(Xs,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-blue-50/30 rounded-xl shadow-sm p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:[c.items?.length||0,"ê°œ"]})]}),e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:e.jsx(Es,{className:"h-6 w-6 text-purple-600"})})]})}),e.jsx("div",{className:"bg-blue-50/30 rounded-xl shadow-sm p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ë‚©ê¸°ì¼"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-2",children:c.deliveryDate?Le(new Date(c.deliveryDate),"MMì›” ddì¼"):"ë¯¸ì •"})]}),e.jsx("div",{className:"bg-orange-100 p-3 rounded-lg",children:e.jsx(_s,{className:"h-6 w-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-blue-50/30 rounded-xl shadow-sm p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ìž‘ì„±ìž"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 mt-2",children:c.user?.firstName&&c.user?.lastName?`${c.user.lastName}${c.user.firstName}`:c.user?.email||"ì•Œ ìˆ˜ ì—†ìŒ"})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx(ks,{className:"h-6 w-6 text-green-600"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(L,{className:"shadow-sm bg-white border-blue-200",children:e.jsxs(q,{className:"p-6 bg-blue-50/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ye,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ì„œ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.orderNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì¼"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.orderDate?Le(new Date(c.orderDate),"yyyyë…„ MMì›” ddì¼"):"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ë‚©ê¸°ì¼"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.deliveryDate?Le(new Date(c.deliveryDate),"yyyyë…„ MMì›” ddì¼"):"-"})]}),c.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"ë¹„ê³ "}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm text-gray-700",children:c.notes})]})]})]})}),c.vendor&&e.jsx(L,{className:"shadow-sm bg-white border-blue-200",children:e.jsxs(q,{className:"p-6 bg-blue-50/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(cs,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ê±°ëž˜ì²˜ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì—…ì²´ëª…"}),e.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-700",onClick:()=>c.vendor?.id&&t(`/vendors/${c.vendor.id}`),children:c.vendor.name})]}),c.vendor.contact&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.vendor.contact})]})]}),c.vendor.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì „í™”ë²ˆí˜¸"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.vendor.phone})]})]}),c.vendor.email&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì´ë©”ì¼"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.vendor.email})]})]}),c.vendor.address&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì£¼ì†Œ"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(St,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.vendor.address})]})]})]})]})}),c.project&&e.jsx(L,{className:"shadow-sm bg-white border-blue-200",children:e.jsxs(q,{className:"p-6 bg-blue-50/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(cs,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"í˜„ìž¥ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"í˜„ìž¥ëª…"}),e.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-700",onClick:()=>t(`/projects/${c.project.id}`),children:c.project.projectName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["(",c.project.projectCode,")"]})]}),c.project.projectManager&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.project.projectManager})]})]}),c.project.location&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ìœ„ì¹˜"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(St,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.project.location})]})]}),c.project.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"ì„¤ëª…"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm text-gray-700",children:c.project.description})]})]})]})})]}),e.jsx(L,{className:"shadow-sm mb-8 bg-white border-blue-200",children:e.jsxs(q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["ì´ ",c.items?.length||0,"ê°œ í’ˆëª©"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:Ee(c.totalAmount)})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-blue-50 border-b border-blue-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ê·œê²©"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ë‹¨ê°€"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ë¹„ê³ "})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.items?.map((_,k)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.itemName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:_.specification||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:typeof _.quantity=="number"?_.quantity.toLocaleString():_.quantity||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900",children:Ee(_.unitPrice)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:Ee(_.totalAmount)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:_.notes||"-"})]},k))}),e.jsx("tfoot",{className:"bg-blue-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-6 py-4 text-right text-sm font-medium text-gray-900",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("span",{className:"text-lg font-bold text-blue-600",children:Ee(c.totalAmount)})}),e.jsx("td",{})]})})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8",children:[e.jsx("div",{children:e.jsx(oi,{orderId:n})}),c.items&&c.items.length>0&&e.jsx("div",{children:e.jsx(xi,{orderItems:c.items,orderId:n})})]}),c.attachments&&c.attachments.length>0&&e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Aa,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["ì´ ",c.attachments.length,"ê°œ íŒŒì¼"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:c.attachments.map(_=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx(ye,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",title:_.filename,children:_.filename}),e.jsx("p",{className:"text-xs text-gray-500",children:"ì²¨ë¶€íŒŒì¼"})]})]}),e.jsxs(b,{variant:"outline",size:"sm",className:"ml-2 flex-shrink-0",children:[e.jsx(Ts,{className:"h-4 w-4 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]})]},_.id))})]})}),e.jsx(ze,{open:l,onOpenChange:i,children:e.jsxs(qe,{className:"max-w-[1366px] max-h-[90vh] overflow-y-auto",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const _=window.open("","_blank");_&&(_.document.write(`
                          <html>
                            <head>
                              <title>ë°œì£¼ì„œ - ${c?.orderNumber}</title>
                              <style>
                                body { margin: 0; font-family: Arial, sans-serif; }
                                @media print {
                                  body { margin: 0; }
                                  .no-print { display: none !important; }
                                }
                              </style>
                            </head>
                            <body>
                              ${document.querySelector(".order-preview-content")?.innerHTML||""}
                            </body>
                          </html>
                        `),_.document.close(),_.print())},children:[e.jsx(Vt,{className:"h-4 w-4 mr-1"}),"PDF ì¶œë ¥"]})})]})}),e.jsx("div",{className:"order-preview-content mt-4",children:c&&e.jsx(mi,{order:c})})]})})]})})}const rm=Object.freeze(Object.defineProperty({__proto__:null,default:am},Symbol.toStringTag,{value:"Module"}));function lm(){os();const{toast:s}=Ze(),[,a]=Je(),t=ht(),[r,l]=d.useState(!1),i=parseInt(t.id),{data:n,isLoading:c}=se({queryKey:[`/api/orders/${i}`]}),{data:g}=se({queryKey:["/api/order-statuses"]}),o=Ce({mutationFn:async()=>{await me("POST",`/api/orders/${i}/approve`)},onSuccess:()=>{s({title:"ë°œì£¼ì„œ ìŠ¹ì¸",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/orders"]}),rs.invalidateQueries({queryKey:[`/api/orders/${i}`]})},onError:f=>{s({title:"ìŠ¹ì¸ ì‹¤íŒ¨",description:"ë°œì£¼ì„œ ìŠ¹ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),w=Ce({mutationFn:async()=>{await me("POST",`/api/orders/${i}/send`)},onSuccess:()=>{s({title:"ë°œì£¼ì„œ ì „ì†¡",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/orders"]}),rs.invalidateQueries({queryKey:[`/api/orders/${i}`]})},onError:f=>{s({title:"ì „ì†¡ ì‹¤íŒ¨",description:"ë°œì£¼ì„œ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});if(c)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg",children:"ë¡œë”© ì¤‘..."})});if(!n)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-gray-500",children:"ë°œì£¼ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})});const p=n.status==="draft"?"bg-gray-500":n.status==="pending"?"bg-yellow-500":n.status==="approved"?"bg-green-500":n.status==="sent"?"bg-blue-500":"bg-gray-500",m=g?.find(f=>f.code===n.status)?.name||n.status;return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>a("/orders"),className:"flex items-center space-x-2 h-8",children:[e.jsx(ns,{className:"h-4 w-4"}),e.jsx("span",{children:"ëŒì•„ê°€ê¸°"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n.orderNumber}),e.jsx("p",{className:"text-sm text-gray-500",children:"í‘œì¤€ ë°œì£¼ì„œ ìƒì„¸"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:`${p} text-white text-xs px-2 py-1`,children:m}),e.jsx("span",{className:"text-xs text-gray-500",children:n.orderDate?Le(new Date(n.orderDate),"yyyy. M. d."):""})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(Ws,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"ê¸°ë³¸ ì •ë³´"})]})}),e.jsx(q,{className:"px-4 py-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-xs",children:[e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ë°œì£¼ë²ˆí˜¸:"}),e.jsx("span",{className:"font-medium",children:n.orderNumber})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ë°œì£¼ì¼:"}),e.jsx("span",{children:n.orderDate?Le(new Date(n.orderDate),"yyyy-MM-dd"):"-"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ë‚©ê¸°í¬ë§ì¼:"}),e.jsx("span",{children:n.deliveryDate?Le(new Date(n.deliveryDate),"yyyy-MM-dd"):"-"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"í•©ê³„:"}),e.jsx("span",{className:"font-semibold text-blue-600",children:Ee(n.totalAmount)})]})]})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(St,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"í˜„ìž¥ ì •ë³´"})]})}),e.jsx(q,{className:"px-4 py-3",children:n.project?e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-xs",children:[e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"í˜„ìž¥ëª…:"}),e.jsx("span",{className:"font-medium",children:n.project.projectName})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"í˜„ìž¥ì½”ë“œ:"}),e.jsx("span",{children:n.project.projectCode})]}),e.jsxs("div",{className:"flex col-span-2",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"í˜„ìž¥ì£¼ì†Œ:"}),e.jsx("span",{children:n.project.location})]})]}):e.jsx("p",{className:"text-xs text-gray-500",children:"í˜„ìž¥ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(Ws,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"ë‚©í’ˆì²˜"})]})}),e.jsx(q,{className:"px-4 py-3",children:n.vendor?e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-xs",children:[e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ì—…ì²´ëª…:"}),e.jsx("span",{className:"font-medium",children:n.vendor.name})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ëŒ€í‘œìž:"}),e.jsx("span",{children:n.vendor.representative||"-"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{children:n.vendor.businessNumber})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ì—°ë½ì²˜:"}),e.jsx("span",{children:n.vendor.phone})]})]}):e.jsx("p",{className:"text-xs text-gray-500",children:"ê±°ëž˜ì²˜ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(ks,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"ë‹´ë‹¹ìž"})]})}),e.jsx(q,{className:"px-4 py-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-xs",children:[e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž:"}),e.jsx("span",{className:"font-medium",children:n.user?.name||"-"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-gray-600 w-20",children:"ì¸ìˆ˜ ë‹´ë‹¹ìž:"}),e.jsx("span",{children:"í˜„ìž¥ ë‹´ë‹¹ìž"})]})]})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center justify-between text-sm font-semibold",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Es,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"í’ˆëª© ë¦¬ìŠ¤íŠ¸"})]}),e.jsxs("span",{className:"text-blue-600",children:["ì´ í•©ê³„ ",Ee(n.totalAmount)]})]})}),e.jsx(q,{className:"px-0 py-3",children:n.items&&n.items.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-600",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-600",children:"ê·œê²©"}),e.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-600",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-600",children:"ë‹¨ìœ„"}),e.jsx("th",{className:"text-right py-2 px-4 font-medium text-gray-600",children:"ë‹¨ê°€"}),e.jsx("th",{className:"text-right py-2 px-4 font-medium text-gray-600",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-600",children:"ë¹„ê³ "})]})}),e.jsx("tbody",{children:n.items.map((f,T)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-4 font-medium",children:f.itemName||f.item_name}),e.jsx("td",{className:"py-2 px-4 text-center",children:f.specification||"-"}),e.jsx("td",{className:"py-2 px-4 text-center",children:typeof f.quantity=="number"?f.quantity.toLocaleString():f.quantity||"-"}),e.jsx("td",{className:"py-2 px-4 text-center",children:"ê°œ"}),e.jsx("td",{className:"py-2 px-4 text-right font-semibold text-blue-600",children:Ee(f.unitPrice||f.unit_price)}),e.jsx("td",{className:"py-2 px-4 text-right font-semibold text-blue-600",children:Ee(f.totalAmount||f.total_amount)}),e.jsx("td",{className:"py-2 px-4 text-center text-gray-500",children:f.notes?f.notes.split("/").join(" "):"-"})]},T))})]})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Es,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-xs",children:"ë“±ë¡ëœ í’ˆëª©ì´ ì—†ìŠµë‹ˆë‹¤."})]})})]}),n.notes&&e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"íŠ¹ì´ì‚¬í•­"})]})}),e.jsx(q,{className:"px-4 py-3",children:e.jsx("p",{className:"text-xs text-gray-700 leading-relaxed",children:n.notes})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"ì²¨ë¶€íŒŒì¼"})]})}),e.jsx(q,{className:"px-4 py-3",children:n.attachments&&n.attachments.length>0?e.jsx("div",{className:"space-y-2",children:n.attachments.map(f=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"h-3 w-3 text-blue-600"}),e.jsx("span",{children:f.originalName}),e.jsxs("span",{className:"text-gray-500",children:["(",(f.fileSize/1024).toFixed(1)," KB)"]})]}),e.jsx(b,{size:"sm",variant:"outline",className:"h-6 px-2 text-xs",onClick:()=>window.open(`/api/attachments/${f.id}`,"_blank"),children:"ë‹¤ìš´ë¡œë“œ"})]},f.id))}):e.jsx("p",{className:"text-xs text-gray-500",children:"ì²¨ë¶€ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤."})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(ps,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"ìŠ¹ì¸ ìƒíƒœ"})]})}),e.jsx(q,{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-1",children:"í˜„ìž¬ ìƒíƒœ"}),e.jsx(B,{className:`${p} text-white text-xs`,children:m})]}),n.status==="pending"&&e.jsxs(b,{onClick:()=>o.mutate(),disabled:o.isPending,className:"w-full h-8 text-xs",size:"sm",children:[e.jsx(ps,{className:"h-3 w-3 mr-1"}),"ìŠ¹ì¸"]}),n.status==="approved"&&e.jsxs(b,{onClick:()=>w.mutate(),disabled:w.isPending,className:"w-full h-8 text-xs",size:"sm",children:[e.jsx(qt,{className:"h-3 w-3 mr-1"}),"ì „ì†¡"]})]})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 py-3 px-4",children:e.jsxs(W,{className:"flex items-center space-x-2 text-lg font-semibold",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"ìž‘ì—…"})]})}),e.jsxs(q,{className:"px-4 py-3 space-y-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"w-full h-8 text-xs justify-start",children:[e.jsx(ls,{className:"h-3 w-3 mr-2"}),"PDF ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>a(`/orders/${i}/edit`),className:"w-full h-8 text-xs justify-start",children:[e.jsx(ds,{className:"h-3 w-3 mr-2"}),"ë°œì£¼ì„œ ìˆ˜ì •"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>window.print(),className:"w-full h-8 text-xs justify-start",children:[e.jsx(Vt,{className:"h-3 w-3 mr-2"}),"ì¸ì‡„"]})]})]})]})]}),e.jsx(ze,{open:r,onOpenChange:l,children:e.jsxs(qe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white border rounded-lg p-8",style:{width:"210mm",minHeight:"297mm"},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"í‘œì¤€ ë°œì£¼ì„œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Purchase Order"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-4",children:"ë°œì£¼ì²˜ ì •ë³´"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"íšŒì‚¬ëª…:"})," (ì£¼)ìµì§„ì—”ì§€ë‹ˆì–´ë§"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ë°œì£¼ë²ˆí˜¸:"})," ",n.orderNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ë°œì£¼ì¼:"})," ",n.orderDate?Le(new Date(n.orderDate),"yyyy-MM-dd"):"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ë‚©ê¸°ì¼:"})," ",n.deliveryDate?Le(new Date(n.deliveryDate),"yyyy-MM-dd"):"-"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-4",children:"ë‚©í’ˆì—…ì²´ ì •ë³´"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ì—…ì²´ëª…:"})," ",n.vendor?.name||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ì‚¬ì—…ìžë²ˆí˜¸:"})," ",n.vendor?.businessNumber||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ì—°ë½ì²˜:"})," ",n.vendor?.phone||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ì´ë©”ì¼:"})," ",n.vendor?.email||"-"]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"í’ˆëª© ì •ë³´"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 p-2 text-left",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"border border-gray-300 p-2 text-left",children:"ê·œê²©"}),e.jsx("th",{className:"border border-gray-300 p-2 text-center",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"border border-gray-300 p-2 text-right",children:"ë‹¨ê°€"}),e.jsx("th",{className:"border border-gray-300 p-2 text-right",children:"ê¸ˆì•¡"})]})}),e.jsxs("tbody",{children:[n.items?.map((f,T)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 p-2",children:f.itemName||f.item_name}),e.jsx("td",{className:"border border-gray-300 p-2",children:f.specification||"-"}),e.jsx("td",{className:"border border-gray-300 p-2 text-center",children:f.quantity?.toLocaleString()||"-"}),e.jsx("td",{className:"border border-gray-300 p-2 text-right",children:Ee(f.unitPrice||f.unit_price)}),e.jsx("td",{className:"border border-gray-300 p-2 text-right",children:Ee(f.totalAmount||f.total_amount)})]},T)),e.jsxs("tr",{className:"bg-gray-100 font-semibold",children:[e.jsx("td",{colSpan:4,className:"border border-gray-300 p-2 text-right",children:"ì´ í•©ê³„"}),e.jsx("td",{className:"border border-gray-300 p-2 text-right",children:Ee(n.totalAmount)})]})]})]})]}),n.notes&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx("p",{className:"text-sm border border-gray-300 p-4 rounded",children:n.notes})]}),e.jsx("div",{className:"mt-16 text-center",children:e.jsxs("div",{className:"inline-block",children:[e.jsx("img",{src:"/attached_assets/ikjin-logo.png",alt:"íšŒì‚¬ ë¡œê³ ",className:"h-4 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-600",children:"(ì£¼)ìµì§„ì—”ì§€ë‹ˆì–´ë§"})]})})]})})]})})]})})}const nm=Object.freeze(Object.defineProperty({__proto__:null,default:lm},Symbol.toStringTag,{value:"Module"}));function im(){os();const{toast:s}=Ze(),[a,t]=Je(),r=ht(),l=r.id;console.log("OrderEdit params:",r),console.log("OrderEdit orderId:",l,typeof l);const[i,n]=d.useState({vendorId:"",orderDate:"",deliveryDate:"",notes:"",items:[]}),{data:c,isLoading:g,error:o}=se({queryKey:[`/api/orders/${l}`],queryFn:()=>me("GET",`/api/orders/${l}`),enabled:!!l});console.log("OrderEdit Debug:",{orderId:l,order:c,orderLoading:g,orderError:o,enabled:!!l});const{data:w}=se({queryKey:["/api/vendors"],queryFn:()=>me("GET","/api/vendors")}),{data:p}=se({queryKey:["/api/items"],queryFn:()=>me("GET","/api/items")}),m=p?.items||[];d.useEffect(()=>{if(c&&m.length>0){const _=(c.items||[]).map(k=>{let A=null;return A=m.find(x=>x.name===k.itemName),A||(A=m.find(x=>x.name.includes(k.itemName)||k.itemName.includes(x.name))),!A&&k.itemId&&(A=m.find(x=>x.id===k.itemId)),{itemId:A?.id||null,itemName:k.itemName||"",quantity:parseFloat(k.quantity)||1,unitPrice:parseFloat(k.unitPrice)||0,specification:k.specification||"",notes:k.notes||""}});n({vendorId:c.vendorId?.toString()||"",orderDate:c.orderDate?new Date(c.orderDate).toISOString().split("T")[0]:"",deliveryDate:c.deliveryDate?new Date(c.deliveryDate).toISOString().split("T")[0]:"",notes:c.notes||"",items:_})}else c&&m.length===0&&n({vendorId:c.vendorId?.toString()||"",orderDate:c.orderDate?new Date(c.orderDate).toISOString().split("T")[0]:"",deliveryDate:c.deliveryDate?new Date(c.deliveryDate).toISOString().split("T")[0]:"",notes:c.notes||"",items:c.items||[]})},[c,m]);const f=Ce({mutationFn:async _=>await me("PATCH",`/api/orders/${l}`,_),onSuccess:()=>{s({title:"ì„±ê³µ",description:"ë°œì£¼ì„œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:[`/api/orders/${l}`]}),rs.invalidateQueries({queryKey:["/api/orders"]}),t(`/orders/${l}`)},onError:_=>{if(Ht(_)){s({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{t("/login")},500);return}s({title:"ì˜¤ë¥˜",description:"ë°œì£¼ì„œ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),T=_=>{if(_.preventDefault(),!i.vendorId||!i.orderDate||i.items.length===0){s({title:"ì˜¤ë¥˜",description:"ëª¨ë“  í•„ìˆ˜ í•„ë“œë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}const k={vendorId:parseInt(i.vendorId),orderDate:new Date(i.orderDate),deliveryDate:i.deliveryDate?new Date(i.deliveryDate):null,notes:i.notes,items:i.items.map(A=>({itemId:A.itemId,itemName:A.itemName,quantity:Number(A.quantity),unitPrice:Number(A.unitPrice),specification:A.specification||"",notes:A.notes||""}))};f.mutate(k)},O=()=>{n(_=>({..._,items:[..._.items,{itemId:null,itemName:"",quantity:1,unitPrice:0,specification:"",notes:""}]}))},E=_=>{n(k=>({...k,items:k.items.filter((A,x)=>x!==_)}))},v=(_,k,A)=>{n(x=>({...x,items:x.items.map((D,u)=>u===_?{...D,[k]:A}:D)}))},F=(_,k)=>{const A=m.find(x=>x.id.toString()===k);A&&(v(_,"itemId",A.id),v(_,"itemName",A.name),v(_,"unitPrice",A.unitPrice||0),v(_,"specification",A.specification||""))};return g?e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded"})]})}):o?e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"ë°œì£¼ì„œ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"mb-4 text-red-600",children:o.message}),e.jsx(b,{onClick:()=>t("/orders"),children:"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})}):c?e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>t(`/orders/${l}`),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëŒì•„ê°€ê¸°"]}),e.jsx(ds,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ë°œì£¼ì„œ ìˆ˜ì •"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"ë°œì£¼ì„œ ì •ë³´ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤"})]})]})})}),e.jsxs("form",{onSubmit:T,children:[e.jsxs(L,{className:"mb-6",children:[e.jsx(H,{children:e.jsx(W,{children:"ê¸°ë³¸ ì •ë³´"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"vendor",children:"ê±°ëž˜ì²˜ *"}),e.jsxs(Z,{value:i.vendorId,onValueChange:_=>n(k=>({...k,vendorId:_})),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:w?.map(_=>e.jsx(R,{value:_.id.toString(),children:_.name},_.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"orderDate",children:"ë°œì£¼ì¼ìž *"}),e.jsx(U,{id:"orderDate",type:"date",value:i.orderDate,onChange:_=>n(k=>({...k,orderDate:_.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"deliveryDate",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx(U,{id:"deliveryDate",type:"date",value:i.deliveryDate,onChange:_=>n(k=>({...k,deliveryDate:_.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"notes",children:"ë¹„ê³ "}),e.jsx(Ge,{id:"notes",placeholder:"ì¶”ê°€ ì •ë³´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”",value:i.notes,onChange:_=>n(k=>({...k,notes:_.target.value})),rows:3})]})]})]}),e.jsxs(L,{className:"mb-6",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{children:"ë°œì£¼ í’ˆëª©"}),e.jsxs(b,{type:"button",onClick:O,children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"í’ˆëª© ì¶”ê°€"]})]})}),e.jsxs(q,{children:[i.items.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"ë°œì£¼í•  í’ˆëª©ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”"}):e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{children:[e.jsx(oe,{children:"í’ˆëª©ëª… *"}),e.jsx(oe,{children:"ìˆ˜ëŸ‰ *"}),e.jsx(oe,{children:"ë‹¨ê°€"}),e.jsx(oe,{children:"ê·œê²©"}),e.jsx(oe,{children:"ë¹„ê³ "}),e.jsx(oe,{children:"ì´ì•¡"}),e.jsx(oe,{className:"w-[100px]",children:"ìž‘ì—…"})]})}),e.jsx(tt,{children:i.items.map((_,k)=>e.jsxs(Me,{children:[e.jsx(G,{children:e.jsxs(Z,{value:_.itemId?.toString()||"",onValueChange:A=>F(k,A),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:_.itemName||"í’ˆëª© ì„ íƒ"})}),e.jsx(ee,{children:m.map(A=>e.jsx(R,{value:A.id.toString(),children:A.name},A.id))})]})}),e.jsx(G,{children:e.jsx(U,{type:"number",value:_.quantity,onChange:A=>v(k,"quantity",Number(A.target.value)),min:"1",required:!0})}),e.jsx(G,{children:e.jsx(U,{type:"number",value:_.unitPrice,onChange:A=>v(k,"unitPrice",Number(A.target.value)),min:"0"})}),e.jsx(G,{children:e.jsx(U,{value:_.specification,onChange:A=>v(k,"specification",A.target.value),placeholder:"ê·œê²© ìž…ë ¥"})}),e.jsx(G,{children:e.jsx(U,{value:_.notes,onChange:A=>v(k,"notes",A.target.value),placeholder:"ë¹„ê³  ìž…ë ¥"})}),e.jsxs(G,{children:["â‚©",(Number(_.quantity)*Number(_.unitPrice)).toLocaleString("ko-KR")]}),e.jsx(G,{children:e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>E(k),children:e.jsx(Qe,{className:"h-4 w-4 text-red-500"})})})]},k))})]}),i.items.length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t mx-6 mb-6",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"ì´ í•©ê³„ ê¸ˆì•¡"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:["â‚©",i.items.reduce((_,k)=>{const A=(k.quantity||0)*(k.unitPrice||0);return _+A},0).toLocaleString()]})]})})})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>t(`/orders/${l}`),children:"ì·¨ì†Œ"}),e.jsxs(b,{type:"submit",disabled:f.isPending,children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),f.isPending?"ì €ìž¥ ì¤‘...":"ì €ìž¥"]})]})]})]}):e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"ë°œì£¼ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["OrderID: ",l]}),e.jsx(b,{onClick:()=>t("/orders"),children:"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})})}const cm=Object.freeze(Object.defineProperty({__proto__:null,default:im},Symbol.toStringTag,{value:"Module"}));function dm(){const a=ht().id,{data:t,isLoading:r}=se({queryKey:[`/api/orders/${a}`],queryFn:()=>fetch(`/api/orders/${a}`).then(n=>n.json()),enabled:!!a}),l=()=>{window.print()},i=()=>{window.print()};return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-lg",children:"ë°œì£¼ì„œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"no-print fixed top-4 right-4 z-50 flex space-x-2",children:[e.jsxs(b,{onClick:l,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"ì¸ì‡„"]}),e.jsxs(b,{onClick:i,variant:"outline",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"PDF ì €ìž¥"]})]}),e.jsxs("div",{className:"order-preview-container",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"ë°œì£¼ì„œ Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["ë°œì£¼ë²ˆí˜¸: ",t.orderNumber]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ê±°ëž˜ì²˜ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"íšŒì‚¬ëª…:"}),e.jsx("span",{style:{flex:"1"},children:t.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì‚¬ì—…ìžë²ˆí˜¸:"}),e.jsx("span",{style:{flex:"1"},children:t.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì—°ë½ì²˜:"}),e.jsx("span",{style:{flex:"1"},children:t.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì´ë©”ì¼:"}),e.jsx("span",{style:{flex:"1"},children:t.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ì£¼ì†Œ:"}),e.jsx("span",{style:{flex:"1"},children:t.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ì¼ìž:"}),e.jsx("span",{style:{flex:"1"},children:t.orderDate?new Date(t.orderDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë‚©í’ˆí¬ë§ì¼:"}),e.jsx("span",{style:{flex:"1"},children:t.deliveryDate?new Date(t.deliveryDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ë°œì£¼ìž:"}),e.jsxs("span",{style:{flex:"1"},children:[t.user?.lastName||""," ",t.user?.firstName||""]})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"ìƒíƒœ:"}),e.jsx("span",{style:{flex:"1"},children:t.status==="pending"?"ëŒ€ê¸°":t.status==="approved"?"ìŠ¹ì¸":t.status==="sent"?"ë°œì†¡":t.status})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"ë°œì£¼ í’ˆëª©"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"í’ˆëª©ëª…"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê·œê²©"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ìˆ˜ëŸ‰"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë‹¨ê°€"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ê¸ˆì•¡"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"ë¹„ê³ "})]})}),e.jsx("tbody",{children:t.items?.map((n,c)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:n.itemName}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:n.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(n.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",Number(n.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["â‚©",Number(n.totalAmount).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:n.notes||"-"})]},c))||[]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"ì´ ê¸ˆì•¡"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["â‚©",Number(t.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),t.notes&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"íŠ¹ì´ì‚¬í•­:"}),e.jsx("br",{}),t.notes]})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"ë°œì£¼ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(b,{onClick:()=>window.close(),children:"ì°½ ë‹«ê¸°"})]})})}const om=Object.freeze(Object.defineProperty({__proto__:null,default:dm},Symbol.toStringTag,{value:"Module"}));function xm(){const[,s]=Je();d.useState([]);const a=()=>{s("/orders")},t=()=>{s("/orders")};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ë°œì£¼ì„œ ìž‘ì„±"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"ìƒˆë¡œìš´ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•˜ê±°ë‚˜ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”"})]})]})}),e.jsx(nd,{onSuccess:a,onCancel:t})]})})}const mm=Object.freeze(Object.defineProperty({__proto__:null,default:xm},Symbol.toStringTag,{value:"Module"}));function Ys({className:s,classNames:a,showOutsideDays:t=!0,...r}){return e.jsx(Ec,{showOutsideDays:t,className:V("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:V(ca({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100 dark:border-slate-600 dark:text-white dark:hover:bg-slate-800"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem] dark:text-slate-400",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:V(ca({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100 dark:text-white dark:hover:bg-slate-800 dark:hover:text-white"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground dark:bg-slate-800 dark:text-white",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground dark:text-slate-500",day_disabled:"text-muted-foreground opacity-50 dark:text-slate-600",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({className:l,...i})=>e.jsx(hr,{className:V("h-4 w-4",l),...i}),IconRight:({className:l,...i})=>e.jsx(mt,{className:V("h-4 w-4",l),...i})},...r})}Ys.displayName="Calendar";let hm=class{constructor(a){this.data=a}getCellReference(a){const t=a.match(/^([A-Z]+)(\d+)$/);if(!t)return 0;const r=this.columnToIndex(t[1]),l=Number.parseInt(t[2])-1;if(l>=0&&l<this.data.length&&r>=0&&r<(this.data[l]?.length||0)){const i=this.data[l][r];if(i){const n=i.displayValue!==void 0?i.displayValue:i.value,c=String(n).replace(/[,\s]/g,""),g=Number.parseFloat(c);return isNaN(g)?0:g}}return 0}columnToIndex(a){let t=0;for(let r=0;r<a.length;r++)t=t*26+(a.charCodeAt(r)-64);return t-1}evaluate(a){try{return a=a.replace(/^=/,"").trim(),a.includes("SUM(")?this.evaluateSum(a):(a=a.replace(/[A-Z]+\d+/g,t=>this.getCellReference(t).toString()),this.evaluateArithmetic(a))}catch(t){return console.error("Formula evaluation error:",t),0}}evaluateSum(a){const t=a.match(/SUM\(([^)]+)\)/i);if(!t)return 0;const r=t[1].trim(),l=r.match(/([A-Z]+\d+):([A-Z]+\d+)/i);if(l){const n=l[1].toUpperCase(),c=l[2].toUpperCase();return this.sumRange(n,c)}return r.split(",").map(n=>n.trim().toUpperCase()).reduce((n,c)=>n+this.getCellReference(c),0)}sumRange(a,t){const r=a.match(/^([A-Z]+)(\d+)$/),l=t.match(/^([A-Z]+)(\d+)$/);if(!r||!l)return 0;const i=this.columnToIndex(r[1]),n=Number.parseInt(r[2])-1,c=this.columnToIndex(l[1]),g=Number.parseInt(l[2])-1;let o=0;for(let w=n;w<=g;w++)for(let p=i;p<=c;p++)if(w>=0&&w<this.data.length&&p>=0&&p<(this.data[w]?.length||0)){const m=this.data[w][p];if(m){const f=m.displayValue!==void 0?m.displayValue:m.value,T=String(f).replace(/[,\s]/g,""),O=Number.parseFloat(T);isNaN(O)||(o+=O)}}return o}evaluateArithmetic(a){try{const t=a.replace(/[^0-9+\-*/().\s]/g,"");return t.trim()?Function(`"use strict"; return (${t})`)():0}catch(t){return console.error("Arithmetic evaluation error:",t),0}}};const tr=s=>typeof s=="string"?s==="í˜‘ì˜"?"í˜‘ì˜":new Date(s).toLocaleDateString("ko-KR"):s.toLocaleDateString("ko-KR");function bt({title:s,onAdd:a,trigger:t}){const[r,l]=d.useState(""),[i,n]=d.useState(!1),c=()=>{r.trim()&&(a(r.trim()),l(""),n(!1))};return e.jsxs(ze,{open:i,onOpenChange:n,children:[e.jsx(Ls,{asChild:!0,children:t}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsxs(Ke,{children:[s," ì¶”ê°€"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(P,{htmlFor:"newItem",children:["ìƒˆ ",s]}),e.jsx(U,{id:"newItem",value:r,onChange:g=>l(g.target.value),placeholder:`${s}ì„ ìž…ë ¥í•˜ì„¸ìš”`,onKeyDown:g=>g.key==="Enter"&&c()})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{variant:"outline",onClick:()=>n(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{onClick:c,children:"ì¶”ê°€"})]})]})]})]})}function um(){const[s,a]=d.useState("input"),[t,r]=d.useState(null),[l,i]=d.useState([]),[n,c]=d.useState(""),[g,o]=d.useState(!1),[w,p]=d.useState({}),[m,f]=d.useState({siteName:"",materialReceiver:"",headOfficeManager:"",specialNotes:"",extrusion:{deliveryDate:"",supplier:"",deliveryLocation:""},painting:{deliveryDate:"",supplier:"",deliveryLocation:""},insulation:{deliveryDate:"",supplier:"",deliveryLocation:""}}),{data:T=[]}=se({queryKey:["/api/projects"]}),{data:O=[]}=se({queryKey:["/api/vendors"]}),{data:E=[]}=se({queryKey:["/api/users"]}),v=Array.isArray(T)?T.map(C=>C.name||C.projectName).filter(Boolean):[],F=Array.isArray(O)?O.map(C=>C.companyName||C.name).filter(Boolean):[],_=Array.isArray(O)?O.map(C=>C.companyName||C.name).filter(Boolean):[],k=Array.isArray(E)?E.map(C=>C.name).filter(Boolean):[],A=Array.isArray(E)?E.map(C=>C.name).filter(Boolean):[],[x,D]=d.useState([]),[u,N]=d.useState([]),[j,h]=d.useState([]),[I,S]=d.useState([]),z=[...F,...x],Q=[..._,...u],K=[...k,...j],ne=[...A,...I],Se=C=>{D(M=>[...M,C])},je=C=>{N(M=>[...M,C])},y=C=>{h(M=>[...M,C])},$=C=>{S(M=>[...M,C])},J=()=>{a("input")},ie=()=>{const C=new Date().toISOString();r({projectSettings:m,spreadsheetData:l,fileName:n,timestamp:C}),a("pdf-preview")},xe=C=>{const M=C.target.files?.[0];if(!M)return;o(!0),c(M.name);const te=new FileReader;te.onload=le=>{try{const ce=new Uint8Array(le.target?.result),_e=pr(ce,{type:"array"}),de=_e.SheetNames[0],$e=_e.Sheets[de],fe=Wt.decode_range($e["!ref"]||"A1:A1"),Ps=[];for(let re=fe.s.r;re<=fe.e.r;re++){const ge=[];for(let ke=fe.s.c;ke<=fe.e.c;ke++){const Ie=Wt.encode_cell({r:re,c:ke}),bs=$e[Ie];if(bs){const at={value:bs.v,formula:bs.f,displayValue:bs.v};ge.push(at)}else ge.push({value:"",displayValue:""})}Ps.push(ge)}i(Ps),setTimeout(()=>vs(Ps),100)}catch(ce){console.error("Error parsing Excel file:",ce),alert("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{o(!1)}},te.readAsArrayBuffer(M)},vs=d.useCallback(C=>{const M=new hm(C),te=C.map(le=>le.map(ce=>{if(ce.formula&&ce.formula.startsWith("=")){const _e=M.evaluate(ce.formula);return{...ce,displayValue:_e}}return{...ce,displayValue:ce.displayValue!==void 0?ce.displayValue:ce.value}}));i(te)},[]);return s==="pdf-preview"&&t?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ye,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì €ìž¥ëœ ë°œì£¼ì„œ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ìµœì¢… ì œì¶œí•˜ì„¸ìš”."})]})]}),e.jsxs(b,{onClick:J,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"ìˆ˜ì •í•˜ê¸°"]})]}),e.jsxs(L,{className:"hover:shadow-md transition-shadow",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-600"}),"í˜„ìž¥ ì •ë³´"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"í˜„ìž¥ëª…"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.siteName})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.materialReceiver})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.headOfficeManager})]})]}),t.projectSettings.specialNotes&&e.jsxs("div",{className:"mt-4",children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx("p",{className:"text-sm",children:t.projectSettings.specialNotes})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(L,{className:"border-blue-200",children:[e.jsx(H,{className:"bg-blue-50",children:e.jsx(W,{className:"text-blue-700 text-sm",children:"ì••ì¶œ ê³µì •"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.extrusion.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.extrusion.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.extrusion.deliveryLocation})]})]})})]}),e.jsxs(L,{className:"border-green-200",children:[e.jsx(H,{className:"bg-green-50",children:e.jsx(W,{className:"text-green-700 text-sm",children:"ë„ìž¥ ê³µì •"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.painting.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.painting.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.painting.deliveryLocation})]})]})})]}),e.jsxs(L,{className:"border-orange-200",children:[e.jsx(H,{className:"bg-orange-50",children:e.jsx(W,{className:"text-orange-700 text-sm",children:"ë‹¨ì—´ ê³µì •"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.insulation.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.insulation.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.insulation.deliveryLocation})]})]})})]})]}),e.jsxs(L,{className:"hover:shadow-md transition-shadow",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-green-600"}),"ë°œì£¼ í’ˆëª© ëª©ë¡"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["íŒŒì¼ëª…: ",t.fileName]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:t.spreadsheetData[0]?.map((C,M)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+M)},M))})}),e.jsx("tbody",{children:t.spreadsheetData.slice(0,10).map((C,M)=>e.jsx("tr",{className:"border-t",children:C.map((te,le)=>e.jsx("td",{className:"px-3 py-2 border-r",children:te.displayValue||te.value||""},le))},M))})]}),t.spreadsheetData.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... ê·¸ ì™¸ ",t.spreadsheetData.length-10,"ê°œ í–‰"]})]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-6",children:[e.jsxs(b,{onClick:J,variant:"outline",size:"lg",className:"flex items-center gap-2 px-6",children:[e.jsx(ns,{className:"h-4 w-4"}),"ì´ì „ ë‹¨ê³„"]}),e.jsxs(b,{size:"lg",className:"flex items-center gap-2 px-8 bg-green-600 hover:bg-green-700",onClick:()=>{alert("ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!")},children:[e.jsx(Ks,{className:"h-4 w-4"}),"ìµœì¢… ì œì¶œ"]})]})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ye,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"ì••ì¶œ ë°œì£¼ì„œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì••ì¶œ ê³µì • ì „ìš© ë°œì£¼ì„œë¥¼ ìž‘ì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤."})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(B,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"ì‹¤í—˜ì  ê¸°ëŠ¥"})})]}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Hs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ì„œ ê¸°ë³¸ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"í”„ë¡œì íŠ¸ ëª…"}),e.jsxs(Z,{value:m.siteName,onValueChange:C=>f(M=>({...M,siteName:C})),children:[e.jsx(Y,{className:`h-10 ${m.siteName?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:v.map(C=>e.jsx(R,{value:C,children:C},C))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.materialReceiver,onValueChange:C=>f(M=>({...M,materialReceiver:C})),children:[e.jsx(Y,{className:`flex-1 h-10 ${m.materialReceiver?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ìžìž¬ ì¸ìˆ˜ìž ì„ íƒ"})}),e.jsx(ee,{children:K.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ìžìž¬ ì¸ìˆ˜ìž",onAdd:y,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.headOfficeManager,onValueChange:C=>f(M=>({...M,headOfficeManager:C})),children:[e.jsx(Y,{className:`flex-1 h-10 ${m.headOfficeManager?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ë³¸ì‚¬ ë‹´ë‹¹ìž ì„ íƒ"})}),e.jsx(ee,{children:ne.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ë³¸ì‚¬ ë‹´ë‹¹ìž",onAdd:$,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"font-semibold text-blue-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"ì••ì¶œ"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-blue-700 font-medium",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"sm",className:"flex-1 justify-start text-left font-normal h-8",children:[e.jsx(ut,{className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:m.extrusion.deliveryDate?tr(m.extrusion.deliveryDate):"ë‚ ì§œ ì„ íƒ"})]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.extrusion.deliveryDate&&m.extrusion.deliveryDate!=="í˜‘ì˜"?new Date(m.extrusion.deliveryDate):void 0,onSelect:C=>{C&&f(M=>({...M,extrusion:{...M.extrusion,deliveryDate:C.toISOString().split("T")[0]}}))},initialFocus:!0})})]}),e.jsx(b,{variant:m.extrusion.deliveryDate==="í˜‘ì˜"?"default":"outline",size:"sm",className:"text-xs h-8 px-2",onClick:()=>f(C=>({...C,extrusion:{...C.extrusion,deliveryDate:"í˜‘ì˜"}})),children:"í˜‘ì˜"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-blue-700 font-medium",children:"ê±°ëž˜ì²˜ëª…"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.extrusion.supplier,onValueChange:C=>f(M=>({...M,extrusion:{...M.extrusion,supplier:C}})),children:[e.jsx(Y,{className:"flex-1 h-8 text-xs",children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:z.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ê±°ëž˜ì²˜",onAdd:Se,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-3 w-3"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-blue-700 font-medium",children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.extrusion.deliveryLocation,onValueChange:C=>f(M=>({...M,extrusion:{...M.extrusion,deliveryLocation:C}})),children:[e.jsx(Y,{className:"flex-1 h-8 text-xs",children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:Q.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ë‚©í’ˆì²˜",onAdd:je,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-3 w-3"})})})]})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"font-semibold text-green-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"ë„ìž¥"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-green-700 font-medium",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"sm",className:"flex-1 justify-start text-left font-normal h-8",children:[e.jsx(ut,{className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:m.painting.deliveryDate?tr(m.painting.deliveryDate):"ë‚ ì§œ ì„ íƒ"})]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.painting.deliveryDate&&m.painting.deliveryDate!=="í˜‘ì˜"?new Date(m.painting.deliveryDate):void 0,onSelect:C=>{C&&f(M=>({...M,painting:{...M.painting,deliveryDate:C.toISOString().split("T")[0]}}))},initialFocus:!0})})]}),e.jsx(b,{variant:m.painting.deliveryDate==="í˜‘ì˜"?"default":"outline",size:"sm",className:"text-xs h-8 px-2",onClick:()=>f(C=>({...C,painting:{...C.painting,deliveryDate:"í˜‘ì˜"}})),children:"í˜‘ì˜"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-green-700 font-medium",children:"ê±°ëž˜ì²˜ëª…"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.painting.supplier,onValueChange:C=>f(M=>({...M,painting:{...M.painting,supplier:C}})),children:[e.jsx(Y,{className:"flex-1 h-8 text-xs",children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:z.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ê±°ëž˜ì²˜",onAdd:Se,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-3 w-3"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-green-700 font-medium",children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.painting.deliveryLocation,onValueChange:C=>f(M=>({...M,painting:{...M.painting,deliveryLocation:C}})),children:[e.jsx(Y,{className:"flex-1 h-8 text-xs",children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:Q.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ë‚©í’ˆì²˜",onAdd:je,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-3 w-3"})})})]})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-orange-50 rounded-lg border border-orange-200",children:[e.jsxs("h3",{className:"font-semibold text-orange-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"ë‹¨ì—´"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-orange-700 font-medium",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"sm",className:"flex-1 justify-start text-left font-normal h-8",children:[e.jsx(ut,{className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:m.insulation.deliveryDate?tr(m.insulation.deliveryDate):"ë‚ ì§œ ì„ íƒ"})]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.insulation.deliveryDate&&m.insulation.deliveryDate!=="í˜‘ì˜"?new Date(m.insulation.deliveryDate):void 0,onSelect:C=>{C&&f(M=>({...M,insulation:{...M.insulation,deliveryDate:C.toISOString().split("T")[0]}}))},initialFocus:!0})})]}),e.jsx(b,{variant:m.insulation.deliveryDate==="í˜‘ì˜"?"default":"outline",size:"sm",className:"text-xs h-8 px-2",onClick:()=>f(C=>({...C,insulation:{...C.insulation,deliveryDate:"í˜‘ì˜"}})),children:"í˜‘ì˜"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-orange-700 font-medium",children:"ê±°ëž˜ì²˜ëª…"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.insulation.supplier,onValueChange:C=>f(M=>({...M,insulation:{...M.insulation,supplier:C}})),children:[e.jsx(Y,{className:"flex-1 h-8 text-xs",children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:z.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ê±°ëž˜ì²˜",onAdd:Se,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-3 w-3"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-orange-700 font-medium",children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.insulation.deliveryLocation,onValueChange:C=>f(M=>({...M,insulation:{...M.insulation,deliveryLocation:C}})),children:[e.jsx(Y,{className:"flex-1 h-8 text-xs",children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:Q.map(C=>e.jsx(R,{value:C,children:C},C))})]}),e.jsx(bt,{title:"ë‚©í’ˆì²˜",onAdd:je,trigger:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(we,{className:"h-3 w-3"})})})]})]})]})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"íŠ¹ì´ ì‚¬í•­"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"specialNotes",className:"text-sm font-medium text-gray-700",children:"í”„ë¡œì íŠ¸ íŠ¹ì´ì‚¬í•­ ë° ìš”ì²­ì‚¬í•­"}),e.jsx("textarea",{id:"specialNotes",value:m.specialNotes,onChange:C=>f(M=>({...M,specialNotes:C.target.value})),placeholder:"í”„ë¡œì íŠ¸ ì§„í–‰ ì‹œ ê³ ë ¤í•´ì•¼ í•  íŠ¹ì´ì‚¬í•­ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”...",className:"w-full min-h-[100px] p-3 border border-gray-300 rounded-md resize-vertical focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",rows:4}),e.jsx("p",{className:"text-xs text-gray-500",children:"ì˜ˆ: ë‚©í’ˆ ì‹œê°„ ì œí•œ, íŠ¹ë³„ í¬ìž¥ ìš”êµ¬ì‚¬í•­, í’ˆì§ˆ ê¸°ì¤€, ì„¤ì¹˜ ê´€ë ¨ ì£¼ì˜ì‚¬í•­ ë“±"})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Vs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(U,{type:"file",accept:".xlsx,.xls",onChange:xe,disabled:g,className:"h-10"}),n&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-700 font-medium",children:["ì—…ë¡œë“œëœ íŒŒì¼: ",n]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{c(""),i([]);const C=document.querySelector('input[type="file"]');C&&(C.value="")},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Qe,{className:"h-4 w-4"})})]})]}),g&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm",children:"íŒŒì¼ì„ ì²˜ë¦¬í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]})]})]})}),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ìš”ì•½í‘œ (B1:E4)"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsx("div",{className:"overflow-auto",children:e.jsx("table",{className:"w-full border-collapse",children:e.jsx("tbody",{children:l.slice(0,4).map((C,M)=>e.jsx("tr",{className:"hover:bg-gray-50 transition-colors",children:Array.from({length:4},(te,le)=>{const ce=le+1,_e=C[ce];let de=_e?.displayValue!==void 0?_e.displayValue:_e?.value;if(de==null||de===""||de===0||de==="0")de="";else if(typeof de=="number"&&!isNaN(de))de=Number(de).toFixed(1);else if(typeof de=="string"&&!isNaN(Number(de))){const $e=Number(de);$e===0?de="":de=$e.toFixed(1)}return e.jsx("td",{className:"border border-gray-300 p-2 text-center",children:e.jsx("span",{className:"text-sm text-gray-900",children:String(de||"")})},le)})},M))})})})})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ í’ˆëª© ë¦¬ìŠ¤íŠ¸ (A6:I22)"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsx("tr",{children:["No","í’ˆëª…","Dies No","ìƒ‰ìƒ","ê¸¸ì´","ë‹¨ì¤‘","ì¤‘ëŸ‰","ë¹„ê³ ","ê¸°íƒ€"].map((C,M)=>e.jsx("th",{className:"border border-gray-300 p-2 text-left font-semibold text-gray-700 bg-blue-50 text-xs",children:C},M))})}),e.jsx("tbody",{children:l.slice(6,22).map((C,M)=>{const te=M+1,le=te===16,ce=C[1]?.displayValue||C[1]?.value||"";return!le&&String(ce).trim()===""?null:e.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${le?"bg-yellow-100":""}`,children:Array.from({length:9},(_e,de)=>{const $e=C[de];let fe=$e?.displayValue!==void 0?$e.displayValue:$e?.value;if(le&&(de>=1&&de<=6||de===8))fe="";else if(fe==null||fe===""||fe===0||fe==="0")fe="";else if(de===0){if(typeof fe=="number"&&!isNaN(fe))fe=Math.round(fe).toString();else if(typeof fe=="string"&&!isNaN(Number(fe))){const Ps=Number(fe);Ps===0?fe="":fe=Math.round(Ps).toString()}}else if(typeof fe=="number"&&!isNaN(fe))fe=Number(fe).toFixed(1);else if(typeof fe=="string"&&!isNaN(Number(fe))){const Ps=Number(fe);Ps===0?fe="":fe=Ps.toFixed(1)}return e.jsx("td",{className:`border border-gray-300 p-2 text-center ${le?"bg-yellow-100 font-semibold":""}`,children:e.jsx("span",{className:"text-xs text-gray-900",children:String(fe||"")})},de)})},te)})})]})})})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Da,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"í˜•ìƒ ì´ë¯¸ì§€ ì—…ë¡œë“œ"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"ê° í’ˆëª©ì— í•´ë‹¹í•˜ëŠ” í˜•ìƒ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”. (JPG, PNG, PDF íŒŒì¼ ì§€ì›)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.slice(6,22).map((C,M)=>{const te=C[0]?.displayValue||C[0]?.value||"",le=C[1]?.displayValue||C[1]?.value||"";return M===16||String(le).trim()===""?null:e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs(B,{variant:"outline",className:"text-xs",children:["No. ",typeof te=="number"?Math.round(te):te||M+1]})}),e.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",title:String(le),children:String(le)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{type:"file",accept:".jpg,.jpeg,.png,.pdf",onChange:_e=>{const de=_e.target.files?.[0]||null;de&&p($e=>({...$e,[M]:de}))},className:"text-xs h-8"}),w[M]&&e.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-2 rounded text-xs",children:[e.jsx("span",{className:"text-green-700 truncate",children:w[M]?.name}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>{p(_e=>{const de={..._e};return delete de[M],de})},className:"h-6 w-6 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Qe,{className:"h-3 w-3"})})]})]})]},M)})})]})]})})]}),l.length===0&&e.jsx(L,{className:"border-dashed border-2 border-gray-300 hover:border-blue-400 transition-colors",children:e.jsxs(q,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(fs,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 text-center mb-2 font-medium",children:"ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ì—¬ê¸°ì— ìŠ¤í”„ë ˆë“œì‹œíŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"ìˆ˜ì‹ ì§€ì›: =A1+B1, =SUM(A1:A5), =B2*C2 ë“±"})]})}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsxs(b,{onClick:ie,size:"lg",className:"flex items-center gap-2 px-8 h-12 text-base font-medium",disabled:!n||l.length===0,children:[e.jsx(Ks,{className:"h-5 w-5"}),"ì €ìž¥í•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ",e.jsx(ft,{className:"h-5 w-5"})]})})]})}const pm=Object.freeze(Object.defineProperty({__proto__:null,default:um},Symbol.toStringTag,{value:"Module"}));let jm=class{constructor(a){this.data=a}getCellReference(a){const t=a.match(/([A-Z]+)(\d+)/);if(!t)return 0;const r=this.columnToIndex(t[1]),l=parseInt(t[2])-1;if(l<0||l>=this.data.length||r<0||r>=this.data[l].length)return 0;const i=this.data[l][r].value;return typeof i=="number"?i:parseFloat(i)||0}columnToIndex(a){let t=0;for(let r=0;r<a.length;r++)t=t*26+(a.charCodeAt(r)-64);return t-1}evaluate(a){try{return a=a.replace(/^=/,"").trim(),a.includes("SUM(")?this.evaluateSum(a):(a=a.replace(/[A-Z]+\d+/g,t=>this.getCellReference(t).toString()),this.evaluateArithmetic(a))}catch(t){return console.error("Formula evaluation error:",t),0}}evaluateSum(a){const t=a.match(/SUM\(([^)]+)\)/i);if(!t)return 0;const l=t[1].trim().match(/([A-Z]+\d+):([A-Z]+\d+)/i);if(l){const i=l[1].toUpperCase(),n=l[2].toUpperCase();return this.sumRange(i,n)}return 0}sumRange(a,t){const r=a.match(/([A-Z]+)(\d+)/),l=t.match(/([A-Z]+)(\d+)/);if(!r||!l)return 0;const i=this.columnToIndex(r[1]),n=parseInt(r[2])-1,c=this.columnToIndex(l[1]),g=parseInt(l[2])-1;let o=0;for(let w=n;w<=g;w++)for(let p=i;p<=c;p++)if(w>=0&&w<this.data.length&&p>=0&&p<this.data[w].length){const m=this.data[w][p].value;o+=typeof m=="number"?m:parseFloat(m)||0}return o}evaluateArithmetic(a){try{return Function(`"use strict"; return (${a})`)()}catch(t){return console.error("Arithmetic evaluation error:",t),0}}};function gm({onImageUpload:s}){const[a,t]=d.useState(null),r=l=>{const i=l.target.files?.[0];if(i){const n=URL.createObjectURL(i);t(n),s(i)}};return e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(mn,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"í˜•ìƒ ì´ë¯¸ì§€ ì—…ë¡œë“œ"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Da,{className:"w-8 h-8 mb-4 text-gray-500"}),e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:e.jsx("span",{className:"font-semibold",children:"í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG íŒŒì¼ (ìµœëŒ€ 10MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:r})]})}),a&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:a,alt:"ë¯¸ë¦¬ë³´ê¸°",className:"w-full h-32 object-cover rounded-lg"})})]})]})]})}function fm(){const[s,a]=d.useState("input"),[t,r]=d.useState(null),[l,i]=d.useState([]),[n,c]=d.useState(""),[g,o]=d.useState(!1),[w,p]=d.useState({}),[m,f]=d.useState({siteName:"",materialReceiver:"",headOfficeManager:"",specialNotes:"",panel:{deliveryDate:"",supplier:"",deliveryLocation:""},assembly:{deliveryDate:"",supplier:"",deliveryLocation:""},installation:{deliveryDate:"",supplier:"",deliveryLocation:""}}),[T,O]=d.useState([]),[E,v]=d.useState([]),[F,_]=d.useState([]),{data:k=[]}=se({queryKey:["/api/projects"]}),{data:A=[]}=se({queryKey:["/api/users"]}),{data:x=[]}=se({queryKey:["/api/vendors"]}),{data:D=[]}=se({queryKey:["/api/companies"]}),u=[...k.map(y=>y.projectName),"ê¸°ë³¸ í”„ë¡œì íŠ¸ A","ê¸°ë³¸ í”„ë¡œì íŠ¸ B"],N=[...A.map(y=>y.name),...E,"ê¸°ë³¸ ì¸ìˆ˜ìž A","ê¸°ë³¸ ì¸ìˆ˜ìž B"],j=[...A.map(y=>y.name),...F,"ê¸°ë³¸ ë‹´ë‹¹ìž A","ê¸°ë³¸ ë‹´ë‹¹ìž B"],h=[...x.map(y=>y.name),"ê¸°ë³¸ ê±°ëž˜ì²˜ A","ê¸°ë³¸ ê±°ëž˜ì²˜ B"],I=[...D.map(y=>y.companyName),...T,"ê¸°ë³¸ ë‚©í’ˆì²˜ A","ê¸°ë³¸ ë‚©í’ˆì²˜ B"],S=y=>{O($=>[...$,y])},z=y=>{v($=>[...$,y])},Q=y=>{_($=>[...$,y])},K=()=>{a("input")},ne=()=>{const y=new Date().toISOString();r({projectSettings:m,spreadsheetData:l,fileName:n,timestamp:y}),a("pdf-preview")},Se=y=>{const $=y.target.files?.[0];if(!$)return;o(!0),c($.name);const J=new FileReader;J.onload=ie=>{try{const xe=new Uint8Array(ie.target?.result),vs=pr(xe,{type:"array"}),C=vs.SheetNames[0],M=vs.Sheets[C],te=Wt.decode_range(M["!ref"]||"A1:A1"),le=[];for(let ce=te.s.r;ce<=te.e.r;ce++){const _e=[];for(let de=te.s.c;de<=te.e.c;de++){const $e=Wt.encode_cell({r:ce,c:de}),fe=M[$e];if(fe){const Ps={value:fe.v,formula:fe.f,displayValue:fe.v};_e.push(Ps)}else _e.push({value:"",displayValue:""})}le.push(_e)}i(le),setTimeout(()=>je(le),100)}catch(xe){console.error("Error parsing Excel file:",xe),alert("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{o(!1)}},J.readAsArrayBuffer($)},je=d.useCallback(y=>{const $=new jm(y),J=y.map(ie=>ie.map(xe=>{if(xe.formula&&xe.formula.startsWith("=")){const vs=$.evaluate(xe.formula);return{...xe,displayValue:vs}}return{...xe,displayValue:xe.displayValue!==void 0?xe.displayValue:xe.value}}));i(J)},[]);return s==="pdf-preview"&&t?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(sa,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"íŒë„¬ ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì €ìž¥ëœ ë°œì£¼ì„œ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ìµœì¢… ì œì¶œí•˜ì„¸ìš”."})]})]}),e.jsxs(b,{onClick:K,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"ìˆ˜ì •í•˜ê¸°"]})]}),e.jsxs(L,{className:"hover:shadow-md transition-shadow",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-600"}),"í˜„ìž¥ ì •ë³´"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"í˜„ìž¥ëª…"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.siteName})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.materialReceiver})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.headOfficeManager})]})]}),t.projectSettings.specialNotes&&e.jsxs("div",{className:"mt-4",children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx("p",{className:"text-sm",children:t.projectSettings.specialNotes})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(L,{className:"border-green-200",children:[e.jsx(H,{className:"bg-green-50",children:e.jsx(W,{className:"text-green-700 text-sm",children:"íŒë„¬ ê³µì •"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.panel.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.panel.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.panel.deliveryLocation})]})]})})]}),e.jsxs(L,{className:"border-blue-200",children:[e.jsx(H,{className:"bg-blue-50",children:e.jsx(W,{className:"text-blue-700 text-sm",children:"ì¡°ë¦½ ê³µì •"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.assembly.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.assembly.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.assembly.deliveryLocation})]})]})})]}),e.jsxs(L,{className:"border-purple-200",children:[e.jsx(H,{className:"bg-purple-50",children:e.jsx(W,{className:"text-purple-700 text-sm",children:"ì„¤ì¹˜ ê³µì •"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.installation.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.installation.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.installation.deliveryLocation})]})]})})]})]}),e.jsxs(L,{className:"hover:shadow-md transition-shadow",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-green-600"}),"ë°œì£¼ í’ˆëª© ëª©ë¡"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["íŒŒì¼ëª…: ",t.fileName]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:t.spreadsheetData[0]?.map((y,$)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+$)},$))})}),e.jsx("tbody",{children:t.spreadsheetData.slice(0,10).map((y,$)=>e.jsx("tr",{className:"border-t",children:y.map((J,ie)=>e.jsx("td",{className:"px-3 py-2 border-r",children:J.displayValue||J.value||""},ie))},$))})]}),t.spreadsheetData.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... ê·¸ ì™¸ ",t.spreadsheetData.length-10,"ê°œ í–‰"]})]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-6",children:[e.jsxs(b,{onClick:K,variant:"outline",size:"lg",className:"flex items-center gap-2 px-6",children:[e.jsx(ns,{className:"h-4 w-4"}),"ì´ì „ ë‹¨ê³„"]}),e.jsxs(b,{size:"lg",className:"flex items-center gap-2 px-8 bg-green-600 hover:bg-green-700",onClick:()=>{alert("íŒë„¬ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!")},children:[e.jsx(Ks,{className:"h-4 w-4"}),"ìµœì¢… ì œì¶œ"]})]})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(sa,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"íŒë„¬ ë°œì£¼ì„œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"íŒë„¬ ê³µì • ì „ìš© ë°œì£¼ì„œë¥¼ ìž‘ì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤."})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(B,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"ì‹¤í—˜ì  ê¸°ëŠ¥"})})]}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Hs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ì„œ ê¸°ë³¸ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"í”„ë¡œì íŠ¸ ëª…"}),e.jsxs(Z,{value:m.siteName,onValueChange:y=>f($=>({...$,siteName:y})),children:[e.jsx(Y,{className:`h-10 ${m.siteName?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:u.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.materialReceiver,onValueChange:y=>f($=>({...$,materialReceiver:y})),children:[e.jsx(Y,{className:`h-10 ${m.materialReceiver?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ì¸ìˆ˜ìž ì„ íƒ"})}),e.jsx(ee,{children:N.map(y=>e.jsx(R,{value:y,children:y},y))})]}),e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìƒˆ ìžìž¬ ì¸ìˆ˜ìž ì¶”ê°€"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(U,{placeholder:"ìžìž¬ ì¸ìˆ˜ìž ì´ë¦„",onKeyDown:y=>{if(y.key==="Enter"){const $=y.currentTarget.value.trim();$&&(z($),f(J=>({...J,materialReceiver:$})),y.currentTarget.value="")}}})})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.headOfficeManager,onValueChange:y=>f($=>({...$,headOfficeManager:y})),children:[e.jsx(Y,{className:`h-10 ${m.headOfficeManager?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ë‹´ë‹¹ìž ì„ íƒ"})}),e.jsx(ee,{children:j.map(y=>e.jsx(R,{value:y,children:y},y))})]}),e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìƒˆ ë³¸ì‚¬ ë‹´ë‹¹ìž ì¶”ê°€"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(U,{placeholder:"ë³¸ì‚¬ ë‹´ë‹¹ìž ì´ë¦„",onKeyDown:y=>{if(y.key==="Enter"){const $=y.currentTarget.value.trim();$&&(Q($),f(J=>({...J,headOfficeManager:$})),y.currentTarget.value="")}}})})]})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx(Ge,{placeholder:"íŠ¹ì´ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”...",value:m.specialNotes,onChange:y=>f($=>({...$,specialNotes:y.target.value})),className:"h-20"})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow border-green-200",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(sa,{className:"h-5 w-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"íŒë„¬ ê³µì •"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${m.panel.deliveryDate?"border-green-500 bg-green-50":""}`,children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),m.panel.deliveryDate||"ë‚ ì§œ ì„ íƒ"]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.panel.deliveryDate?new Date(m.panel.deliveryDate):void 0,onSelect:y=>f($=>({...$,panel:{...$.panel,deliveryDate:y?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:m.panel.supplier,onValueChange:y=>f($=>({...$,panel:{...$.panel,supplier:y}})),children:[e.jsx(Y,{className:`h-10 ${m.panel.supplier?"border-green-500 bg-green-50":""}`,children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:h.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.panel.deliveryLocation,onValueChange:y=>f($=>({...$,panel:{...$.panel,deliveryLocation:y}})),children:[e.jsx(Y,{className:`h-10 ${m.panel.deliveryLocation?"border-green-500 bg-green-50":""}`,children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:I.map(y=>e.jsx(R,{value:y,children:y},y))})]}),e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìƒˆ ë‚©í’ˆì²˜ ì¶”ê°€"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(U,{placeholder:"ë‚©í’ˆì²˜ ì´ë¦„",onKeyDown:y=>{if(y.key==="Enter"){const $=y.currentTarget.value.trim();$&&(S($),f(J=>({...J,panel:{...J.panel,deliveryLocation:$}})),y.currentTarget.value="")}}})})]})]})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow border-blue-200",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Hs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ì¡°ë¦½ ê³µì •"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${m.assembly.deliveryDate?"border-blue-500 bg-blue-50":""}`,children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),m.assembly.deliveryDate||"ë‚ ì§œ ì„ íƒ"]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.assembly.deliveryDate?new Date(m.assembly.deliveryDate):void 0,onSelect:y=>f($=>({...$,assembly:{...$.assembly,deliveryDate:y?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:m.assembly.supplier,onValueChange:y=>f($=>({...$,assembly:{...$.assembly,supplier:y}})),children:[e.jsx(Y,{className:`h-10 ${m.assembly.supplier?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:h.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆì²˜"}),e.jsxs(Z,{value:m.assembly.deliveryLocation,onValueChange:y=>f($=>({...$,assembly:{...$.assembly,deliveryLocation:y}})),children:[e.jsx(Y,{className:`h-10 ${m.assembly.deliveryLocation?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:I.map(y=>e.jsx(R,{value:y,children:y},y))})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow border-purple-200",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(cs,{className:"h-5 w-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ì„¤ì¹˜ ê³µì •"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${m.installation.deliveryDate?"border-purple-500 bg-purple-50":""}`,children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),m.installation.deliveryDate||"ë‚ ì§œ ì„ íƒ"]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.installation.deliveryDate?new Date(m.installation.deliveryDate):void 0,onSelect:y=>f($=>({...$,installation:{...$.installation,deliveryDate:y?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:m.installation.supplier,onValueChange:y=>f($=>({...$,installation:{...$.installation,supplier:y}})),children:[e.jsx(Y,{className:`h-10 ${m.installation.supplier?"border-purple-500 bg-purple-50":""}`,children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:h.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆì²˜"}),e.jsxs(Z,{value:m.installation.deliveryLocation,onValueChange:y=>f($=>({...$,installation:{...$.installation,deliveryLocation:y}})),children:[e.jsx(Y,{className:`h-10 ${m.installation.deliveryLocation?"border-purple-500 bg-purple-50":""}`,children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:I.map(y=>e.jsx(R,{value:y,children:y},y))})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Excel íŒŒì¼ ì—…ë¡œë“œ"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Vs,{className:"w-8 h-8 mb-4 text-gray-500"}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"})," ë˜ëŠ” ë“œëž˜ê·¸ ì•¤ ë“œë¡­"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Excel íŒŒì¼ (.xlsx, .xls)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:Se})]})}),g&&e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:"íŒŒì¼ì„ ì²˜ë¦¬í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})}),n&&e.jsxs("div",{className:"text-sm text-gray-600",children:["ì—…ë¡œë“œëœ íŒŒì¼: ",e.jsx("span",{className:"font-medium",children:n})]})]})]})}),l.length>0&&e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°"})]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[l[0]?.map((y,$)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+$)},$)),e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"í˜•ìƒ"})]})}),e.jsx("tbody",{children:l.slice(0,10).map((y,$)=>e.jsxs("tr",{className:"border-t",children:[y.map((J,ie)=>e.jsx("td",{className:"px-3 py-2 border-r",children:J.displayValue||J.value||""},ie)),e.jsx("td",{className:"px-3 py-2",children:e.jsx(gm,{onImageUpload:J=>{p(ie=>({...ie,[$]:J}))}})})]},$))})]}),l.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... ê·¸ ì™¸ ",l.length-10,"ê°œ í–‰"]})]})]})}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsxs(b,{onClick:ne,className:"flex items-center gap-2 px-6 bg-green-600 hover:bg-green-700",disabled:!m.siteName||!m.materialReceiver,children:[e.jsx(ft,{className:"h-4 w-4"}),"ì €ìž¥í•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ"]})})]})}const Nm=Object.freeze(Object.defineProperty({__proto__:null,default:fm},Symbol.toStringTag,{value:"Module"}));class ym{constructor(a){this.data=a}getCellReference(a){const t=a.match(/([A-Z]+)(\d+)/);if(!t)return 0;const r=this.columnToIndex(t[1]),l=parseInt(t[2])-1;if(l<0||l>=this.data.length||r<0||r>=this.data[l].length)return 0;const i=this.data[l][r].value;return typeof i=="number"?i:parseFloat(i)||0}columnToIndex(a){let t=0;for(let r=0;r<a.length;r++)t=t*26+(a.charCodeAt(r)-64);return t-1}evaluate(a){try{return a=a.replace(/^=/,"").trim(),a.includes("SUM(")?this.evaluateSum(a):(a=a.replace(/[A-Z]+\d+/g,t=>this.getCellReference(t).toString()),this.evaluateArithmetic(a))}catch(t){return console.error("Formula evaluation error:",t),0}}evaluateSum(a){const t=a.match(/SUM\(([^)]+)\)/i);if(!t)return 0;const l=t[1].trim().match(/([A-Z]+\d+):([A-Z]+\d+)/i);if(l){const i=l[1].toUpperCase(),n=l[2].toUpperCase();return this.sumRange(i,n)}return 0}sumRange(a,t){const r=a.match(/([A-Z]+)(\d+)/),l=t.match(/([A-Z]+)(\d+)/);if(!r||!l)return 0;const i=this.columnToIndex(r[1]),n=parseInt(r[2])-1,c=this.columnToIndex(l[1]),g=parseInt(l[2])-1;let o=0;for(let w=n;w<=g;w++)for(let p=i;p<=c;p++)if(w>=0&&w<this.data.length&&p>=0&&p<this.data[w].length){const m=this.data[w][p].value;o+=typeof m=="number"?m:parseFloat(m)||0}return o}evaluateArithmetic(a){try{return Function(`"use strict"; return (${a})`)()}catch(t){return console.error("Arithmetic evaluation error:",t),0}}}function vm({onImageUpload:s}){const[a,t]=d.useState(null),r=l=>{const i=l.target.files?.[0];if(i){const n=URL.createObjectURL(i);t(n),s(i)}};return e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(mn,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ë¶€ìžìž¬ ì´ë¯¸ì§€ ì—…ë¡œë“œ"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Da,{className:"w-8 h-8 mb-4 text-gray-500"}),e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:e.jsx("span",{className:"font-semibold",children:"í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG íŒŒì¼ (ìµœëŒ€ 10MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:r})]})}),a&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:a,alt:"ë¯¸ë¦¬ë³´ê¸°",className:"w-full h-32 object-cover rounded-lg"})})]})]})]})}function bm(){const[s,a]=d.useState("input"),[t,r]=d.useState(null),[l,i]=d.useState([]),[n,c]=d.useState(""),[g,o]=d.useState(!1),[w,p]=d.useState({}),[m,f]=d.useState({siteName:"",materialReceiver:"",headOfficeManager:"",specialNotes:"",hardware:{deliveryDate:"",supplier:"",deliveryLocation:""},sealing:{deliveryDate:"",supplier:"",deliveryLocation:""},finishing:{deliveryDate:"",supplier:"",deliveryLocation:""}}),[T,O]=d.useState([]),[E,v]=d.useState([]),[F,_]=d.useState([]),{data:k=[]}=se({queryKey:["/api/projects"]}),{data:A=[]}=se({queryKey:["/api/users"]}),{data:x=[]}=se({queryKey:["/api/vendors"]}),{data:D=[]}=se({queryKey:["/api/companies"]}),u=[...k.map(y=>y.projectName),"ê¸°ë³¸ í˜„ìž¥ A","ê¸°ë³¸ í˜„ìž¥ B"],N=[...A.map(y=>y.name),...E,"ê¸°ë³¸ ì¸ìˆ˜ìž A","ê¸°ë³¸ ì¸ìˆ˜ìž B"],j=[...A.map(y=>y.name),...F,"ê¸°ë³¸ ë‹´ë‹¹ìž A","ê¸°ë³¸ ë‹´ë‹¹ìž B"],h=[...x.map(y=>y.name),"ê¸°ë³¸ ê±°ëž˜ì²˜ A","ê¸°ë³¸ ê±°ëž˜ì²˜ B"],I=[...D.map(y=>y.companyName),...T,"ê¸°ë³¸ ë‚©í’ˆì²˜ A","ê¸°ë³¸ ë‚©í’ˆì²˜ B"],S=y=>{O($=>[...$,y])},z=y=>{v($=>[...$,y])},Q=y=>{_($=>[...$,y])},K=()=>{a("input")},ne=()=>{const y=new Date().toISOString();r({projectSettings:m,spreadsheetData:l,fileName:n,timestamp:y}),a("pdf-preview")},Se=y=>{const $=y.target.files?.[0];if(!$)return;o(!0),c($.name);const J=new FileReader;J.onload=ie=>{try{const xe=new Uint8Array(ie.target?.result),vs=pr(xe,{type:"array"}),C=vs.SheetNames[0],M=vs.Sheets[C],te=Wt.decode_range(M["!ref"]||"A1:A1"),le=[];for(let ce=te.s.r;ce<=te.e.r;ce++){const _e=[];for(let de=te.s.c;de<=te.e.c;de++){const $e=Wt.encode_cell({r:ce,c:de}),fe=M[$e];if(fe){const Ps={value:fe.v,formula:fe.f,displayValue:fe.v};_e.push(Ps)}else _e.push({value:"",displayValue:""})}le.push(_e)}i(le),setTimeout(()=>je(le),100)}catch(xe){console.error("Error parsing Excel file:",xe),alert("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{o(!1)}},J.readAsArrayBuffer($)},je=d.useCallback(y=>{const $=new ym(y),J=y.map(ie=>ie.map(xe=>{if(xe.formula&&xe.formula.startsWith("=")){const vs=$.evaluate(xe.formula);return{...xe,displayValue:vs}}return{...xe,displayValue:xe.displayValue!==void 0?xe.displayValue:xe.value}}));i(J)},[]);return s==="pdf-preview"&&t?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(Ua,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"ë¶€ìžìž¬ ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì €ìž¥ëœ ë°œì£¼ì„œ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ìµœì¢… ì œì¶œí•˜ì„¸ìš”."})]})]}),e.jsxs(b,{onClick:K,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"ìˆ˜ì •í•˜ê¸°"]})]}),e.jsxs(L,{className:"hover:shadow-md transition-shadow shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-600"}),"í˜„ìž¥ ì •ë³´"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"í˜„ìž¥ëª…"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.siteName})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.materialReceiver})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsx("p",{className:"text-sm font-semibold",children:t.projectSettings.headOfficeManager})]})]}),t.projectSettings.specialNotes&&e.jsxs("div",{className:"mt-4",children:[e.jsx(P,{className:"text-sm font-medium text-gray-600",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx("p",{className:"text-sm",children:t.projectSettings.specialNotes})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs(L,{className:"border-orange-200 shadow-sm",children:[e.jsx(H,{className:"bg-orange-50",children:e.jsx(W,{className:"text-orange-700 text-sm",children:"í•˜ë“œì›¨ì–´"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.hardware.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.hardware.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.hardware.deliveryLocation})]})]})})]}),e.jsxs(L,{className:"border-teal-200 shadow-sm",children:[e.jsx(H,{className:"bg-teal-50",children:e.jsx(W,{className:"text-teal-700 text-sm",children:"ì‹¤ë§ìž¬"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.sealing.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.sealing.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.sealing.deliveryLocation})]})]})})]}),e.jsxs(L,{className:"border-indigo-200 shadow-sm",children:[e.jsx(H,{className:"bg-indigo-50",children:e.jsx(W,{className:"text-indigo-700 text-sm",children:"ë§ˆê°ìž¬"})}),e.jsx(q,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.finishing.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.finishing.supplier})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆì²˜"}),e.jsx("p",{className:"text-sm font-medium",children:t.projectSettings.finishing.deliveryLocation})]})]})})]})]}),e.jsxs(L,{className:"hover:shadow-md transition-shadow shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-orange-600"}),"ë°œì£¼ í’ˆëª© ëª©ë¡"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["íŒŒì¼ëª…: ",t.fileName]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:t.spreadsheetData[0]?.map((y,$)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+$)},$))})}),e.jsx("tbody",{children:t.spreadsheetData.slice(0,10).map((y,$)=>e.jsx("tr",{className:"border-t",children:y.map((J,ie)=>e.jsx("td",{className:"px-3 py-2 border-r",children:J.displayValue||J.value||""},ie))},$))})]}),t.spreadsheetData.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... ê·¸ ì™¸ ",t.spreadsheetData.length-10,"ê°œ í–‰"]})]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-6",children:[e.jsxs(b,{onClick:K,variant:"outline",size:"lg",className:"flex items-center gap-2 px-6",children:[e.jsx(ns,{className:"h-4 w-4"}),"ì´ì „ ë‹¨ê³„"]}),e.jsxs(b,{size:"lg",className:"flex items-center gap-2 px-8 bg-orange-600 hover:bg-orange-700",onClick:()=>{alert("ë¶€ìžìž¬ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!")},children:[e.jsx(Ks,{className:"h-4 w-4"}),"ìµœì¢… ì œì¶œ"]})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ua,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ë¶€ìžìž¬ ë°œì£¼ì„œ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë¶€ìžìž¬ ê³µì • ì „ìš© ë°œì£¼ì„œë¥¼ ìž‘ì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤."})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(B,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"ì‹¤í—˜ì  ê¸°ëŠ¥"})})]}),e.jsx(L,{className:"hover:shadow-md transition-shadow shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Hs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ì„œ ê¸°ë³¸ ì •ë³´"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"í˜„ìž¥ ëª…"}),e.jsxs(Z,{value:m.siteName,onValueChange:y=>f($=>({...$,siteName:y})),children:[e.jsx(Y,{className:`h-10 ${m.siteName?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:u.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.materialReceiver,onValueChange:y=>f($=>({...$,materialReceiver:y})),children:[e.jsx(Y,{className:`h-10 ${m.materialReceiver?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ì¸ìˆ˜ìž ì„ íƒ"})}),e.jsx(ee,{children:N.map(y=>e.jsx(R,{value:y,children:y},y))})]}),e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìƒˆ ìžìž¬ ì¸ìˆ˜ìž ì¶”ê°€"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(U,{placeholder:"ìžìž¬ ì¸ìˆ˜ìž ì´ë¦„",onKeyDown:y=>{if(y.key==="Enter"){const $=y.currentTarget.value.trim();$&&(z($),f(J=>({...J,materialReceiver:$})),y.currentTarget.value="")}}})})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.headOfficeManager,onValueChange:y=>f($=>({...$,headOfficeManager:y})),children:[e.jsx(Y,{className:`h-10 ${m.headOfficeManager?"border-blue-500 bg-blue-50":""}`,children:e.jsx(X,{placeholder:"ë‹´ë‹¹ìž ì„ íƒ"})}),e.jsx(ee,{children:j.map(y=>e.jsx(R,{value:y,children:y},y))})]}),e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìƒˆ ë³¸ì‚¬ ë‹´ë‹¹ìž ì¶”ê°€"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(U,{placeholder:"ë³¸ì‚¬ ë‹´ë‹¹ìž ì´ë¦„",onKeyDown:y=>{if(y.key==="Enter"){const $=y.currentTarget.value.trim();$&&(Q($),f(J=>({...J,headOfficeManager:$})),y.currentTarget.value="")}}})})]})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx(Ge,{placeholder:"íŠ¹ì´ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”...",value:m.specialNotes,onChange:y=>f($=>({...$,specialNotes:y.target.value})),className:"h-20"})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow border-orange-200 shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ua,{className:"h-5 w-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"í•˜ë“œì›¨ì–´"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${m.hardware.deliveryDate?"border-orange-500 bg-orange-50":""}`,children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),m.hardware.deliveryDate||"ë‚ ì§œ ì„ íƒ"]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.hardware.deliveryDate?new Date(m.hardware.deliveryDate):void 0,onSelect:y=>f($=>({...$,hardware:{...$.hardware,deliveryDate:y?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:m.hardware.supplier,onValueChange:y=>f($=>({...$,hardware:{...$.hardware,supplier:y}})),children:[e.jsx(Y,{className:`h-10 ${m.hardware.supplier?"border-orange-500 bg-orange-50":""}`,children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:h.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:m.hardware.deliveryLocation,onValueChange:y=>f($=>({...$,hardware:{...$.hardware,deliveryLocation:y}})),children:[e.jsx(Y,{className:`h-10 ${m.hardware.deliveryLocation?"border-orange-500 bg-orange-50":""}`,children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:I.map(y=>e.jsx(R,{value:y,children:y},y))})]}),e.jsxs(ze,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìƒˆ ë‚©í’ˆì²˜ ì¶”ê°€"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(U,{placeholder:"ë‚©í’ˆì²˜ ì´ë¦„",onKeyDown:y=>{if(y.key==="Enter"){const $=y.currentTarget.value.trim();$&&(S($),f(J=>({...J,hardware:{...J.hardware,deliveryLocation:$}})),y.currentTarget.value="")}}})})]})]})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow border-teal-200 shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Hs,{className:"h-5 w-5 text-teal-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ì‹¤ë§ìž¬"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${m.sealing.deliveryDate?"border-teal-500 bg-teal-50":""}`,children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),m.sealing.deliveryDate||"ë‚ ì§œ ì„ íƒ"]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.sealing.deliveryDate?new Date(m.sealing.deliveryDate):void 0,onSelect:y=>f($=>({...$,sealing:{...$.sealing,deliveryDate:y?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:m.sealing.supplier,onValueChange:y=>f($=>({...$,sealing:{...$.sealing,supplier:y}})),children:[e.jsx(Y,{className:`h-10 ${m.sealing.supplier?"border-teal-500 bg-teal-50":""}`,children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:h.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆì²˜"}),e.jsxs(Z,{value:m.sealing.deliveryLocation,onValueChange:y=>f($=>({...$,sealing:{...$.sealing,deliveryLocation:y}})),children:[e.jsx(Y,{className:`h-10 ${m.sealing.deliveryLocation?"border-teal-500 bg-teal-50":""}`,children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:I.map(y=>e.jsx(R,{value:y,children:y},y))})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow border-indigo-200 shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(cs,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë§ˆê°ìž¬"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆí¬ë§ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${m.finishing.deliveryDate?"border-indigo-500 bg-indigo-50":""}`,children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),m.finishing.deliveryDate||"ë‚ ì§œ ì„ íƒ"]})}),e.jsx(Is,{className:"w-auto p-0",align:"start",children:e.jsx(Ys,{mode:"single",selected:m.finishing.deliveryDate?new Date(m.finishing.deliveryDate):void 0,onSelect:y=>f($=>({...$,finishing:{...$.finishing,deliveryDate:y?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:m.finishing.supplier,onValueChange:y=>f($=>({...$,finishing:{...$.finishing,supplier:y}})),children:[e.jsx(Y,{className:`h-10 ${m.finishing.supplier?"border-indigo-500 bg-indigo-50":""}`,children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:h.map(y=>e.jsx(R,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium text-gray-700",children:"ë‚©í’ˆì²˜"}),e.jsxs(Z,{value:m.finishing.deliveryLocation,onValueChange:y=>f($=>({...$,finishing:{...$.finishing,deliveryLocation:y}})),children:[e.jsx(Y,{className:`h-10 ${m.finishing.deliveryLocation?"border-indigo-500 bg-indigo-50":""}`,children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ ì„ íƒ"})}),e.jsx(ee,{children:I.map(y=>e.jsx(R,{value:y,children:y},y))})]})]})]})]})}),e.jsx(L,{className:"hover:shadow-md transition-shadow shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Excel íŒŒì¼ ì—…ë¡œë“œ"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Vs,{className:"w-8 h-8 mb-4 text-gray-500"}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ"})," ë˜ëŠ” ë“œëž˜ê·¸ ì•¤ ë“œë¡­"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Excel íŒŒì¼ (.xlsx, .xls)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:Se})]})}),g&&e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:"íŒŒì¼ì„ ì²˜ë¦¬í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})}),n&&e.jsxs("div",{className:"text-sm text-gray-600",children:["ì—…ë¡œë“œëœ íŒŒì¼: ",e.jsx("span",{className:"font-medium",children:n})]})]})]})}),l.length>0&&e.jsx(L,{className:"hover:shadow-md transition-shadow shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°"})]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[l[0]?.map((y,$)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+$)},$)),e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"ì´ë¯¸ì§€"})]})}),e.jsx("tbody",{children:l.slice(0,10).map((y,$)=>e.jsxs("tr",{className:"border-t",children:[y.map((J,ie)=>e.jsx("td",{className:"px-3 py-2 border-r",children:J.displayValue||J.value||""},ie)),e.jsx("td",{className:"px-3 py-2",children:e.jsx(vm,{onImageUpload:J=>{p(ie=>({...ie,[$]:J}))}})})]},$))})]}),l.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... ê·¸ ì™¸ ",l.length-10,"ê°œ í–‰"]})]})]})}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsxs(b,{onClick:ne,className:"flex items-center gap-2 px-6 bg-orange-600 hover:bg-orange-700",disabled:!m.siteName||!m.materialReceiver,children:[e.jsx(ft,{className:"h-4 w-4"}),"ì €ìž¥í•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ"]})})]})})}const wm=Object.freeze(Object.defineProperty({__proto__:null,default:bm},Symbol.toStringTag,{value:"Module"})),Cm=Oc,Sm=Fc,km=Mc,bi=d.forwardRef(({className:s,inset:a,children:t,...r},l)=>e.jsxs(hn,{ref:l,className:V("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",a&&"pl-8",s),...r,children:[t,e.jsx(mt,{className:"ml-auto h-4 w-4"})]}));bi.displayName=hn.displayName;const wi=d.forwardRef(({className:s,...a},t)=>e.jsx(un,{ref:t,className:V("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]",s),...a}));wi.displayName=un.displayName;const Ci=d.forwardRef(({className:s,...a},t)=>e.jsx(Ic,{children:e.jsx(pn,{ref:t,className:V("z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]",s),...a})}));Ci.displayName=pn.displayName;const At=d.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(jn,{ref:r,className:V("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s),...t}));At.displayName=jn.displayName;const _m=d.forwardRef(({className:s,children:a,checked:t,...r},l)=>e.jsxs(gn,{ref:l,className:V("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(fn,{children:e.jsx(ps,{className:"h-4 w-4"})})}),a]}));_m.displayName=gn.displayName;const Dm=d.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Nn,{ref:r,className:V("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(fn,{children:e.jsx(Sl,{className:"h-2 w-2 fill-current"})})}),a]}));Dm.displayName=Nn.displayName;const Am=d.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(yn,{ref:r,className:V("px-2 py-1.5 text-sm font-semibold text-foreground",a&&"pl-8",s),...t}));Am.displayName=yn.displayName;const nr=d.forwardRef(({className:s,...a},t)=>e.jsx(vn,{ref:t,className:V("-mx-1 my-1 h-px bg-border",s),...a}));nr.displayName=vn.displayName;const Sa={major:{label:"ëŒ€ë¶„ë¥˜",color:"bg-blue-100 text-blue-800 border-blue-200",icon:"ðŸ—ï¸",maxLevel:0,canHaveChildren:!0},middle:{label:"ì¤‘ë¶„ë¥˜",color:"bg-green-100 text-green-800 border-green-200",icon:"ðŸ“",maxLevel:1,canHaveChildren:!0},minor:{label:"ì†Œë¶„ë¥˜",color:"bg-orange-100 text-orange-800 border-orange-200",icon:"ðŸ“„",maxLevel:2,canHaveChildren:!1}};function Si({node:s,onEdit:a,onDelete:t,onToggle:r,onSelect:l,onAddChild:i,onMove:n,searchTerm:c,isMultiSelectMode:g,selectedNodes:o}){const w=d.useRef(null),[p,m]=d.useState(!1),[f,T]=d.useState(!1),[O,E]=d.useState(null),v=h=>{if(T(!0),h.dataTransfer.setData("application/json",JSON.stringify({id:s.id,node:s})),h.dataTransfer.effectAllowed="move",w.current){const I=w.current.cloneNode(!0);I.style.transform="rotate(5deg)",I.style.opacity="0.8",I.style.backgroundColor="#3b82f6",I.style.color="white",I.style.borderRadius="8px",I.style.padding="8px",I.style.position="absolute",I.style.top="-1000px",I.style.pointerEvents="none",document.body.appendChild(I),h.dataTransfer.setDragImage(I,0,0),setTimeout(()=>{document.body.contains(I)&&document.body.removeChild(I)},0)}},F=()=>{T(!1),E(null)},_=h=>{h.preventDefault();try{const I=JSON.parse(h.dataTransfer.getData("application/json")||"{}");if(I.node&&I.node.id===s.id){h.dataTransfer.dropEffect="none";return}}catch{}if(h.dataTransfer.dropEffect="move",w.current){const I=w.current.getBoundingClientRect(),S=h.clientY-I.top,z=I.height;S<z*.25?E("before"):S>z*.75?E("after"):E(Sa[s.categoryType].canHaveChildren?"inside":"after")}},k=()=>{E(null)},A=h=>{h.preventDefault(),E(null);try{const I=JSON.parse(h.dataTransfer.getData("application/json"));I.node&&I.node.id!==s.id&&O&&n(I.node,s,O)}catch(I){console.error("Error parsing drag data:",I)}},x=(h,I)=>{if(!I.trim())return h;const S=new RegExp(`(${I})`,"gi");return h.split(S).map((Q,K)=>S.test(Q)?e.jsx("mark",{className:"bg-yellow-200 px-1 rounded",children:Q},K):Q)},D=Sa[s.categoryType],u=s.children.length>0,N=o.has(s.id),j=D.canHaveChildren;return e.jsxs("div",{ref:w,className:`relative ${f?"opacity-50":""}`,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),onDragOver:_,onDragLeave:k,onDrop:A,children:[O==="before"&&e.jsx("div",{className:"absolute -top-1 left-0 right-0 h-1 bg-blue-500 rounded-full shadow-lg z-10 animate-pulse"}),O==="after"&&e.jsx("div",{className:"absolute -bottom-1 left-0 right-0 h-1 bg-blue-500 rounded-full shadow-lg z-10 animate-pulse"}),e.jsxs(Cm,{children:[e.jsx(Sm,{children:e.jsxs("div",{draggable:!0,onDragStart:v,onDragEnd:F,className:`
              flex items-center gap-3 p-3 rounded-lg border transition-all duration-200 cursor-pointer
              ${N?"bg-blue-50 border-blue-300 shadow-sm":"hover:bg-gray-50 border-gray-200"}
              ${O==="inside"?"bg-blue-100 border-blue-400 shadow-lg":""}
              ${f?"shadow-lg transform scale-95":""}
              ${O?"ring-2 ring-blue-300 ring-opacity-50":""}
            `,style:{marginLeft:`${s.level*24}px`},onClick:h=>{h.preventDefault(),l(s,h.ctrlKey||h.metaKey||g)},children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:u&&e.jsx(b,{variant:"ghost",size:"sm",className:"w-5 h-5 p-0 hover:bg-gray-200",onClick:h=>{h.stopPropagation(),r(s)},children:s.isExpanded?e.jsx(Zs,{className:"w-4 h-4"}):e.jsx(mt,{className:"w-4 h-4"})})}),g&&e.jsx("input",{type:"checkbox",checked:N,onChange:()=>l(s,!0),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",onClick:h=>h.stopPropagation()}),e.jsxs(B,{variant:"secondary",className:`${D.color} text-xs font-medium px-2 py-1 border`,children:[e.jsx("span",{className:"mr-1",children:D.icon}),D.label]}),e.jsx("span",{className:"flex-1 font-medium text-gray-900",children:x(s.categoryName,c)}),e.jsxs("div",{className:"flex items-center gap-2",children:[!s.isActive&&e.jsx(B,{variant:"outline",className:"text-gray-500 border-gray-300",children:"ë¹„í™œì„±"}),u&&e.jsxs(B,{variant:"outline",className:"text-blue-600 border-blue-300 text-xs",children:[s.children.length,"ê°œ"]})]}),(p||N)&&e.jsxs("div",{className:"flex items-center gap-1 transition-opacity duration-200",children:[e.jsx(pt,{children:e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"w-8 h-8 p-0 hover:bg-blue-100",onClick:h=>{h.stopPropagation(),a(s)},children:e.jsx(ds,{className:"w-4 h-4"})})}),e.jsx(Fs,{children:e.jsx("p",{children:"íŽ¸ì§‘"})})]})}),j&&e.jsx(pt,{children:e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"w-8 h-8 p-0 hover:bg-green-100",onClick:h=>{h.stopPropagation(),i(s)},children:e.jsx(zc,{className:"w-4 h-4"})})}),e.jsx(Fs,{children:e.jsx("p",{children:"í•˜ìœ„ ë¶„ë¥˜ ì¶”ê°€"})})]})}),e.jsx(pt,{children:e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"w-8 h-8 p-0 hover:bg-red-100",onClick:h=>{h.stopPropagation(),t(s)},children:e.jsx(Qe,{className:"w-4 h-4"})})}),e.jsx(Fs,{children:e.jsx("p",{children:"ì‚­ì œ"})})]})})]})]})}),e.jsxs(Ci,{className:"w-56",children:[e.jsxs(At,{onClick:()=>a(s),children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),"íŽ¸ì§‘"]}),j&&e.jsxs(At,{onClick:()=>i(s),children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"í•˜ìœ„ ë¶„ë¥˜ ì¶”ê°€"]}),e.jsx(nr,{}),e.jsxs(km,{children:[e.jsxs(bi,{children:[e.jsx(na,{className:"w-4 h-4 mr-2"}),"ë³µì‚¬"]}),e.jsxs(wi,{children:[e.jsx(At,{children:"ì´ë¦„ë§Œ ë³µì‚¬"}),e.jsx(At,{children:"êµ¬ì¡°ì™€ í•¨ê»˜ ë³µì‚¬"})]})]}),e.jsxs(At,{children:[e.jsx(qc,{className:"w-4 h-4 mr-2"}),"ì´ë™"]}),e.jsx(nr,{}),e.jsxs(At,{onClick:()=>t(s),className:"text-red-600 focus:text-red-600",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"ì‚­ì œ"]})]})]}),u&&s.isExpanded&&e.jsx("div",{className:"mt-2 space-y-1",children:s.children.map(h=>e.jsx(Si,{node:h,onEdit:a,onDelete:t,onToggle:r,onSelect:l,onAddChild:i,onMove:n,searchTerm:c,isMultiSelectMode:g,selectedNodes:o},h.id))})]})}function op(){const{toast:s}=Ze(),a=us(),[t,r]=d.useState("tree"),[l,i]=d.useState(!1),[n,c]=d.useState(new Set),[g,o]=d.useState(new Set),[w,p]=d.useState(null),[m,f]=d.useState(!1),[T,O]=d.useState(null),[E,v]=d.useState(!1),[F,_]=d.useState([]),[k,A]=d.useState(-1),[x,D]=d.useState(""),[u,N]=d.useState({searchTerm:"",categoryType:"all",isActive:"all",parentId:null}),[j,h]=d.useState(100),[I,S]=d.useState(!0),[z,Q]=d.useState({categoryType:"major",categoryName:"",parentId:null,displayOrder:0,isActive:!0}),{data:K=[],isLoading:ne}=se({queryKey:["/api/item-categories"],queryFn:()=>me("GET","/api/item-categories")}),Se=Ce({mutationFn:re=>me("POST","/api/item-categories",re),onSuccess:re=>{a.invalidateQueries({queryKey:["/api/item-categories"]}),f(!1),ce(),J("Created category: "+re.categoryName),s({title:"ë¶„ë¥˜ ì¶”ê°€ ì™„ë£Œ",description:"ìƒˆë¡œìš´ ë¶„ë¥˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{s({title:"ì˜¤ë¥˜",description:"ë¶„ë¥˜ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),je=Ce({mutationFn:({id:re,data:ge})=>me("PUT",`/api/item-categories/${re}`,ge),onSuccess:re=>{a.invalidateQueries({queryKey:["/api/item-categories"]}),p(null),J("Updated category: "+re.categoryName),s({title:"ë¶„ë¥˜ ìˆ˜ì • ì™„ë£Œ",description:"ë¶„ë¥˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{s({title:"ì˜¤ë¥˜",description:"ë¶„ë¥˜ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),y=Ce({mutationFn:re=>me("DELETE",`/api/item-categories/${re}`),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/item-categories"]}),c(new Set),J("Deleted category"),s({title:"ë¶„ë¥˜ ì‚­ì œ ì™„ë£Œ",description:"ë¶„ë¥˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:()=>{s({title:"ì˜¤ë¥˜",description:"ë¶„ë¥˜ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),$=d.useMemo(()=>{const re=(ge,ke=0)=>K.filter(Ie=>Ie.parentId===ge).filter(Ie=>!(!I&&!Ie.isActive||u.categoryType!=="all"&&Ie.categoryType!==u.categoryType||u.isActive!=="all"&&(u.isActive==="active"&&!Ie.isActive||u.isActive==="inactive"&&Ie.isActive)||x&&!Ie.categoryName.toLowerCase().includes(x.toLowerCase()))).sort((Ie,bs)=>Ie.displayOrder-bs.displayOrder).map(Ie=>({...Ie,level:ke,path:[],children:re(Ie.id,ke+1),isExpanded:g.has(Ie.id),isVisible:!0,isEditing:!1,isSelected:n.has(Ie.id),isDragging:!1,isDropTarget:!1}));return re(null)},[K,g,n,I,u,x]),J=d.useCallback(re=>{const ge={categories:[...K],timestamp:Date.now(),action:re},ke=F.slice(0,k+1);ke.push(ge),ke.length>50&&ke.shift(),_(ke),A(ke.length-1)},[K,F,k]),ie=d.useCallback((re,ge=!1)=>{if(ge||l){const ke=new Set(n);ke.has(re.id)?ke.delete(re.id):ke.add(re.id),c(ke)}else c(new Set([re.id]))},[n,l]),xe=d.useCallback(re=>{const ge=new Set(g);ge.has(re.id)?ge.delete(re.id):ge.add(re.id),o(ge)},[g]),vs=d.useCallback(re=>{p(re),Q({categoryType:re.categoryType,categoryName:re.categoryName,parentId:re.parentId,displayOrder:re.displayOrder,isActive:re.isActive}),f(!0)},[]),C=d.useCallback(re=>{const ge=re.categoryType==="major"?"middle":"minor";O(re),Q({categoryType:ge,categoryName:"",parentId:re.id,displayOrder:re.children.length,isActive:!0}),f(!0)},[]),M=d.useCallback(async(re,ge,ke)=>{if(!E){v(!0);try{let Ie=null,bs=0;if(ke==="inside"){if(!Sa[ge.categoryType].canHaveChildren){s({title:"ì´ë™ ë¶ˆê°€",description:`${Sa[ge.categoryType].label}ëŠ” í•˜ìœ„ ë¶„ë¥˜ë¥¼ ê°€ì§ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,variant:"destructive"});return}if(te(ge,re)){s({title:"ì´ë™ ë¶ˆê°€",description:"ìƒìœ„ ë¶„ë¥˜ë¥¼ í•˜ìœ„ ë¶„ë¥˜ë¡œ ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",variant:"destructive"});return}Ie=ge.id,bs=ge.children.length}else{Ie=ge.parentId;const at=K.filter(_t=>_t.parentId===Ie),Tr=at.findIndex(_t=>_t.id===ge.id);if(ke==="before"){bs=ge.displayOrder;const _t=at.filter(ws=>ws.displayOrder>=bs&&ws.id!==re.id).map(ws=>({id:ws.id,displayOrder:ws.displayOrder+1}));for(const ws of _t)await je.mutateAsync({id:ws.id,data:{displayOrder:ws.displayOrder}})}else{bs=ge.displayOrder+1;const _t=at.filter(ws=>ws.displayOrder>ge.displayOrder&&ws.id!==re.id).map(ws=>({id:ws.id,displayOrder:ws.displayOrder+1}));for(const ws of _t)await je.mutateAsync({id:ws.id,data:{displayOrder:ws.displayOrder}})}}await je.mutateAsync({id:re.id,data:{parentId:Ie,displayOrder:bs}}),J(`Moved "${re.categoryName}" ${ke} "${ge.categoryName}"`),s({title:"ì´ë™ ì™„ë£Œ",description:`"${re.categoryName}"ê°€ ì„±ê³µì ìœ¼ë¡œ ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤.`})}catch(Ie){console.error("Error moving category:",Ie),s({title:"ì´ë™ ì‹¤íŒ¨",description:"ë¶„ë¥˜ ì´ë™ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}finally{v(!1)}}},[K,je,J,s,E]),te=d.useCallback((re,ge)=>{if(re.parentId===ge.id)return!0;if(re.parentId===null)return!1;const ke=K.find(Ie=>Ie.id===re.parentId);return ke?te(ke,ge):!1},[K]),le=d.useCallback(re=>{confirm(`"${re.categoryName}" ë¶„ë¥˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&y.mutate(re.id)},[y]),ce=()=>{Q({categoryType:"major",categoryName:"",parentId:null,displayOrder:0,isActive:!0}),p(null),O(null)},_e=()=>{if(!z.categoryName.trim()){s({title:"ìž…ë ¥ ì˜¤ë¥˜",description:"ë¶„ë¥˜ëª…ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}w?je.mutate({id:w.id,data:z}):Se.mutate(z)};d.useEffect(()=>{const re=ge=>{if(ge.ctrlKey||ge.metaKey)switch(ge.key){case"z":ge.preventDefault(),ge.shiftKey?console.log("Redo"):console.log("Undo");break;case"a":ge.preventDefault(),i(!0),c(new Set(K.map(ke=>ke.id)));break;case"f":ge.preventDefault(),document.getElementById("search-input")?.focus();break}if(ge.key==="Escape"&&(c(new Set),i(!1)),ge.key==="Delete"&&n.size>0&&confirm(`ì„ íƒëœ ${n.size}ê°œì˜ ë¶„ë¥˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&n.forEach(ke=>y.mutate(ke)),ge.key==="ArrowUp"||ge.key==="ArrowDown"){ge.preventDefault();const ke=K.filter(Ie=>Ie.isActive);if(n.size===1){const Ie=Array.from(n)[0],bs=ke.findIndex(Tr=>Tr.id===Ie);let at;ge.key==="ArrowUp"?at=bs>0?bs-1:ke.length-1:at=bs<ke.length-1?bs+1:0,at>=0&&at<ke.length&&c(new Set([ke[at].id]))}}};return document.addEventListener("keydown",re),()=>document.removeEventListener("keydown",re)},[K,n,y]);const de=()=>{const re=K.map(ge=>ge.id);o(new Set(re))},$e=()=>{o(new Set)},fe=()=>{n.size!==0&&confirm(`ì„ íƒëœ ${n.size}ê°œì˜ ë¶„ë¥˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&n.forEach(re=>y.mutate(re))},Ps=()=>{const re=JSON.stringify(K,null,2),ge="data:application/json;charset=utf-8,"+encodeURIComponent(re),ke="categories.json",Ie=document.createElement("a");Ie.setAttribute("href",ge),Ie.setAttribute("download",ke),Ie.click()};return e.jsxs(pt,{children:[e.jsxs(L,{className:"h-full",children:[e.jsxs(H,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"flex items-center gap-3",children:[e.jsx(sa,{className:"w-6 h-6"}),"ê³„ì¸µ ë¶„ë¥˜ ê´€ë¦¬ ì‹œìŠ¤í…œ",e.jsx(pt,{children:e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:e.jsx($c,{className:"w-4 h-4 text-gray-400"})})}),e.jsx(Fs,{className:"max-w-md",children:e.jsxs("div",{className:"space-y-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-1",children:"ðŸš€ ì£¼ìš” ê¸°ëŠ¥"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Or,{className:"w-3 h-3 text-blue-600"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ë“œëž˜ê·¸ ì•¤ ë“œë¡­:"})," ì§ê´€ì ì¸ ìž¬ë°°ì—´"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-100 flex items-center justify-center",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-green-600 rounded"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì‹¤ì‹œê°„ íŽ¸ì§‘:"})," ì¦‰ì‹œ ë°˜ì˜ë˜ëŠ” ë³€ê²½ì‚¬í•­"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-purple-100 flex items-center justify-center",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-600 rounded"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"ë‹¤ì¤‘ ì„ íƒ:"})," ì¼ê´„ ìž‘ì—… ì§€ì›"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-orange-100 flex items-center justify-center",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-orange-600 rounded"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"ìŠ¤ë§ˆíŠ¸ ê²€ìƒ‰:"})," ê³ ê¸‰ í•„í„°ë§"]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-1",children:"âŒ¨ï¸ ë‹¨ì¶•í‚¤ ë° ì¡°ìž‘ë²•"}),e.jsxs("div",{className:"space-y-1 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ë“œëž˜ê·¸ ì•¤ ë“œë¡­:"})," ë¶„ë¥˜ë¥¼ ë“œëž˜ê·¸í•˜ì—¬ ìž¬ì •ë ¬í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë¶€ëª¨ë¡œ ì´ë™"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"í‚¤ë³´ë“œ:"})," í™”ì‚´í‘œ í‚¤ë¡œ íƒìƒ‰, Deleteë¡œ ì‚­ì œ, Ctrl+Aë¡œ ì „ì²´ ì„ íƒ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ë‹¤ì¤‘ ì„ íƒ:"})," Ctrl+í´ë¦­ ë˜ëŠ” ë‹¤ì¤‘ ì„ íƒ ëª¨ë“œ í™œì„±í™”"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ê²€ìƒ‰:"})," Ctrl+Fë¡œ ë¹ ë¥¸ ê²€ìƒ‰, ì‹¤ì‹œê°„ í•„í„°ë§"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"í™•ìž¥/ì¶•ì†Œ:"})," ì „ì²´ í™•ìž¥/ì¶•ì†Œ, ì¤Œ ì¡°ì ˆ ê¸°ëŠ¥"]})]})]})]})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(b,{variant:t==="tree"?"default":"ghost",size:"sm",onClick:()=>r("tree"),className:"h-8",children:e.jsx(Or,{className:"w-4 h-4"})}),e.jsx(b,{variant:t==="grid"?"default":"ghost",size:"sm",onClick:()=>r("grid"),className:"h-8",children:e.jsx(gt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{checked:l,onCheckedChange:i,id:"multi-select"}),e.jsx(P,{htmlFor:"multi-select",className:"text-sm",children:"ë‹¤ì¤‘ ì„ íƒ"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",disabled:k<=0,onClick:()=>{},className:"h-8 w-8 p-0",children:e.jsx(Rc,{className:"w-4 h-4"})})}),e.jsx(Fs,{children:e.jsx("p",{children:"ì‹¤í–‰ ì·¨ì†Œ (Ctrl+Z)"})})]}),e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",disabled:k>=F.length-1,onClick:()=>{},className:"h-8 w-8 p-0",children:e.jsx(Lc,{className:"w-4 h-4"})})}),e.jsx(Fs,{children:e.jsx("p",{children:"ë‹¤ì‹œ ì‹¤í–‰ (Ctrl+Shift+Z)"})})]})]}),e.jsx(nt,{orientation:"vertical",className:"h-6"}),n.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"secondary",className:"text-blue-600",children:[n.size,"ê°œ ì„ íƒë¨"]}),e.jsxs(b,{variant:"destructive",size:"sm",onClick:fe,className:"h-8",children:[e.jsx(Qe,{className:"w-4 h-4 mr-1"}),"ì¼ê´„ ì‚­ì œ"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:Ps,className:"h-8",children:[e.jsx(Ts,{className:"w-4 h-4 mr-1"}),"ë‚´ë³´ë‚´ê¸°"]}),e.jsxs(b,{size:"sm",onClick:()=>{ce(),f(!0)},className:"h-8",children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"ë¶„ë¥˜ ì¶”ê°€"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(U,{id:"search-input",placeholder:"ë¶„ë¥˜ëª… ê²€ìƒ‰... (Ctrl+F)",value:x,onChange:re=>D(re.target.value),className:"pl-10"})]}),e.jsxs(Z,{value:u.categoryType,onValueChange:re=>N({...u,categoryType:re}),children:[e.jsx(Y,{className:"w-32",children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ëª¨ë“  ìœ í˜•"}),e.jsx(R,{value:"major",children:"ëŒ€ë¶„ë¥˜"}),e.jsx(R,{value:"middle",children:"ì¤‘ë¶„ë¥˜"}),e.jsx(R,{value:"minor",children:"ì†Œë¶„ë¥˜"})]})]}),e.jsxs(Z,{value:u.isActive,onValueChange:re=>N({...u,isActive:re}),children:[e.jsx(Y,{className:"w-32",children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ëª¨ë“  ìƒíƒœ"}),e.jsx(R,{value:"active",children:"í™œì„±"}),e.jsx(R,{value:"inactive",children:"ë¹„í™œì„±"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:de,children:e.jsx(Zs,{className:"w-4 h-4"})}),e.jsx(b,{variant:"outline",size:"sm",onClick:$e,children:e.jsx(zt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>h(Math.max(50,j-10)),className:"h-8 w-8 p-0",children:e.jsx(ka,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium w-12 text-center",children:[j,"%"]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>h(Math.min(200,j+10)),className:"h-8 w-8 p-0",children:e.jsx(_a,{className:"w-4 h-4"})})]})]})]}),e.jsxs(q,{className:"flex-1 overflow-hidden relative",children:[E&&e.jsx("div",{className:"absolute inset-0 bg-white/50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 bg-white px-4 py-2 rounded-lg shadow-lg border",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:"ë¶„ë¥˜ ì´ë™ ì¤‘..."})]})}),t==="tree"&&e.jsx("div",{className:"h-full overflow-auto space-y-2 p-2",style:{fontSize:`${j}%`},children:ne?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"ë¡œë”© ì¤‘..."})}):$.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(Aa,{className:"w-12 h-12 mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"ë“±ë¡ëœ ë¶„ë¥˜ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm",children:"ìƒˆë¡œìš´ ë¶„ë¥˜ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”"})]}):$.map(re=>e.jsx(Si,{node:re,onEdit:vs,onDelete:le,onToggle:xe,onSelect:ie,onAddChild:C,onMove:M,searchTerm:x,isMultiSelectMode:l,selectedNodes:n},re.id))}),t==="grid"&&e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(gt,{className:"w-12 h-12 mx-auto mb-4"}),e.jsx("p",{children:"ê·¸ë¦¬ë“œ ë·°ëŠ” ê³§ êµ¬í˜„ë  ì˜ˆì •ìž…ë‹ˆë‹¤"})]})})]})]}),e.jsx(ze,{open:m,onOpenChange:f,children:e.jsxs(qe,{className:"sm:max-w-md",children:[e.jsxs(Ve,{children:[e.jsx(Ke,{children:w?"ë¶„ë¥˜ ìˆ˜ì •":"ìƒˆ ë¶„ë¥˜ ì¶”ê°€"}),e.jsxs(Ia,{children:[T&&`"${T.categoryName}" í•˜ìœ„ì— `,"ìƒˆë¡œìš´ ë¶„ë¥˜ë¥¼ ",w?"ìˆ˜ì •":"ì¶”ê°€","í•©ë‹ˆë‹¤."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"categoryName",children:"ë¶„ë¥˜ëª…"}),e.jsx(U,{id:"categoryName",value:z.categoryName,onChange:re=>Q({...z,categoryName:re.target.value}),placeholder:"ë¶„ë¥˜ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"categoryType",children:"ë¶„ë¥˜ ìœ í˜•"}),e.jsxs(Z,{value:z.categoryType,onValueChange:re=>Q({...z,categoryType:re}),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"major",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ—ï¸"}),"ëŒ€ë¶„ë¥˜"]})}),e.jsx(R,{value:"middle",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“"}),"ì¤‘ë¶„ë¥˜"]})}),e.jsx(R,{value:"minor",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“„"}),"ì†Œë¶„ë¥˜"]})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gs,{id:"isActive",checked:z.isActive,onCheckedChange:re=>Q({...z,isActive:re})}),e.jsx(P,{htmlFor:"isActive",children:"í™œì„± ìƒíƒœ"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(b,{variant:"outline",onClick:()=>f(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{onClick:_e,disabled:Se.isPending||je.isPending,children:w?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})}function ll(s){return s?(typeof s=="string"?s.replace(/,/g,""):s.toString()).replace(/\B(?=(\d{3})+(?!\d))/g,","):""}function ir(s){return s.replace(/,/g,"")}function la(s){return s==null?"â‚©0":`â‚©${s.toLocaleString()}`}function nl(){return{category:"",subCategory1:"",subCategory2:"",item:"",name:"",quantity:"",unit:"",unitPrice:"",price:0,vendor:"",deliveryLocation:""}}function ki(s,a){const t=Number.parseFloat(ir(s)||"0"),r=Number.parseFloat(ir(a)||"0");return t*r}function kr(){const s=new Date,a=s.getFullYear(),t=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0"),l=String(s.getHours()).padStart(2,"0")+String(s.getMinutes()).padStart(2,"0");return`PO-${a}${t}${r}-${l}`}function Tm(){const{toast:s}=Ze();us();const[,a]=Je(),[t,r]=d.useState(!1),[l]=d.useState(kr()),[i,n]=d.useState({site:"",deliveryDate:"",isNegotiable:!1,receiver:"",manager:"",notes:"",items:[{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:""}]}),c=()=>i.items.reduce((k,A)=>k+(A.totalPrice||0),0),{data:g=[]}=se({queryKey:["/api/projects"],select:k=>k?.filter(A=>A.isActive)||[]}),{data:o}=se({queryKey:["/api/auth/user"]}),{data:w=[]}=se({queryKey:["/api/users"],select:k=>k?.filter(A=>A.isActive)||[]}),{data:p=[]}=se({queryKey:["/api/item-categories/major"],queryFn:()=>fetch("/api/item-categories/major").then(k=>k.json())}),[m,f]=d.useState({middleQueries:{},minorQueries:{}}),T=async k=>{if(m.middleQueries[k])return m.middleQueries[k];try{const x=await(await fetch(`/api/item-categories/middle?majorId=${k}`)).json();return f(D=>({...D,middleQueries:{...D.middleQueries,[k]:x}})),x}catch(A){return console.error("Error fetching middle categories:",A),[]}},O=async k=>{if(m.minorQueries[k])return m.minorQueries[k];try{const x=await(await fetch(`/api/item-categories/minor?middleId=${k}`)).json();return f(D=>({...D,minorQueries:{...D.minorQueries,[k]:x}})),x}catch(A){return console.error("Error fetching minor categories:",A),[]}},E=k=>{if(!k.majorCategory)return[];const A=p.find(x=>x.categoryName===k.majorCategory);return A?m.middleQueries[A.id]||[]:[]},v=k=>{if(!k.middleCategory||!k.majorCategory)return[];const A=p.find(u=>u.categoryName===k.majorCategory);if(!A)return[];const D=(m.middleQueries[A.id]||[]).find(u=>u.categoryName===k.middleCategory);return D?m.minorQueries[D.id]||[]:[]};se({queryKey:["/api/vendors"],select:k=>k?.filter(A=>A.isActive)||[]});const F=async k=>{if(k.preventDefault(),!i.site){s({title:"í•„ìˆ˜ ì •ë³´ ëˆ„ë½",description:"í˜„ìž¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}if(!i.receiver){s({title:"í•„ìˆ˜ ì •ë³´ ëˆ„ë½",description:"ìžìž¬ ì¸ìˆ˜ìžë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}const A=i.items.filter(x=>x.name.trim());if(A.length===0){s({title:"í•„ìˆ˜ ì •ë³´ ëˆ„ë½",description:"ìµœì†Œ í•˜ë‚˜ì˜ í’ˆëª©ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}try{r(!0);const x={orderNumber:l,projectId:parseInt(i.site),userId:o?.id,orderDate:new Date,deliveryDate:i.deliveryDate?new Date(i.deliveryDate):void 0,totalAmount:c(),notes:i.notes||void 0,status:"pending",items:A.map(N=>({itemName:N.name,quantity:N.quantity||0,unitPrice:N.unitPrice||0,totalAmount:N.totalPrice||0,specification:N.specs||void 0,notes:N.remarks||void 0}))},D=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!D.ok)throw new Error("Failed to create order");const u=await D.json();s({title:"ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),u?.id&&a(`/orders/${u.id}`)}catch(x){console.error("Order creation error:",x),s({title:"ì €ìž¥ ì‹¤íŒ¨",description:"ë°œì£¼ì„œ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}finally{r(!1)}},_=()=>{if(i.items.length>=10){s({title:"í’ˆëª© ì¶”ê°€ ì œí•œ",description:"ìµœëŒ€ 10ê°œê¹Œì§€ ì¶”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.",variant:"destructive"});return}n(k=>({...k,items:[...k.items,{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:""}]}))};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>a("/orders"),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),"ë°œì£¼ì„œ ëª©ë¡ìœ¼ë¡œ"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„±"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ìƒˆë¡œìš´ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(B,{variant:"outline",className:"text-sm px-3 py-1",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),l]})})]})]}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs(L,{className:"shadow-sm bg-white",children:[e.jsx("div",{className:"p-6 border-b border-blue-200 bg-blue-50/30",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ë°œì£¼ ì •ë³´"})]})}),e.jsx(q,{className:"p-6 bg-white",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs(P,{htmlFor:"site",className:"text-sm font-medium text-gray-700 mb-2 block",children:["í˜„ìž¥ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(Z,{value:i.site,onValueChange:k=>n(A=>({...A,site:k})),children:[e.jsx(Y,{id:"site",className:"h-11",children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:g.map(k=>e.jsx(R,{value:k.id.toString(),children:k.projectName},k.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"deliveryDate",className:"text-sm font-medium text-gray-700 mb-2 block",children:"ë‚©ê¸°ì¼"}),e.jsxs("div",{className:"relative",children:[e.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5 pointer-events-none"}),e.jsx(U,{id:"deliveryDate",type:"date",value:i.deliveryDate,onChange:k=>n(A=>({...A,deliveryDate:k.target.value})),className:"pl-10 h-11"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(gs,{checked:i.isNegotiable,onCheckedChange:k=>n(A=>({...A,isNegotiable:k}))}),"í˜‘ì˜ ê°€ëŠ¥"]})})]}),e.jsxs("div",{children:[e.jsxs(P,{htmlFor:"receiver",className:"text-sm font-medium text-gray-700 mb-2 block",children:["ìžìž¬ ì¸ìˆ˜ìž ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(Z,{value:i.receiver,onValueChange:k=>n(A=>({...A,receiver:k})),children:[e.jsx(Y,{id:"receiver",className:"h-11",children:e.jsx(X,{placeholder:"ì¸ìˆ˜ìžë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:w.map(k=>e.jsx(R,{value:k.id,children:k.firstName&&k.lastName?`${k.lastName}${k.firstName}`:k.email},k.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"manager",className:"text-sm font-medium text-gray-700 mb-2 block",children:"í˜„ìž¥ ì±…ìž„ìž"}),e.jsxs(Z,{value:i.manager,onValueChange:k=>n(A=>({...A,manager:k})),children:[e.jsx(Y,{id:"manager",className:"h-11",children:e.jsx(X,{placeholder:"ì±…ìž„ìžë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:w.map(k=>e.jsx(R,{value:k.id,children:k.firstName&&k.lastName?`${k.lastName}${k.firstName}`:k.email},k.id))})]})]})]})})]}),e.jsxs(L,{className:"shadow-sm bg-white",children:[e.jsx("div",{className:"p-6 border-b border-blue-200 bg-blue-50/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"í’ˆëª© ì •ë³´"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.items.filter(k=>k.name).length," / 10 í’ˆëª©"]})]}),e.jsxs(b,{type:"button",variant:"outline",size:"sm",onClick:_,disabled:i.items.length>=10,className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"í’ˆëª© ì¶”ê°€"]})]})}),e.jsx(q,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-blue-50 border-b border-blue-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ëŒ€ë¶„ë¥˜"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ì¤‘ë¶„ë¥˜"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ì†Œë¶„ë¥˜"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ë‹¨ìœ„"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ë‹¨ê°€"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"px-4 py-3"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.items.map((k,A)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(U,{value:k.name,onChange:x=>{const D=[...i.items];D[A]={...k,name:x.target.value},n(u=>({...u,items:D}))},placeholder:"í’ˆëª©ëª…",className:"h-9 border-gray-200"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Z,{value:k.majorCategory,onValueChange:async x=>{const D=p.find(N=>N.categoryName===x),u=[...i.items];u[A]={...k,majorCategory:x,middleCategory:"",minorCategory:""},n(N=>({...N,items:u})),D&&await T(D.id)},children:[e.jsx(Y,{className:"h-9 border-gray-200",children:e.jsx(X,{placeholder:"ëŒ€ë¶„ë¥˜"})}),e.jsx(ee,{children:p.map(x=>e.jsx(R,{value:x.categoryName,children:x.categoryName},x.id))})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Z,{value:k.middleCategory,onValueChange:async x=>{const u=E(k).find(j=>j.categoryName===x),N=[...i.items];N[A]={...k,middleCategory:x,minorCategory:""},n(j=>({...j,items:N})),u&&await O(u.id)},disabled:!k.majorCategory,children:[e.jsx(Y,{className:"h-9 border-gray-200",children:e.jsx(X,{placeholder:k.majorCategory?"ì¤‘ë¶„ë¥˜":"ëŒ€ë¶„ë¥˜ ë¨¼ì €"})}),e.jsx(ee,{children:E(k).map(x=>e.jsx(R,{value:x.categoryName,children:x.categoryName},x.id))})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Z,{value:k.minorCategory,onValueChange:x=>{const D=[...i.items];D[A]={...k,minorCategory:x},n(u=>({...u,items:D}))},disabled:!k.middleCategory,children:[e.jsx(Y,{className:"h-9 border-gray-200",children:e.jsx(X,{placeholder:k.middleCategory?"ì†Œë¶„ë¥˜":"ì¤‘ë¶„ë¥˜ ë¨¼ì €"})}),e.jsx(ee,{children:v(k).map(x=>e.jsx(R,{value:x.categoryName,children:x.categoryName},x.id))})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(U,{type:"number",value:k.quantity||"",onChange:x=>{const D=[...i.items];D[A]={...k,quantity:parseInt(x.target.value)||0,totalPrice:(parseInt(x.target.value)||0)*(k.unitPrice||0)},n(u=>({...u,items:D}))},placeholder:"0",className:"h-9 text-center w-20 border-gray-200"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(U,{value:k.unit||"",onChange:x=>{const D=[...i.items];D[A]={...k,unit:x.target.value},n(u=>({...u,items:D}))},placeholder:"ê°œ",className:"h-9 text-center w-16 border-gray-200"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(U,{type:"number",value:k.unitPrice||"",onChange:x=>{const D=[...i.items];D[A]={...k,unitPrice:parseInt(x.target.value)||0,totalPrice:(k.quantity||0)*(parseInt(x.target.value)||0)},n(u=>({...u,items:D}))},placeholder:"0",className:"h-9 text-right border-gray-200"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("span",{className:"font-semibold text-blue-600",children:[(k.totalPrice||0).toLocaleString(),"ì›"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(b,{type:"button",variant:"ghost",size:"icon",onClick:()=>{const x=i.items.filter((D,u)=>u!==A);n(D=>({...D,items:x}))},className:"h-8 w-8 text-gray-400 hover:text-red-600",children:e.jsx(Qe,{className:"h-4 w-4"})})})]},A))}),e.jsx("tfoot",{className:"bg-blue-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:7,className:"px-4 py-4 text-right text-sm font-medium text-gray-900",children:"ì´ ë°œì£¼ê¸ˆì•¡"}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[c().toLocaleString(),"ì›"]})}),e.jsx("td",{})]})})]})})})]}),e.jsxs(L,{className:"shadow-sm bg-white",children:[e.jsx("div",{className:"p-6 border-b border-blue-200 bg-blue-50/30",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ì¶”ê°€ ì •ë³´"})]})}),e.jsx(q,{className:"p-6 bg-white",children:e.jsxs("div",{children:[e.jsx(P,{htmlFor:"notes",className:"text-sm font-medium text-gray-700 mb-2 block",children:"ë¹„ê³ ì‚¬í•­"}),e.jsx(Ge,{id:"notes",value:i.notes,onChange:k=>n(A=>({...A,notes:k.target.value})),placeholder:"ì¶”ê°€ ìš”ì²­ì‚¬í•­ì´ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”...",className:"min-h-[100px] resize-none"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>a("/orders"),disabled:t,children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:t?e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"h-4 w-4 animate-spin"}),"ì €ìž¥ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"h-4 w-4"}),"ë°œì£¼ì„œ ì €ìž¥"]})})]})]})]})})}const Pm=Object.freeze(Object.defineProperty({__proto__:null,default:Tm},Symbol.toStringTag,{value:"Module"}));function Em({formData:s,onFormDataChange:a,projects:t,users:r,poNumber:l}){const i=(n,c)=>{a({...s,[n]:c})};return e.jsxs(L,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(H,{className:"bg-gray-50 border-b",children:e.jsxs(W,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ws,{className:"h-5 w-5 text-blue-600"}),"ë°œì£¼ì„œ ê¸°ë³¸ ì •ë³´"]})}),e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-sm font-medium",children:"ë°œì£¼ì„œ ë²ˆí˜¸"}),e.jsx("div",{className:"h-10 px-3 py-2 text-sm font-semibold text-blue-600 bg-gray-50 border rounded-md flex items-center",children:l})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-sm font-medium",children:"ìž‘ì„±ì¼"}),e.jsx("div",{className:"h-10 px-3 py-2 text-sm bg-gray-50 border rounded-md flex items-center",children:new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{htmlFor:"site",className:"text-sm font-medium",children:"í˜„ìž¥ ì„ íƒ"}),e.jsxs(Z,{value:s.site,onValueChange:n=>i("site",n),children:[e.jsx(Y,{className:"h-10",children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:t.map(n=>e.jsx(R,{value:n.projectName,children:n.projectName},n.id))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{htmlFor:"deliveryDate",className:"text-sm font-medium",children:"ë‚©í’ˆ í¬ë§ì¼"}),e.jsx(U,{type:"date",id:"deliveryDate",className:"h-10",value:s.deliveryDate,onChange:n=>i("deliveryDate",n.target.value)}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(gs,{id:"isNegotiable",checked:s.isNegotiable,onCheckedChange:n=>i("isNegotiable",n)}),e.jsx(P,{htmlFor:"isNegotiable",className:"text-sm text-gray-600",children:"í˜‘ì˜ ê°€ëŠ¥"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{htmlFor:"receiver",className:"text-sm font-medium",children:"ìžìž¬ ì¸ìˆ˜ìž"}),e.jsxs(Z,{value:s.receiver,onValueChange:n=>i("receiver",n),children:[e.jsx(Y,{className:"h-10",children:e.jsx(X,{placeholder:"ì¸ìˆ˜ìž ì„ íƒ"})}),e.jsx(ee,{children:r.map(n=>e.jsx(R,{value:n.email||"",children:n.email},n.id))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{htmlFor:"manager",className:"text-sm font-medium",children:"ë³¸ì‚¬ ë‹´ë‹¹ìž"}),e.jsxs(Z,{value:s.manager,onValueChange:n=>i("manager",n),children:[e.jsx(Y,{className:"h-10",children:e.jsx(X,{placeholder:"ë‹´ë‹¹ìž ì„ íƒ"})}),e.jsx(ee,{children:r.map(n=>e.jsx(R,{value:n.email||"",children:n.email},n.id))})]})]})]})})]})}function Im({value:s,onChange:a,placeholder:t="í’ˆëª©ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”"}){const[r,l]=d.useState(!1),[i,n]=d.useState(s),{data:c}=se({queryKey:["/api/items"],enabled:!0}),g=c?.items||[],o=Array.isArray(g)?g.filter(m=>m.name&&m.name.toLowerCase().includes(i.toLowerCase())):[],w=m=>{n(m),a(m),l(!1)},p=m=>{n(m),a(m)};return e.jsxs(zs,{open:r,onOpenChange:l,children:[e.jsx(qs,{asChild:!0,children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{value:i,onChange:m=>p(m.target.value),placeholder:t,className:"h-8 text-sm pr-8",onFocus:()=>l(!0)}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-8 w-8 p-0 hover:bg-transparent",onClick:()=>l(!r),children:e.jsx(xr,{className:"h-3 w-3 shrink-0 opacity-50"})})]})}),e.jsx(Is,{className:"w-full p-0",align:"start",children:e.jsxs(Oa,{children:[e.jsx(Fa,{placeholder:"í’ˆëª©ëª… ê²€ìƒ‰...",value:i,onValueChange:p}),e.jsx(Ma,{children:e.jsx("div",{className:"p-2 text-sm text-gray-500",children:"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ì§ì ‘ ìž…ë ¥í•˜ì‹œë©´ ìƒˆ í’ˆëª©ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤."})}),e.jsx($a,{className:"max-h-48 overflow-auto",children:o.map(m=>e.jsxs(Ra,{value:m.name,onSelect:()=>w(m.name),className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:m.name}),e.jsx("span",{className:"text-xs text-gray-500",children:m.category})]}),e.jsx(ps,{className:V("ml-auto h-4 w-4",i===m.name?"opacity-100":"opacity-0")})]},m.id))})]})})]})}function Om({items:s,onItemChange:a,onAddItem:t,onRemoveItem:r,onCopyItem:l,vendors:i}){s.reduce((c,g)=>c+(g.price||0),0);const n=(c,g,o)=>{if(g==="quantity"||g==="unitPrice"){const w=[...s],p=ir(o);w[c]={...w[c],[g]:p};const m=ki(g==="quantity"?p:w[c].quantity,g==="unitPrice"?p:w[c].unitPrice);w[c].price=m,a(c,g,p)}else a(c,g,o)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{}),e.jsxs(b,{onClick:t,variant:"outline",size:"sm",className:"gap-2 h-8 px-3 text-sm bg-transparent",children:[e.jsx(Fr,{className:"w-3 h-3"}),"í’ˆëª© ì¶”ê°€"]})]}),s.map((c,g)=>e.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("h4",{className:"text-xs font-medium text-gray-700",children:["í’ˆëª© #",g+1]}),e.jsxs("div",{className:"flex gap-1 -space-x-1",children:[e.jsx(b,{size:"sm",variant:"ghost",onClick:()=>l(g),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-800 hover:bg-blue-50",title:"í’ˆëª© ë³µì‚¬",children:e.jsx(na,{className:"w-3 h-3"})}),e.jsx(b,{size:"sm",variant:"ghost",onClick:()=>r(g),disabled:s.length===1,className:"h-8 w-8 p-0 text-red-600 hover:text-red-800 hover:bg-red-50 disabled:opacity-50",title:"í’ˆëª© ì‚­ì œ",children:e.jsx(Qe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 border-b pb-1 flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-blue-600"}),"ë¶„ë¥˜ ì •ë³´"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ëŒ€ë¶„ë¥˜"}),e.jsxs(Z,{value:c.category,onValueChange:o=>n(g,"category",o),children:[e.jsx(Y,{className:"h-8",children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"1.ì›ìžìž¬",children:"1.ì›ìžìž¬"}),e.jsx(R,{value:"2.ë¶€ìžìž¬",children:"2.ë¶€ìžìž¬"}),e.jsx(R,{value:"3.ì‹œê³µë…¸ë¬´ë¹„",children:"3.ì‹œê³µë…¸ë¬´ë¹„"}),e.jsx(R,{value:"4.ìž¥ë¹„ë¹„",children:"4.ìž¥ë¹„ë¹„"}),e.jsx(R,{value:"5.ìš´ë°˜ë¹„",children:"5.ìš´ë°˜ë¹„"}),e.jsx(R,{value:"6.ì•ˆì „ê´€ë¦¬ë¹„",children:"6.ì•ˆì „ê´€ë¦¬ë¹„"}),e.jsx(R,{value:"7.íê¸°ë¬¼ì²˜ë¦¬ë¹„",children:"7.íê¸°ë¬¼ì²˜ë¦¬ë¹„"}),e.jsx(R,{value:"8.í˜„ìž¥ê´€ë¦¬ë¹„",children:"8.í˜„ìž¥ê´€ë¦¬ë¹„"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ì¤‘ë¶„ë¥˜"}),e.jsxs(Z,{value:c.subCategory1,onValueChange:o=>n(g,"subCategory1",o),children:[e.jsx(Y,{className:"h-8",children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"ALUM.SHEET",children:"ALUM.SHEET"}),e.jsx(R,{value:"ALUM.ì°½í˜¸",children:"ALUM.ì°½í˜¸"}),e.jsx(R,{value:"íŒë„¬",children:"íŒë„¬"}),e.jsx(R,{value:"ì°½í˜¸",children:"ì°½í˜¸"}),e.jsx(R,{value:"ê¸°íƒ€",children:"ê¸°íƒ€"}),e.jsx(R,{value:"ì°½í˜¸,íŒë„¬",children:"ì°½í˜¸,íŒë„¬"}),e.jsx(R,{value:"ì¡°ë¦½ë¹„",children:"ì¡°ë¦½ë¹„"}),e.jsx(R,{value:"ìœ ë¦¬",children:"ìœ ë¦¬"}),e.jsx(R,{value:"ìž¥ë¹„ë¹„",children:"ìž¥ë¹„ë¹„"}),e.jsx(R,{value:"ì‹ í˜¸ìˆ˜ ì™¸",children:"ì‹ í˜¸ìˆ˜ ì™¸"}),e.jsx(R,{value:"ì•ˆì „ìž¥ë¹„",children:"ì•ˆì „ìž¥ë¹„"}),e.jsx(R,{value:"ê±´ê°•ê²€ì§„",children:"ê±´ê°•ê²€ì§„"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ì†Œë¶„ë¥˜"}),e.jsxs(Z,{value:c.subCategory2,onValueChange:o=>n(g,"subCategory2",o),children:[e.jsx(Y,{className:"h-8",children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"ì›ìžìž¬",children:"ì›ìžìž¬"}),e.jsx(R,{value:"ê°€ê³µ",children:"ê°€ê³µ"}),e.jsx(R,{value:"ë„ìž¥",children:"ë„ìž¥"}),e.jsx(R,{value:"ì••ì¶œ",children:"ì••ì¶œ"}),e.jsx(R,{value:"ë‹¨ì—´",children:"ë‹¨ì—´"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 border-b pb-1 flex items-center gap-2",children:[e.jsx(Es,{className:"h-4 w-4 text-blue-600"}),"í’ˆëª© ë° ìˆ˜ëŸ‰"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"í’ˆëª©ëª…"}),e.jsx(Im,{value:c.name,onChange:o=>n(g,"name",o),placeholder:"í’ˆëª©ëª…ì„ ì„ íƒí•˜ê±°ë‚˜ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ìˆ˜ëŸ‰"}),e.jsx(U,{type:"number",value:c.quantity,onChange:o=>n(g,"quantity",o.target.value),placeholder:"ìˆ˜ëŸ‰",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‹¨ìœ„"}),e.jsxs(Z,{value:c.unit,onValueChange:o=>n(g,"unit",o),children:[e.jsx(Y,{className:"h-8",children:e.jsx(X,{placeholder:"ë‹¨ìœ„"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"EA",children:"EA"}),e.jsx(R,{value:"M",children:"M"}),e.jsx(R,{value:"SET",children:"SET"}),e.jsx(R,{value:"KG",children:"KG"}),e.jsx(R,{value:"TON",children:"TON"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‹¨ê°€"}),e.jsx(U,{type:"number",value:c.unitPrice,onChange:o=>n(g,"unitPrice",o.target.value),placeholder:"ë‹¨ê°€",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê¸ˆì•¡"}),e.jsx("div",{className:"h-8 px-3 py-1 text-sm font-semibold text-blue-600 bg-gray-50 border rounded-md flex items-center",children:la(c.price||0)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 border-b pb-1 flex items-center gap-2",children:[e.jsx(Ws,{className:"h-4 w-4 text-blue-600"}),"ê±°ëž˜ì²˜ ë° ë‚©í’ˆ ì •ë³´"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:c.vendorId?.toString(),onValueChange:o=>n(g,"vendorId",o),children:[e.jsx(Y,{className:"h-8",children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:i.map(o=>e.jsx(R,{value:o.id.toString(),children:o.name},o.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©í’ˆìž¥ì†Œ"}),e.jsx(U,{value:c.deliveryLocation||"",onChange:o=>n(g,"deliveryLocation",o.target.value),placeholder:"ë‚©í’ˆìž¥ì†Œ",className:"h-8 text-sm"})]})]})]})]})]},g)),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"ì´ ê¸ˆì•¡"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:la(s.reduce((c,g)=>c+(g.price||0),0))})]})})]})}function Fm({uploadedFiles:s,onFilesChange:a}){const[t,r]=d.useState(!1),l=d.useRef(null),i=w=>{w.preventDefault(),w.stopPropagation(),r(!0)},n=w=>{w.preventDefault(),w.stopPropagation(),r(!1)},c=w=>{w.preventDefault(),w.stopPropagation(),r(!1);const p=Array.from(w.dataTransfer.files);p.length>0&&a([...s,...p])},g=w=>{if(w.target.files){const p=Array.from(w.target.files);a([...s,...p])}},o=()=>{l.current?.click()};return e.jsxs(L,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(H,{className:"bg-gray-50 border-b",children:e.jsxs(W,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Qt,{className:"h-5 w-5 text-blue-600"}),"íŒŒì¼ ì²¨ë¶€ ë° ê¸°íƒ€ ì •ë³´"]})}),e.jsxs(q,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(P,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Vs,{className:"h-4 w-4"}),"ì²¨ë¶€íŒŒì¼"]}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer ${t?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,onDragOver:i,onDragLeave:n,onDrop:c,onClick:o,children:[e.jsx(Vs,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ì—¬ê¸°ì— ë“œëž˜ê·¸í•˜ì„¸ìš”"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, Word, Excel, ì´ë¯¸ì§€ íŒŒì¼ ì§€ì›"}),e.jsx(U,{ref:l,type:"file",multiple:!0,className:"hidden",onChange:g,accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.gif"})]})]}),s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-sm font-medium",children:"ì²¨ë¶€ëœ íŒŒì¼"}),e.jsx("div",{className:"space-y-1",children:s.map((w,p)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:w.name}),e.jsx("button",{onClick:()=>{const m=s.filter((f,T)=>T!==p);a(m)},className:"text-red-500 hover:text-red-700",children:e.jsx(Qe,{className:"h-4 w-4"})})]},p))})]}),s.length>0&&e.jsx("div",{className:"space-y-1 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-green-800",children:["âœ… ",s.length,"ê°œì˜ íŒŒì¼ì´ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤."]})})]})]})}function Mm({isOpen:s,onClose:a,formData:t,items:r,poNumber:l}){const i=r.reduce((n,c)=>n+(c.price||0),0);return e.jsx(ze,{open:s,onOpenChange:a,children:e.jsxs(qe,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"PDF ë¯¸ë¦¬ë³´ê¸°"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",children:e.jsx(ka,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",children:e.jsx(_a,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",children:e.jsx(Vc,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",children:e.jsx(Vt,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",onClick:a,children:e.jsx(ns,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"bg-white p-8 shadow-lg",style:{width:"190mm",minHeight:"297mm",margin:"0 auto"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl font-bold",children:"êµ¬ë§¤ ë°œì£¼ì„œ"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Purchase Order"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ë°œì£¼ì„œ ë²ˆí˜¸:"})," ",l]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ìž‘ì„±ì¼:"})," ",new Date().toLocaleDateString("ko-KR")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"í˜„ìž¥:"})," ",t.site]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ë‚©í’ˆ í¬ë§ì¼:"})," ",t.deliveryDate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ìžìž¬ ì¸ìˆ˜ìž:"})," ",t.receiver]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ë³¸ì‚¬ ë‹´ë‹¹ìž:"})," ",t.manager]})]})]}),e.jsx("div",{className:"border border-gray-300",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 p-1",children:"No"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ëŒ€ë¶„ë¥˜"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ì¤‘ë¶„ë¥˜"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ì†Œë¶„ë¥˜"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ê·œê²©"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ë‹¨ìœ„"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ë‹¨ê°€"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"ë‚©í’ˆì²˜"})]})}),e.jsxs("tbody",{children:[r.map((n,c)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 p-1 text-center",children:c+1}),e.jsx("td",{className:"border border-gray-300 p-1",children:n.category}),e.jsx("td",{className:"border border-gray-300 p-1",children:n.subCategory1}),e.jsx("td",{className:"border border-gray-300 p-1",children:n.subCategory2}),e.jsx("td",{className:"border border-gray-300 p-1",children:n.item}),e.jsx("td",{className:"border border-gray-300 p-1",children:n.name}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:n.quantity}),e.jsx("td",{className:"border border-gray-300 p-1 text-center",children:n.unit}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:la(parseInt(n.unitPrice)||0)}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:la(n.price)}),e.jsx("td",{className:"border border-gray-300 p-1",children:n.deliveryLocation})]},c)),e.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[e.jsx("td",{colSpan:9,className:"border border-gray-300 p-1 text-center",children:"í•©ê³„"}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:la(i)}),e.jsx("td",{className:"border border-gray-300 p-1"})]})]})]})}),t.notes&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:e.jsx("strong",{children:"íŠ¹ì´ì‚¬í•­:"})}),e.jsx("p",{className:"mt-1 p-2 bg-gray-50 border",children:t.notes})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4 text-xs mt-8",children:[e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"ë‹´ë‹¹"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"ê³µë¬´"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"íŒ€ìž¥"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"ìž„ì›"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"ì‚¬ìž¥"}),e.jsx("div",{className:"h-12"})]})]}),e.jsxs("div",{className:"text-center text-sm mt-8",children:[e.jsx("p",{className:"font-semibold",children:"íšŒì‚¬ëª…"}),e.jsx("p",{children:"ì£¼ì†Œ: ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬"}),e.jsx("p",{children:"ì „í™”: 02-1234-5678 | íŒ©ìŠ¤: 02-1234-5679"})]})]})})]})})}function $m({approvalStatus:s,onStatusChange:a,onSaveDraft:t,onSendEmail:r,onRequestApproval:l,onSkipApproval:i}){const n=c=>{switch(c){case"draft":return e.jsxs(B,{variant:"secondary",className:"gap-1",children:[e.jsx(Rs,{className:"h-3 w-3"}),"ìž‘ì„±ì¤‘"]});case"pending":return e.jsxs(B,{variant:"outline",className:"gap-1",children:[e.jsx(Rs,{className:"h-3 w-3"}),"ìŠ¹ì¸ ëŒ€ê¸°ì¤‘"]});case"approved":return e.jsxs(B,{variant:"default",className:"gap-1 bg-green-500",children:[e.jsx(pe,{className:"h-3 w-3"}),"ìŠ¹ì¸ ì™„ë£Œ"]});case"rejected":return e.jsxs(B,{variant:"destructive",className:"gap-1",children:[e.jsx(it,{className:"h-3 w-3"}),"ìŠ¹ì¸ ë°˜ë ¤"]});case"skipped":return e.jsxs(B,{variant:"outline",className:"gap-1",children:[e.jsx(it,{className:"h-3 w-3"}),"ìŠ¹ì¸ ìƒëžµ"]});default:return null}};return e.jsxs(L,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(H,{className:"bg-gray-50 border-b",children:e.jsxs(W,{className:"text-lg font-semibold text-gray-900 flex items-center justify-between",children:["ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°",n(s)]})}),e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(b,{variant:"outline",onClick:t,className:"gap-2",children:[e.jsx(Ks,{className:"h-4 w-4"}),"ìž„ì‹œì €ìž¥"]}),e.jsxs(b,{variant:"outline",onClick:r,className:"gap-2",children:[e.jsx(Ns,{className:"h-4 w-4"}),"ì´ë©”ì¼ ë°œì†¡"]}),e.jsxs(b,{variant:"default",onClick:l,className:"gap-2",children:[e.jsx(it,{className:"h-4 w-4"}),"ìŠ¹ì¸ ìš”ì²­"]}),e.jsxs(b,{variant:"default",onClick:i,className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"ìŠ¹ì¸ ìƒëžµ"]})]})})]})}function Rm(){Ze();const[s,a]=d.useState({site:"",deliveryDate:"",isNegotiable:!1,receiver:"",manager:"",notes:"",items:[]}),[t,r]=d.useState([nl()]),[l,i]=d.useState([]);d.useState(!1);const[n,c]=d.useState("draft"),[g]=d.useState(kr());d.useState(!0);const[o,w]=d.useState(!1);d.useState(100);const{data:p=[]}=se({queryKey:["/api/projects"],select:D=>D?.filter(u=>u.isActive)||[]}),{data:m=[]}=se({queryKey:["/api/users"],select:D=>D?.filter(u=>u.isActive)||[]}),{data:f=[]}=se({queryKey:["/api/vendors"],select:D=>D?.filter(u=>u.isActive)||[]}),T=D=>{a(u=>({...u,...D}))},O=(D,u,N)=>{const j=[...t];j[D]={...j[D],[u]:N},(u==="quantity"||u==="unitPrice")&&(j[D].price=ki(j[D].quantity,j[D].unitPrice)),r(j)},E=()=>{const D=t[t.length-1],u=D?{...D,quantity:"",unitPrice:"",price:0}:nl();r([...t,u])},v=D=>{if(t.length>1){const u=t.filter((N,j)=>j!==D);r(u)}},F=D=>{const u={...t[D]},N=[...t];N.splice(D+1,0,u),r(N)},_=D=>{i(D)},k=()=>{a(D=>({...D,items:t})),w(!0)},A=D=>{c(D)};t.reduce((D,u)=>D+(u.price||0),0);const x=()=>{switch(n){case"draft":return e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),"ìž‘ì„±ì¤‘"]});case"pending":return e.jsxs("div",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),"ìŠ¹ì¸ ëŒ€ê¸°ì¤‘"]});case"approved":return e.jsxs("div",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"ìŠ¹ì¸ ì™„ë£Œ"]});case"skipped":return e.jsxs("div",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"ìŠ¹ì¸ ìƒëžµ"]});default:return null}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„±"}),e.jsx("p",{className:"text-sm text-gray-600",children:"í†µí•©ëœ í‘œì¤€ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•©ë‹ˆë‹¤"})]}),x()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-white border px-2 py-1 rounded text-xs",children:g}),e.jsx("div",{className:"bg-white border px-2 py-1 rounded text-xs",children:new Date().toLocaleDateString("ko-KR")})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 border-b p-3",children:e.jsxs(W,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),"ê¸°ë³¸ ì •ë³´ ìž…ë ¥"]})}),e.jsx(q,{className:"p-3",children:e.jsx(Em,{formData:s,onFormDataChange:T,projects:p,users:m,poNumber:g})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 border-b p-3",children:e.jsxs(W,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),"í’ˆëª© ì •ë³´ ìž…ë ¥"]})}),e.jsx(q,{className:"p-3",children:e.jsx(Om,{items:t,onItemChange:O,onAddItem:E,onRemoveItem:v,onCopyItem:F,vendors:f})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 border-b p-3",children:e.jsxs(W,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),"íŒŒì¼ ì²¨ë¶€"]})}),e.jsx(q,{className:"p-3",children:e.jsx(Fm,{uploadedFiles:l,onFilesChange:_})})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"bg-gray-50 border-b p-3",children:e.jsxs(W,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),"ìŠ¹ì¸ ë° ì œì¶œ ê´€ë¦¬"]})}),e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx($m,{approvalStatus:n,onStatusChange:A,onSaveDraft:()=>console.log("Save draft"),onSendEmail:()=>console.log("Send email"),onRequestApproval:()=>console.log("Request approval"),onSkipApproval:()=>console.log("Skip approval")}),e.jsx("div",{className:"pt-3 border-t",children:e.jsxs(b,{onClick:k,className:"w-full gap-2",size:"lg",children:[e.jsx(ls,{className:"w-4 h-4"}),"PDF ë¯¸ë¦¬ë³´ê¸°"]})})]})})]})]})}),e.jsx(Mm,{isOpen:o,onClose:()=>w(!1),formData:s,items:t,poNumber:g})]})}const Lm=Object.freeze(Object.defineProperty({__proto__:null,default:Rm},Symbol.toStringTag,{value:"Module"}));function zm(){return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-orange-100 rounded-lg",children:e.jsx(Kc,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ë¶€ìžìž¬ ë°œì£¼ì„œ ìž‘ì„±"}),e.jsx("p",{className:"text-gray-600",children:"ë¶€ìžìž¬ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•©ë‹ˆë‹¤"})]})]}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"ë¶€ìžìž¬ ë°œì£¼ì„œ"})}),e.jsx(q,{children:e.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"ë¶€ìžìž¬ ë°œì£¼ì„œ ìž‘ì„± ì–‘ì‹ì´ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤."})})]})]})}const qm=Object.freeze(Object.defineProperty({__proto__:null,default:zm},Symbol.toStringTag,{value:"Module"})),Vm={PDF_GENERATION:{id:"pdf_generation",title:"PDF ìƒì„±",description:"ë°œì£¼ì„œë¥¼ PDFë¡œ ë³€í™˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},VENDOR_VALIDATION:{id:"vendor_validation",title:"ê±°ëž˜ì²˜ ê²€ì¦",description:"ê±°ëž˜ì²˜ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},EMAIL_PREPARATION:{id:"email_preparation",title:"ì´ë©”ì¼ ì¤€ë¹„",description:"ì´ë©”ì¼ì„ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},ATTACHMENT_PROCESSING:{id:"attachment_processing",title:"ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬",description:"ì²¨ë¶€íŒŒì¼ì„ ì¤€ë¹„í•˜ê³  ìžˆìŠµë‹ˆë‹¤"},FINAL_VALIDATION:{id:"final_validation",title:"ìµœì¢… ê²€ì¦",description:"ëª¨ë“  ì •ë³´ë¥¼ ìµœì¢… í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤"}},_i={select:{title:"ë°©ì‹ ì„ íƒ",description:"í‘œì¤€/ì—‘ì…€ ì„ íƒ",required:!0,validation:s=>!!s.creationMethod},create:{title:"ë°œì£¼ì„œ ìž‘ì„±",description:"ë°ì´í„° ìž…ë ¥",required:!0,validation:s=>s.stepStates.creation.isValid},approve:{title:"ìŠ¹ì¸ ì²˜ë¦¬",description:"ì„ íƒì ",required:!1,validation:s=>!s.stepStates.approval.required||s.stepStates.approval.status==="approved"},process:{title:"í›„ì²˜ë¦¬",description:"PDF/ì´ë©”ì¼",required:!0,validation:s=>s.stepStates.processing.failedSteps.length===0},complete:{title:"ì™„ë£Œ",description:"ê²°ê³¼ í™•ì¸",required:!0,validation:s=>!!s.stepStates.completed.savedAt}},Di=d.createContext(void 0),Ai=()=>({currentStep:"select",steps:Object.entries(_i).map(([s,a])=>({id:s,title:a.title,description:a.description,status:s==="select"?"current":"pending"})),stepStates:{creation:{isValid:!1},approval:{required:!1},processing:{steps:Object.values(Vm).map(s=>({...s,status:"idle"})),completedSteps:[],failedSteps:[]},completed:{}},metadata:{workflowId:Rr(),startedAt:new Date,lastModified:new Date,userId:"",sessionId:Rr(),version:"1.0.0"},flags:{skipApproval:!1,autoProcess:!0,sendEmails:!0,generatePDF:!0}}),Km=(s,a)=>{switch(a.type){case"SET_STEP":return{...s,currentStep:a.payload,steps:s.steps.map(i=>({...i,status:i.id===a.payload?"current":s.steps.findIndex(n=>n.id===i.id)<s.steps.findIndex(n=>n.id===a.payload)?"completed":"pending"})),metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_STEP_STATUS":return{...s,steps:s.steps.map(i=>i.id===a.payload.step?{...i,status:a.payload.status}:i),metadata:{...s.metadata,lastModified:new Date}};case"SET_CREATION_METHOD":return{...s,creationMethod:a.payload,stepStates:{...s.stepStates,creation:{...s.stepStates.creation,method:a.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_ORDER_DATA":return{...s,orderData:a.payload,metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_CREATION_STATE":return{...s,stepStates:{...s.stepStates,creation:{...s.stepStates.creation,...a.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_APPROVAL_STATE":return{...s,stepStates:{...s.stepStates,approval:{...s.stepStates.approval,...a.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_PROCESSING_STEP":const t=s.stepStates.processing.steps.map(i=>i.id===a.payload.stepId?{...i,...a.payload.update}:i),r=t.filter(i=>i.status==="completed").map(i=>i.id),l=t.filter(i=>i.status==="error").map(i=>i.id);return{...s,stepStates:{...s.stepStates,processing:{...s.stepStates.processing,steps:t,completedSteps:r,failedSteps:l}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_COMPLETED_STATE":return{...s,stepStates:{...s.stepStates,completed:{...s.stepStates.completed,...a.payload}},metadata:{...s.metadata,lastModified:new Date}};case"SET_FLAGS":return{...s,flags:{...s.flags,...a.payload},metadata:{...s.metadata,lastModified:new Date}};case"RESET_WORKFLOW":return Ai();default:return s}},Um=({children:s})=>{const[a,t]=d.useReducer(Km,Ai()),r=["select","create","approve","process","complete"],l=d.useCallback(()=>r.indexOf(a.currentStep),[a.currentStep]),i=d.useCallback(()=>{const T=_i[a.currentStep];return T.validation?T.validation(a):!0},[a]),n=d.useCallback(()=>{const T=l();if(T<r.length-1){const O=r[T+1];O==="approve"&&!a.stepStates.approval.required?(t({type:"UPDATE_STEP_STATUS",payload:{step:"approve",status:"skipped"}}),t({type:"SET_STEP",payload:"process"})):t({type:"SET_STEP",payload:O})}},[l,a.stepStates.approval.required]),c=d.useCallback(()=>{const T=l();if(T>0){const O=r[T-1];O==="approve"&&a.steps.find(E=>E.id==="approve")?.status==="skipped"?t({type:"SET_STEP",payload:"create"}):t({type:"SET_STEP",payload:O})}},[l,a.steps]),g=d.useCallback(T=>{t({type:"SET_STEP",payload:T})},[]),o=d.useCallback(T=>{t({type:"SET_CREATION_METHOD",payload:T})},[]),w=d.useCallback(T=>{t({type:"UPDATE_ORDER_DATA",payload:T})},[]),p=d.useCallback((T,O)=>{t({type:"UPDATE_PROCESSING_STEP",payload:{stepId:T,update:O}})},[]),m=d.useCallback(T=>a.steps.find(O=>O.id===T),[a.steps]);d.useEffect(()=>{localStorage.getItem(`workflow_${a.metadata.workflowId}`)||localStorage.setItem(`workflow_${a.metadata.workflowId}`,JSON.stringify(a))},[a]);const f={state:a,dispatch:t,goToNextStep:n,goToPreviousStep:c,goToStep:g,setCreationMethod:o,updateOrderData:w,updateProcessingStep:p,canProceed:i,getCurrentStepIndex:l,getStepStatus:m};return e.jsx(Di.Provider,{value:f,children:s})},Bm=()=>{const s=d.useContext(Di);if(!s)throw new Error("useOrderWorkflow must be used within OrderWorkflowProvider");return s},Qm=(s,a=!1)=>{const t=["select","create","approve","process","complete"],r=t.indexOf(s);if(r===-1||r===t.length-1)return null;const l=t[r+1];return l==="approve"&&a?t[r+2]||null:l},Hm=(s,a=!1)=>{const t=["select","create","approve","process","complete"],r=t.indexOf(s);if(r<=0)return null;const l=t[r-1];return l==="approve"&&a?t[r-2]||null:l},Wm=s=>{const a=s.steps.filter(r=>r.id!=="approve"||s.stepStates.approval.required).length,t=s.steps.filter(r=>r.status==="completed"||r.status==="skipped").length;return Math.round(t/a*100)},Gm=s=>{const a={select:1,create:5,approve:10,process:3,complete:1};return s.steps.filter(r=>r.status==="pending"||r.status==="current").reduce((r,l)=>l.id==="approve"&&!s.stepStates.approval.required?r:r+(a[l.id]||0),0)},Jm=(s,a)=>{const t={};return s==="standard"?(a?.projectId||(t.projectId="í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),a?.vendorId||(t.vendorId="ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),(!a?.items||a.items.length===0)&&(t.items="í’ˆëª©ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”"),a?.orderDate||(t.orderDate="ë°œì£¼ì¼ìžë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),a?.deliveryDate||(t.deliveryDate="ë‚©ê¸°ì¼ìžë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”")):s==="excel"&&(a?((!a.type||a.type!=="excel")&&(t.type="ì—‘ì…€ ì—…ë¡œë“œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"),(!a.orders||a.orders.length===0)&&(t.orders="íŒŒì‹±ëœ ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"),a.filePath||(t.filePath="íŒŒì¼ ê²½ë¡œê°€ ì—†ìŠµë‹ˆë‹¤"),a.parseErrors&&a.parseErrors.length>0&&(t.parse="ì—‘ì…€ íŒŒì¼ íŒŒì‹± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤")):t.data="ì—…ë¡œë“œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"),{isValid:Object.keys(t).length===0,errors:t}},Ym=s=>{const a=[];return s.generatePDF&&a.push({id:"pdf_generation",title:"PDF ìƒì„±",description:"ë°œì£¼ì„œë¥¼ PDFë¡œ ë³€í™˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),a.push({id:"vendor_validation",title:"ê±°ëž˜ì²˜ ê²€ì¦",description:"ê±°ëž˜ì²˜ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),s.sendEmails&&(a.push({id:"email_preparation",title:"ì´ë©”ì¼ ì¤€ë¹„",description:"ì´ë©”ì¼ì„ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),a.push({id:"attachment_processing",title:"ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬",description:"ì²¨ë¶€íŒŒì¼ì„ ì¤€ë¹„í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"})),a.push({id:"final_validation",title:"ìµœì¢… ê²€ì¦",description:"ëª¨ë“  ì •ë³´ë¥¼ ìµœì¢… í™•ì¸í•˜ê³  ìžˆìŠµë‹ˆë‹¤",status:"idle"}),a},Zm=s=>{const a=`workflow_${s.metadata.workflowId}`;localStorage.setItem(a,JSON.stringify(s));const t=Ti(),r=[{id:s.metadata.workflowId,date:s.metadata.lastModified},...t.filter(l=>l.id!==s.metadata.workflowId)].slice(0,10);localStorage.setItem("recentWorkflows",JSON.stringify(r))},Xm=s=>{const a=`workflow_${s}`,t=localStorage.getItem(a);if(!t)return null;try{return JSON.parse(t)}catch(r){return console.error("Failed to parse workflow state:",r),null}},Ti=()=>{const s=localStorage.getItem("recentWorkflows");if(!s)return[];try{return JSON.parse(s)}catch{return[]}},eh=s=>s.status==="error"&&!["final_validation"].includes(s.id),sh=s=>Math.min(1e3*Math.pow(2,s),3e4),th=(s,a)=>{if(!s)return"-";const r=(a||new Date).getTime()-s.getTime(),l=Math.floor(r/1e3);if(l<60)return`${l}ì´ˆ`;const i=Math.floor(l/60),n=l%60;return`${i}ë¶„ ${n}ì´ˆ`},ah=s=>({select:"ðŸ“‹",create:"âœï¸",approve:"âœ…",process:"âš™ï¸",complete:"ðŸŽ‰"})[s]||"ðŸ“„",rh=s=>({pending:"text-gray-500 bg-gray-100",current:"text-blue-700 bg-blue-100",completed:"text-green-700 bg-green-100",error:"text-red-700 bg-red-100",skipped:"text-gray-400 bg-gray-50"})[s]||"text-gray-500 bg-gray-100",ct={getNextStep:Qm,getPreviousStep:Hm,calculateWorkflowProgress:Wm,estimateRemainingTime:Gm,validateCreationData:Jm,createProcessingPipeline:Ym,saveWorkflowState:Zm,loadWorkflowState:Xm,getRecentWorkflows:Ti,canRetryStep:eh,getRetryDelay:sh,formatStepDuration:th,getStepIcon:ah,getStatusColor:rh},cr={post:async(s,a)=>s.includes("check-approval")?{data:{required:a.amount>1e6}}:s.includes("generate-pdf")?{data:{url:"/api/downloads/order.pdf"}}:s.includes("validate")?{data:{valid:!0,suggestions:[]}}:{data:{}}},lh=()=>{const s=Bm(),{toast:a}=Ze(),[t,r]=d.useState(!1),[l,i]=d.useState(null),n=s.canProceed(),c=s.getCurrentStepIndex()>0,g=ct.calculateWorkflowProgress(s.state),o=ct.estimateRemainingTime(s.state),w=d.useCallback(()=>{if(!n){a({title:"ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",description:"í˜„ìž¬ ë‹¨ê³„ë¥¼ ì™„ë£Œí•´ì£¼ì„¸ìš”",variant:"destructive"});return}s.goToNextStep()},[n,s,a]),p=d.useCallback(()=>{c&&s.goToPreviousStep()},[c,s]),m=d.useCallback(_=>{const k=["select","create","approve","process","complete"].indexOf(_),A=s.getCurrentStepIndex();if(k>A+1){a({title:"ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",description:"ì´ì „ ë‹¨ê³„ë¥¼ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”",variant:"destructive"});return}s.goToStep(_)},[s,a]),f=d.useCallback(_=>{s.setCreationMethod(_),setTimeout(()=>{s.goToNextStep()},500)},[s]),T=d.useCallback(async _=>{try{const k=ct.validateCreationData(s.state.creationMethod,_);if(!k.isValid){const x=Object.values(k.errors).join(", ");a({title:"ìž…ë ¥ ì˜¤ë¥˜",description:x||"í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”",variant:"destructive"}),console.error("Validation errors:",k.errors),console.error("Submitted data:",_);return}s.updateOrderData(_),s.dispatch({type:"UPDATE_CREATION_STATE",payload:{data:_,isValid:!0,validationErrors:{}}});const A=await nh(_);s.dispatch({type:"UPDATE_APPROVAL_STATE",payload:{required:A}}),ct.saveWorkflowState(s.state),a({title:"ì €ìž¥ ì™„ë£Œ",description:"ë°œì£¼ì„œ ì •ë³´ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"}),setTimeout(()=>{s.goToNextStep()},1e3)}catch(k){console.error("Failed to submit order data:",k),a({title:"ì €ìž¥ ì‹¤íŒ¨",description:"ë°œì£¼ì„œ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",variant:"destructive"})}},[s,a]),O=d.useCallback(async()=>{r(!0);try{const _=ct.createProcessingPipeline(s.state.flags);for(const k of _){i(k.id),s.updateProcessingStep(k.id,{status:"processing"});try{const A=await il(k,s.state);s.updateProcessingStep(k.id,{status:"completed",result:A,progress:100})}catch(A){throw s.updateProcessingStep(k.id,{status:"error",error:A.message}),A}}s.dispatch({type:"UPDATE_COMPLETED_STATE",payload:{savedAt:new Date,orderNumber:s.state.orderData?.orderNumber,nextActions:["ë°œì£¼ì„œ ëª©ë¡ ë³´ê¸°","ìƒˆ ë°œì£¼ì„œ ìž‘ì„±"]}}),ct.saveWorkflowState(s.state),s.goToNextStep(),a({title:"ì²˜ë¦¬ ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤"})}catch(_){a({title:"ì²˜ë¦¬ ì‹¤íŒ¨",description:_.message||"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",variant:"destructive"})}finally{r(!1),i(null)}},[s,a]),E=d.useCallback(async _=>{const k=s.state.stepStates.processing.steps.find(A=>A.id===_);if(!(!k||!ct.canRetryStep(k))){r(!0),i(_);try{s.updateProcessingStep(_,{status:"processing"});const A=await il(k,s.state);s.updateProcessingStep(_,{status:"completed",result:A,progress:100}),a({title:"ìž¬ì‹œë„ ì„±ê³µ",description:`${k.title} ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤`}),s.state.stepStates.processing.failedSteps.length===1&&await O()}catch(A){s.updateProcessingStep(_,{status:"error",error:A.message}),a({title:"ìž¬ì‹œë„ ì‹¤íŒ¨",description:A.message||"ìž¬ì‹œë„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",variant:"destructive"})}finally{r(!1),i(null)}}},[s,O,a]),v=d.useCallback(()=>{ct.saveWorkflowState(s.state),a({title:"ì €ìž¥ ì™„ë£Œ",description:"ì§„í–‰ ìƒí™©ì´ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"})},[s.state,a]),F=d.useCallback(_=>{const k=ct.loadWorkflowState(_);a(k?{title:"ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ",description:"ì €ìž¥ëœ ì§„í–‰ ìƒí™©ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤"}:{title:"ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨",description:"ì €ìž¥ëœ ì§„í–‰ ìƒí™©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",variant:"destructive"})},[a]);return d.useEffect(()=>{const _=setTimeout(()=>{ct.saveWorkflowState(s.state)},2e3);return()=>clearTimeout(_)},[s.state]),{workflow:s.state,isProcessing:t,currentProcessingStep:l,canGoNext:n,canGoPrevious:c,goNext:w,goPrevious:p,goToStep:m,selectCreationMethod:f,submitOrderData:T,startProcessing:O,retryProcessingStep:E,progress:g,estimatedTime:o,saveProgress:v,loadProgress:F}};async function nh(s){try{return(await cr.post("/api/orders/check-approval",{amount:s.totalAmount,projectId:s.projectId})).data.required}catch{return!0}}async function il(s,a){switch(await new Promise(t=>setTimeout(t,1e3)),s.id){case"pdf_generation":return{pdfUrl:(await cr.post("/api/orders/generate-pdf",{orderData:a.orderData})).data.url};case"vendor_validation":const r=await cr.post("/api/vendors/validate",{vendorId:a.orderData.vendorId,vendorEmail:a.orderData.vendorEmail});return{isValid:r.data.valid,suggestions:r.data.suggestions};case"email_preparation":return{subject:`ë°œì£¼ì„œ - ${a.orderData.orderNumber}`,recipients:[a.orderData.vendorEmail],body:"ë°œì£¼ì„œë¥¼ ì²¨ë¶€í•©ë‹ˆë‹¤."};case"attachment_processing":return{attachments:["purchase_order.pdf","additional_docs.zip"]};case"final_validation":return{allChecksPass:!0};default:throw new Error(`Unknown processing step: ${s.id}`)}}const ih=[{id:"excel",title:"ì—‘ì…€ ë°œì£¼ì„œ",description:"ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë°œì£¼ì„œë¥¼ ìžë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤",icon:e.jsx(fs,{className:"w-8 h-8 text-green-600"}),features:["ë‹¤ëŸ‰ì˜ ë°œì£¼ì„œ ì¼ê´„ ì²˜ë¦¬","ê¸°ì¡´ ì—‘ì…€ ì–‘ì‹ í™œìš©","ìžë™ ë°ì´í„° íŒŒì‹±","ê±°ëž˜ì²˜ ìžë™ ê²€ì¦","PDF ë³€í™˜ ë° ì´ë©”ì¼ ë°œì†¡"],pros:["ë¹ ë¥¸ ëŒ€ëŸ‰ ì²˜ë¦¬","ê¸°ì¡´ ì—…ë¬´ ë°©ì‹ ìœ ì§€","ìžë™í™”ëœ í›„ì²˜ë¦¬"],cons:["ì—‘ì…€ ì–‘ì‹ ì¤€ìˆ˜ í•„ìš”","ì˜¤ë¥˜ ì‹œ ì¼ê´„ ìˆ˜ì • ì–´ë ¤ì›€"],estimatedTime:"3-5ë¶„",difficulty:"easy",recommended:!0},{id:"standard",title:"í‘œì¤€ ë°œì£¼ì„œ",description:"ì›¹ í¼ì„ í†µí•´ ë°œì£¼ì„œë¥¼ ì§ì ‘ ìž…ë ¥í•˜ì—¬ ìƒì„±í•©ë‹ˆë‹¤",icon:e.jsx(bn,{className:"w-8 h-8 text-blue-600"}),features:["ì§ê´€ì ì¸ ì›¹ í¼ ì¸í„°íŽ˜ì´ìŠ¤","ì‹¤ì‹œê°„ ìž…ë ¥ ê²€ì¦","ë‹¨ê³„ë³„ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°","ê°œë³„ ë°œì£¼ì„œ ì •ë°€ ê´€ë¦¬","PDF ë¯¸ë¦¬ë³´ê¸°"],pros:["ì •í™•í•œ ë°ì´í„° ìž…ë ¥","ìœ ì—°í•œ ìˆ˜ì • ê°€ëŠ¥","ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° ì§€ì›"],cons:["ê°œë³„ ìž…ë ¥ìœ¼ë¡œ ì‹œê°„ ì†Œìš”","ëŒ€ëŸ‰ ì²˜ë¦¬ ì‹œ ë¹„íš¨ìœ¨ì "],estimatedTime:"5-10ë¶„",difficulty:"medium"}],ch=s=>{switch(s){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800"}},dh=({onMethodSelect:s,disabled:a=!1})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ë°œì£¼ì„œ ìž‘ì„± ë°©ì‹ ì„ íƒ"}),e.jsx("p",{className:"text-gray-600",children:"í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë§žëŠ” ë°œì£¼ì„œ ìž‘ì„± ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto",children:ih.map(t=>e.jsxs(L,{className:`relative transition-all duration-300 hover:shadow-xl hover:-translate-y-1 transform ${t.recommended?"ring-2 ring-blue-500 ring-opacity-50":""} ${a?"opacity-50":""} h-full flex flex-col`,children:[t.recommended&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsxs(B,{className:"bg-blue-600 text-white px-3 py-1",children:[e.jsx(ia,{className:"w-3 h-3 mr-1"}),"ì¶”ì²œ"]})}),e.jsxs(H,{className:"pb-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[t.icon,e.jsxs("div",{children:[e.jsx(W,{className:"text-xl",children:t.title}),e.jsx(jt,{className:"mt-1",children:t.description})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Rs,{className:"w-4 h-4"}),e.jsx("span",{children:t.estimatedTime})]}),e.jsx(B,{variant:"secondary",className:ch(t.difficulty),children:t.difficulty==="easy"?"ì‰¬ì›€":t.difficulty==="medium"?"ë³´í†µ":"ì–´ë ¤ì›€"})]})]}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),"ì£¼ìš” ê¸°ëŠ¥"]}),e.jsx("ul",{className:"space-y-1",children:t.features.map((r,l)=>e.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(pe,{className:"w-3 h-3 text-green-500 mr-2 flex-shrink-0"}),r]},l))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-700 mb-2 flex items-center text-sm",children:[e.jsx(pe,{className:"w-4 h-4 mr-1"}),"ìž¥ì "]}),e.jsx("ul",{className:"space-y-1",children:t.pros.map((r,l)=>e.jsxs("li",{className:"text-xs text-green-600 ml-5",children:["â€¢ ",r]},l))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-orange-700 mb-2 flex items-center text-sm",children:[e.jsx(Be,{className:"w-4 h-4 mr-1"}),"ê³ ë ¤ì‚¬í•­"]}),e.jsx("ul",{className:"space-y-1",children:t.cons.map((r,l)=>e.jsxs("li",{className:"text-xs text-orange-600 ml-5",children:["â€¢ ",r]},l))})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(b,{onClick:()=>s(t.id),disabled:a,className:`w-full h-12 ${t.id==="excel"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,size:"lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[t.icon,e.jsxs("span",{children:[t.title," ì„ íƒ"]})]})})})]})]},t.id))}),e.jsx(L,{className:"bg-blue-50 border-blue-200",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ot,{className:"w-4 h-4 text-blue-600"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"ì–´ë–¤ ë°©ì‹ì„ ì„ íƒí•´ì•¼ í• ê¹Œìš”?"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ì—‘ì…€ ë°œì£¼ì„œ"}),": ì—¬ëŸ¬ ê°œì˜ ë°œì£¼ì„œë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•´ì•¼ í•˜ê±°ë‚˜, ê¸°ì¡´ ì—‘ì…€ ì–‘ì‹ì´ ìžˆëŠ” ê²½ìš°"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"í‘œì¤€ ë°œì£¼ì„œ"}),": ê°œë³„ ë°œì£¼ì„œë¥¼ ì •í™•ížˆ ê´€ë¦¬í•˜ê³  ì‹¶ê±°ë‚˜, ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°ê°€ í•„ìš”í•œ ê²½ìš°"]})]})]})]})})})]}),oh=s=>{switch(s.id){case"pdf_generation":return e.jsx(ye,{className:"w-5 h-5"});case"vendor_validation":return e.jsx(ur,{className:"w-5 h-5"});case"email_preparation":return e.jsx(Ns,{className:"w-5 h-5"});case"attachment_processing":return e.jsx(Qt,{className:"w-5 h-5"});case"final_validation":return e.jsx(pe,{className:"w-5 h-5"});default:return e.jsx(pe,{className:"w-5 h-5"})}},xh=s=>{switch(s){case"completed":return"text-green-600 bg-green-50 border-green-200";case"processing":return"text-blue-600 bg-blue-50 border-blue-200";case"error":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},mh=s=>{switch(s.status){case"completed":return e.jsx(pe,{className:"w-6 h-6 text-green-600"});case"processing":return e.jsx(lt,{className:"w-6 h-6 text-blue-600 animate-spin"});case"error":return e.jsx(Be,{className:"w-6 h-6 text-red-600"});default:return e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"})}},Dt=s=>s<60?`${s}ì´ˆ`:s<3600?`${Math.floor(s/60)}ë¶„ ${s%60}ì´ˆ`:`${Math.floor(s/3600)}ì‹œê°„ ${Math.floor(s%3600/60)}ë¶„`,hh=({steps:s,currentStep:a,onRetry:t,onPreview:r,onEdit:l,onPause:i,onResume:n,onSkip:c,onCancel:g,isProcessing:o=!1,isPaused:w=!1,canPause:p=!1,canSkip:m=!1,totalElapsedTime:f=0,estimatedTimeRemaining:T,onStepComplete:O,maxRetries:E=3})=>{const[v,F]=d.useState(new Date),[_,k]=d.useState(new Set);d.useEffect(()=>{const S=setInterval(()=>{F(new Date)},1e3);return()=>clearInterval(S)},[]);const A=s.filter(S=>S.status==="completed").length,x=s.length,D=x>0?Math.round(A/x*100):0,u=s.some(S=>S.status==="error"),N=A===x,j=s.find(S=>S.status==="processing"),h=s.filter(S=>S.status==="error"),I=S=>{const z=new Set(_);z.has(S)?z.delete(S):z.add(S),k(z)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"í›„ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸"}),o&&!w&&e.jsxs(B,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[e.jsx(ia,{className:"w-3 h-3 mr-1"}),"ì²˜ë¦¬ ì¤‘"]}),w&&e.jsxs(B,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(ma,{className:"w-3 h-3 mr-1"}),"ì¼ì‹œì •ì§€"]}),u&&e.jsxs(B,{variant:"destructive",className:"bg-red-100 text-red-800",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"ì˜¤ë¥˜ ",h.length,"ê°œ"]}),N&&!u&&e.jsxs(B,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(dt,{className:"w-3 h-3 mr-1"}),"ì™„ë£Œ"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì„œ ìƒì„± í›„ í•„ìš”í•œ ìž‘ì—…ë“¤ì„ ìžë™ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤"})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[D,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[A,"/",x," ë‹¨ê³„ ì™„ë£Œ"]}),f>0&&e.jsxs("div",{className:"text-xs text-gray-500",children:["ê²½ê³¼: ",Dt(f)]}),T&&e.jsxs("div",{className:"text-xs text-blue-600",children:[e.jsx(ha,{className:"w-3 h-3 inline mr-1"}),"ì˜ˆìƒ ",Dt(T)," ë‚¨ìŒ"]}),e.jsx("div",{className:"text-xs text-gray-400",children:v.toLocaleTimeString("ko-KR")})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&p&&!w&&i&&e.jsxs(b,{variant:"outline",size:"sm",onClick:i,className:"text-yellow-600 border-yellow-300 hover:bg-yellow-50",children:[e.jsx(ma,{className:"w-4 h-4 mr-1"}),"ì¼ì‹œì •ì§€"]}),w&&n&&e.jsxs(b,{variant:"outline",size:"sm",onClick:n,className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(Uc,{className:"w-4 h-4 mr-1"}),"ìž¬ê°œ"]}),u&&h.length>0&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{h.forEach(S=>t?.(S.id))},className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(lt,{className:"w-4 h-4 mr-1"}),"ëª¨ë“  ì˜¤ë¥˜ ìž¬ì‹œë„"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:g&&e.jsxs(b,{variant:"outline",size:"sm",onClick:g,disabled:N,className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:[e.jsx(ya,{className:"w-4 h-4 mr-1"}),"ì·¨ì†Œ"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"ì „ì²´ ì§„í–‰ë¥ "}),j&&e.jsxs(B,{variant:"outline",className:"text-xs px-2 py-0.5",children:[j.title," ì²˜ë¦¬ ì¤‘"]})]}),e.jsxs("span",{className:"font-semibold text-lg",children:[D,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{value:D,className:"h-3"}),o&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-30 animate-pulse rounded-full h-3"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:[A,"ê°œ ì™„ë£Œ"]}),e.jsxs("span",{children:[x-A,"ê°œ ë‚¨ìŒ"]})]})]}),w&&e.jsxs(As,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(ma,{className:"h-4 w-4 text-yellow-600"}),e.jsx(Ss,{className:"text-yellow-800",children:"í›„ì²˜ë¦¬ ìž‘ì—…ì´ ì¼ì‹œì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ìž¬ê°œ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê³„ì† ì§„í–‰í•˜ì„¸ìš”."})]}),u&&e.jsxs(As,{className:"border-red-200 bg-red-50",children:[e.jsx(Be,{className:"h-4 w-4 text-red-600"}),e.jsxs(Ss,{className:"text-red-800",children:[e.jsxs("div",{className:"font-medium mb-1",children:[h.length,"ê°œ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"]}),e.jsxs("div",{className:"text-sm",children:[h.map(S=>S.title).join(", ")," ë‹¨ê³„ë¥¼ í™•ì¸í•˜ê³  ìž¬ì‹œë„í•´ì£¼ì„¸ìš”."]})]})]}),N&&!u&&e.jsxs(As,{className:"border-green-200 bg-green-50",children:[e.jsx(pe,{className:"h-4 w-4 text-green-600"}),e.jsxs(Ss,{className:"text-green-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"ëª¨ë“  í›„ì²˜ë¦¬ ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"}),e.jsxs("div",{className:"text-sm",children:["ì´ ",x,"ê°œ ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.",f>0&&` (ì†Œìš”ì‹œê°„: ${Dt(f)})`]})]})]}),e.jsx("div",{className:"space-y-3",children:s.map((S,z)=>{const Q=_.has(S.id),K=S.retryCount||0,ne=S.status==="error"&&K<E;return e.jsxs(L,{className:`border transition-all duration-300 transform hover:scale-[1.01] ${xh(S.status)} ${S.id===a?"shadow-lg ring-2 ring-blue-200 ring-opacity-50":"shadow-sm"}`,children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[mh(S),S.status==="processing"&&e.jsx("div",{className:"absolute -inset-2 border-2 border-blue-400 rounded-full opacity-30 animate-pulse"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-1",children:[e.jsxs(W,{className:"text-base flex items-center space-x-2",children:[oh(S),e.jsx("span",{children:S.title})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[S.status==="processing"&&e.jsxs(B,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs px-2 py-0.5",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-1"}),"ì§„í–‰ ì¤‘"]}),S.status==="completed"&&e.jsxs(B,{variant:"secondary",className:"bg-green-100 text-green-800 text-xs px-2 py-0.5",children:[e.jsx(dt,{className:"w-3 h-3 mr-1"}),"ì™„ë£Œ"]}),S.status==="error"&&e.jsxs(B,{variant:"destructive",className:"bg-red-100 text-red-800 text-xs px-2 py-0.5",children:[e.jsx(ya,{className:"w-3 h-3 mr-1"}),"ì˜¤ë¥˜ ",K>0&&`(${K}/${E} ì‹œë„)`]}),S.priority&&e.jsx(B,{variant:"outline",className:"text-xs px-2 py-0.5",children:S.priority==="high"?"ë†’ìŒ":S.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:S.description}),(S.startedAt||S.completedAt||S.estimatedDuration)&&e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-2",children:[S.startedAt&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Rs,{className:"w-3 h-3"}),e.jsxs("span",{children:["ì‹œìž‘: ",S.startedAt.toLocaleTimeString("ko-KR")]})]}),S.completedAt&&S.startedAt&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ha,{className:"w-3 h-3"}),e.jsxs("span",{children:["ì†Œìš”: ",Dt(Math.round((S.completedAt.getTime()-S.startedAt.getTime())/1e3))]})]}),S.estimatedDuration&&S.status==="pending"&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ha,{className:"w-3 h-3"}),e.jsxs("span",{children:["ì˜ˆìƒ: ",Dt(S.estimatedDuration)]})]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["ë‹¨ê³„ ",z+1,"/",s.length]}),(S.details?.length||S.result||S.error)&&e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>I(S.id),className:"text-xs px-2 py-1 h-6",children:[Q?"ì ‘ê¸°":"íŽ¼ì¹˜ê¸°",e.jsx(ft,{className:`w-3 h-3 ml-1 transition-transform duration-200 ${Q?"rotate-90":""}`})]})]})})]})}),e.jsxs(q,{className:"pt-0",children:[S.status==="processing"&&S.progress!==void 0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsx("span",{className:"font-medium",children:"ì²˜ë¦¬ ì§„í–‰ë¥ "}),e.jsxs("span",{className:"font-bold",children:[S.progress,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{value:S.progress,className:"h-2"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-20 animate-pulse rounded-full h-2"})]})]}),Q&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(nt,{}),S.status==="error"&&S.error&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Be,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-red-800 mb-2",children:"ì˜¤ë¥˜ ìƒì„¸ ì •ë³´"}),e.jsx("div",{className:"text-sm text-red-700 bg-red-100 p-3 rounded border border-red-200 font-mono",children:S.error}),K>0&&e.jsxs("div",{className:"text-xs text-red-600 mt-2",children:["ìž¬ì‹œë„ íšŸìˆ˜: ",K,"/",E]})]})]})}),S.details&&S.details.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ms,{className:"w-4 h-4 text-blue-600"}),e.jsx("div",{className:"font-medium text-blue-800",children:"ì²˜ë¦¬ ë‚´ìš©"})]}),e.jsx("ul",{className:"space-y-2",children:S.details.map((Se,je)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:Se})]},je))})]}),S.status==="completed"&&S.result&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(dt,{className:"w-4 h-4 text-green-600"}),e.jsx("div",{className:"font-medium text-green-800",children:"ì²˜ë¦¬ ê²°ê³¼"})]}),e.jsx("div",{className:"text-sm text-green-700",children:typeof S.result=="string"?S.result:S.result.message||"ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤"}),S.result?.details&&e.jsx("div",{className:"mt-2 text-xs text-green-600 bg-green-100 p-2 rounded border border-green-200",children:JSON.stringify(S.result.details,null,2)})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[S.status==="error"&&t&&ne&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>t(S.id),className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"}),"ìž¬ì‹œë„ (",E-K,"íšŒ ë‚¨ìŒ)"]}),S.status==="pending"&&m&&c&&S.priority!=="high"&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>c(S.id),className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:[e.jsx(ft,{className:"w-3 h-3 mr-1"}),"ê±´ë„ˆë›°ê¸°"]}),S.status==="completed"&&r&&(S.id==="pdf_generation"||S.id==="email_preparation")&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>r(S.id,S.result),className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(ls,{className:"w-3 h-3 mr-1"}),"ë¯¸ë¦¬ë³´ê¸°"]}),S.status==="completed"&&S.id==="pdf_generation"&&S.result?.pdfUrl&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>window.open(S.result.pdfUrl,"_blank"),className:"text-green-600 border-green-300 hover:bg-green-50",children:[e.jsx(Ts,{className:"w-3 h-3 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]}),S.status==="completed"&&l&&S.id==="email_preparation"&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>l(S.id,S.result),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(Hs,{className:"w-3 h-3 mr-1"}),"íŽ¸ì§‘"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[S.status==="completed"&&e.jsxs("div",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(dt,{className:"w-3 h-3 mr-1"}),"ì™„ë£Œ"]}),S.status==="processing"&&e.jsxs("div",{className:"text-xs text-blue-600 flex items-center",children:[e.jsx(lt,{className:"w-3 h-3 mr-1 animate-spin"}),"ì²˜ë¦¬ ì¤‘"]})]})]}),z<s.length-1&&e.jsx("div",{className:"flex justify-center mt-4 mb-2",children:e.jsx("div",{className:`w-0.5 h-4 transition-colors duration-300 ${S.status==="completed"?"bg-green-400":S.status==="processing"?"bg-blue-400":S.status==="error"?"bg-red-400":"bg-gray-300"}`})})]})]},S.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:A}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì™„ë£Œëœ ë‹¨ê³„"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:s.filter(S=>S.status==="processing").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì²˜ë¦¬ ì¤‘"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:h.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì˜¤ë¥˜ ë°œìƒ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600 mb-1",children:s.filter(S=>S.status==="pending").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ëŒ€ê¸° ì¤‘"})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[o&&!w&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx(lt,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:j?`${j.title} ì²˜ë¦¬ ì¤‘...`:"ì²˜ë¦¬ ì¤‘ìž…ë‹ˆë‹¤..."})]}),w&&e.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600",children:[e.jsx(ma,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì¼ì‹œì •ì§€ë¨"})]}),N&&!u&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"})]}),u&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì˜¤ë¥˜ê°€ ë°œìƒí•œ ìž‘ì—…ì´ ìžˆìŠµë‹ˆë‹¤"})]}),!o&&!N&&!u&&!w&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(Rs,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì‹œìž‘ ëŒ€ê¸° ì¤‘"})]})]}),(f>0||T)&&e.jsxs("div",{className:"flex items-center justify-center space-x-6 mt-3 text-xs text-gray-500",children:[f>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ha,{className:"w-3 h-3"}),e.jsxs("span",{children:["ê²½ê³¼: ",Dt(f)]})]}),T&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Rs,{className:"w-3 h-3"}),e.jsxs("span",{children:["ë‚¨ì€ ì‹œê°„: ",Dt(T)]})]})]})]})]})]})},uh=({onUploadComplete:s,disabled:a})=>{const[t,r]=d.useState(null),[l,i]=d.useState(!1),[n,c]=d.useState(!1),[g,o]=d.useState(null),[w,p]=d.useState(0),[m,f]=d.useState(!1),[T,O]=d.useState([{id:"upload",title:"íŒŒì¼ ì—…ë¡œë“œ",description:"ì—‘ì…€ íŒŒì¼ì„ ì„œë²„ë¡œ ì—…ë¡œë“œ",status:"pending"},{id:"parse",title:"Input ì‹œíŠ¸ íŒŒì‹±",description:"ì—‘ì…€ íŒŒì¼ì˜ Input ì‹œíŠ¸ ë°ì´í„° ë¶„ì„",status:"pending"},{id:"save",title:"ë°ì´í„°ë² ì´ìŠ¤ ì €ìž¥",description:"ë°œì£¼ì„œ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ìž¥",status:"pending"},{id:"extract",title:"ê°‘ì§€/ì„ì§€ ì¶”ì¶œ",description:"ê°‘ì§€/ì„ì§€ ì‹œíŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì¶”ì¶œ",status:"pending"}]),E=u=>{u.preventDefault(),u.stopPropagation(),u.type==="dragenter"||u.type==="dragover"?i(!0):u.type==="dragleave"&&i(!1)},v=u=>{if(u.preventDefault(),u.stopPropagation(),i(!1),u.dataTransfer.files&&u.dataTransfer.files[0]){const N=u.dataTransfer.files[0];N.type.includes("excel")||N.type.includes("spreadsheet")||N.name.endsWith(".xlsx")?(r(N),o(null),_()):alert("ì—‘ì…€ íŒŒì¼(.xlsx)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")}},F=u=>{u.target.files&&u.target.files[0]&&(r(u.target.files[0]),o(null),_())},_=()=>{O(u=>u.map(N=>({...N,status:"pending",message:void 0})))},k=(u,N,j)=>{O(h=>h.map(I=>I.id===u?{...I,status:N,message:j}:I))},A=(u,N,j,h)=>{const I=u[N];if(!I){console.error("ì„ íƒëœ ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤.");return}const S={orderNumber:I.orderNumber,projectName:I.projectName,projectId:I.projectId,vendorName:I.vendorName,vendorId:I.vendorId,vendorEmail:I.vendorEmail,orderDate:I.orderDate,deliveryDate:I.dueDate||I.deliveryDate,dueDate:I.dueDate||I.deliveryDate,totalAmount:I.totalAmount||0,totalItems:I.items?.length||0,items:I.items||[],notes:I.notes||I.remarks||"",remarks:I.notes||I.remarks||"",createdBy:I.createdBy||"",creationMethod:"excel",type:"excel",excelFileName:j.data?.fileName,filePath:j.data?.filePath,processedExcelUrl:h?`/api/po-template/download/${h.split("/").pop()}`:void 0,processedExcelPath:h,allOrders:u,totalOrders:u.length,selectedOrderIndex:N};console.log("ExcelUploadComponent submitting orderData:",S),s(S),f(!1)},x=async()=>{if(t){c(!0);try{k("upload","processing");const u=new FormData;u.append("file",t);const N=await fetch("/api/po-template/upload",{method:"POST",body:u}),j=await N.json();if(!N.ok){k("upload","error",j.error||"íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨"),c(!1);return}k("upload","completed",`${j.data.fileName} ì—…ë¡œë“œ ì™„ë£Œ`),k("parse","completed",`ë°œì£¼ì„œ ${j.data.totalOrders}ê°œ, ì•„ì´í…œ ${j.data.totalItems}ê°œ íŒŒì‹± ì™„ë£Œ`),k("save","processing");const h=await fetch("/api/po-template/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:j.data.orders})}),I=await h.json();if(!h.ok){k("save","error",I.error||"ë°ì´í„°ë² ì´ìŠ¤ ì €ìž¥ ì‹¤íŒ¨"),c(!1);return}k("save","completed",`ë°œì£¼ì„œ ${I.data.savedOrders}ê°œ ì €ìž¥ ì™„ë£Œ`),k("extract","processing");const S=await fetch("/api/po-template/extract-sheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:j.data.filePath})}),z=await S.json();let Q;S.ok?(k("extract","completed",`${z.data.extractedSheets.join(", ")} ì‹œíŠ¸ ì¶”ì¶œ ì™„ë£Œ`),Q=z.data?.extractedPath,console.log("Extracted file path:",Q)):k("extract","error",z.error||"ì‹œíŠ¸ ì¶”ì¶œ ì‹¤íŒ¨"),o(j),j.data.orders.length>1?(f(!0),o({...j,extractedPath:Q})):A(j.data.orders,0,j,Q)}catch(u){console.error("Processing error:",u),k("upload","error","ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{c(!1)}}},D=()=>T.filter(N=>N.status==="completed").length/T.length*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{className:"border-blue-200 bg-blue-50",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"ðŸ“‹ ì—‘ì…€ íŒŒì¼ ìš”êµ¬ì‚¬í•­"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì‹œíŠ¸ëª…:"})," 'Input' (ëŒ€ì†Œë¬¸ìž êµ¬ë¶„)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ì»¬ëŸ¼ êµ¬ì¡°:"})," A~Pì—´ (16ê°œ ì»¬ëŸ¼) í‘œì¤€ êµ¬ì¡°"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í˜•ì‹:"})," .xlsx (Excel 2007 ì´ìƒ)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"íŒŒì¼ í¬ê¸°:"})," ìµœëŒ€ 10MB"]})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"ðŸ“¥ í‘œì¤€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"ì‹œìŠ¤í…œì— ìµœì í™”ëœ 16ê°œ ì»¬ëŸ¼ êµ¬ì¡°ì˜ í‘œì¤€ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”."}),e.jsxs(b,{onClick:async()=>{try{const u=await fetch("/api/excel-template/download",{method:"GET"});if(u.ok){const N=await u.blob(),j=window.URL.createObjectURL(N),h=document.createElement("a");h.href=j,h.download="PO_Excel_Template.xlsx",document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(j)}else throw new Error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨")}catch(u){console.error("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:",u),alert("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",disabled:a,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"PO_Excel_Template.xlsx ë‹¤ìš´ë¡œë“œ"]})]})]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${l?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${a?"opacity-50 pointer-events-none":""}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:v,children:[e.jsx(Vs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.size/1024/1024).toFixed(2)," MB"]}),e.jsx(B,{variant:"secondary",className:"mt-2",children:"íŒŒì¼ ì¤€ë¹„ ì™„ë£Œ"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"ì—‘ì…€ íŒŒì¼ì„ ë“œëž˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì§€ì› í˜•ì‹: .xlsx (Excel íŒŒì¼)"})]}),e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:F,className:"hidden",id:"file-upload",disabled:a}),e.jsx("label",{htmlFor:"file-upload",className:`inline-block mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors font-medium ${a?"opacity-50 pointer-events-none":""}`,children:"íŒŒì¼ ì„ íƒ"})]}),t&&e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx(b,{onClick:x,disabled:n||a,className:"flex-1 h-12",size:"lg",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),"ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì‹œìž‘"]})}),e.jsx(b,{variant:"outline",onClick:()=>{r(null),o(null),_()},className:"h-12",size:"lg",disabled:n||a,children:"ì·¨ì†Œ"})]}),n&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"ì²˜ë¦¬ ì§„í–‰ ìƒí™©"}),e.jsxs("span",{className:"text-sm text-blue-700",children:[Math.round(D()),"%"]})]}),e.jsx(Zt,{value:D(),className:"h-2 mb-3"}),e.jsx("div",{className:"text-sm text-blue-700",children:T.find(u=>u.status==="processing")?.title||"ì²˜ë¦¬ ì¤‘..."})]})]}),g&&g.data?.orders&&e.jsx(L,{className:"mt-6",children:e.jsxs(q,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Ms,{className:"w-5 h-5 text-blue-600"}),"ë°œì£¼ì„œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs("div",{className:"space-y-6",children:[g.data.orders.slice(0,2).map((u,N)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:u.orderNumber}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ê±°ëž˜ì²˜: ",u.vendorName," | ë‚©í’ˆì²˜: ",u.deliveryName||u.vendorName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["í˜„ìž¥: ",u.siteName," | ë°œì£¼ì¼: ",u.orderDate," | ë‚©ê¸°ì¼: ",u.dueDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(u.totalAmount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[u.items.length,"ê°œ í’ˆëª©"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"ê·œê²©"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ë‹¨ê°€"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"ê¸ˆì•¡"})]})}),e.jsxs("tbody",{children:[u.items.slice(0,3).map((j,h)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:j.itemName}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:j.specification}),e.jsx("td",{className:"border border-gray-300 px-2 py-1 text-right",children:new Intl.NumberFormat("ko-KR").format(j.quantity)}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR").format(j.unitPrice),"ì›"]}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR").format(j.totalAmount),"ì›"]})]},h)),u.items.length>3&&e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"border border-gray-300 px-2 py-1 text-center text-gray-500",children:["... ì™¸ ",u.items.length-3,"ê°œ í’ˆëª©"]})})]})]})})]},N)),g.data.orders.length>2&&e.jsx("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-gray-600",children:["... ì™¸ ",g.data.orders.length-2,"ê°œ ë°œì£¼ì„œ"]})})]})]})}),m&&g&&g.data&&e.jsx(L,{children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ë°œì£¼ì„œ ì„ íƒ"}),e.jsxs(B,{variant:"secondary",children:[g.data.orders.length,"ê°œ ë°œì£¼ì„œ"]})]}),e.jsxs(As,{children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx(Ss,{children:"ì—¬ëŸ¬ ê°œì˜ ë°œì£¼ì„œê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ì²˜ë¦¬í•  ë°œì£¼ì„œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."})]}),e.jsx("div",{className:"space-y-3",children:g.data.orders.map((u,N)=>e.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${w===N?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>p(N),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:u.orderNumber}),e.jsxs("div",{className:"text-sm text-gray-600",children:[u.projectName," | ",u.vendorName]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[u.items?.length||0,"ê°œ í’ˆëª© | ì´ì•¡: â‚©",(u.totalAmount||0).toLocaleString()]})]}),e.jsx("input",{type:"radio",name:"orderSelection",checked:w===N,onChange:()=>p(N),className:"w-4 h-4 text-blue-600"})]})},N))}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(b,{onClick:()=>A(g.data.orders,w,g,g.extractedPath),className:"flex-1",disabled:a,children:"ì„ íƒí•œ ë°œì£¼ì„œë¡œ ì§„í–‰"}),e.jsx(b,{variant:"outline",onClick:()=>{f(!1),o(null),r(null),_()},disabled:a,children:"ì·¨ì†Œ"})]})]})})}),g&&!m&&e.jsxs(As,{children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsxs(Ss,{children:["ì—‘ì…€ ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì£¼ì„œ ",g.data?.totalOrders,"ê°œ, í’ˆëª© ",g.data?.totalItems,"ê°œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."]})]})]})},ph=({onFormComplete:s,disabled:a})=>{const[t]=d.useState(kr()),[r,l]=d.useState(!1),[i,n]=d.useState({site:"",deliveryDate:"",isNegotiable:!1,receiver:"",manager:"",notes:"",items:[{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:"",vendorId:"",deliveryLocation:"",deliveryToSite:!1}]}),c=()=>i.items.reduce((x,D)=>x+(D.totalPrice||0),0),{data:g=[]}=se({queryKey:["/api/projects"],select:x=>x?.filter(D=>D.isActive)||[]});se({queryKey:["/api/auth/user"]});const{data:o=[]}=se({queryKey:["/api/users"],select:x=>x?.filter(D=>D.isActive)||[]}),{data:w=[]}=se({queryKey:["/api/vendors"],select:x=>x?.filter(D=>D.isActive)||[]}),{data:p=[]}=se({queryKey:["/api/item-categories/major"],queryFn:()=>fetch("/api/item-categories/major").then(x=>x.json())}),{data:m=[]}=se({queryKey:["/api/item-categories/middle"],queryFn:()=>fetch("/api/item-categories/middle").then(x=>x.json())}),{data:f=[]}=se({queryKey:["/api/item-categories/minor"],queryFn:()=>fetch("/api/item-categories/minor").then(x=>x.json())}),T=x=>m,O=x=>f,E=(x,D)=>{n(u=>({...u,[x]:D}))},v=(x,D,u)=>{const N=[...i.items];if(N[x]={...N[x],[D]:u},D==="quantity"||D==="unitPrice"){const j=D==="quantity"?u:N[x].quantity,h=D==="unitPrice"?u:N[x].unitPrice;N[x].totalPrice=j*h}D==="majorCategory"?(N[x].middleCategory="",N[x].minorCategory=""):D==="middleCategory"&&(N[x].minorCategory=""),D==="deliveryToSite"&&u===!0&&(N[x].deliveryLocation="í˜„ìž¥"),n(j=>({...j,items:N}))},F=()=>{n(x=>({...x,items:[...x.items,{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:"",vendorId:"",deliveryLocation:"",deliveryToSite:!1}]}))},_=x=>{i.items.length>1&&n(D=>({...D,items:D.items.filter((u,N)=>N!==x)}))},k=()=>i.site?i.deliveryDate?i.items.some(x=>!x.name||x.quantity<=0)?(alert("ëª¨ë“  í’ˆëª©ì˜ ì´ë¦„ê³¼ ìˆ˜ëŸ‰ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”."),!1):i.items[0]?.vendorId?!0:(alert("ìµœì†Œí•œ í•˜ë‚˜ì˜ í’ˆëª©ì— ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."),!1):(alert("í¬ë§ ë‚©ê¸°ì¼ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”."),!1):(alert("í˜„ìž¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”."),!1),A=async()=>{if(k()){l(!0);try{const x=g.find(N=>N.projectName===i.site),D=i.items[0]?.vendorId||"",u={type:"standard",orderNumber:t,projectId:x?.id?.toString()||"",vendorId:D,siteName:i.site,orderDate:new Date().toISOString().split("T")[0],deliveryDate:i.deliveryDate,isNegotiable:i.isNegotiable,receiver:i.receiver,manager:i.manager,notes:i.notes,totalAmount:c(),items:i.items.map(N=>({itemName:N.name,specification:N.specs,quantity:N.quantity,unit:N.unit,unitPrice:N.unitPrice,totalAmount:N.totalPrice,category:N.category,majorCategory:N.majorCategory,middleCategory:N.middleCategory,minorCategory:N.minorCategory,remarks:N.remarks,vendorId:N.vendorId,deliveryLocation:N.deliveryLocation,deliveryToSite:N.deliveryToSite}))};s(u)}catch(x){console.error("Form submission error:",x),alert("ë°œì£¼ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{l(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{className:"border-blue-200 bg-blue-50",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(Ms,{className:"w-4 h-4"}),"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„± ì•ˆë‚´"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"ë‹¨ê³„ë³„ ìž…ë ¥ìœ¼ë¡œ ì •í™•í•œ ë°œì£¼ì„œ ìž‘ì„±"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"ì‹¤ì‹œê°„ ë°ì´í„° ê²€ì¦ ë° ìžë™ ì™„ì„±"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"ìžë™ ì €ìž¥ìœ¼ë¡œ ì•ˆì „í•œ ë°ì´í„° ë³´ê´€"})]})]})]})})}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5"}),"ë°œì£¼ì„œ ê¸°ë³¸ ì •ë³´"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"poNumber",children:"ë°œì£¼ì„œ ë²ˆí˜¸"}),e.jsx(U,{id:"poNumber",value:t,disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"site",children:"í˜„ìž¥ ì„ íƒ *"}),e.jsxs(Z,{value:i.site,onValueChange:x=>E("site",x),disabled:a,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"í˜„ìž¥ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:g.map(x=>e.jsx(R,{value:x.projectName,children:x.projectName},x.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"deliveryDate",children:"í¬ë§ ë‚©ê¸°ì¼ *"}),e.jsx(U,{id:"deliveryDate",type:"date",value:i.deliveryDate,onChange:x=>E("deliveryDate",x.target.value),disabled:a})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-8",children:[e.jsx(gs,{id:"isNegotiable",checked:i.isNegotiable,onCheckedChange:x=>E("isNegotiable",x),disabled:a}),e.jsx(P,{htmlFor:"isNegotiable",children:"ë‚©ê¸° í˜‘ì˜ ê°€ëŠ¥"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"receiver",children:"ìˆ˜ì‹ ìž"}),e.jsxs(Z,{value:i.receiver,onValueChange:x=>E("receiver",x),disabled:a,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ìˆ˜ì‹ ìžë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:o.map(x=>e.jsxs(R,{value:x.name,children:[x.name," (",x.role,")"]},x.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"manager",children:"ë‹´ë‹¹ìž"}),e.jsx(U,{id:"manager",value:i.manager,onChange:x=>E("manager",x.target.value),placeholder:"ë‹´ë‹¹ìžëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:a})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"notes",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx(Ge,{id:"notes",value:i.notes,onChange:x=>E("notes",x.target.value),placeholder:"íŠ¹ì´ì‚¬í•­ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”",rows:3,disabled:a})]})]})]}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5"}),"ë°œì£¼ í’ˆëª©"]}),e.jsxs(b,{onClick:F,variant:"outline",size:"sm",disabled:a,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"í’ˆëª© ì¶”ê°€"]})]})}),e.jsx(q,{children:e.jsx("div",{className:"space-y-4",children:i.items.map((x,D)=>e.jsx(L,{className:"border border-gray-200",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(B,{variant:"outline",children:["í’ˆëª© ",D+1]}),i.items.length>1&&e.jsx(b,{onClick:()=>_(D),variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",disabled:a,children:e.jsx(Qe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{children:"í’ˆëª©ëª… *"}),e.jsx(U,{value:x.name,onChange:u=>v(D,"name",u.target.value),placeholder:"í’ˆëª©ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:a})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ê·œê²©"}),e.jsx(U,{value:x.specs,onChange:u=>v(D,"specs",u.target.value),placeholder:"ê·œê²©ì„ ìž…ë ¥í•˜ì„¸ìš”",disabled:a})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(P,{children:"ëŒ€ë¶„ë¥˜"}),e.jsxs(Z,{value:x.majorCategory,onValueChange:u=>v(D,"majorCategory",u),disabled:a,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsx(ee,{children:p.map(u=>e.jsx(R,{value:u.categoryValue||u.categoryName,children:u.categoryValue||u.categoryName},u.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ì¤‘ë¶„ë¥˜"}),e.jsxs(Z,{value:x.middleCategory,onValueChange:u=>v(D,"middleCategory",u),disabled:a||!x.majorCategory,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsx(ee,{children:T(x.majorCategory).map(u=>e.jsx(R,{value:u.categoryValue||u.categoryName,children:u.categoryValue||u.categoryName},u.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ì†Œë¶„ë¥˜"}),e.jsxs(Z,{value:x.minorCategory,onValueChange:u=>v(D,"minorCategory",u),disabled:a||!x.middleCategory,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ì„ íƒ"})}),e.jsx(ee,{children:O(x.middleCategory).map(u=>e.jsx(R,{value:u.categoryValue||u.categoryName,children:u.categoryValue||u.categoryName},u.id))})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(P,{children:"ìˆ˜ëŸ‰ *"}),e.jsx(U,{type:"number",value:x.quantity||"",onChange:u=>v(D,"quantity",parseFloat(u.target.value)||0),placeholder:"0",min:"0",step:"0.01",disabled:a})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ë‹¨ìœ„"}),e.jsxs(Z,{value:x.unit,onValueChange:u=>v(D,"unit",u),disabled:a,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ë‹¨ìœ„ ì„ íƒ"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"ea",children:"ea"}),e.jsx(R,{value:"set",children:"set"}),e.jsx(R,{value:"ton",children:"ton"}),e.jsx(R,{value:"kg",children:"kg"}),e.jsx(R,{value:"g",children:"g"}),e.jsx(R,{value:"m",children:"m"}),e.jsx(R,{value:"cm",children:"cm"}),e.jsx(R,{value:"mm",children:"mm"}),e.jsx(R,{value:"mÂ²",children:"mÂ²"}),e.jsx(R,{value:"mÂ³",children:"mÂ³"}),e.jsx(R,{value:"L",children:"L"}),e.jsx(R,{value:"mL",children:"mL"}),e.jsx(R,{value:"ê¸°íƒ€",children:"ê¸°íƒ€"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ë‹¨ê°€"}),e.jsx(U,{type:"number",value:x.unitPrice||"",onChange:u=>v(D,"unitPrice",parseFloat(u.target.value)||0),placeholder:"0",min:"0",step:"0.01",disabled:a})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ì´ì•¡"}),e.jsx(U,{value:ll(x.totalPrice),disabled:!0,className:"bg-gray-50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(P,{children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:x.vendorId||"",onValueChange:u=>v(D,"vendorId",u),disabled:a,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:w.map(u=>e.jsx(R,{value:u.id.toString(),children:u.name},u.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ë‚©í’ˆì²˜"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{value:x.deliveryLocation||"",onValueChange:u=>v(D,"deliveryLocation",u),disabled:a||x.deliveryToSite,className:"flex-1",children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ë‚©í’ˆì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ee,{children:w.map(u=>e.jsx(R,{value:u.name,children:u.name},u.id))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gs,{id:`deliveryToSite-${D}`,checked:x.deliveryToSite||!1,onCheckedChange:u=>{v(D,"deliveryToSite",u),u&&v(D,"deliveryLocation","í˜„ìž¥")},disabled:a}),e.jsx(P,{htmlFor:`deliveryToSite-${D}`,className:"text-sm cursor-pointer",children:"í˜„ìž¥"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(P,{children:"ë¹„ê³ "}),e.jsx(Ge,{value:x.remarks,onChange:u=>v(D,"remarks",u.target.value),placeholder:"ì¶”ê°€ ì„¤ëª…ì´ë‚˜ ìš”ì²­ì‚¬í•­",rows:2,disabled:a})]})]})]})},D))})})]}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Bc,{className:"w-5 h-5"}),"ì£¼ë¬¸ ìš”ì•½"]})}),e.jsx(q,{children:e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-medium",children:"ì´ ì£¼ë¬¸ ê¸ˆì•¡"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[ll(c()),"ì›"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:["ì´ ",i.items.length,"ê°œ í’ˆëª©"]})]})})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(b,{onClick:A,disabled:a||r,className:"flex-1 bg-blue-600 hover:bg-blue-700",size:"lg",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"ë°œì£¼ì„œ ìƒì„±"]})})})]})},jh=({method:s,onDataSubmit:a,disabled:t})=>s==="excel"?e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"w-5 h-5"}),"ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"]})}),e.jsx(q,{children:e.jsx(uh,{onUploadComplete:a,disabled:t})})]}):e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"í‘œì¤€ ë°œì£¼ì„œ ìž‘ì„±"})}),e.jsx(q,{children:e.jsx(ph,{onFormComplete:a,disabled:t})})]}),gh=({orderData:s})=>{const a=s.totalOrders||s.orders?.length||1,t=s.totalItems||s.items?.length||0,r=s.totalAmount||0;return e.jsxs(L,{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(pe,{className:"w-6 h-6"}),"ë°œì£¼ì„œ ìƒì„± ì™„ë£Œ ìš”ì•½"]})}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:a}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3"}),"ë°œì£¼ì„œ"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:t}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(Es,{className:"w-3 h-3"}),"í’ˆëª©"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:r>0?`â‚©${r.toLocaleString()}`:"-"}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(Xs,{className:"w-3 h-3"}),"ì´ ê¸ˆì•¡"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:s.type==="excel"?"Excel":"í‘œì¤€"}),e.jsx("div",{className:"text-sm text-gray-600",children:"ìž‘ì„± ë°©ì‹"})]})]}),s.orderNumber&&e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"ë°œì£¼ì„œ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ë°œì£¼ì„œ ë²ˆí˜¸:"}),e.jsx(B,{variant:"outline",className:"font-mono",children:s.orderNumber})]}),s.projectName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"í”„ë¡œì íŠ¸:"}),e.jsx("span",{className:"font-medium",children:s.projectName})]}),s.vendorName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ê±°ëž˜ì²˜:"}),e.jsx("span",{className:"font-medium",children:s.vendorName})]}),s.createdAt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"ìƒì„±ì¼:"}),e.jsx("span",{className:"font-medium",children:new Date(s.createdAt).toLocaleDateString("ko-KR")})]})]})]}),e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(pe,{className:"w-4 h-4"}),"ëª¨ë“  ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"]})})]})]})},fh=({steps:s,onRetryStep:a,showRetryButtons:t=!1})=>{const r=s.filter(o=>o.status==="completed"),l=s.filter(o=>o.status==="error"),i=s.filter(o=>o.status==="processing"),n=o=>{switch(o.id){case"pdf_generation":return e.jsx(ye,{className:"w-4 h-4"});case"vendor_validation":return e.jsx(ur,{className:"w-4 h-4"});case"email_preparation":return e.jsx(Ns,{className:"w-4 h-4"});case"attachment_processing":return e.jsx(ye,{className:"w-4 h-4"});case"final_validation":return e.jsx(pe,{className:"w-4 h-4"});default:return e.jsx(ia,{className:"w-4 h-4"})}},c=o=>{switch(o){case"completed":return e.jsx(pe,{className:"w-4 h-4 text-green-600"});case"error":return e.jsx(Be,{className:"w-4 h-4 text-red-600"});case"processing":return e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"});default:return e.jsx(Rs,{className:"w-4 h-4 text-gray-400"})}},g=o=>{switch(o){case"completed":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"processing":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Qc,{className:"w-5 h-5 text-blue-600"}),"ì²˜ë¦¬ ê²°ê³¼ ìƒì„¸"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:r.length}),e.jsx("div",{className:"text-sm text-green-700",children:"ì™„ë£Œ"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:i.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"ì²˜ë¦¬ ì¤‘"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:l.length}),e.jsx("div",{className:"text-sm text-red-700",children:"ì˜¤ë¥˜"})]})]}),e.jsx("div",{className:"space-y-3",children:s.map(o=>e.jsx("div",{className:`p-4 rounded-lg border ${g(o.status)} transition-all duration-200`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[n(o),c(o.status)]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:o.title}),e.jsx(B,{variant:"outline",className:o.status==="completed"?"border-green-600 text-green-600":o.status==="error"?"border-red-600 text-red-600":o.status==="processing"?"border-blue-600 text-blue-600":"border-gray-400 text-gray-600",children:o.status==="completed"?"ì™„ë£Œ":o.status==="error"?"ì˜¤ë¥˜":o.status==="processing"?"ì²˜ë¦¬ ì¤‘":"ëŒ€ê¸°"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:o.description}),o.progress!==void 0&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"ì§„í–‰ë¥ "}),e.jsxs("span",{children:[o.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${o.progress}%`}})})]}),o.result&&e.jsxs("div",{className:"text-sm text-green-700 bg-green-50 p-2 rounded mt-2",children:[e.jsx("strong",{children:"ê²°ê³¼:"})," ",typeof o.result=="string"?o.result:JSON.stringify(o.result)]}),o.error&&e.jsxs("div",{className:"text-sm text-red-700 bg-red-50 p-2 rounded mt-2",children:[e.jsx("strong",{children:"ì˜¤ë¥˜:"})," ",o.error]}),o.details&&o.details.length>0&&e.jsx("div",{className:"mt-2",children:e.jsxs("details",{className:"text-sm",children:[e.jsx("summary",{className:"cursor-pointer text-gray-600 hover:text-gray-800",children:"ìƒì„¸ ì •ë³´ ë³´ê¸°"}),e.jsx("ul",{className:"mt-2 space-y-1 text-gray-600 ml-4",children:o.details.map((w,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"â€¢"}),w]},p))})]})})]})]}),t&&o.status==="error"&&a&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>a(o.id),className:"ml-2",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"}),"ìž¬ì‹œë„"]})]})},o.id))}),l.length===0&&r.length===s.length&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(pe,{className:"w-4 h-4"}),"ëª¨ë“  ì²˜ë¦¬ ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"]})}),l.length>0&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-100 text-red-800 rounded-full text-sm font-medium",children:[e.jsx(Be,{className:"w-4 h-4"}),l.length,"ê°œ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"]})})]})]})},Nh=({orderData:s,isOpen:a,onClose:t,trigger:r,onDownload:l})=>{const[i,n]=d.useState({status:"idle"}),[c,g]=d.useState(100),[o,w]=d.useState(1),[p,m]=d.useState(1),f=async()=>{n({status:"generating",progress:0});try{if(console.log("PDF ìƒì„± ì‹œìž‘ - orderData:",s),!s||Object.keys(s).length===0)throw new Error("ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë°œì£¼ì„œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.");const F=[{message:"ë°œì£¼ì„œ ë°ì´í„° ì¤€ë¹„ ì¤‘...",progress:20},{message:"PDF í…œí”Œë¦¿ ë¡œë”© ì¤‘...",progress:40},{message:"PDF ìƒì„± ì¤‘...",progress:70},{message:"ìµœì¢… ê²€ì¦ ì¤‘...",progress:90},{message:"ì™„ë£Œ",progress:100}];for(const A of F)n({status:"generating",progress:A.progress}),await new Promise(x=>setTimeout(x,800));const _=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderData:{orderNumber:s.orderNumber||"PO-TEMP-001",projectName:s.projectName||s.project?.name||"í”„ë¡œì íŠ¸ ë¯¸ì§€ì •",vendorName:s.vendorName||s.vendor?.name||"ê±°ëž˜ì²˜ ë¯¸ì§€ì •",items:s.items||[],totalAmount:s.totalAmount||0,notes:s.notes||s.remarks||"",orderDate:s.orderDate||new Date().toISOString(),deliveryDate:s.deliveryDate||s.dueDate||null,createdBy:s.createdBy||s.user?.name||"ìž‘ì„±ìž ë¯¸ìƒ"},options:{includeWatermark:!0,format:"A4",orientation:"portrait"}})});if(!_.ok)throw new Error("PDF ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤");const k=await _.json();n({status:"ready",url:k.pdfUrl||"/api/placeholder-pdf.pdf"})}catch(F){n({status:"error",error:F instanceof Error?F.message:"PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"})}};d.useEffect(()=>{a&&i.status==="idle"&&f()},[a]);const T=()=>{if(i.url&&l)l(i.url);else if(i.url){const F=document.createElement("a");F.href=i.url,F.download=`ë°œì£¼ì„œ_${s?.orderNumber||"unknown"}.pdf`,document.body.appendChild(F),F.click(),document.body.removeChild(F)}},O=()=>{i.url&&window.open(i.url,"_blank")},E=()=>{switch(i.status){case"generating":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx($s,{className:"w-12 h-12 text-blue-600 animate-spin"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF ìƒì„± ì¤‘..."}),e.jsx("div",{className:"w-80 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i.progress||0}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.progress||0,"% ì™„ë£Œ"]})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx(Be,{className:"w-12 h-12 text-red-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF ìƒì„± ì‹¤íŒ¨"}),e.jsxs("div",{className:"text-center max-w-md space-y-2",children:[e.jsx("p",{className:"text-sm text-red-600",children:i.error}),e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"í•´ê²° ë°©ë²•:"}),e.jsx("br",{}),"â€¢ ë¸Œë¼ìš°ì €ì—ì„œ íŒì—… ì°¨ë‹¨ì„ í•´ì œí•´ë³´ì„¸ìš”",e.jsx("br",{}),"â€¢ íŒŒì¼ ê¶Œí•œ ë¬¸ì œì¼ ìˆ˜ ìžˆìœ¼ë‹ˆ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”",e.jsx("br",{}),"â€¢ Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œëŠ” ì—¬ì „ížˆ ê°€ëŠ¥í•©ë‹ˆë‹¤"]})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(b,{onClick:f,variant:"outline",children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"ë‹¤ì‹œ ì‹œë„"]}),e.jsxs(b,{onClick:()=>{s?.excelUrl&&window.open(s.excelUrl,"_blank")},variant:"secondary",disabled:!s?.excelUrl,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Excel ë‹¤ìš´ë¡œë“œ"]})]})]});case"ready":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>g(Math.max(50,c-25)),disabled:c<=50,children:e.jsx(ka,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium px-2",children:[c,"%"]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>g(Math.min(200,c+25)),disabled:c>=200,children:e.jsx(_a,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[o," / ",p]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:O,children:[e.jsx(Vt,{className:"w-4 h-4 mr-1"}),"ì¸ì‡„"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(Ts,{className:"w-4 h-4 mr-1"}),"ë‹¤ìš´ë¡œë“œ"]})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 min-h-[600px] flex items-center justify-center",children:i.url?e.jsx("iframe",{src:`${i.url}#view=FitH&zoom=${c}`,className:"w-full h-[600px] border-0 rounded",title:"PDF ë¯¸ë¦¬ë³´ê¸°"}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(ye,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"PDF ë¡œë”© ì¤‘..."})]})})]});default:return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs(b,{onClick:f,children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"PDF ë¯¸ë¦¬ë³´ê¸° ì‹œìž‘"]})})}},v=e.jsxs(qe,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"w-5 h-5"}),"PDF ë¯¸ë¦¬ë³´ê¸°",s?.orderNumber&&e.jsx(B,{variant:"outline",children:s.orderNumber})]})}),e.jsxs(kt,{defaultValue:"preview",className:"h-full flex flex-col",children:[e.jsxs(vt,{className:"grid w-full grid-cols-2",children:[e.jsx(is,{value:"preview",children:"ë¯¸ë¦¬ë³´ê¸°"}),e.jsx(is,{value:"details",children:"ë°œì£¼ì„œ ì •ë³´"})]}),e.jsx(hs,{value:"preview",className:"flex-1 overflow-auto",children:E()}),e.jsx(hs,{value:"details",className:"flex-1 overflow-auto",children:e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"ë°œì£¼ì„œ ìƒì„¸ ì •ë³´"})}),e.jsxs(q,{className:"space-y-4",children:[s?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ë°œì£¼ì„œ ë²ˆí˜¸:"}),e.jsx("p",{className:"mt-1",children:s.orderNumber||"PO-TEMP-001"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"í”„ë¡œì íŠ¸:"}),e.jsx("p",{className:"mt-1",children:s.projectName||s.project?.name||"í”„ë¡œì íŠ¸ ë¯¸ì§€ì •"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ê±°ëž˜ì²˜:"}),e.jsx("p",{className:"mt-1",children:s.vendorName||s.vendor?.name||"ê±°ëž˜ì²˜ ë¯¸ì§€ì •"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ì´ ê¸ˆì•¡:"}),e.jsx("p",{className:"mt-1",children:s.totalAmount?`â‚©${s.totalAmount.toLocaleString()}`:"â‚©0"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"í’ˆëª© ìˆ˜:"}),e.jsxs("p",{className:"mt-1",children:[s.totalItems||s.items?.length||0,"ê°œ"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ìž‘ì„± ë°©ì‹:"}),e.jsx("p",{className:"mt-1",children:s.type==="excel"||s.creationMethod==="excel"?"Excel ì—…ë¡œë“œ":"í‘œì¤€ ìž…ë ¥"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ë°œì£¼ì¼ìž:"}),e.jsx("p",{className:"mt-1",children:s.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ë‚©ê¸°ì¼ìž:"}),e.jsx("p",{className:"mt-1",children:s.deliveryDate||s.dueDate?new Date(s.deliveryDate||s.dueDate).toLocaleDateString("ko-KR"):"ë¯¸ì§€ì •"})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"ë°œì£¼ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm mt-2",children:"ë°œì£¼ì„œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”."})]}),e.jsx(nt,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"PDF ìƒì„± ì˜µì…˜"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600"}),"ì›Œí„°ë§ˆí¬ í¬í•¨"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600"}),"A4 í¬ê¸°"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-green-600"}),"ì„¸ë¡œ ë°©í–¥"]})]})]})]})]})})]})]});return r?e.jsxs(ze,{open:a,onOpenChange:t,children:[e.jsx(Ls,{asChild:!0,children:r}),v]}):e.jsx(ze,{open:a,onOpenChange:t,children:v})},yh=({recipients:s,onRecipientsChange:a,isOpen:t,onClose:r,trigger:l,projectId:i,vendorId:n})=>{const[c,g]=d.useState(""),[o,w]=d.useState(null),[p,m]=d.useState({type:"vendor",verified:!1}),[f,T]=d.useState([]);d.useEffect(()=>{O()},[i,n]);const O=async()=>{try{const h=localStorage.getItem("emailRecipients");h&&T(JSON.parse(h))}catch(h){console.error("ìˆ˜ì‹ ìž ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",h)}},E=h=>{try{localStorage.setItem("emailRecipients",JSON.stringify(h))}catch(I){console.error("ìˆ˜ì‹ ìž ëª©ë¡ ì €ìž¥ ì‹¤íŒ¨:",I)}},v=()=>{if(!p.email||!p.name)return;const h={id:`recipient-${Date.now()}`,email:p.email,name:p.name,company:p.company||"",position:p.position||"",phone:p.phone||"",type:p.type||"vendor",verified:A(p.email),tags:p.tags||[],lastUsed:new Date},I=[...s,h];a(I);const S=[...f,h];T(S),E(S),m({type:"vendor",verified:!1})},F=h=>{const I=s.filter(S=>S.id!==h);a(I)},_=h=>{const I=s.map(z=>z.id===h.id?h:z);a(I);const S=f.map(z=>z.id===h.id?h:z);T(S),E(S),w(null)},k=h=>{if(s.find(S=>S.id===h.id))return;const I=[...s,{...h,lastUsed:new Date}];a(I)},A=h=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h),x=f.filter(h=>!s.find(I=>I.id===h.id)&&(h.name.toLowerCase().includes(c.toLowerCase())||h.email.toLowerCase().includes(c.toLowerCase())||h.company?.toLowerCase().includes(c.toLowerCase()))),D=h=>{switch(h){case"vendor":return"bg-blue-100 text-blue-800";case"cc":return"bg-green-100 text-green-800";case"bcc":return"bg-gray-100 text-gray-800";case"manager":return"bg-purple-100 text-purple-800";case"approver":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},u=h=>{switch(h){case"vendor":return"ê±°ëž˜ì²˜";case"cc":return"ì°¸ì¡°";case"bcc":return"ìˆ¨ì€ì°¸ì¡°";case"manager":return"ê´€ë¦¬ìž";case"approver":return"ìŠ¹ì¸ìž";default:return"ê¸°íƒ€"}},N=()=>{const h=[["ì´ë¦„","ì´ë©”ì¼","íšŒì‚¬","ì§ì±…","ì „í™”ë²ˆí˜¸","ìœ í˜•"].join(","),...s.map(z=>[z.name,z.email,z.company||"",z.position||"",z.phone||"",u(z.type)].join(","))].join(`
`),I=new Blob([h],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a");S.href=URL.createObjectURL(I),S.download=`email_recipients_${new Date().toISOString().split("T")[0]}.csv`,S.click()},j=e.jsxs(qe,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"w-5 h-5"}),"ì´ë©”ì¼ ìˆ˜ì‹ ìž ê´€ë¦¬"]})}),e.jsxs(kt,{defaultValue:"current",className:"h-full flex flex-col",children:[e.jsxs(vt,{className:"grid w-full grid-cols-3",children:[e.jsxs(is,{value:"current",children:["í˜„ìž¬ ìˆ˜ì‹ ìž (",s.length,")"]}),e.jsx(is,{value:"add",children:"ìƒˆ ìˆ˜ì‹ ìž ì¶”ê°€"}),e.jsx(is,{value:"saved",children:"ì €ìž¥ëœ ìˆ˜ì‹ ìž"})]}),e.jsxs(hs,{value:"current",className:"flex-1 overflow-auto space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["ì´ ",s.length,"ëª…ì˜ ìˆ˜ì‹ ìž"]}),e.jsxs(b,{onClick:N,variant:"outline",size:"sm",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"CSV ë‚´ë³´ë‚´ê¸°"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.map(h=>e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:h.name}),e.jsx(B,{className:D(h.type),children:u(h.type)}),h.verified?e.jsx(pe,{className:"w-4 h-4 text-green-600"}):e.jsx(Be,{className:"w-4 h-4 text-orange-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"w-3 h-3"}),h.email]}),h.company&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-3 h-3"}),h.company]}),h.position&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"w-3 h-3"}),h.position]}),h.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"w-3 h-3"}),h.phone]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>w(h),children:e.jsx(bn,{className:"w-3 h-3"})}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>F(h.id),children:e.jsx(ys,{className:"w-3 h-3"})})]})]})},h.id)),s.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(ot,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"ë“±ë¡ëœ ìˆ˜ì‹ ìžê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm",children:"ìƒˆ ìˆ˜ì‹ ìžë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”."})]})]})]}),e.jsx(hs,{value:"add",className:"flex-1 overflow-auto",children:e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"ìƒˆ ìˆ˜ì‹ ìž ì •ë³´"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"new-name",children:"ì´ë¦„ *"}),e.jsx(U,{id:"new-name",value:p.name||"",onChange:h=>m({...p,name:h.target.value}),placeholder:"ìˆ˜ì‹ ìž ì´ë¦„"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"new-email",children:"ì´ë©”ì¼ ì£¼ì†Œ *"}),e.jsx(U,{id:"new-email",type:"email",value:p.email||"",onChange:h=>m({...p,email:h.target.value}),placeholder:"example@company.com"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"new-company",children:"íšŒì‚¬ëª…"}),e.jsx(U,{id:"new-company",value:p.company||"",onChange:h=>m({...p,company:h.target.value}),placeholder:"íšŒì‚¬ëª…"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"new-position",children:"ì§ì±…"}),e.jsx(U,{id:"new-position",value:p.position||"",onChange:h=>m({...p,position:h.target.value}),placeholder:"ì§ì±…"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"new-phone",children:"ì „í™”ë²ˆí˜¸"}),e.jsx(U,{id:"new-phone",value:p.phone||"",onChange:h=>m({...p,phone:h.target.value}),placeholder:"010-1234-5678"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"new-type",children:"ìˆ˜ì‹ ìž ìœ í˜•"}),e.jsxs("select",{id:"new-type",className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md",value:p.type,onChange:h=>m({...p,type:h.target.value}),children:[e.jsx("option",{value:"vendor",children:"ê±°ëž˜ì²˜"}),e.jsx("option",{value:"cc",children:"ì°¸ì¡°"}),e.jsx("option",{value:"bcc",children:"ìˆ¨ì€ì°¸ì¡°"}),e.jsx("option",{value:"manager",children:"ê´€ë¦¬ìž"}),e.jsx("option",{value:"approver",children:"ìŠ¹ì¸ìž"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(b,{onClick:v,disabled:!p.name||!p.email,className:"w-full",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"ìˆ˜ì‹ ìž ì¶”ê°€"]})})]})]})}),e.jsxs(hs,{value:"saved",className:"flex-1 overflow-auto space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(U,{placeholder:"ìˆ˜ì‹ ìž ê²€ìƒ‰...",value:c,onChange:h=>g(h.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[x.length,"ëª… í‘œì‹œ"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[x.map(h=>e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:h.name}),e.jsx(B,{className:D(h.type),children:u(h.type)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"w-3 h-3"}),h.email]}),h.company&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-3 h-3"}),h.company]})]}),h.lastUsed&&e.jsxs("div",{className:"text-xs text-gray-500",children:["ë§ˆì§€ë§‰ ì‚¬ìš©: ",new Date(h.lastUsed).toLocaleDateString("ko-KR")]})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>k(h),children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"ì¶”ê°€"]})]})},h.id)),x.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(ot,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."})]})]})]})]}),o&&e.jsx(ze,{open:!!o,onOpenChange:()=>w(null),children:e.jsxs(qe,{children:[e.jsx(Ve,{children:e.jsx(Ke,{children:"ìˆ˜ì‹ ìž ì •ë³´ ìˆ˜ì •"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"edit-name",children:"ì´ë¦„"}),e.jsx(U,{id:"edit-name",value:o.name,onChange:h=>w({...o,name:h.target.value})})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"edit-email",children:"ì´ë©”ì¼ ì£¼ì†Œ"}),e.jsx(U,{id:"edit-email",type:"email",value:o.email,onChange:h=>w({...o,email:h.target.value})})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"edit-company",children:"íšŒì‚¬ëª…"}),e.jsx(U,{id:"edit-company",value:o.company||"",onChange:h=>w({...o,company:h.target.value})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{variant:"outline",onClick:()=>w(null),children:"ì·¨ì†Œ"}),e.jsxs(b,{onClick:()=>_(o),children:[e.jsx(Ks,{className:"w-4 h-4 mr-2"}),"ì €ìž¥"]})]})]})]})})]});return l?e.jsxs(ze,{open:t,onOpenChange:r,children:[e.jsx(Ls,{asChild:!0,children:l}),j]}):e.jsx(ze,{open:t,onOpenChange:r,children:j})},vh=({orderData:s,recipients:a=[],isOpen:t,onClose:r,onSend:l,trigger:i})=>{const[n,c]=d.useState(a),[g,o]=d.useState(!1),[w,p]=d.useState({subject:`ë°œì£¼ì„œ ì „ì†¡ - ${s?.orderNumber||""}`,body:m(s),includeAttachments:!0,sendAsHTML:!0});function m(v){return`ì•ˆë…•í•˜ì„¸ìš”,

${v?.vendorName||"ê±°ëž˜ì²˜"}ë‹˜ê»˜ ë°œì£¼ì„œë¥¼ ì†¡ë¶€ë“œë¦½ë‹ˆë‹¤.

â–  ë°œì£¼ì„œ ì •ë³´
- ë°œì£¼ì„œ ë²ˆí˜¸: ${v?.orderNumber||"ë¯¸ìƒì„±"}
- í”„ë¡œì íŠ¸: ${v?.projectName||"ë¯¸ì§€ì •"}
- ë°œì£¼ ì¼ìž: ${new Date().toLocaleDateString("ko-KR")}
- ì´ í’ˆëª© ìˆ˜: ${v?.totalItems||v?.items?.length||0}ê°œ
${v?.totalAmount?`- ì´ ê¸ˆì•¡: â‚©${v.totalAmount.toLocaleString()}`:""}

ì²¨ë¶€ëœ ë°œì£¼ì„œë¥¼ í™•ì¸í•˜ì‹œê³ , ë‚©ê¸°ì¼ì •ì— ë§žì¶° ì¤€ë¹„í•´ ì£¼ì‹œê¸° ë°”ëžë‹ˆë‹¤.

ë¬¸ì˜ì‚¬í•­ì´ ìžˆìœ¼ì‹œë©´ ì–¸ì œë“  ì—°ë½ ì£¼ì‹œê¸° ë°”ëžë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.

---
${v?.companyName||"íšŒì‚¬ëª…"}
${v?.senderName||"ë°œì‹ ìž"}
${v?.senderEmail||"sender@company.com"}
${v?.senderPhone||"ì—°ë½ì²˜"}`}d.useEffect(()=>{if(a.length===0&&s?.vendorEmail){const v={id:"vendor-1",email:s.vendorEmail,name:s.vendorName||"ê±°ëž˜ì²˜",company:s.vendorName,type:"vendor",verified:!0};c([v])}},[s,a]);const f=()=>{l&&l({recipients:n,template:w}),r?.()},T=v=>{switch(v){case"vendor":return e.jsx(ot,{className:"w-4 h-4 text-blue-600"});case"cc":return e.jsx(na,{className:"w-4 h-4 text-green-600"});case"bcc":return e.jsx(ls,{className:"w-4 h-4 text-gray-600"})}},O=v=>{switch(v){case"vendor":return"ê±°ëž˜ì²˜";case"cc":return"ì°¸ì¡°";case"bcc":return"ìˆ¨ì€ì°¸ì¡°"}},E=e.jsxs(qe,{className:"max-w-4xl h-[90vh] overflow-hidden",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"w-5 h-5"}),"ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ë° ë°œì†¡",s?.orderNumber&&e.jsx(B,{variant:"outline",children:s.orderNumber})]})}),e.jsxs(kt,{defaultValue:"recipients",className:"h-full flex flex-col",children:[e.jsxs(vt,{className:"grid w-full grid-cols-3",children:[e.jsxs(is,{value:"recipients",children:["ìˆ˜ì‹ ìž (",n.length,")"]}),e.jsx(is,{value:"compose",children:"ì´ë©”ì¼ ìž‘ì„±"}),e.jsx(is,{value:"preview",children:"ë¯¸ë¦¬ë³´ê¸°"})]}),e.jsx(hs,{value:"recipients",className:"flex-1 overflow-auto space-y-4",children:e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{className:"text-lg",children:"ìˆ˜ì‹ ìž ëª©ë¡"}),e.jsxs(b,{onClick:()=>o(!0),variant:"outline",size:"sm",children:[e.jsx(Hs,{className:"w-4 h-4 mr-2"}),"ìˆ˜ì‹ ìž ê´€ë¦¬"]})]})}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[n.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[T(v.type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:v.name}),e.jsx(B,{variant:"secondary",className:"text-xs",children:O(v.type)}),v.verified?e.jsx(pe,{className:"w-4 h-4 text-green-600"}):e.jsx(Be,{className:"w-4 h-4 text-orange-600"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:v.email}),v.company&&e.jsx("p",{className:"text-xs text-gray-500",children:v.company})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>c(n.filter(F=>F.id!==v.id)),children:e.jsx(ys,{className:"w-4 h-4"})})]},v.id)),n.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ot,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"ë“±ë¡ëœ ìˆ˜ì‹ ìžê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsxs(b,{onClick:()=>o(!0),variant:"outline",className:"mt-2",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"ìˆ˜ì‹ ìž ì¶”ê°€"]})]})]})})]})}),e.jsx(hs,{value:"compose",className:"flex-1 overflow-auto space-y-4",children:e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{className:"text-lg",children:"ì´ë©”ì¼ ë‚´ìš©"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"email-subject",children:"ì œëª©"}),e.jsx(U,{id:"email-subject",value:w.subject,onChange:v=>p({...w,subject:v.target.value})})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"email-body",children:"ë³¸ë¬¸"}),e.jsx(Ge,{id:"email-body",rows:15,value:w.body,onChange:v=>p({...w,body:v.target.value}),className:"font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{htmlFor:"include-attachments",children:"PDF ì²¨ë¶€"}),e.jsx(Gs,{id:"include-attachments",checked:w.includeAttachments,onCheckedChange:v=>p({...w,includeAttachments:v})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{htmlFor:"send-html",children:"HTML í˜•ì‹ìœ¼ë¡œ ë°œì†¡"}),e.jsx(Gs,{id:"send-html",checked:w.sendAsHTML,onCheckedChange:v=>p({...w,sendAsHTML:v})})]})]}),w.includeAttachments&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(Qt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì²¨ë¶€ ì˜ˆì • íŒŒì¼"})]}),e.jsxs("ul",{className:"mt-2 text-sm text-blue-700",children:[e.jsxs("li",{children:["â€¢ ë°œì£¼ì„œ_",s?.orderNumber||"unknown",".pdf"]}),s?.processedExcelUrl&&e.jsxs("li",{children:["â€¢ ì²˜ë¦¬ëœ_Excel_íŒŒì¼_",s?.excelFileName||"Inputì œê±°",".xlsx"]})]})]})]})]})}),e.jsx(hs,{value:"preview",className:"flex-1 overflow-auto space-y-4",children:e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{className:"text-lg",children:"ë°œì†¡ ë¯¸ë¦¬ë³´ê¸°"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ë°›ëŠ” ì‚¬ëžŒ:"}),e.jsx("div",{className:"mt-1",children:n.filter(v=>v.type==="vendor").map(v=>v.email).join(", ")||"ì—†ìŒ"})]}),n.some(v=>v.type==="cc")&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ì°¸ì¡°:"}),e.jsx("div",{className:"mt-1",children:n.filter(v=>v.type==="cc").map(v=>v.email).join(", ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"ì œëª©:"}),e.jsx("div",{className:"mt-1 font-medium",children:w.subject})]})]})}),e.jsx("div",{className:"p-4 border rounded-lg bg-white",children:e.jsx("div",{className:"whitespace-pre-wrap text-sm",children:w.body})}),w.includeAttachments&&e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[e.jsx(Qt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"ì²¨ë¶€íŒŒì¼"})]}),e.jsxs("div",{className:"mt-2 text-sm text-green-700",children:["ë°œì£¼ì„œ_",s?.orderNumber||"unknown",".pdf"]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(b,{onClick:f,disabled:n.length===0,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"ì´ë©”ì¼ ë°œì†¡ (",n.length,"ëª…)"]})})]})]})})]}),e.jsx(yh,{recipients:n,onRecipientsChange:c,isOpen:g,onClose:()=>o(!1),projectId:s?.projectId,vendorId:s?.vendorId})]});return i?e.jsxs(ze,{open:t,onOpenChange:r,children:[e.jsx(Ls,{asChild:!0,children:i}),E]}):e.jsx(ze,{open:t,onOpenChange:r,children:E})},bh=({orderData:s,onViewPDF:a,onDownloadPDF:t,onSendEmail:r,onViewOrders:l,onCreateNew:i,onPrint:n,onArchive:c,onShare:g,disabled:o=!1})=>{const[w,p]=d.useState(!1),[m,f]=d.useState(!1);return e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Mr,{className:"w-5 h-5"}),"ì‚¬ìš© ê°€ëŠ¥í•œ ìž‘ì—…"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ë¬¸ì„œ ê´€ë¦¬"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(b,{variant:"outline",onClick:()=>p(!0),disabled:o,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(ls,{className:"w-4 h-4"}),"PDF ë¯¸ë¦¬ë³´ê¸°"]}),s?.pdfUrl&&e.jsxs(b,{variant:"outline",onClick:t,disabled:o,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Ts,{className:"w-4 h-4"}),"PDF ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(b,{variant:"outline",onClick:n,disabled:o,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Vt,{className:"w-4 h-4"}),"ì¸ì‡„í•˜ê¸°"]}),e.jsxs(b,{variant:"outline",onClick:g,disabled:o,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Mr,{className:"w-4 h-4"}),"ê³µìœ í•˜ê¸°"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ì´ë©”ì¼ ë°œì†¡"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs(b,{variant:s?.emailsSent?"outline":"default",onClick:()=>f(!0),disabled:o,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Ns,{className:"w-4 h-4"}),s?.emailsSent?"ì´ë©”ì¼ ìž¬ë°œì†¡":"ì´ë©”ì¼ ë°œì†¡"]}),s?.emailsSent&&e.jsx("div",{className:"text-sm text-green-600 text-center py-2 bg-green-50 rounded-lg",children:"âœ“ ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ë‹¤ìŒ ë‹¨ê³„"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(b,{onClick:()=>{l?l():window.location.href="/orders"},disabled:o,className:"flex items-center justify-center gap-2 h-12 bg-blue-600 hover:bg-blue-700",children:[e.jsx(ye,{className:"w-4 h-4"}),"ë°œì£¼ì„œ ê´€ë¦¬"]}),e.jsxs(b,{onClick:()=>{i?i():window.location.href="/create-order/unified"},variant:"outline",disabled:o,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(we,{className:"w-4 h-4"}),"ìƒˆ ë°œì£¼ì„œ ìž‘ì„±"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"ê¸°íƒ€"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(b,{variant:"outline",onClick:c,disabled:o,className:"flex items-center justify-center gap-2 h-10 text-gray-600",children:[e.jsx(Aa,{className:"w-4 h-4"}),"ë³´ê´€í•˜ê¸°"]})})]}),s?.orderNumber&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"ë°œì£¼ì„œ ë²ˆí˜¸"}),e.jsx("div",{className:"font-mono text-blue-900",children:s.orderNumber})]})})]}),e.jsx(Nh,{orderData:s,isOpen:w,onClose:()=>p(!1),onDownload:t}),e.jsx(vh,{orderData:s,isOpen:m,onClose:()=>f(!1),onSend:T=>{console.log("ì´ë©”ì¼ ë°œì†¡:",T),r&&r(),f(!1)}})]})},wh=({orderData:s,onNavigate:a})=>{const r=(()=>{const o=[];return o.push({id:"view_orders",title:"ë°œì£¼ì„œ ìƒì„¸ í™•ì¸",description:"ìƒì„±ëœ ë°œì£¼ì„œì˜ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•˜ì„¸ìš”",priority:"high",status:"recommended",estimatedTime:"2-3ë¶„",url:"/orders",icon:e.jsx(ye,{className:"w-4 h-4"})}),s?.emailsSent||o.push({id:"send_emails",title:"ê±°ëž˜ì²˜ì— ì´ë©”ì¼ ë°œì†¡",description:"ìƒì„±ëœ ë°œì£¼ì„œë¥¼ ê±°ëž˜ì²˜ì— ì´ë©”ì¼ë¡œ ë°œì†¡í•˜ì„¸ìš”",priority:"high",status:"pending",estimatedTime:"1-2ë¶„",url:"/orders?action=send-email",icon:e.jsx(Ns,{className:"w-4 h-4"})}),s?.requiresApproval&&o.push({id:"request_approval",title:"ìŠ¹ì¸ ìš”ì²­",description:"ë°œì£¼ì„œ ìŠ¹ì¸ì„ ìœ„í•´ ìƒê¸‰ìžì—ê²Œ ìŠ¹ì¸ ìš”ì²­ì„ ë³´ë‚´ì„¸ìš”",priority:"high",status:"pending",estimatedTime:"1ë¶„",url:"/approvals/request",icon:e.jsx(ot,{className:"w-4 h-4"})}),s?.totalAmount&&s.totalAmount>1e7&&o.push({id:"financial_review",title:"ìž¬ë¬´ ê²€í†  ìš”ì²­",description:"ê³ ì•¡ ë°œì£¼ì„œë¡œ ì¸í•´ ìž¬ë¬´íŒ€ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤",priority:"medium",status:"recommended",estimatedTime:"5ë¶„",url:"/financial-review",icon:e.jsx(rr,{className:"w-4 h-4"})}),s?.vendorCount&&s.vendorCount>3&&o.push({id:"vendor_management",title:"ê±°ëž˜ì²˜ ê´€ë¦¬ ê²€í† ",description:"ë‹¤ìˆ˜ ê±°ëž˜ì²˜ ë°œì£¼ì„œì´ë¯€ë¡œ ê±°ëž˜ì²˜ ì •ë³´ë¥¼ ìž¬ê²€í† í•˜ì„¸ìš”",priority:"medium",status:"optional",estimatedTime:"3-5ë¶„",url:"/vendors",icon:e.jsx(Hs,{className:"w-4 h-4"})}),o.push({id:"project_tracking",title:"í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸",description:"í”„ë¡œì íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œì— ë°œì£¼ì„œ ì •ë³´ë¥¼ ë°˜ì˜í•˜ì„¸ìš”",priority:"low",status:"optional",estimatedTime:"2-3ë¶„",url:"/projects",icon:e.jsx(rr,{className:"w-4 h-4"})}),o})(),l=r.filter(o=>o.status==="pending"),i=r.filter(o=>o.status==="recommended"),n=r.filter(o=>o.status==="optional"),c=o=>{switch(o){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200"}},g=o=>{o.action?o.action():o.url&&(a?a(o.url):window.location.href=o.url)};return e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"w-5 h-5 text-blue-600"}),"ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´"]})}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600 mb-1",children:l.length}),e.jsx("div",{className:"text-sm text-orange-700",children:"í•„ìˆ˜ ìž‘ì—…"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600 mb-1",children:i.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"ê¶Œìž¥ ìž‘ì—…"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-gray-600 mb-1",children:n.length}),e.jsx("div",{className:"text-sm text-gray-700",children:"ì„ íƒ ìž‘ì—…"})]})]}),l.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-orange-700 flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"í•„ìˆ˜ ìž‘ì—…"]}),l.map(o=>e.jsx("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:o.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:o.title}),e.jsx(B,{className:c(o.priority),children:o.priority==="high"?"ë†’ìŒ":o.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"}),o.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:o.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:o.description})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>g(o),className:"ml-2",children:"ì‹¤í–‰"})]})},o.id))]}),i.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-blue-700 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"ê¶Œìž¥ ìž‘ì—…"]}),i.map(o=>e.jsx("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:o.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:o.title}),e.jsx(B,{className:c(o.priority),children:o.priority==="high"?"ë†’ìŒ":o.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"}),o.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:o.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:o.description})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>g(o),className:"ml-2",children:"ì‹¤í–‰"})]})},o.id))]}),n.length>0&&e.jsxs("details",{className:"space-y-3",children:[e.jsxs("summary",{className:"font-semibold text-gray-700 cursor-pointer flex items-center gap-2",children:[e.jsx(Rs,{className:"w-4 h-4"}),"ì„ íƒ ìž‘ì—… (",n.length,"ê°œ)"]}),e.jsx("div",{className:"space-y-3 mt-3",children:n.map(o=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:o.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:o.title}),e.jsx(B,{className:c(o.priority),children:o.priority==="high"?"ë†’ìŒ":o.priority==="medium"?"ë³´í†µ":"ë‚®ìŒ"}),o.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:o.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:o.description})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>g(o),className:"ml-2",children:"ì‹¤í–‰"})]})},o.id))})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"ðŸ’¡ ë„ì›€ë§"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("p",{children:"â€¢ í•„ìˆ˜ ìž‘ì—…ë¶€í„° ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤"}),e.jsx("p",{children:"â€¢ ê° ìž‘ì—…ì˜ ì˜ˆìƒ ì‹œê°„ì„ ì°¸ê³ í•˜ì—¬ ê³„íšì„ ì„¸ìš°ì„¸ìš”"}),e.jsx("p",{children:"â€¢ ë¬¸ì˜ì‚¬í•­ì´ ìžˆìœ¼ì‹œë©´ ì‹œìŠ¤í…œ ê´€ë¦¬ìžì—ê²Œ ì—°ë½í•˜ì„¸ìš”"})]})]})]})]})},Ch=({orderData:s,processingSteps:a=[],onViewOrders:t,onCreateNew:r,onViewPDF:l,onDownloadPDF:i,onSendEmail:n,onPrint:c,onShare:g,onArchive:o,onNavigate:w,disabled:p})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(pe,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"ë°œì£¼ì„œ ìž‘ì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"}),e.jsx("p",{className:"text-lg text-gray-600",children:"ëª¨ë“  ì²˜ë¦¬ ê³¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."})]}),e.jsx(gh,{orderData:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.length>0&&e.jsx("div",{className:"lg:col-span-2",children:e.jsx(fh,{steps:a,showRetryButtons:!1})}),e.jsx(bh,{orderData:s,onViewPDF:l,onDownloadPDF:i,onSendEmail:n,onViewOrders:t,onCreateNew:r,onPrint:c,onArchive:o,onShare:g,disabled:p}),e.jsx(wh,{orderData:s,onNavigate:w})]})]}),Sh=({onComplete:s,onCancel:a,className:t="",helpContent:r})=>{const{workflow:l,isProcessing:i,currentProcessingStep:n,canGoNext:c,canGoPrevious:g,goNext:o,goPrevious:w,goToStep:p,selectCreationMethod:m,submitOrderData:f,startProcessing:T,retryProcessingStep:O,progress:E,estimatedTime:v,saveProgress:F}=lh(),[_,k]=d.useState(!1),[A,x]=d.useState(!1),D=S=>{m(S)},u=()=>{F(),k(!0),setTimeout(()=>k(!1),3e3)},N=()=>{a&&a()},j=l.steps.find(S=>S.id===l.currentStep),h=l.steps.findIndex(S=>S.id===l.currentStep),I=()=>{switch(l.currentStep){case"select":return e.jsx(dh,{onMethodSelect:D,disabled:i});case"create":return e.jsx(Re.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(jh,{method:l.creationMethod||"standard",onDataSubmit:f,disabled:i})});case"approve":return e.jsx(Re.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(Rs,{className:"w-8 h-8 text-yellow-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ìŠ¹ì¸ ëŒ€ê¸° ì¤‘"}),e.jsx("p",{className:"text-gray-600",children:"ìŠ¹ì¸ ê¶Œí•œìžì˜ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤."})]})});case"process":return e.jsx(hh,{steps:l.stepStates.processing.steps,currentStep:n,onRetry:O,isProcessing:i});case"complete":return e.jsx(Re.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(Ch,{orderData:l.orderData,processingSteps:l.stepStates.processing.steps,onViewOrders:()=>{s?s(l.orderData):window.location.href="/orders"},onCreateNew:()=>{window.location.href="/create-order/unified"},onViewPDF:()=>{l.stepStates.completed.pdfUrl&&window.open(l.stepStates.completed.pdfUrl,"_blank")},onDownloadPDF:()=>{if(l.stepStates.completed.pdfUrl){const z=document.createElement("a");z.href=l.stepStates.completed.pdfUrl,z.download=`ë°œì£¼ì„œ_${l.orderData?.orderNumber||"unknown"}.pdf`,document.body.appendChild(z),z.click(),document.body.removeChild(z)}},onSendEmail:()=>{console.log("ì´ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥ (êµ¬í˜„ ì˜ˆì •)")},onPrint:()=>{window.print()},onShare:()=>{navigator.share&&l.orderData?.orderNumber&&navigator.share({title:`ë°œì£¼ì„œ ${l.orderData.orderNumber}`,text:"ë°œì£¼ì„œë¥¼ ê³µìœ í•©ë‹ˆë‹¤.",url:window.location.href})},onArchive:()=>{console.log("ë³´ê´€í•˜ê¸° ê¸°ëŠ¥ (êµ¬í˜„ ì˜ˆì •)")},onNavigate:z=>{window.location.href=z},disabled:i})});default:return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(ys,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ì•Œ ìˆ˜ ì—†ëŠ” ë‹¨ê³„"}),e.jsx("p",{className:"text-gray-600",children:"í˜„ìž¬ ë‹¨ê³„ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]})}};return e.jsxs("div",{className:`h-screen flex flex-col bg-gray-50 ${t}`,children:[e.jsx("div",{className:"bg-white border-b border-gray-200 flex-shrink-0",children:e.jsx("div",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"ë°œì£¼ì„œ ìž‘ì„±"}),e.jsx("div",{className:"h-4 w-px bg-gray-300"}),e.jsx("span",{className:"text-sm text-gray-600",children:j?.title})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:u,disabled:i,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(Ks,{className:"w-4 h-4 mr-1"}),"ì €ìž¥"]}),e.jsxs(b,{variant:"ghost",size:"sm",onClick:N,disabled:i,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(ys,{className:"w-4 h-4 mr-1"}),"ì·¨ì†Œ"]})]})]})})}),_&&e.jsx("div",{className:"absolute top-16 right-6 z-50",children:e.jsxs(As,{className:"border-green-200 bg-green-50 shadow-lg",children:[e.jsx(Ks,{className:"h-4 w-4 text-green-600"}),e.jsx(Ss,{className:"text-green-800",children:"ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"})]})}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:`bg-white border-r border-gray-200 flex-shrink-0 transition-all duration-300 ${A?"w-16":"w-80"}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>x(!A),className:"w-full justify-between",children:[!A&&e.jsx("span",{className:"text-sm font-medium",children:"ì§„í–‰ ìƒí™©"}),A?e.jsx(mt,{className:"w-4 h-4"}):e.jsx(hr,{className:"w-4 h-4"})]})}),!A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-4",children:l.steps.map((S,z)=>{const Q=S.id===l.currentStep,K=z<h,ne=z<=h;return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${K?"bg-green-500 text-white":Q?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:K?"âœ“":z+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("button",{onClick:()=>ne&&p(S.id),disabled:!ne,className:`text-left w-full ${ne?"cursor-pointer hover:text-blue-600":"cursor-not-allowed"}`,children:[e.jsx("h3",{className:`text-sm font-medium truncate ${Q?"text-blue-600":K?"text-green-600":"text-gray-700"}`,children:S.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:S.description})]}),Q&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all duration-300",style:{width:`${E}%`}})}),v&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ì˜ˆìƒ ì†Œìš”: ",v]})]})]})]},S.id)})})}),e.jsxs("div",{className:"p-4 border-t border-gray-100 space-y-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:w,disabled:!g||i,className:"w-full justify-start",children:[e.jsx(ns,{className:"w-4 h-4 mr-2"}),"ì´ì „ ë‹¨ê³„"]}),l.currentStep==="process"?e.jsx(b,{onClick:T,disabled:i||!c,className:"w-full justify-start",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-4 h-4 mr-2"}),"ì²˜ë¦¬ ì‹œìž‘"]})}):l.currentStep==="complete"?e.jsx(b,{onClick:()=>s?.(l.orderData),className:"w-full justify-start bg-green-600 hover:bg-green-700",children:"ì™„ë£Œ"}):e.jsxs(b,{onClick:o,disabled:!c||i,className:"w-full justify-start",children:[e.jsx(ft,{className:"w-4 h-4 mr-2"}),"ë‹¤ìŒ ë‹¨ê³„"]})]})]}),A&&e.jsx("div",{className:"p-2",children:e.jsx("div",{className:"space-y-2",children:l.steps.map((S,z)=>{const Q=S.id===l.currentStep,K=z<h;return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${K?"bg-green-500 text-white":Q?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:K?"âœ“":z+1})},S.id)})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto flex flex-col",children:[e.jsx("div",{className:"flex-1 p-6",children:e.jsx(L,{className:"h-full shadow-sm",children:e.jsxs(q,{className:"h-full p-6 flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:j?.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:j?.description})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:I()})]})})}),r&&e.jsx("div",{className:"flex-shrink-0",children:r})]})]})]})},kh=s=>e.jsx(Um,{children:e.jsx(Sh,{...s})});function _h(){const{user:s}=os(),{toast:a}=Ze(),[t,r]=Je();new URLSearchParams(window.location.search).get("method"),d.useEffect(()=>{if(!s){r("/login");return}a({title:"í†µí•© ë°œì£¼ì„œ ìž‘ì„±",description:"ìƒˆë¡œìš´ í†µí•© ì›Œí¬í”Œë¡œìš°ë¡œ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•´ë³´ì„¸ìš”"})},[s,r,a]);const i=c=>{a({title:"ë°œì£¼ì„œ ìž‘ì„± ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"}),r("/orders")},n=()=>{window.confirm("ìž‘ì„± ì¤‘ì¸ ë°œì£¼ì„œë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì €ìž¥ë˜ì§€ ì•Šì€ ë‚´ìš©ì€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.")&&(a({title:"ìž‘ì—… ì·¨ì†Œë¨",description:"ë°œì£¼ì„œ ìž‘ì„±ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤",variant:"destructive"}),r("/dashboard"))};return s?e.jsx(kh,{onComplete:i,onCancel:n,helpContent:e.jsx("div",{className:"bg-white border-t border-gray-200",children:e.jsx("div",{className:"max-w-[1366px] mx-auto px-6 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"ðŸ“‹ ë°©ì‹ ì„ íƒ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë§žëŠ” ë°œì£¼ì„œ ìž‘ì„± ë°©ì‹ì„ ì„ íƒí•˜ì„¸ìš”. ê° ë°©ì‹ì˜ ìž¥ë‹¨ì ì„ ë¹„êµí•˜ì—¬ ìµœì ì˜ ì„ íƒì„ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"âš™ï¸ ìžë™ ì²˜ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì„œ ìƒì„± í›„ PDF ë³€í™˜, ê±°ëž˜ì²˜ ê²€ì¦, ì´ë©”ì¼ ë°œì†¡ê¹Œì§€ ëª¨ë“  ê³¼ì •ì´ ìžë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"ðŸ’¾ ìžë™ ì €ìž¥"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ìž‘ì—… ì§„í–‰ ìƒí™©ì´ ìžë™ìœ¼ë¡œ ì €ìž¥ë˜ì–´ ì¤‘ê°„ì— ì¤‘ë‹¨ë˜ì–´ë„ ì´ì–´ì„œ ìž‘ì—…í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]})]})})})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"ë¡œê·¸ì¸ í™•ì¸ ì¤‘..."})]})})}const Dh=Object.freeze(Object.defineProperty({__proto__:null,default:_h},Symbol.toStringTag,{value:"Module"})),Ah=({onDataExtracted:s,onProcessedFileReady:a})=>{const[t,r]=d.useState(!1),[l,i]=d.useState(!1),[n,c]=d.useState(null),[g,o]=d.useState("idle"),[w,p]=d.useState(""),[m,f]=d.useState([]),[T,O]=d.useState(0),E=d.useCallback(x=>{x.preventDefault(),r(!0)},[]),v=d.useCallback(x=>{x.preventDefault(),r(!1)},[]),F=d.useCallback(x=>{x.preventDefault(),r(!1);const u=Array.from(x.dataTransfer.files).find(N=>N.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||N.name.endsWith(".xlsx"));u?k(u):(p("ì—‘ì…€ íŒŒì¼(.xlsx)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤."),o("error"))},[]),_=x=>{const D=x.target.files?.[0];D&&k(D)},k=async x=>{c(x),i(!0),o("processing"),p("");const D=new FormData;D.append("file",x);try{const u=await fetch("/api/po-template/upload",{method:"POST",body:D});if(!u.ok)throw new Error("íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨");const N=await u.json();if(N.success&&N.data.orders.length>0){f(N.data.orders),o("success");try{const j=await fetch("/api/po-template/extract-sheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:N.data.filePath,sheetNames:["ê°‘ì§€","ì„ì§€"]})});if(j.ok){const h=await j.json();if(h.success&&h.data.extractedPath){const S=`/uploads/${h.data.extractedPath.split("/").pop()}`,z=`${x.name.replace(".xlsx","")}_Inputì œê±°.xlsx`;console.log("ðŸ”· ì²˜ë¦¬ëœ Excel íŒŒì¼ ì •ë³´:",{processedFileUrl:S,processedFileName:z}),a?.({url:S,name:z})}}else{console.warn("âš ï¸ Extract sheets API ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©");const I=`/uploads/extracted-${Date.now()}.xlsx`,S=`${x.name.replace(".xlsx","")}_Inputì œê±°.xlsx`;a?.({url:I,name:S})}}catch(j){console.error("Extract sheets í˜¸ì¶œ ì‹¤íŒ¨:",j);const I=`/uploads/extracted-${Date.now()}.xlsx`,S=`${x.name.replace(".xlsx","")}_Inputì œê±°.xlsx`;a?.({url:I,name:S})}if(N.data.orders.length===1){const j=N.data.orders[0],h={...j,projectName:j.siteName||j.projectName,orderDate:j.orderDate,deliveryDate:j.dueDate||j.deliveryDate,items:(j.items||[]).map(I=>({...I,name:I.itemName||I.name,unit:I.unit||"EA"}))};s(h)}}else throw new Error(N.error||"ë°ì´í„° ì¶”ì¶œ ì‹¤íŒ¨")}catch(u){p(u.message||"íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),o("error")}finally{i(!1)}},A=async()=>{if(m[T]&&n){const x=m[T],D={...x,projectName:x.siteName||x.projectName,orderDate:x.orderDate,deliveryDate:x.dueDate||x.deliveryDate,items:(x.items||[]).map(u=>({...u,name:u.itemName||u.name,unit:u.unit||"EA"}))};s(D)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{onDragOver:E,onDragLeave:v,onDrop:F,className:`
          border-2 border-dashed rounded-lg ${g==="success"?"p-4":"p-8"} text-center transition-all
          ${t?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}
          ${l?"opacity-50 pointer-events-none":""}
        `,children:l?e.jsxs("div",{className:"space-y-2",children:[e.jsx($s,{className:"w-8 h-8 mx-auto text-blue-600 animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"íŒŒì¼ì„ ì²˜ë¦¬í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]}):g==="success"?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:n?.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[m.length,"ê°œì˜ ë°œì£¼ì„œ ê°ì§€ë¨"]})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{o("idle"),f([]),c(null)},children:"ë‹¤ì‹œ ì—…ë¡œë“œ"})]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-700 mb-2",children:"ì—‘ì…€ íŒŒì¼ì„ ë“œëž˜ê·¸í•˜ì—¬ ë†“ìœ¼ì„¸ìš”"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"ë˜ëŠ”"}),e.jsx("input",{type:"file",accept:".xlsx",onChange:_,className:"hidden",id:"excel-upload"}),e.jsx("label",{htmlFor:"excel-upload",children:e.jsx(b,{variant:"outline",asChild:!0,children:e.jsxs("span",{className:"cursor-pointer",children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),"íŒŒì¼ ì„ íƒ"]})})})]})}),g==="error"&&w&&e.jsxs(As,{variant:"destructive",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(Ss,{children:w})]}),m.length>1&&g==="success"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"ë°œì£¼ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”:"}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto border rounded-lg p-2 bg-gray-50",children:m.map((x,D)=>e.jsx("div",{onClick:()=>O(D),className:`
                  p-3 border rounded-lg cursor-pointer transition-colors
                  ${T===D?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-white"}
                `,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:x.orderNumber}),e.jsxs("p",{className:"text-xs text-gray-600",children:[x.vendorName," | ",x.projectName]})]}),e.jsxs(B,{variant:"secondary",children:[x.items?.length||0,"ê°œ í’ˆëª©"]})]}),x.items&&x.items.length>0&&e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-500",children:[e.jsx("th",{className:"text-left font-normal",children:"í’ˆëª©"}),e.jsx("th",{className:"text-right font-normal",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"text-right font-normal",children:"ë‹¨ê°€"}),e.jsx("th",{className:"text-right font-normal",children:"ê¸ˆì•¡"})]})}),e.jsx("tbody",{children:x.items.slice(0,2).map((u,N)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-600 truncate max-w-[150px] pr-2",children:u.itemName}),e.jsx("td",{className:"text-right text-gray-700",children:Math.floor(u.quantity||0).toLocaleString()}),e.jsx("td",{className:"text-right text-gray-700",children:Math.floor(u.unitPrice||0).toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:Math.floor(u.totalAmount||0).toLocaleString()})]},N))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[x.items.length>2&&e.jsxs("p",{className:"text-xs text-gray-500 italic",children:["ì™¸ ",x.items.length-2,"ê°œ"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xs text-gray-600 mr-2",children:"ì´ì•¡"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-600",children:[Math.floor(x.totalAmount||x.items.reduce((u,N)=>u+(N.totalAmount||0),0)).toLocaleString(),"ì›"]})]})]})]})]})},D))}),e.jsx(b,{onClick:A,className:"w-full",size:"sm",children:"ì„ íƒí•œ ë°œì£¼ì„œ ì‚¬ìš©"})]})]})},Th=({initialData:s={},onChange:a})=>{const[t,r]=d.useState({orderNumber:s.orderNumber||`PO-${new Date().getTime()}`,orderDate:s.orderDate||new Date,deliveryDate:s.deliveryDate||new Date(Date.now()+6048e5),projectId:s.projectId||"",projectName:s.projectName||"",vendorId:s.vendorId||"",vendorName:s.vendorName||"",vendorEmail:s.vendorEmail||"",items:s.items||[{itemName:"",specification:"",quantity:1,unitPrice:0,totalAmount:0}],notes:s.notes||"",totalAmount:s.totalAmount||0}),{data:l}=se({queryKey:["projects"],queryFn:async()=>(await fetch("/api/projects")).json()}),{data:i}=se({queryKey:["vendors"],queryFn:async()=>(await fetch("/api/vendors")).json()});d.useEffect(()=>{a(t)},[t]),d.useEffect(()=>{const m=t.items.reduce((f,T)=>f+(T.totalAmount||0),0);r(f=>({...f,totalAmount:m}))},[t.items]);const n=(m,f)=>{r(T=>({...T,[m]:f}))},c=m=>{const f=l?.find(T=>T.id===m);f&&r(T=>({...T,projectId:m,projectName:f.name}))},g=m=>{const f=i?.find(T=>T.id===m);f&&r(T=>({...T,vendorId:m,vendorName:f.name,vendorEmail:f.email||""}))},o=(m,f,T)=>{const O=[...t.items];O[m]={...O[m],[f]:T},(f==="quantity"||f==="unitPrice")&&(O[m].totalAmount=O[m].quantity*O[m].unitPrice),r(E=>({...E,items:O}))},w=()=>{r(m=>({...m,items:[...m.items,{itemName:"",specification:"",quantity:1,unitPrice:0,totalAmount:0}]}))},p=m=>{if(t.items.length>1){const f=t.items.filter((T,O)=>O!==m);r(T=>({...T,items:f}))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ê¸°ë³¸ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"orderNumber",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx(U,{id:"orderNumber",value:t.orderNumber,onChange:m=>n("orderNumber",m.target.value),placeholder:"PO-20240101-001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ë°œì£¼ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),Le(t.orderDate,"PPP",{locale:Js})]})}),e.jsx(Is,{className:"w-auto p-0",children:e.jsx(Ys,{mode:"single",selected:t.orderDate,onSelect:m=>m&&n("orderDate",m),initialFocus:!0})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"í”„ë¡œì íŠ¸"}),e.jsxs(Z,{value:t.projectId,onValueChange:c,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"í”„ë¡œì íŠ¸ ì„ íƒ"})}),e.jsx(ee,{children:l?.map(m=>e.jsx(R,{value:m.id,children:m.name},m.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ë‚©ê¸°ì¼"}),e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),Le(t.deliveryDate,"PPP",{locale:Js})]})}),e.jsx(Is,{className:"w-auto p-0",children:e.jsx(Ys,{mode:"single",selected:t.deliveryDate,onSelect:m=>m&&n("deliveryDate",m),initialFocus:!0})})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ê±°ëž˜ì²˜ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:t.vendorId,onValueChange:g,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ê±°ëž˜ì²˜ ì„ íƒ"})}),e.jsx(ee,{children:i?.map(m=>e.jsx(R,{value:m.id,children:m.name},m.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"vendorEmail",children:"ì´ë©”ì¼"}),e.jsx(U,{id:"vendorEmail",type:"email",value:t.vendorEmail,onChange:m=>n("vendorEmail",m.target.value),placeholder:"vendor@example.com"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"í’ˆëª© ì •ë³´"}),e.jsxs(b,{onClick:w,size:"sm",variant:"outline",children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"í’ˆëª© ì¶”ê°€"]})]}),e.jsx("div",{className:"space-y-3",children:t.items.map((m,f)=>e.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end p-3 border rounded-lg",children:[e.jsxs("div",{className:"col-span-3 space-y-2",children:[e.jsx(P,{children:"í’ˆëª©ëª…"}),e.jsx(U,{value:m.itemName,onChange:T=>o(f,"itemName",T.target.value),placeholder:"í’ˆëª©ëª…"})]}),e.jsxs("div",{className:"col-span-3 space-y-2",children:[e.jsx(P,{children:"ê·œê²©"}),e.jsx(U,{value:m.specification,onChange:T=>o(f,"specification",T.target.value),placeholder:"ê·œê²©"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(P,{children:"ìˆ˜ëŸ‰"}),e.jsx(U,{type:"number",value:m.quantity,onChange:T=>o(f,"quantity",Number(T.target.value)),min:"1"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(P,{children:"ë‹¨ê°€"}),e.jsx(U,{type:"number",value:m.unitPrice,onChange:T=>o(f,"unitPrice",Number(T.target.value)),min:"0"})]}),e.jsxs("div",{className:"col-span-1 space-y-2",children:[e.jsx(P,{children:"ê¸ˆì•¡"}),e.jsxs("div",{className:"text-sm font-medium py-2",children:[m.totalAmount.toLocaleString(),"ì›"]})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(b,{onClick:()=>p(f),size:"sm",variant:"ghost",className:"text-red-600 hover:text-red-700",disabled:t.items.length===1,children:e.jsx(Qe,{className:"w-4 h-4"})})})]},f))}),e.jsx("div",{className:"flex justify-end p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"text-lg font-semibold",children:["ì´ì•¡: ",t.totalAmount.toLocaleString(),"ì›"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"notes",children:"ë¹„ê³ "}),e.jsx(Ge,{id:"notes",value:t.notes,onChange:m=>n("notes",m.target.value),placeholder:"ì¶”ê°€ ìš”ì²­ì‚¬í•­ì´ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”",rows:3})]})]})},Ph=({orderData:s,pdfUrl:a,processingStatus:t})=>{const[r,l]=d.useState([s.vendorEmail||""]),[i,n]=d.useState([]),[c,g]=d.useState(`ë°œì£¼ì„œ - ${s.orderNumber||""}`),[o,w]=d.useState("info");d.useState(!1);const[p,m]=d.useState([]),[f,T]=d.useState([]),[O,E]=d.useState(()=>`ì•ˆë…•í•˜ì„¸ìš”,

${s.vendorName||"ê±°ëž˜ì²˜"} ë‹´ë‹¹ìžë‹˜

ë°œì£¼ì„œë¥¼ ì²¨ë¶€í•˜ì—¬ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.

ë°œì£¼ë²ˆí˜¸: ${s.orderNumber||"-"}
í”„ë¡œì íŠ¸: ${s.projectName||"-"}
ë‚©ê¸°ì¼: ${s.deliveryDate?new Date(s.deliveryDate).toLocaleDateString("ko-KR"):"-"}

í™•ì¸ í›„ íšŒì‹  ë¶€íƒë“œë¦½ë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.`);d.useEffect(()=>{E(`ì•ˆë…•í•˜ì„¸ìš”,

${s.vendorName||"ê±°ëž˜ì²˜"} ë‹´ë‹¹ìžë‹˜

ë°œì£¼ì„œë¥¼ ì²¨ë¶€í•˜ì—¬ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.

ë°œì£¼ë²ˆí˜¸: ${s.orderNumber||"-"}
í”„ë¡œì íŠ¸: ${s.projectName||"-"}
ë‚©ê¸°ì¼: ${s.deliveryDate?new Date(s.deliveryDate).toLocaleDateString("ko-KR"):"-"}

í™•ì¸ í›„ íšŒì‹  ë¶€íƒë“œë¦½ë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.`)},[s.vendorName,s.orderNumber,s.projectName,s.deliveryDate]),d.useEffect(()=>{const j=[];s.processedExcelUrl&&j.push({id:"processed-excel",name:s.originalFileName||"ì²˜ë¦¬ëœ_Excel_íŒŒì¼.xlsx",size:0,type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",url:s.processedExcelUrl,isDefault:!0,isSelected:!0}),a&&t.pdf==="completed"&&j.push({id:"generated-pdf",name:`ë°œì£¼ì„œ_${s.orderNumber||"generated"}.pdf`,size:0,type:"application/pdf",url:a,isDefault:!0,isSelected:!0}),m(h=>{const I=h.filter(S=>!S.isDefault);return[...j,...I]})},[s.processedExcelUrl,a,t.pdf,s.orderNumber]);const v=j=>{j==="to"?l([...r,""]):n([...i,""])},F=(j,h)=>{j==="to"&&r.length>1?l(r.filter((I,S)=>S!==h)):j==="cc"&&n(i.filter((I,S)=>S!==h))},_=(j,h,I)=>{if(j==="to"){const S=[...r];S[h]=I,l(S)}else{const S=[...i];S[h]=I,n(S)}},k=async j=>{const h=Array.from(j);for(const I of h){const S=`custom-${Date.now()}-${Math.random()}`;T(z=>[...z,S]);try{const z={id:S,name:I.name,size:I.size,type:I.type,file:I,isDefault:!1,isSelected:!0};m(Q=>[...Q,z])}catch(z){console.error("íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨:",z)}finally{T(z=>z.filter(Q=>Q!==S))}}},A=j=>{m(h=>h.map(I=>I.id===j?{...I,isSelected:!I.isSelected}:I))},x=j=>{m(h=>h.filter(I=>I.id!==j))},D=j=>{if(j===0)return"0 Bytes";const h=1024,I=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(j)/Math.log(h));return parseFloat((j/Math.pow(h,S)).toFixed(2))+" "+I[S]},u=j=>j.includes("pdf")?e.jsx(ye,{className:"w-4 h-4 text-red-600"}):j.includes("spreadsheet")||j.includes("excel")?e.jsx(ye,{className:"w-4 h-4 text-green-600"}):e.jsx(Qt,{className:"w-4 h-4 text-gray-600"}),N=j=>{switch(j){case"completed":return e.jsx(pe,{className:"w-4 h-4 text-green-600"});case"processing":return e.jsx($s,{className:"w-4 h-4 text-blue-600 animate-spin"});case"error":return e.jsx(Be,{className:"w-4 h-4 text-red-600"});default:return null}};return e.jsxs(L,{className:"h-full",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{children:"ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:t.pdf==="completed"?"success":"secondary",children:[N(t.pdf),e.jsx("span",{className:"ml-1",children:"PDF"})]}),e.jsxs(B,{variant:t.vendor==="completed"?"success":"secondary",children:[N(t.vendor),e.jsx("span",{className:"ml-1",children:"ê±°ëž˜ì²˜"})]}),e.jsxs(B,{variant:t.email==="completed"?"success":"secondary",children:[N(t.email),e.jsx("span",{className:"ml-1",children:"ì´ë©”ì¼"})]})]})]})}),e.jsx(q,{className:"h-[calc(100%-5rem)]",children:e.jsxs(kt,{value:o,onValueChange:w,className:"h-full",children:[e.jsxs(vt,{className:"grid w-full grid-cols-3",children:[e.jsxs(is,{value:"info",children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"ë°œì£¼ì„œ ì •ë³´"]}),e.jsxs(is,{value:"pdf",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"PDF ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs(is,{value:"email",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"ì´ë©”ì¼ ì„¤ì •"]})]}),e.jsx(hs,{value:"pdf",className:"h-[calc(100%-3rem)]",children:t.pdf==="processing"?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx($s,{className:"w-12 h-12 mx-auto text-blue-600 animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"PDFë¥¼ ìƒì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]})}):t.pdf==="error"?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(Be,{className:"w-12 h-12 mx-auto text-red-600"}),e.jsx("p",{className:"text-sm text-red-600",children:"PDF ìƒì„± ì‹¤íŒ¨"}),e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"ë‹¤ì‹œ ì‹œë„"]})]})}):a&&t.pdf==="completed"?e.jsx("div",{className:"w-full h-full flex flex-col",children:e.jsx("div",{className:"flex-1 bg-gray-50 rounded-lg p-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(pe,{className:"w-16 h-16 mx-auto text-green-600"}),e.jsx("h3",{className:"text-lg font-medium",children:"PDFê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì•„ëž˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ PDFë¥¼ í™•ì¸í•˜ì„¸ìš”"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 mt-6",children:[e.jsxs(b,{variant:"default",onClick:()=>window.open(a,"_blank"),children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"PDF ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs(b,{variant:"outline",onClick:()=>window.open(`${a}?download=true`,"_blank"),children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"PDF ë‹¤ìš´ë¡œë“œ"]})]})]})})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(ye,{className:"w-12 h-12 mx-auto text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì„œ ì •ë³´ê°€ ì™„ì„±ë˜ë©´ PDFê°€ ìžë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤"}),e.jsx("p",{className:"text-xs text-gray-500",children:"ë¨¼ì € 'ë°œì£¼ì„œ ì •ë³´' íƒ­ì—ì„œ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”"})]})})}),e.jsxs(hs,{value:"info",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx("p",{className:"font-medium",children:s.orderNumber||"-"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë°œì£¼ì¼"}),e.jsx("p",{className:"font-medium",children:s.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"í”„ë¡œì íŠ¸"}),e.jsx("p",{className:"font-medium",children:s.projectName||"-"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜"}),e.jsx("p",{className:"font-medium",children:s.vendorName||"-"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ë‚©ê¸°ì¼"}),e.jsx("p",{className:"font-medium",children:s.deliveryDate?new Date(s.deliveryDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs text-gray-600",children:"ì´ì•¡"}),e.jsx("p",{className:"font-medium text-lg text-blue-600",children:s.totalAmount?`${Math.floor(s.totalAmount).toLocaleString()}ì›`:"-"})]})]}),s.items&&s.items.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-xs text-gray-600",children:"í’ˆëª© ëª©ë¡"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"text-right p-2",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"text-right p-2",children:"ë‹¨ê°€"}),e.jsx("th",{className:"text-right p-2",children:"ê¸ˆì•¡"})]})}),e.jsx("tbody",{children:s.items.map((j,h)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:j.itemName||j.name}),e.jsx("td",{className:"text-right p-2",children:Math.floor(j.quantity||0).toLocaleString()}),e.jsxs("td",{className:"text-right p-2",children:[Math.floor(j.unitPrice||0).toLocaleString(),"ì›"]}),e.jsxs("td",{className:"text-right p-2",children:[Math.floor(j.totalAmount||j.quantity*j.unitPrice||0).toLocaleString(),"ì›"]})]},h))})]})})]})]}),e.jsx(hs,{value:"email",className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{children:"ë°›ëŠ” ì‚¬ëžŒ"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>v("to"),children:e.jsx(we,{className:"w-4 h-4"})})]}),r.map((j,h)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{type:"email",value:j,onChange:I=>_("to",h,I.target.value),placeholder:"email@example.com"}),r.length>1&&e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>F("to",h),children:e.jsx(ys,{className:"w-4 h-4"})})]},h))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{children:"ì°¸ì¡° (CC)"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>v("cc"),children:e.jsx(we,{className:"w-4 h-4"})})]}),i.map((j,h)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{type:"email",value:j,onChange:I=>_("cc",h,I.target.value),placeholder:"cc@example.com"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>F("cc",h),children:e.jsx(ys,{className:"w-4 h-4"})})]},h))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ì œëª©"}),e.jsx(U,{value:c,onChange:j=>g(j.target.value),placeholder:"ì´ë©”ì¼ ì œëª©"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ë©”ì¼ ë³¸ë¬¸"}),e.jsx(Ge,{value:O,onChange:j=>E(j.target.value),placeholder:"ì´ë©”ì¼ ë³¸ë¬¸ì„ ìž…ë ¥í•˜ì„¸ìš”",className:"min-h-[200px] font-mono text-sm",rows:10})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{children:"ì²¨ë¶€íŒŒì¼"}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const j=document.createElement("input");j.type="file",j.multiple=!0,j.accept=".pdf,.xlsx,.xls,.doc,.docx,.txt",j.onchange=h=>{const I=h.target;I.files&&I.files.length>0&&k(I.files)},j.click()},children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),"íŒŒì¼ ì¶”ê°€"]})]}),e.jsx("div",{className:"space-y-3",children:p.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"ì²¨ë¶€í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤"}):p.map(j=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg bg-gray-50",children:[e.jsx(gs,{checked:j.isSelected,onCheckedChange:()=>A(j.id)}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[u(j.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:j.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:D(j.size)}),j.isDefault&&e.jsx(B,{variant:"secondary",className:"text-xs",children:"ê¸°ë³¸íŒŒì¼"})]})]})]}),f.includes(j.id)&&e.jsx($s,{className:"w-4 h-4 animate-spin text-blue-600"}),!j.isDefault&&!f.includes(j.id)&&e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>x(j.id),children:e.jsx(Qe,{className:"w-4 h-4 text-red-600"})})]},j.id))}),p.length>0&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["ì„ íƒëœ íŒŒì¼: ",p.filter(j=>j.isSelected).length,"/",p.length,"ê°œ"]})})]})]})})]})})]})},Eh=({orderData:s,pdfUrl:a,processingStatus:t,onSave:r,onSend:l,onDownload:i,onCreateOrder:n})=>{const c=t.pdf==="completed"&&t.vendor==="completed"&&s.vendorEmail,g=s.orderNumber&&s.vendorName&&s.projectName&&s.items?.length>0,o=Object.values(t).some(w=>w==="processing");return e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-30",children:e.jsxs("div",{className:"container mx-auto px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{variant:"outline",onClick:r,disabled:o,children:[e.jsx(Ks,{className:"w-4 h-4 mr-2"}),"ìž„ì‹œ ì €ìž¥"]}),e.jsxs(b,{variant:"outline",onClick:i,disabled:!a||t.pdf!=="completed",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"ë‹¤ìš´ë¡œë“œ"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx($s,{className:"w-4 h-4 animate-spin"}),"ì²˜ë¦¬ ì¤‘..."]}),e.jsx(b,{variant:"default",onClick:n,disabled:!g||t.order==="processing",className:V("min-w-[120px]",g?"bg-green-600 hover:bg-green-700":""),children:t.order==="processing"?e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"w-4 h-4 mr-2 animate-spin"}),"ìƒì„± ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"ë°œì£¼ì„œ ìƒì„±"]})}),e.jsx(b,{onClick:l,disabled:!c||t.email==="processing",className:V("min-w-[120px]",c?"bg-blue-600 hover:bg-blue-700":""),children:t.email==="processing"?e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"w-4 h-4 mr-2 animate-spin"}),"ë°œì†¡ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"ë°œì†¡í•˜ê¸°"]})})]})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-6 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:V("w-2 h-2 rounded-full",t.pdf==="completed"?"bg-green-500":t.pdf==="processing"?"bg-blue-500 animate-pulse":t.pdf==="error"?"bg-red-500":"bg-gray-300")}),"PDF ìƒì„±"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:V("w-2 h-2 rounded-full",t.vendor==="completed"?"bg-green-500":t.vendor==="processing"?"bg-blue-500 animate-pulse":t.vendor==="error"?"bg-red-500":"bg-gray-300")}),"ê±°ëž˜ì²˜ í™•ì¸"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:V("w-2 h-2 rounded-full",t.order==="completed"?"bg-green-500":t.order==="processing"?"bg-blue-500 animate-pulse":t.order==="error"?"bg-red-500":"bg-gray-300")}),"ë°œì£¼ì„œ ìƒì„±"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:V("w-2 h-2 rounded-full",t.email==="completed"?"bg-green-500":t.email==="processing"?"bg-blue-500 animate-pulse":t.email==="error"?"bg-red-500":"bg-gray-300")}),"ì´ë©”ì¼ ì¤€ë¹„"]})]})]})})},Ih=({orderData:s,onSuggestionApply:a})=>{const[t,r]=d.useState([]),[l,i]=d.useState(new Set),[n,c]=d.useState(!1);d.useEffect(()=>{g()},[s]);const g=()=>{c(!0);const f=[];if(s.vendorName&&!s.vendorEmail&&f.push({id:"vendor-email",type:"autofill",title:"ê±°ëž˜ì²˜ ì´ë©”ì¼ ìžë™ ì™„ì„±",description:"ë“±ë¡ëœ ê±°ëž˜ì²˜ ì •ë³´ì—ì„œ ì´ë©”ì¼ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",action:{label:"ì´ë©”ì¼ ìžë™ ìž…ë ¥",data:{vendorEmail:"vendor@example.com"}},priority:"high"}),s.deliveryDate){const T=new Date(s.deliveryDate),O=new Date,E=Math.ceil((T.getTime()-O.getTime())/(1e3*60*60*24));E<3&&f.push({id:"delivery-urgent",type:"warning",title:"ê¸´ê¸‰ ë‚©ê¸°",description:`ë‚©ê¸°ì¼ì´ ${E}ì¼ ë‚¨ì•˜ìŠµë‹ˆë‹¤. ê¸´ê¸‰ ì²˜ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.`,priority:"high"})}s.projectName&&!s.notes&&f.push({id:"project-defaults",type:"recommendation",title:"í”„ë¡œì íŠ¸ ê¸°ë³¸ ì„¤ì •",description:"ì´ì „ ë°œì£¼ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ìžì£¼ ì‚¬ìš©í•˜ëŠ” ì„¤ì •ì„ ì ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",action:{label:"ê¸°ë³¸ê°’ ì ìš©",data:{notes:"ìƒì°¨ í›„ ì—°ë½ ìš”ë§",deliveryLocation:"í˜„ìž¥ ì§ë‚©"}},priority:"medium"}),s.totalAmount>1e7&&f.push({id:"amount-check",type:"info",title:"ê³ ì•¡ ë°œì£¼ì„œ",description:"1ì²œë§Œì› ì´ìƒì˜ ë°œì£¼ì„œìž…ë‹ˆë‹¤. ê²°ìž¬ ìŠ¹ì¸ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",priority:"medium"}),s.vendorName&&s.vendorName.length>2&&["(ì£¼)ABCê±´ì„¤","(ì£¼)ABCì¢…í•©ê±´ì„¤"].length>0&&f.push({id:"similar-vendors",type:"recommendation",title:"ìœ ì‚¬ ê±°ëž˜ì²˜ ë°œê²¬",description:`'${s.vendorName}'ì™€ ìœ ì‚¬í•œ ê±°ëž˜ì²˜ê°€ ìžˆìŠµë‹ˆë‹¤. í™•ì¸í•´ë³´ì„¸ìš”.`,priority:"low"}),r(f.filter(T=>!l.has(T.id))),c(!1)},o=f=>{f.action&&(a(f.action.data),w(f.id))},w=f=>{i(T=>new Set(T).add(f)),r(T=>T.filter(O=>O.id!==f))},p=f=>{switch(f){case"warning":return e.jsx(it,{className:"w-5 h-5 text-yellow-600"});case"info":return e.jsx(Ms,{className:"w-5 h-5 text-blue-600"});case"recommendation":return e.jsx(rr,{className:"w-5 h-5 text-green-600"});case"autofill":return e.jsx($r,{className:"w-5 h-5 text-purple-600"});default:return e.jsx(Ms,{className:"w-5 h-5 text-gray-600"})}},m=f=>{switch(f){case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";case"recommendation":return"bg-green-50 border-green-200";case"autofill":return"bg-purple-50 border-purple-200";default:return"bg-gray-50 border-gray-200"}};return t.length===0&&!n?null:e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx($r,{className:"w-5 h-5 text-yellow-500"}),"ìŠ¤ë§ˆíŠ¸ ì–´ì‹œìŠ¤íŠ¸"]}),n&&e.jsx(lt,{className:"w-4 h-4 text-gray-500 animate-spin"})]})}),e.jsxs(q,{className:"space-y-3",children:[t.sort((f,T)=>{const O={high:0,medium:1,low:2};return O[f.priority]-O[T.priority]}).map(f=>e.jsx(As,{className:`${m(f.type)} border`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[p(f.type),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-medium text-sm",children:f.title}),f.priority==="high"&&e.jsx(B,{variant:"destructive",className:"text-xs",children:"ì¤‘ìš”"})]}),e.jsx(Ss,{className:"text-xs",children:f.description}),f.action&&e.jsxs(b,{size:"sm",variant:"outline",className:"mt-2",onClick:()=>o(f),children:[f.action.label,e.jsx(ft,{className:"w-3 h-3 ml-1"})]})]}),e.jsx(b,{size:"sm",variant:"ghost",className:"text-gray-400 hover:text-gray-600 h-6 w-6 p-0",onClick:()=>w(f.id),children:"Ã—"})]})},f.id)),t.length===0&&!n&&e.jsxs("div",{className:"text-center py-4 text-sm text-gray-500",children:[e.jsx(pe,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),"ëª¨ë“  í•­ëª©ì´ ì˜¬ë°”ë¥´ê²Œ ìž…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤"]})]})]})},Oh=()=>{const{toast:s}=Ze(),[a,t]=d.useState(null),[r,l]=d.useState({}),[i,n]=d.useState({pdf:"idle",vendor:"idle",email:"idle",order:"idle"}),[c,g]=d.useState(null),[o,w]=d.useState(!1),[p,m]=d.useState(!1);d.useEffect(()=>{if(p&&r.orderNumber){const x=setTimeout(()=>{f()},2e3);return()=>clearTimeout(x)}},[r,p]),d.useEffect(()=>{if(r.orderNumber&&r.vendorName&&r.projectName&&r.items?.length>0){const x=setTimeout(()=>{T()},500);return()=>clearTimeout(x)}},[r.orderNumber,r.vendorName,r.projectName,r.items]);const f=async()=>{w(!0);try{localStorage.setItem("draftOrder",JSON.stringify(r)),m(!1)}catch(x){console.error("Auto-save failed:",x)}finally{w(!1)}},T=async()=>{if(r.orderNumber){console.log("ðŸ”µ PDF ìƒì„± ì‹œìž‘:",r),n(x=>({...x,pdf:"processing"}));try{const x=r.totalAmount||(r.items||[]).reduce((N,j)=>N+(j.quantity||0)*(j.unitPrice||0),0),D={...r,totalAmount:x};console.log("ðŸ”µ PDF ìƒì„± ìš”ì²­ ë°ì´í„°:",D);const u=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderData:D})});if(u.ok){const N=await u.json();console.log("ðŸ”µ PDF ìƒì„± ì‘ë‹µ:",N);const j=N.pdfUrl.startsWith("http")?N.pdfUrl:`${window.location.origin}${N.pdfUrl}`;console.log("ðŸ”µ PDF URL:",j),g(j),n(h=>({...h,pdf:"completed"})),fetch(j,{method:"HEAD"}).then(h=>{console.log("ðŸ”µ PDF ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸:",h.status,h.headers.get("content-type"))}).catch(h=>{console.error("ðŸ”´ PDF ì ‘ê·¼ ì‹¤íŒ¨:",h)})}else{const N=await u.text();throw console.error("ðŸ”´ PDF ìƒì„± ì‹¤íŒ¨ ì‘ë‹µ:",u.status,N),new Error(`PDF ìƒì„± ì‹¤íŒ¨: ${u.status}`)}}catch(x){n(D=>({...D,pdf:"error"})),console.error("ðŸ”´ PDF generation error:",x)}}},O=x=>{t(x);const D=localStorage.getItem("draftOrder");if(D){const u=JSON.parse(D);window.confirm("ì €ìž¥ëœ ìž„ì‹œ ìž‘ì—…ì´ ìžˆìŠµë‹ˆë‹¤. ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?")&&l(u)}},E=x=>{l(D=>({...D,...x})),m(!0),x.vendorName&&x.vendorName!==r.vendorName&&F(x.vendorName)},v=x=>{l(D=>({...D,processedExcelUrl:x.url,originalFileName:x.name}))},F=async x=>{n(D=>({...D,vendor:"processing"}));try{const D=await fetch("/api/vendors/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({vendorName:x})});if(D.ok){const u=await D.json();u.isValid?(n(N=>({...N,vendor:"completed"})),u.vendorEmail&&l(N=>({...N,vendorEmail:u.vendorEmail}))):n(N=>({...N,vendor:"error"}))}}catch{n(u=>({...u,vendor:"error"}))}},_=async()=>{if(!r.orderNumber||!r.vendorName||!r.projectName||!r.items?.length){s({title:"ìƒì„± ë¶ˆê°€",description:"í•„ìˆ˜ ì •ë³´ë¥¼ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}n(x=>({...x,order:"processing"}));try{const x=await fetch("/api/auth/me");if(console.log("ðŸ” ì¸ì¦ ìƒíƒœ í™•ì¸:",x.status),!x.ok){console.error("ðŸ”´ ì¸ì¦ ì‹¤íŒ¨ - ë¡œê·¸ì¸ í•„ìš”"),s({title:"ì¸ì¦ í•„ìš”",description:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ íŽ˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.",variant:"destructive"}),setTimeout(()=>{window.location.href="/login"},2e3);return}const D=await x.json();console.log("ðŸ” í˜„ìž¬ ì‚¬ìš©ìž:",D)}catch(x){console.error("ðŸ”´ ì¸ì¦ í™•ì¸ ì‹¤íŒ¨:",x)}try{console.log("ðŸŸ¢ ë°œì£¼ì„œ ìƒì„± ì‹œìž‘:",r);const x=new FormData;x.append("projectId","1"),x.append("vendorId","1"),x.append("deliveryDate",r.deliveryDate||new Date().toISOString()),x.append("notes",r.notes||`í†µí•© ì›Œí¬í”Œë¡œìš° V2ë¡œ ìƒì„±ëœ ë°œì£¼ì„œ - ${r.orderNumber}`);const D=(r.items||[]).map(N=>({itemName:N.name||N.itemName||"",quantity:parseFloat(N.quantity||"0"),unitPrice:parseFloat(N.unitPrice||"0"),unit:N.unit||"EA",totalAmount:parseFloat(N.quantity||"0")*parseFloat(N.unitPrice||"0")}));x.append("items",JSON.stringify(D)),console.log("ðŸŸ¢ ë°œì£¼ì„œ ìƒì„± ìš”ì²­ ë°ì´í„°:",{projectId:"1",vendorId:"1",deliveryDate:r.deliveryDate||new Date().toISOString(),notes:r.notes||`í†µí•© ì›Œí¬í”Œë¡œìš° V2ë¡œ ìƒì„±ëœ ë°œì£¼ì„œ - ${r.orderNumber}`,items:D});const u=await fetch("/api/orders",{method:"POST",body:x});if(console.log("ðŸŸ¢ ë°œì£¼ì„œ ìƒì„± ì‘ë‹µ ìƒíƒœ:",u.status),u.ok){const N=await u.json();console.log("ðŸŸ¢ ìƒì„±ëœ ë°œì£¼ì„œ:",N),n(j=>({...j,order:"completed"})),s({title:"ìƒì„± ì™„ë£Œ",description:`ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. (${N.orderNumber||r.orderNumber})`}),localStorage.removeItem("draftOrder"),setTimeout(()=>{window.location.href="/orders"},3e3)}else{const N=await u.text();console.error("ðŸ”´ ë°œì£¼ì„œ ìƒì„± ì‹¤íŒ¨ ì‘ë‹µ:",u.status,N);let j="ë°œì£¼ì„œ ìƒì„± ì‹¤íŒ¨";try{j=JSON.parse(N).message||j}catch{j=`HTTP ${u.status}: ${N}`}throw new Error(j)}}catch(x){n(D=>({...D,order:"error"})),s({title:"ìƒì„± ì‹¤íŒ¨",description:x instanceof Error?x.message:"ë°œì£¼ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}},k=async()=>{if(!r.vendorEmail){s({title:"ë°œì†¡ ë¶ˆê°€",description:"ìˆ˜ì‹ ìž ì´ë©”ì¼ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}n(x=>({...x,email:"processing"}));try{if((await fetch("/api/orders/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderData:r,pdfUrl:c||null,recipients:[r.vendorEmail]})})).ok)n(D=>({...D,email:"completed"})),s({title:"ë°œì†¡ ì™„ë£Œ",description:"ë°œì£¼ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."}),localStorage.removeItem("draftOrder"),setTimeout(()=>{window.location.href="/orders"},3e3);else throw new Error("ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨")}catch{n(D=>({...D,email:"error"})),s({title:"ë°œì†¡ ì‹¤íŒ¨",description:"ì´ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}},A=()=>{const x=Object.values(i);return x.filter(u=>u==="completed").length/x.length*100};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ë°œì£¼ì„œ ìž‘ì„± V2"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"í•œ í™”ë©´ì—ì„œ ëª¨ë“  ìž‘ì—…ì„ ì™„ë£Œí•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsxs(B,{variant:"secondary",className:"animate-pulse",children:[e.jsx($s,{className:"w-3 h-3 mr-1 animate-spin"}),"ìžë™ ì €ìž¥ ì¤‘..."]}),!o&&!p&&r.orderNumber&&e.jsxs(B,{variant:"secondary",className:"bg-green-50 text-green-700",children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),"ì €ìž¥ë¨"]}),e.jsx(Zt,{value:A(),className:"w-32 h-2"})]})]})})}),e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[!a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 max-w-4xl mx-auto",children:[e.jsx(L,{className:"cursor-pointer hover:shadow-lg transition-shadow border-2 hover:border-blue-500",onClick:()=>O("excel"),children:e.jsxs(q,{className:"p-8 text-center",children:[e.jsx(Vs,{className:"w-16 h-16 mx-auto mb-4 text-blue-600"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"}),e.jsx("p",{className:"text-gray-600",children:"ê¸°ì¡´ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë¹ ë¥´ê²Œ ìž‘ì„±"})]})}),e.jsx(L,{className:"cursor-pointer hover:shadow-lg transition-shadow border-2 hover:border-green-500",onClick:()=>O("direct"),children:e.jsxs(q,{className:"p-8 text-center",children:[e.jsx(ye,{className:"w-16 h-16 mx-auto mb-4 text-green-600"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"ì§ì ‘ ìž…ë ¥"}),e.jsx("p",{className:"text-gray-600",children:"í¼ì„ í†µí•´ ì§ì ‘ ì •ë³´ ìž…ë ¥"})]})})]}),a&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{window.confirm("ë°©ë²•ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ìž…ë ¥í•œ ë‚´ìš©ì€ ì €ìž¥ë©ë‹ˆë‹¤.")&&(f(),t(null))},children:"ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ë³€ê²½"}),e.jsx(L,{children:e.jsxs(q,{className:"p-6",children:[a==="excel"&&e.jsx(Ah,{onDataExtracted:E,onProcessedFileReady:v}),a==="direct"&&e.jsx(Th,{initialData:r,onChange:E})]})}),e.jsx(Ih,{orderData:r,onSuggestionApply:E})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(Ph,{orderData:r,pdfUrl:c,processingStatus:i})})]}),a&&r.orderNumber&&e.jsx(Eh,{orderData:r,pdfUrl:c,processingStatus:i,onSave:f,onSend:k,onCreateOrder:_,onDownload:()=>{c&&window.open(`${c}?download=true`,"_blank")}})]})]})},Fh=Object.freeze(Object.defineProperty({__proto__:null,default:Oh},Symbol.toStringTag,{value:"Module"})),Mh=ve.object({name:ve.string().min(1,"ê±°ëž˜ì²˜ëª…ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”"),businessNumber:ve.string().optional(),industry:ve.string().optional(),contactPerson:ve.string().optional(),phone:ve.string().optional(),email:ve.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”").optional().or(ve.literal("")),address:ve.string().optional(),memo:ve.string().optional(),isActive:ve.boolean()});function $h(){const{user:s,isAuthenticated:a,isLoading:t}=os(),{toast:r}=Ze(),[,l]=Je(),i=us(),[n,c]=Sn("/vendors/:id/edit"),g=c?.id?parseInt(c.id):0;d.useEffect(()=>{if(!t&&(!a||s?.role!=="admin")){r({title:"ê¶Œí•œ ì—†ìŒ",description:"ê´€ë¦¬ìžë§Œ ì ‘ê·¼í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",variant:"destructive"}),setTimeout(()=>{l("/vendors")},500);return}},[a,t,s,r,l]);const{data:o,isLoading:w}=se({queryKey:[`/api/vendors/${g}`],enabled:!!s&&s.role==="admin"}),p=or({resolver:pd(Mh),defaultValues:{name:"",businessNumber:"",industry:"",contactPerson:"",phone:"",email:"",address:"",memo:"",isActive:!0}});d.useEffect(()=>{o&&p.reset({name:o.name||"",businessNumber:o.businessNumber||"",industry:o.industry||"",contactPerson:o.contactPerson||"",phone:o.phone||"",email:o.email||"",address:o.address||"",memo:o.memo||"",isActive:o.isActive??!0})},[o,p]);const m=Ce({mutationFn:async T=>await me("PATCH",`/api/vendors/${g}`,T),onSuccess:()=>{r({title:"ì„±ê³µ",description:"ê±°ëž˜ì²˜ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),i.invalidateQueries({queryKey:[`/api/vendors/${g}`]}),i.invalidateQueries({queryKey:["/api/vendors"]}),l(`/vendors/${g}`)},onError:T=>{if(Ht(T)){r({title:"ê¶Œí•œ ì—†ìŒ",description:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",variant:"destructive"}),setTimeout(()=>{l("/login")},500);return}r({title:"ì˜¤ë¥˜",description:"ê±°ëž˜ì²˜ ì •ë³´ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});if(t||!s||s.role!=="admin")return e.jsx("div",{children:"Loading..."});if(w)return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded"})]})});if(!o)return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ê±°ëž˜ì²˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ìš”ì²­í•˜ì‹  ê±°ëž˜ì²˜ ì •ë³´ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."}),e.jsx(b,{onClick:()=>l("/vendors"),children:"ê±°ëž˜ì²˜ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})});const f=T=>{m.mutate(T)};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ds,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ê±°ëž˜ì²˜ ì •ë³´ ìˆ˜ì •"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.name})]})]}),e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>l(`/vendors/${g}`),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ë’¤ë¡œ ê°€ê¸°"]})]})}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center text-lg font-semibold",children:[e.jsx(cs,{className:"h-5 w-5 mr-2"}),"ê±°ëž˜ì²˜ ì •ë³´"]})}),e.jsx(q,{children:e.jsx(jr,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(f),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Oe,{control:p.control,name:"name",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ê±°ëž˜ì²˜ëª… *"}),e.jsx(Te,{children:e.jsx(U,{...T,placeholder:"ê±°ëž˜ì²˜ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"businessNumber",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì‚¬ì—…ìžë²ˆí˜¸"}),e.jsx(Te,{children:e.jsx(U,{...T,placeholder:"ì‚¬ì—…ìžë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"industry",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì—…ì¢…"}),e.jsx(Te,{children:e.jsx(U,{...T,placeholder:"ì—…ì¢…ì„ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"contactPerson",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ë‹´ë‹¹ìž"}),e.jsx(Te,{children:e.jsx(U,{...T,placeholder:"ë‹´ë‹¹ìžëª…ì„ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"phone",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì „í™”ë²ˆí˜¸"}),e.jsx(Te,{children:e.jsx(U,{...T,placeholder:"ì „í™”ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"email",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì´ë©”ì¼"}),e.jsx(Te,{children:e.jsx(U,{...T,type:"email",placeholder:"ì´ë©”ì¼ì„ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})})]}),e.jsx(Oe,{control:p.control,name:"address",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì£¼ì†Œ"}),e.jsx(Te,{children:e.jsx(U,{...T,placeholder:"ì£¼ì†Œë¥¼ ìž…ë ¥í•˜ì„¸ìš”"})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"memo",render:({field:T})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ë©”ëª¨"}),e.jsx(Te,{children:e.jsx(Ge,{...T,placeholder:"ë©”ëª¨ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",rows:3})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:p.control,name:"isActive",render:({field:T})=>e.jsxs(De,{className:"flex items-center space-x-3",children:[e.jsx(Ae,{children:"í™œì„± ìƒíƒœ"}),e.jsx(Te,{children:e.jsx(Gs,{checked:T.value,onCheckedChange:T.onChange})}),e.jsx(Pe,{})]})}),e.jsxs("div",{className:"flex items-center space-x-4 pt-6",children:[e.jsxs(b,{type:"submit",disabled:m.isPending,className:"flex items-center",children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),m.isPending?"ì €ìž¥ ì¤‘...":"ì €ìž¥"]}),e.jsx(b,{type:"button",variant:"outline",onClick:()=>l(`/vendors/${g}`),children:"ì·¨ì†Œ"})]})]})})})]})]})})}const Rh=Object.freeze(Object.defineProperty({__proto__:null,default:$h},Symbol.toStringTag,{value:"Module"}));function za({title:s,description:a,actionLabel:t,onAction:r,action:l,children:i,showAction:n=!0}){return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[s&&e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:s}),a&&e.jsx("p",{className:"text-sm text-gray-600",children:a}),i]}),n&&(l||t&&r)&&e.jsx("div",{className:"flex gap-2 mt-3 sm:mt-0",children:l||e.jsxs(b,{size:"sm",className:"h-8 text-sm",onClick:r,children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),t]})})]})}Ye("sessions",{sid:ae("sid").primaryKey(),sess:Cs("sess").notNull(),expire:ue("expire").notNull()},s=>[be("IDX_session_expire").on(s.expire)]);const Pi=Ye("ui_terms",{id:ss("id").primaryKey(),termKey:ae("term_key",{length:100}).notNull().unique(),termValue:ae("term_value",{length:255}).notNull(),category:ae("category",{length:50}).default("general"),description:Xe("description"),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),Lh=Ye("item_categories",{id:ss("id").primaryKey(),categoryType:ae("category_type",{length:20}).notNull(),categoryName:ae("category_name",{length:100}).notNull(),parentId:He("parent_id"),displayOrder:He("display_order").default(0),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_item_categories_type").on(s.categoryType),be("idx_item_categories_parent").on(s.parentId)]),_r=Kt("user_role",["field_worker","project_manager","hq_management","executive","admin"]),zh=Kt("purchase_order_status",["draft","pending","approved","sent","completed"]),qh=Kt("project_status",["planning","active","on_hold","completed","cancelled"]),Vh=Kt("project_type",["commercial","residential","industrial","infrastructure"]),Kh=Kt("invoice_status",["pending","verified","paid"]),Uh=Kt("item_receipt_status",["pending","approved","rejected"]),Bh=Kt("verification_action",["invoice_uploaded","item_verified","quality_checked"]),Qh=Ye("approval_authorities",{id:ss("id").primaryKey(),role:_r("role").notNull(),maxAmount:xt("max_amount",{precision:15,scale:2}).notNull(),description:Xe("description"),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[kn("unique_role_approval").on(s.role)]),Os=Ye("users",{id:ae("id").primaryKey().notNull(),email:ae("email").unique().notNull(),name:ae("name").notNull(),password:ae("hashed_password").notNull(),phoneNumber:ae("phone_number"),profileImageUrl:ae("profile_image_url"),role:_r("role").notNull().default("field_worker"),position:ae("position"),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_users_email").on(s.email),be("idx_users_role").on(s.role)]),Ei=Ye("companies",{id:ss("id").primaryKey(),companyName:ae("company_name",{length:255}).notNull(),businessNumber:ae("business_number",{length:50}),address:Xe("address"),contactPerson:ae("contact_person",{length:100}),phone:ae("phone",{length:50}),email:ae("email",{length:255}),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),Ii=Ye("vendors",{id:ss("id").primaryKey(),name:ae("name",{length:255}).notNull(),vendorCode:ae("vendor_code",{length:50}),aliases:Cs("aliases").default([]).$type(),businessNumber:ae("business_number",{length:50}),contactPerson:ae("contact_person",{length:100}).notNull(),email:ae("email",{length:255}).notNull(),phone:ae("phone",{length:50}),address:Xe("address"),businessType:ae("business_type",{length:100}),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_vendors_name").on(s.name),be("idx_vendors_business_number").on(s.businessNumber),be("idx_vendors_email").on(s.email),be("idx_vendors_active").on(s.isActive)]),Hh=Ye("items",{id:ss("id").primaryKey(),name:ae("name",{length:255}).notNull(),specification:Xe("specification"),unit:ae("unit",{length:50}).notNull(),unitPrice:xt("unit_price",{precision:15,scale:2}),category:ae("category",{length:100}),majorCategory:ae("major_category",{length:100}),middleCategory:ae("middle_category",{length:100}),minorCategory:ae("minor_category",{length:100}),description:Xe("description"),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_items_name").on(s.name),be("idx_items_category").on(s.category),be("idx_items_active").on(s.isActive)]),Wh=Ye("terminology",{id:ss("id").primaryKey(),termKey:ae("term_key",{length:100}).notNull().unique(),termValue:ae("term_value",{length:255}).notNull(),category:ae("category",{length:100}),description:Xe("description"),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_terminology_key").on(s.termKey),be("idx_terminology_category").on(s.category),be("idx_terminology_active").on(s.isActive)]),qa=Ye("projects",{id:ss("id").primaryKey(),projectName:ae("project_name",{length:255}).notNull(),projectCode:ae("project_code",{length:100}).notNull().unique(),clientName:ae("client_name",{length:255}),projectType:Vh("project_type").notNull().default("commercial"),location:Xe("location"),startDate:ba("start_date"),endDate:ba("end_date"),status:qh("status").notNull().default("active"),totalBudget:xt("total_budget",{precision:15,scale:2}),projectManagerId:ae("project_manager_id").references(()=>Os.id),orderManagerId:ae("order_manager_id").references(()=>Os.id),description:Xe("description"),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_projects_name").on(s.projectName),be("idx_projects_code").on(s.projectCode),be("idx_projects_status").on(s.status),be("idx_projects_start_date").on(s.startDate),be("idx_projects_active").on(s.isActive),be("idx_projects_manager").on(s.projectManagerId)]),Gh=Ye("project_members",{id:ss("id").primaryKey(),projectId:He("project_id").references(()=>qa.id,{onDelete:"cascade"}).notNull(),userId:ae("user_id").references(()=>Os.id,{onDelete:"cascade"}).notNull(),role:ae("role",{length:50}).notNull(),assignedAt:ue("assigned_at").defaultNow(),assignedBy:ae("assigned_by").references(()=>Os.id),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[kn("project_members_project_user_unique").on(s.projectId,s.userId)]),Jh=Ye("project_history",{id:ss("id").primaryKey(),projectId:He("project_id").references(()=>qa.id,{onDelete:"cascade"}).notNull(),fieldName:ae("field_name",{length:100}).notNull(),oldValue:Xe("old_value"),newValue:Xe("new_value"),changedBy:ae("changed_by").references(()=>Os.id).notNull(),changedAt:ue("changed_at").defaultNow(),changeReason:Xe("change_reason")}),xa=Ye("order_templates",{id:ss("id").primaryKey(),templateName:ae("template_name",{length:100}).notNull(),templateType:ae("template_type",{length:50}).notNull(),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),Yh=Ye("template_fields",{id:ss("id").primaryKey(),templateId:He("template_id").references(()=>xa.id,{onDelete:"cascade"}),fieldType:ae("field_type",{length:50}).notNull(),fieldName:ae("field_name",{length:100}).notNull(),label:ae("label",{length:255}).notNull(),placeholder:ae("placeholder",{length:255}),required:ms("required").default(!1),validation:Cs("validation"),options:Cs("options"),gridPosition:Cs("grid_position").notNull(),sectionName:ae("section_name",{length:100}).notNull(),sortOrder:He("sort_order").default(0),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),Zh=Ye("handsontable_configs",{id:ss("id").primaryKey(),templateId:He("template_id").references(()=>xa.id,{onDelete:"cascade"}),colHeaders:Cs("col_headers").notNull(),columns:Cs("columns").notNull(),rowsCount:He("rows_count").default(10),formulas:Cs("formulas"),validationRules:Cs("validation_rules"),customStyles:Cs("custom_styles"),settings:Cs("settings"),sortOrder:He("sort_order").default(0),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),Xh=Ye("template_versions",{id:ss("id").primaryKey(),templateId:He("template_id").references(()=>xa.id,{onDelete:"cascade"}),versionNumber:ae("version_number",{length:20}).notNull(),changes:Cs("changes"),templateConfig:Cs("template_config").notNull(),createdBy:ae("created_by",{length:255}),createdAt:ue("created_at").defaultNow()}),Ut=Ye("purchase_orders",{id:ss("id").primaryKey(),orderNumber:ae("order_number",{length:50}).notNull().unique(),projectId:He("project_id").references(()=>qa.id).notNull(),vendorId:He("vendor_id").references(()=>Ii.id),userId:ae("user_id").references(()=>Os.id).notNull(),templateId:He("template_id").references(()=>xa.id),orderDate:ba("order_date").notNull(),deliveryDate:ba("delivery_date"),status:zh("status").notNull().default("pending"),totalAmount:xt("total_amount",{precision:15,scale:2}).default("0").$type(),notes:Xe("notes"),isApproved:ms("is_approved").default(!1),approvedBy:ae("approved_by").references(()=>Os.id),approvedAt:ue("approved_at"),currentApproverRole:_r("current_approver_role"),approvalLevel:He("approval_level").default(1),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()},s=>[be("idx_purchase_orders_number").on(s.orderNumber),be("idx_purchase_orders_project").on(s.projectId),be("idx_purchase_orders_vendor").on(s.vendorId),be("idx_purchase_orders_user").on(s.userId),be("idx_purchase_orders_status").on(s.status),be("idx_purchase_orders_date").on(s.orderDate),be("idx_purchase_orders_delivery").on(s.deliveryDate),be("idx_purchase_orders_created").on(s.createdAt),be("idx_purchase_orders_approver").on(s.currentApproverRole)]),Oi=Ye("purchase_order_items",{id:ss("id").primaryKey(),orderId:He("order_id").references(()=>Ut.id).notNull(),itemName:ae("item_name",{length:255}).notNull(),specification:Xe("specification"),unit:ae("unit",{length:50}),quantity:xt("quantity",{precision:10,scale:2}).notNull().$type(),unitPrice:xt("unit_price",{precision:15,scale:2}).notNull().$type(),totalAmount:xt("total_amount",{precision:15,scale:2}).notNull().$type(),majorCategory:ae("major_category",{length:100}),middleCategory:ae("middle_category",{length:100}),minorCategory:ae("minor_category",{length:100}),notes:Xe("notes"),createdAt:ue("created_at").defaultNow()},s=>[be("idx_poi_major_category").on(s.majorCategory),be("idx_poi_middle_category").on(s.middleCategory),be("idx_poi_minor_category").on(s.minorCategory),be("idx_poi_category_hierarchy").on(s.majorCategory,s.middleCategory,s.minorCategory)]),eu=Ye("attachments",{id:ss("id").primaryKey(),orderId:He("order_id").references(()=>Ut.id).notNull(),originalName:ae("original_name",{length:255}).notNull(),storedName:ae("stored_name",{length:255}).notNull(),filePath:ae("file_path",{length:500}).notNull(),fileSize:He("file_size"),mimeType:ae("mime_type",{length:100}),uploadedBy:ae("uploaded_by",{length:50}),uploadedAt:ue("uploaded_at").defaultNow()}),su=Ye("order_history",{id:ss("id").primaryKey(),orderId:He("order_id").references(()=>Ut.id).notNull(),userId:ae("user_id").references(()=>Os.id).notNull(),action:ae("action",{length:100}).notNull(),changes:Cs("changes"),createdAt:ue("created_at").defaultNow()}),tu=Ye("email_send_history",{id:ss("id").primaryKey(),orderId:He("order_id").notNull().references(()=>Ut.id,{onDelete:"cascade"}),sentAt:ue("sent_at").defaultNow().notNull(),sentBy:ae("sent_by",{length:255}).notNull().references(()=>Os.id),recipientEmail:ae("recipient_email",{length:255}).notNull(),recipientName:ae("recipient_name",{length:255}),ccEmails:Xe("cc_emails"),subject:Xe("subject").notNull(),body:Xe("body").notNull(),attachments:Cs("attachments").$type(),status:ae("status",{length:50}).notNull().default("sent"),errorMessage:Xe("error_message"),openedAt:ue("opened_at"),clickedAt:ue("clicked_at"),ipAddress:ae("ip_address",{length:50}),userAgent:Xe("user_agent"),trackingId:ae("tracking_id",{length:100}).unique(),emailProvider:ae("email_provider",{length:50}).default("naver"),messageId:ae("message_id",{length:255}),createdAt:ue("created_at").defaultNow().notNull()},s=>[be("idx_email_history_order").on(s.orderId),be("idx_email_history_sent_by").on(s.sentBy),be("idx_email_history_recipient").on(s.recipientEmail),be("idx_email_history_tracking").on(s.trackingId),be("idx_email_history_status").on(s.status),be("idx_email_history_sent_at").on(s.sentAt)]),Dr=Ye("invoices",{id:ss("id").primaryKey(),orderId:He("order_id").notNull().references(()=>Ut.id,{onDelete:"cascade"}),invoiceNumber:ae("invoice_number",{length:100}).notNull().unique(),invoiceType:ae("invoice_type",{length:20}).notNull(),issueDate:ue("issue_date").notNull(),dueDate:ue("due_date"),totalAmount:xt("total_amount",{precision:15,scale:2}).notNull().$type(),vatAmount:xt("vat_amount",{precision:15,scale:2}).default("0").$type(),status:Kh("status").notNull().default("pending"),filePath:ae("file_path",{length:500}),uploadedBy:ae("uploaded_by").notNull().references(()=>Os.id),verifiedBy:ae("verified_by").references(()=>Os.id),verifiedAt:ue("verified_at"),taxInvoiceIssued:ms("tax_invoice_issued").default(!1),taxInvoiceIssuedDate:ue("tax_invoice_issued_date"),taxInvoiceIssuedBy:ae("tax_invoice_issued_by").references(()=>Os.id),notes:Xe("notes"),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),Fi=Ye("item_receipts",{id:ss("id").primaryKey(),orderItemId:He("order_item_id").notNull().references(()=>Oi.id,{onDelete:"cascade"}),invoiceId:He("invoice_id").references(()=>Dr.id,{onDelete:"set null"}),receivedQuantity:xt("received_quantity",{precision:10,scale:2}).notNull().$type(),receivedDate:ue("received_date").notNull(),qualityCheck:ms("quality_check").default(!1),qualityNotes:Xe("quality_notes"),verifiedBy:ae("verified_by").notNull().references(()=>Os.id),status:Uh("status").notNull().default("pending"),notes:Xe("notes"),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()}),au=Ye("verification_logs",{id:ss("id").primaryKey(),orderId:He("order_id").notNull().references(()=>Ut.id,{onDelete:"cascade"}),invoiceId:He("invoice_id").references(()=>Dr.id,{onDelete:"set null"}),itemReceiptId:He("item_receipt_id").references(()=>Fi.id,{onDelete:"set null"}),action:Bh("action").notNull(),details:Xe("details"),performedBy:ae("performed_by").notNull().references(()=>Os.id),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow()});es(Ei).omit({id:!0,createdAt:!0,updatedAt:!0});es(Ii).omit({id:!0,createdAt:!0,updatedAt:!0});const xp=es(Hh).omit({id:!0,createdAt:!0,updatedAt:!0});es(qa).omit({id:!0,createdAt:!0,updatedAt:!0});es(xa).omit({id:!0,createdAt:!0,updatedAt:!0});es(Lh).omit({id:!0,createdAt:!0,updatedAt:!0});es(Ut).omit({id:!0,createdAt:!0,updatedAt:!0,orderNumber:!0,userId:!0,isApproved:!0,approvedBy:!0,approvedAt:!0}).extend({userId:ve.string().min(1),templateId:ve.number().nullable().optional(),totalAmount:ve.number().positive(),customFields:ve.record(ve.any()).optional(),items:ve.array(ve.object({itemName:ve.string().min(1),specification:ve.string().nullable().optional(),quantity:ve.number().positive(),unitPrice:ve.number().positive(),totalAmount:ve.number().positive(),notes:ve.string().nullable().optional()}))});es(Oi).omit({id:!0,createdAt:!0}).extend({supplyAmount:ve.number().nonnegative().optional(),taxAmount:ve.number().nonnegative().optional()});es(eu).omit({id:!0,uploadedAt:!0});es(su).omit({id:!0,createdAt:!0});es(Dr).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({totalAmount:ve.union([ve.string(),ve.number()]).transform(s=>String(s)),vatAmount:ve.union([ve.string(),ve.number()]).transform(s=>String(s))});es(Fi).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({receivedQuantity:ve.union([ve.string(),ve.number()]).transform(s=>Number(s)),receivedDate:ve.union([ve.string(),ve.date()]).transform(s=>new Date(s))});es(au).omit({id:!0,createdAt:!0});es(tu).omit({id:!0,sentAt:!0,createdAt:!0}).extend({ccEmails:ve.string().nullable().optional(),attachments:ve.array(ve.object({filename:ve.string(),path:ve.string(),size:ve.number()})).nullable().optional()});es(Yh).omit({id:!0,createdAt:!0,updatedAt:!0});es(Zh).omit({id:!0,createdAt:!0,updatedAt:!0});es(Xh).omit({id:!0,createdAt:!0});es(Gh).omit({id:!0,createdAt:!0,updatedAt:!0});es(Jh).omit({id:!0,changedAt:!0});es(Pi);es(Wh).omit({id:!0,createdAt:!0,updatedAt:!0});es(Pi).omit({id:!0,createdAt:!0,updatedAt:!0});es(Qh).omit({id:!0,createdAt:!0,updatedAt:!0});const ru=Ye("approval_workflow_settings",{id:ss("id").primaryKey(),companyId:He("company_id").references(()=>Ei.id),approvalMode:ae("approval_mode",{length:20}).notNull().default("staged"),directApprovalRoles:Cs("direct_approval_roles").default([]).$type(),stagedApprovalThresholds:Cs("staged_approval_thresholds").default({}).$type(),requireAllStages:ms("require_all_stages").default(!0),skipLowerStages:ms("skip_lower_stages").default(!1),isActive:ms("is_active").default(!0),createdAt:ue("created_at").defaultNow(),updatedAt:ue("updated_at").defaultNow().$onUpdate(()=>new Date),createdBy:ae("created_by",{length:255}).references(()=>Os.id)},s=>({companyIdx:be("idx_approval_workflow_company").on(s.companyId),activeIdx:be("idx_approval_workflow_active").on(s.isActive)}));es(ru).omit({id:!0,createdAt:!0,updatedAt:!0});function lu(){const{user:s}=os(),{toast:a}=Ze(),[,t]=Je(),[r,l]=d.useState(""),[i,n]=d.useState("all"),[c,g]=d.useState(null),[o,w]=d.useState("asc"),[p,m]=d.useState(!1),[f,T]=d.useState(null),[O,E]=d.useState("table"),{data:v={items:[],total:0},isLoading:F}=se({queryKey:["/api/items",{category:i==="all"?void 0:i,searchText:r}],queryFn:async()=>{const S=new URLSearchParams({limit:"1000"});i!=="all"&&S.append("category",i),r&&S.append("searchText",r);const z=await fetch(`/api/items?${S.toString()}`);if(!z.ok)throw new Error("Failed to fetch items");return z.json()}}),{data:_=[]}=se({queryKey:["/api/items/categories"]}),k=d.useMemo(()=>{if(!v.items||!Array.isArray(v.items))return[];let S=v.items;if(i!=="all"&&(S=S.filter(z=>z.category===i)),r.trim()){const z=r.toLowerCase();S=S.filter(Q=>Q.name?.toLowerCase().includes(z)||Q.category?.toLowerCase().includes(z)||Q.specification?.toLowerCase().includes(z)||Q.unit?.toLowerCase().includes(z))}return c&&(S=[...S].sort((z,Q)=>{let K=z[c],ne=Q[c];return K==null&&(K=""),ne==null&&(ne=""),c==="unitPrice"?(K=parseFloat(K||"0"),ne=parseFloat(ne||"0")):c==="createdAt"||c==="updatedAt"?(K=K?new Date(K).getTime():0,ne=ne?new Date(ne).getTime():0):(K=String(K).toLowerCase(),ne=String(ne).toLowerCase()),o==="asc"?K<ne?-1:K>ne?1:0:ne<K?-1:ne>K?1:0})),S},[v.items,i,r,c,o]),A=Ce({mutationFn:async S=>{await me("DELETE",`/api/items/${S}`)},onSuccess:()=>{a({title:"ì„±ê³µ",description:"í’ˆëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),rs.invalidateQueries({queryKey:["/api/items"]})},onError:S=>{if(S.status===401){a({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{t("/login")},500);return}a({title:"ì˜¤ë¥˜",description:"í’ˆëª© ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),x=S=>{c===S?w(o==="asc"?"desc":"asc"):(g(S),w("asc"))},D=S=>c!==S?null:o==="asc"?e.jsx(zt,{className:"h-4 w-4"}):e.jsx(Zs,{className:"h-4 w-4"}),u=()=>{T(null),m(!0)},N=S=>{T(S),m(!0)},j=S=>{confirm("ì •ë§ë¡œ ì´ í’ˆëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&A.mutate(S)},h=()=>{m(!1),T(null),rs.invalidateQueries({queryKey:["/api/items"]})},I=S=>({ê°•ìž¬:"default",ê°•íŒ:"secondary",ë‹¨ì—´ìž¬:"outline",ë„ìž¥ìž¬:"destructive",ë§ˆê°ìž¬:"default",ë°©ìˆ˜ìž¬:"secondary"})[S]||"outline";return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx(za,{title:"í’ˆëª© ê´€ë¦¬",action:s?.role==="admin"?e.jsxs(b,{onClick:u,className:"flex items-center",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"í’ˆëª© ì¶”ê°€"]}):void 0}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(U,{placeholder:"í’ˆëª©ëª…, ì¹´í…Œê³ ë¦¬, ê·œê²©ìœ¼ë¡œ ê²€ìƒ‰...",value:r,onChange:S=>l(S.target.value),className:"pl-10 h-10"})]}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(Z,{value:i,onValueChange:n,children:[e.jsx(Y,{className:"h-10",children:e.jsx(X,{placeholder:"ì¹´í…Œê³ ë¦¬ ì„ íƒ"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ëª¨ë“  ì¹´í…Œê³ ë¦¬"}),_.map(S=>e.jsx(R,{value:S,children:S},S))]})]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[k.length,"ê°œ í’ˆëª©"]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(b,{variant:O==="table"?"default":"ghost",size:"sm",onClick:()=>E("table"),className:"h-8 w-8 p-0",title:"ëª©ë¡ ë³´ê¸°",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx(b,{variant:O==="cards"?"default":"ghost",size:"sm",onClick:()=>E("cards"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(gt,{className:"h-4 w-4"})})]})]})]})})}),O==="table"?e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"border-b",children:[e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>x("name"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"í’ˆëª©ëª…"}),D("name")]})}),e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>x("category"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ì¹´í…Œê³ ë¦¬"}),D("category")]})}),e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>x("specification"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ê·œê²©"}),D("specification")]})}),e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>x("unit"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ë‹¨ìœ„"}),D("unit")]})}),e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>x("standardPrice"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ë‹¨ê°€"}),D("standardPrice")]})}),e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>x("createdAt"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"ë“±ë¡ì¼"}),D("createdAt")]})}),s?.role==="admin"&&e.jsx(oe,{className:"h-11 px-4 text-sm font-semibold text-gray-700 text-right",children:"ê´€ë¦¬"})]})}),e.jsx(tt,{children:F?[...Array(5)].map((S,z)=>e.jsxs(Me,{children:[e.jsx(G,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),s?.role==="admin"&&e.jsx(G,{})]},z)):k.length===0?e.jsx(Me,{children:e.jsx(G,{colSpan:s?.role==="admin"?7:6,className:"text-center py-8 text-gray-500",children:r||i!=="all"?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ í’ˆëª©ì´ ì—†ìŠµë‹ˆë‹¤"})}):k.map(S=>e.jsxs(Me,{className:"h-12 hover:bg-gray-50 border-b border-gray-100",children:[e.jsx(G,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-800 hover:underline overflow-hidden text-ellipsis whitespace-nowrap",onClick:()=>t(`/items/${S.id}`),title:S.name,children:S.name})}),e.jsx(G,{className:"py-2 px-4",children:S.category?e.jsx(B,{variant:I(S.category),className:"text-xs",children:S.category}):"-"}),e.jsx(G,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 max-w-32 truncate",title:S.specification,children:S.specification||"-"})}),e.jsx(G,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:S.unit||"-"})}),e.jsx(G,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm font-semibold text-blue-600",children:Ee(S.standardPrice)})}),e.jsx(G,{className:"py-2 px-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:Ds(S.createdAt)})}),s?.role==="admin"&&e.jsx(G,{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>N(S),className:"h-7 w-7 p-0",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>j(S.id),className:"h-7 w-7 p-0 text-red-600 hover:text-red-700",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})})]},S.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:F?[...Array(6)].map((S,z)=>e.jsx(L,{className:"p-6 shadow-sm",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},z)):k.length===0?e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:r||i!=="all"?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë“±ë¡ëœ í’ˆëª©ì´ ì—†ìŠµë‹ˆë‹¤"}):k.map(S=>e.jsxs(L,{className:"p-4 hover:shadow-md transition-shadow shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 cursor-pointer hover:text-blue-600 truncate",onClick:()=>t(`/items/${S.id}`),children:S.name}),S.category&&e.jsx(B,{variant:I(S.category),className:"text-xs mt-1",children:S.category})]}),S.specification&&e.jsx(B,{variant:"outline",className:"text-xs ml-2 flex-shrink-0 max-w-[120px] truncate",title:S.specification,children:S.specification})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(wn,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ê·œê²©:"}),e.jsx("span",{className:"ml-1",children:S.specification||"-"})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(Cn,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ë‹¨ìœ„:"}),e.jsx("span",{className:"ml-1",children:S.unit||"-"})]}),e.jsxs("div",{className:"flex items-center text-sm gap-2",children:[e.jsx(Xs,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-600",children:"ë‹¨ê°€:"}),e.jsx("span",{className:"ml-1 font-semibold text-blue-600",children:Ee(S.standardPrice)})]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:e.jsxs("span",{children:["ë“±ë¡ì¼: ",Ds(S.createdAt)]})}),s?.role==="admin"&&e.jsxs("div",{className:"flex items-center justify-end -space-x-1 pt-2 border-t",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>N(S),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>j(S.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})]},S.id))}),p&&e.jsx(id,{isOpen:p,item:f,onClose:()=>m(!1),onSuccess:h})]})})}const nu=Object.freeze(Object.defineProperty({__proto__:null,default:lu},Symbol.toStringTag,{value:"Module"}));function iu(){const{id:s}=ht(),[,a]=Je(),{data:t,isLoading:r,error:l}=se({queryKey:[`/api/items/${s}`],enabled:!!s});if(r)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-96 bg-gray-200 rounded"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded"})]})]})});if(l||!t)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"í’ˆëª©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ìš”ì²­í•˜ì‹  í’ˆëª©ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."}),e.jsxs(b,{onClick:()=>a("/items"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"í’ˆëª© ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"]})]})});const i=n=>({ê°•ìž¬:"bg-blue-100 text-blue-800",ê°•íŒ:"bg-slate-100 text-slate-800",ë‹¨ì—´ìž¬:"bg-green-100 text-green-800",ë„ìž¥ìž¬:"bg-purple-100 text-purple-800",ë§ˆê°ìž¬:"bg-yellow-100 text-yellow-800",ë°©ìˆ˜ìž¬:"bg-cyan-100 text-cyan-800",ë¶€ì†í’ˆ:"bg-orange-100 text-orange-800",ë³¼íŠ¸:"bg-gray-100 text-gray-800",ì‚¬ê°ê°•ê´€:"bg-indigo-100 text-indigo-800",ì‹œíŠ¸:"bg-pink-100 text-pink-800",ì•µê¸€:"bg-emerald-100 text-emerald-800",ìš©ì ‘ìž¬:"bg-red-100 text-red-800",ì „ì„ :"bg-amber-100 text-amber-800",ì² ê·¼:"bg-stone-100 text-stone-800",íŒŒì´í”„:"bg-teal-100 text-teal-800"})[n]||"bg-gray-100 text-gray-800";return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>a("/items"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëª©ë¡"]}),e.jsx(Es,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"í’ˆëª© ìƒì„¸ ì •ë³´"})]}),e.jsx(B,{className:i(t.category),children:t.category})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(b,{variant:"outline",size:"sm",onClick:()=>a("/items"),children:"ëª©ë¡ìœ¼ë¡œ"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Ct,{className:"h-5 w-5 text-blue-600"}),"ê¸°ë³¸ ì •ë³´"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ct,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"í’ˆëª©ëª…"})]}),e.jsx("p",{className:"text-sm text-gray-900",children:t.name})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(cs,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"ì¹´í…Œê³ ë¦¬"})]}),e.jsx(B,{className:i(t.category),children:t.category})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(wn,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"ê·œê²©"})]}),e.jsx("p",{className:"text-sm text-gray-900",children:t.specification||"-"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Cn,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"ë‹¨ìœ„"})]}),e.jsx("p",{className:"text-sm text-gray-900",children:t.unit})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Xs,{className:"h-5 w-5 text-blue-600"}),"ê°€ê²© ì •ë³´"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Xs,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"ë‹¨ê°€"})]}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:Ee(t.unitPrice)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_s,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"ë“±ë¡ì¼"})]}),e.jsx("p",{className:"text-sm text-gray-900",children:t.createdAt?Le(new Date(t.createdAt),"yyyy.MM.dd"):"-"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_s,{className:"h-4 w-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"ìˆ˜ì •ì¼"})]}),e.jsx("p",{className:"text-sm text-gray-900",children:t.updatedAt?Le(new Date(t.updatedAt),"yyyy.MM.dd"):"-"})]})]})]})]})]})]})})}const cu=Object.freeze(Object.defineProperty({__proto__:null,default:iu},Symbol.toStringTag,{value:"Module"}));function du(){const{id:s}=ht(),[,a]=Je(),{toast:t}=Ze();os();const[r,l]=d.useState([]),[i,n]=d.useState(!1),{data:c,isLoading:g}=se({queryKey:["/api/projects",s],queryFn:()=>fetch(`/api/projects/${s}`).then(v=>v.json()),enabled:!!s}),{data:o=[]}=se({queryKey:["/api/project-statuses"]}),{data:w=[]}=se({queryKey:["/api/project-types"]}),{data:p=[]}=se({queryKey:["/api/users"]}),{data:m=[]}=se({queryKey:["/api/project-members",{projectId:s}],queryFn:()=>fetch(`/api/project-members?projectId=${s}`).then(v=>v.json()),enabled:!!s}),f=or({defaultValues:{projectName:"",projectCode:"",clientName:"",projectType:"",location:"",status:"active",projectManagerId:"",orderManagerId:"",description:"",startDate:"",endDate:"",totalBudget:"",isActive:!0}});d.useEffect(()=>{c&&f.reset({projectName:c.projectName,projectCode:c.projectCode||"",clientName:c.clientName||"",projectType:c.projectType||"",location:c.location||"",status:c.status,projectManagerId:c.projectManagerId||"none",orderManagerId:c.orderManagerId||"none",description:c.description||"",startDate:c.startDate?new Date(c.startDate).toISOString().split("T")[0]:"",endDate:c.endDate?new Date(c.endDate).toISOString().split("T")[0]:"",totalBudget:c.totalBudget||"",isActive:c.isActive??!0})},[c,f]),d.useEffect(()=>{if(m&&m.length>0){const v=m.filter(F=>F.role==="order_manager").map(F=>F.userId);l(v)}},[m]);const T=Ce({mutationFn:async v=>me("PATCH",`/api/projects/${s}`,v),onSuccess:()=>{rs.invalidateQueries({queryKey:["/api/projects"]}),rs.invalidateQueries({queryKey:["/api/projects",s]}),t({description:"í”„ë¡œì íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),a(`/projects/${s}`)},onError:v=>{t({variant:"destructive",description:v.message||"í”„ë¡œì íŠ¸ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}}),O=async v=>{const F={...v,totalBudget:v.totalBudget?parseFloat(v.totalBudget.toString().replace(/[^\d.]/g,"")):null,startDate:v.startDate?new Date(v.startDate):null,endDate:v.endDate?new Date(v.endDate):null,projectManagerId:v.projectManagerId==="none"?null:v.projectManagerId,orderManagerId:v.orderManagerId==="none"?null:v.orderManagerId,orderManagers:r};T.mutate(F)},E=()=>{a(`/projects/${s}`)};return g?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"})]})]})}):c?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx(za,{title:"í”„ë¡œì íŠ¸ ìˆ˜ì •",description:`${c.projectName} í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤`}),e.jsxs(L,{className:"max-w-4xl shadow-sm",children:[e.jsx(H,{children:e.jsx(W,{className:"text-lg font-semibold",children:"í”„ë¡œì íŠ¸ ì •ë³´"})}),e.jsx(q,{children:e.jsx(jr,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(O),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Oe,{control:f.control,name:"projectName",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í”„ë¡œì íŠ¸ëª… *"}),e.jsx(Te,{children:e.jsx(U,{placeholder:"í”„ë¡œì íŠ¸ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",...v})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"projectCode",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í”„ë¡œì íŠ¸ ì½”ë“œ"}),e.jsx(Te,{children:e.jsx(U,{placeholder:"í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ ìž…ë ¥í•˜ì„¸ìš”",...v})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"clientName",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í´ë¼ì´ì–¸íŠ¸ëª…"}),e.jsx(Te,{children:e.jsx(U,{placeholder:"í´ë¼ì´ì–¸íŠ¸ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",...v})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"projectType",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í”„ë¡œì íŠ¸ ìœ í˜•"}),e.jsxs(Z,{onValueChange:v.onChange,value:v.value,children:[e.jsx(Te,{children:e.jsx(Y,{children:e.jsx(X,{placeholder:"í”„ë¡œì íŠ¸ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsx(ee,{children:w.map(F=>e.jsx(R,{value:F.id,children:F.name},F.id))})]}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"location",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ìœ„ì¹˜"}),e.jsx(Te,{children:e.jsx(U,{placeholder:"í”„ë¡œì íŠ¸ ìœ„ì¹˜ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",...v})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"status",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ìƒíƒœ"}),e.jsxs(Z,{onValueChange:v.onChange,value:v.value,children:[e.jsx(Te,{children:e.jsx(Y,{children:e.jsx(X,{placeholder:"ìƒíƒœë¥¼ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsx(ee,{children:o.map(F=>e.jsx(R,{value:F.id,children:F.name},F.id))})]}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"projectManagerId",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €"}),e.jsxs(Z,{onValueChange:v.onChange,value:v.value,children:[e.jsx(Te,{children:e.jsx(Y,{children:e.jsx(X,{placeholder:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €ë¥¼ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsxs(ee,{children:[e.jsx(R,{value:"none",children:"ì„ íƒ ì•ˆí•¨"}),p.map(F=>e.jsx(R,{value:F.id,children:F.name},F.id))]})]}),e.jsx(Pe,{})]})}),e.jsxs(De,{children:[e.jsx(Ae,{children:"ë°œì£¼ ë‹´ë‹¹ìž"}),e.jsx(Te,{children:e.jsxs(zs,{open:i,onOpenChange:n,children:[e.jsx(qs,{asChild:!0,children:e.jsxs(b,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[r.length===0?"ë°œì£¼ ë‹´ë‹¹ìžë¥¼ ì„ íƒí•˜ì„¸ìš”":e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.slice(0,2).map(v=>{const F=p.find(_=>_.id===v);return e.jsx(B,{variant:"secondary",className:"text-xs",children:F?.name||v},v)}),r.length>2&&e.jsxs(B,{variant:"secondary",className:"text-xs",children:["+",r.length-2,"ëª… ë”"]})]}),e.jsx(xr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Is,{className:"w-full p-0",children:e.jsxs(Oa,{children:[e.jsx(Fa,{placeholder:"ë‹´ë‹¹ìž ê²€ìƒ‰..."}),e.jsx(Ma,{children:"ë‹´ë‹¹ìžë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx($a,{children:p.map(v=>e.jsxs(Ra,{onSelect:()=>{const F=r.includes(v.id);l(F?_=>_.filter(k=>k!==v.id):_=>[..._,v.id])},children:[e.jsx(ps,{className:V("mr-2 h-4 w-4",r.includes(v.id)?"opacity-100":"opacity-0")}),v.name]},v.id))})]})})]})}),e.jsx(Pe,{}),r.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ì„ íƒëœ ë°œì£¼ ë‹´ë‹¹ìž:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.map(v=>{const F=p.find(_=>_.id===v);return e.jsxs(B,{variant:"default",className:"text-xs",children:[F?.name||v,e.jsx(b,{type:"button",variant:"ghost",size:"sm",className:"ml-1 h-3 w-3 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>{l(_=>_.filter(k=>k!==v))},children:e.jsx(ys,{className:"h-2 w-2"})})]},v)})})]})]}),e.jsx(Oe,{control:f.control,name:"startDate",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì‹œìž‘ì¼"}),e.jsx(Te,{children:e.jsx(U,{type:"date",...v})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"endDate",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì¢…ë£Œì¼"}),e.jsx(Te,{children:e.jsx(U,{type:"date",...v})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"totalBudget",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì´ ì˜ˆì‚°"}),e.jsx(Te,{children:e.jsx(U,{type:"text",placeholder:"â‚©0",value:v.value?Ee(v.value):"",onChange:F=>{const _=Dn(F.target.value);v.onChange(_.toString())},onBlur:v.onBlur,name:v.name,ref:v.ref})}),e.jsx(Pe,{})]})}),e.jsx(Oe,{control:f.control,name:"isActive",render:({field:v})=>e.jsxs(De,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(Te,{children:e.jsx(gs,{checked:v.value,onCheckedChange:v.onChange})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(Ae,{children:"í™œì„± ìƒíƒœ"})})]})})]}),e.jsx(Oe,{control:f.control,name:"description",render:({field:v})=>e.jsxs(De,{children:[e.jsx(Ae,{children:"ì„¤ëª…"}),e.jsx(Te,{children:e.jsx(Ge,{placeholder:"í”„ë¡œì íŠ¸ ì„¤ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",className:"min-h-[100px]",...v})}),e.jsx(Pe,{})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs(b,{type:"button",variant:"outline",onClick:E,disabled:T.isPending,children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"ì·¨ì†Œ"]}),e.jsxs(b,{type:"submit",disabled:T.isPending,children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),T.isPending?"ì €ìž¥ ì¤‘...":"ì €ìž¥"]})]})]})})})]})]})}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ìš”ì²­í•˜ì‹  í”„ë¡œì íŠ¸ê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsxs(b,{onClick:()=>a("/projects"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëª©ë¡ìœ¼ë¡œ"]})]})})}const ou=Object.freeze(Object.defineProperty({__proto__:null,default:du},Symbol.toStringTag,{value:"Module"}));function xu(){const{id:s}=ht(),[,a]=Je(),{data:t,isLoading:r}=se({queryKey:["/api/users",s],enabled:!!s}),{data:l=[]}=se({queryKey:["/api/positions"]}),i=o=>{if(!o)return"-";const w=l.find(p=>p.id===o);return w?w.name:"-"},n=o=>{switch(o){case"admin":return"bg-red-100 text-red-800";case"manager":return"bg-blue-100 text-blue-800";case"user":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},c=o=>{switch(o){case"admin":return"ê´€ë¦¬ìž";case"manager":return"ë§¤ë‹ˆì €";case"user":return"ì¼ë°˜ ì‚¬ìš©ìž";default:return o}};if(r)return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-8"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-40 bg-gray-200 rounded"}),e.jsx("div",{className:"h-40 bg-gray-200 rounded"})]})]})});if(!t)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"ì‚¬ìš©ìžë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ìš”ì²­í•˜ì‹  ì‚¬ìš©ìžê°€ ì¡´ìž¬í•˜ì§€ ì•Šê±°ë‚˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsxs(b,{onClick:()=>a("/admin"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ì‚¬ìš©ìž ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"]})]})});const g=t.name||`${t.firstName||""} ${t.lastName||""}`.trim()||t.email;return e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>a("/admin"),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"ëª©ë¡ìœ¼ë¡œ"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ur,{src:t.profileImageUrl||"",alt:g,size:"lg",shape:"circle",initials:g.slice(0,2),quality:90,lazy:!1,priority:!0}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:g}),e.jsx("p",{className:"text-sm text-gray-600",children:t.email})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:n(t.role),children:c(t.role)}),e.jsxs(b,{size:"sm",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"ìˆ˜ì •"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(ks,{className:"h-5 w-5 mr-2"}),"ê¸°ë³¸ ì •ë³´"]})}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ì´ë¦„"}),e.jsx("p",{className:"text-sm text-gray-900",children:g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ì´ë©”ì¼"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(Ns,{className:"h-4 w-4 mr-1"}),t.email]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ì „í™”ë²ˆí˜¸"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(Ot,{className:"h-4 w-4 mr-1"}),t.phoneNumber||"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ì§ì±…"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),i(t.positionId)]})]})]})})]}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(ur,{className:"h-5 w-5 mr-2"}),"ê¶Œí•œ ì •ë³´"]})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ì‚¬ìš©ìž ì—­í• "}),e.jsx("div",{className:"mt-1",children:e.jsx(B,{className:n(t.role),children:c(t.role)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ê³„ì • ìƒíƒœ"}),e.jsx("p",{className:"text-sm text-gray-900",children:"í™œì„±"})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(_s,{className:"h-5 w-5 mr-2"}),"ê³„ì • ì •ë³´"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ê°€ìž…ì¼"}),e.jsx("p",{className:"text-sm text-gray-900",children:t.createdAt?Ds(new Date(t.createdAt)):"-"})]}),t.updatedAt&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ìµœì¢… ìˆ˜ì •ì¼"}),e.jsx("p",{className:"text-sm text-gray-900",children:Ds(new Date(t.updatedAt))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ì‚¬ìš©ìž ID"}),e.jsx("p",{className:"text-sm text-gray-900 font-mono",children:t.id})]})]})]}),t.profileImageUrl&&e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"í”„ë¡œí•„ ì´ë¯¸ì§€"})}),e.jsx(q,{children:e.jsx(Ur,{src:t.profileImageUrl,alt:g,size:"xl",shape:"rounded",initials:g.slice(0,2),quality:95,containerClassName:"w-full max-w-md mx-auto"})})]})]})]})]})}const mu=Object.freeze(Object.defineProperty({__proto__:null,default:xu},Symbol.toStringTag,{value:"Module"}));function hu(){const{user:s,isAuthenticated:a,isLoading:t}=os(),{toast:r}=Ze(),l=us(),[,i]=Je();d.useEffect(()=>{if(!t&&!a){r({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{i("/login")},500);return}},[a,t,r,i]),d.useEffect(()=>{if(!t&&s&&s.role!=="admin"){r({title:"ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ",description:"ê´€ë¦¬ìžë§Œ ì ‘ê·¼í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",variant:"destructive"}),setTimeout(()=>{window.location.href="/"},1e3);return}},[s,t,r]);const{data:n=[],isLoading:c}=se({queryKey:["/api/users"],enabled:!!s&&s.role==="admin",retry:!1});return Ce({mutationFn:async({userId:g,role:o})=>{await me("PUT",`/api/users/${g}`,{role:o})},onSuccess:()=>{r({title:"ì‚¬ìš©ìž ì—­í•  ë³€ê²½",description:"ì‚¬ìš©ìž ì—­í• ì´ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."}),l.invalidateQueries({queryKey:["/api/users"]})},onError:g=>{if(Ht(g)){r({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{i("/login")},500);return}r({title:"ì˜¤ë¥˜",description:"ì‚¬ìš©ìž ì—­í•  ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),t||!s||s.role!=="admin"?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(za,{title:"ì‚¬ìš©ìž ê´€ë¦¬"}),e.jsx(L,{children:e.jsx(q,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"border-b bg-gray-50/50",children:[e.jsx(oe,{className:"px-3 py-1.5 text-xs font-semibold text-gray-700",children:"ì‚¬ìš©ìžëª…"}),e.jsx(oe,{className:"px-3 py-1.5 text-xs font-semibold text-gray-700",children:"ì´ë©”ì¼"}),e.jsx(oe,{className:"px-3 py-1.5 text-xs font-semibold text-gray-700",children:"ì—­í• "}),e.jsx(oe,{className:"px-3 py-1.5 text-xs font-semibold text-gray-700",children:"ì—°ë½ì²˜"}),e.jsx(oe,{className:"px-3 py-1.5 text-xs font-semibold text-gray-700",children:"ê°€ìž…ì¼"}),e.jsx(oe,{className:"px-3 py-1.5 text-xs font-semibold text-gray-700 w-[100px]",children:"ìž‘ì—…"})]})}),e.jsx(tt,{children:c?[...Array(5)].map((g,o)=>e.jsxs(Me,{className:"border-b",children:[e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-3/4"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-1/2"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-2/3"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-2/3"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-16"})})]},o)):n&&n.length>0?n.map(g=>e.jsxs(Me,{className:"border-b hover:bg-gray-50/50",children:[e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("button",{className:"text-left",onClick:()=>{},children:e.jsx("div",{className:"text-xs font-medium text-blue-600 hover:text-blue-800",children:g.name||`ì‚¬ìš©ìž ${g.id}`})})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"text-xs text-gray-600",children:g.email})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx(B,{variant:g.role==="admin"?"destructive":g.role==="order_manager"?"default":"secondary",className:"text-xs",children:g.role==="admin"?"ê´€ë¦¬ìž":g.role==="order_manager"?"ë°œì£¼ë‹´ë‹¹ìž":"ì‚¬ìš©ìž"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"text-xs text-gray-600",children:g.phoneNumber||"-"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsx("div",{className:"text-xs text-gray-600",children:g.createdAt?$x(g.createdAt):"-"})}),e.jsx(G,{className:"px-3 py-1.5",children:e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(b,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-blue-600 hover:bg-blue-50",onClick:()=>{},title:"ìˆ˜ì •",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-600 hover:bg-red-50",onClick:()=>{},title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})]})})]},g.id)):e.jsx(Me,{children:e.jsx(G,{colSpan:6,className:"py-8 text-center text-gray-500 text-xs",children:"ë“±ë¡ëœ ì‚¬ìš©ìžê°€ ì—†ìŠµë‹ˆë‹¤"})})})]})})})}),e.jsx(L,{children:e.jsxs(q,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"ì‚¬ìš©ìž ì—­í•  ì•ˆë‚´"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx(B,{variant:"destructive",className:"text-xs",children:"ê´€ë¦¬ìž"})}),e.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[e.jsx("li",{children:"â€¢ ëª¨ë“  ë°œì£¼ì„œ ì¡°íšŒ ë° ìŠ¹ì¸"}),e.jsx("li",{children:"â€¢ ê±°ëž˜ì²˜ ê´€ë¦¬ (ì¶”ê°€, ìˆ˜ì •, ì‚­ì œ)"}),e.jsx("li",{children:"â€¢ ì‚¬ìš©ìž ê¶Œí•œ ê´€ë¦¬"}),e.jsx("li",{children:"â€¢ ì‹œìŠ¤í…œ í†µê³„ ë° ë¶„ì„"})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx(B,{variant:"default",className:"text-xs",children:"ë°œì£¼ë‹´ë‹¹ìž"})}),e.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[e.jsx("li",{children:"â€¢ ë°œì£¼ì„œ ìž‘ì„± ë° ê´€ë¦¬"}),e.jsx("li",{children:"â€¢ ìžì‹ ì˜ ë°œì£¼ì„œë§Œ ì¡°íšŒ"}),e.jsx("li",{children:"â€¢ ê±°ëž˜ì²˜ ì •ë³´ ì¡°íšŒ"}),e.jsx("li",{children:"â€¢ ê°œì¸ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼"})]})]})]})]})})]})}const uu=Object.freeze(Object.defineProperty({__proto__:null,default:hu},Symbol.toStringTag,{value:"Module"}));function pu(){const{user:s,isLoading:a}=os(),{toast:t}=Ze(),[,r]=Je(),[l,i]=d.useState({name:"",email:"",role:""}),[n,c]=d.useState({emailNotifications:!0,orderAlerts:!0,language:"ko"}),[g,o]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[w,p]=d.useState(!1);d.useEffect(()=>{s&&typeof s=="object"&&i({name:s.name||"",email:s.email||"",role:s.role||""})},[s]),d.useEffect(()=>{if(!a&&!s){t({title:"ì¸ì¦ ì˜¤ë¥˜",description:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.",variant:"destructive"}),setTimeout(()=>{r("/login")},500);return}},[s,a,t]);const m=Ce({mutationFn:async E=>await me("PATCH","/api/auth/profile",{name:E.name}),onSuccess:E=>{rs.invalidateQueries({queryKey:["/api/auth/user"]}),rs.refetchQueries({queryKey:["/api/auth/user"]}),E&&typeof E=="object"&&i(v=>({...v,name:E.name||v.name})),t({title:"ì„±ê³µ",description:"í”„ë¡œí•„ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:E=>{Ht(E)?(t({title:"ì¸ì¦ ì˜¤ë¥˜",description:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.",variant:"destructive"}),setTimeout(()=>{r("/login")},500)):t({title:"ì˜¤ë¥˜",description:"í”„ë¡œí•„ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),f=E=>{E.preventDefault(),m.mutate(l)},T=Ce({mutationFn:async E=>await me("PATCH","/api/auth/change-password",E),onSuccess:()=>{t({title:"ì„±ê³µ",description:"ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."}),o({currentPassword:"",newPassword:"",confirmPassword:""}),p(!1)},onError:E=>{Ht(E)?(t({title:"ì¸ì¦ ì˜¤ë¥˜",description:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.",variant:"destructive"}),setTimeout(()=>{r("/login")},500)):t({title:"ì˜¤ë¥˜",description:E.response?.data?.message||"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),O=E=>{if(E.preventDefault(),!g.currentPassword||!g.newPassword||!g.confirmPassword){t({title:"ìž…ë ¥ ì˜¤ë¥˜",description:"ëª¨ë“  í•„ë“œë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}if(g.newPassword!==g.confirmPassword){t({title:"ìž…ë ¥ ì˜¤ë¥˜",description:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",variant:"destructive"});return}if(g.newPassword.length<6){t({title:"ìž…ë ¥ ì˜¤ë¥˜",description:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 6ìž ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.",variant:"destructive"});return}T.mutate({currentPassword:g.currentPassword,newPassword:g.newPassword})};return a?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"ë¡œë”© ì¤‘..."})]})})}):s?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ks,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"í”„ë¡œí•„"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"ê³„ì • ì •ë³´ì™€ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”"})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx(wr,{className:"h-16 w-16",children:e.jsx(Cr,{className:"bg-primary text-white text-lg",children:li(s)})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:lr(s)}),e.jsx("p",{className:"text-gray-600",children:s?.email}),e.jsx(B,{variant:"secondary",className:"mt-1",children:aa(s?.role||"")})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(L,{children:[e.jsxs(H,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(ks,{className:"h-5 w-5"}),e.jsx("span",{children:"í”„ë¡œí•„ ì •ë³´"})]}),e.jsx(jt,{children:"ê°œì¸ ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsx(q,{children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"name",children:"ì´ë¦„"}),e.jsx(U,{id:"name",value:l.name,onChange:E=>i(v=>({...v,name:E.target.value})),placeholder:"ì „ì²´ ì´ë¦„ì„ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"email",children:"ì´ë©”ì¼"}),e.jsx(U,{id:"email",type:"email",value:l.email,disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì´ë©”ì¼ì€ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"role",children:"ì—­í• "}),e.jsx(U,{id:"role",value:aa(l.role),disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì—­í• ì€ ê´€ë¦¬ìžë§Œ ë³€ê²½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ì‚¬ìš©ìž ID"}),e.jsx(U,{value:s?.id||"",disabled:!0,className:"bg-gray-50"})]}),e.jsx(nt,{}),e.jsx(b,{type:"submit",disabled:m.isPending,className:"w-full",children:m.isPending?"ì €ìž¥ ì¤‘...":"í”„ë¡œí•„ ì €ìž¥"})]})})]}),e.jsxs(L,{children:[e.jsxs(H,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(Hs,{className:"h-5 w-5"}),e.jsx("span",{children:"ê³„ì • ì„¤ì •"})]}),e.jsx(jt,{children:"ì•Œë¦¼ ë° ì–¸ì–´ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Il,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"ì•Œë¦¼ ì„¤ì •"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{children:"ì´ë©”ì¼ ì•Œë¦¼"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ì¤‘ìš”í•œ ì—…ë°ì´íŠ¸ë¥¼ ì´ë©”ì¼ë¡œ ë°›ì•„ë³´ì„¸ìš”"})]}),e.jsx(Gs,{checked:n.emailNotifications,onCheckedChange:E=>c(v=>({...v,emailNotifications:E}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{children:"ë°œì£¼ì„œ ì•Œë¦¼"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ë°œì£¼ì„œ ìƒíƒœ ë³€ê²½ ì‹œ ì•Œë¦¼ì„ ë°›ì•„ë³´ì„¸ìš”"})]}),e.jsx(Gs,{checked:n.orderAlerts,onCheckedChange:E=>c(v=>({...v,orderAlerts:E}))})]})]})]}),e.jsx(nt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Hc,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"ì–¸ì–´ ì„¤ì •"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ì–¸ì–´"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{type:"button",variant:n.language==="ko"?"default":"outline",size:"sm",onClick:()=>c(E=>({...E,language:"ko"})),children:"í•œêµ­ì–´"}),e.jsx(b,{type:"button",variant:n.language==="en"?"default":"outline",size:"sm",onClick:()=>c(E=>({...E,language:"en"})),children:"English"})]})]})]}),e.jsx(nt,{}),e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"font-medium mb-3",children:"ê³„ì • ì •ë³´ ìš”ì•½"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"ì‚¬ìš©ìž ID:"}),e.jsx("span",{className:"font-mono",children:s?.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"ì´ë©”ì¼:"}),e.jsx("span",{children:s?.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"ì—­í• :"}),e.jsx("span",{children:aa(s?.role||"")})]})]})]})]})]}),e.jsxs(L,{className:"lg:col-span-1",children:[e.jsxs(H,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(Wc,{className:"h-5 w-5"}),e.jsx("span",{children:"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½"})]}),e.jsx(jt,{children:"ê³„ì • ë³´ì•ˆì„ ìœ„í•´ ì •ê¸°ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì„¸ìš”."})]}),e.jsx(q,{children:w?e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"currentPassword",children:"í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸"}),e.jsx(U,{id:"currentPassword",type:"password",value:g.currentPassword,onChange:E=>o(v=>({...v,currentPassword:E.target.value})),placeholder:"í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"newPassword",children:"ìƒˆ ë¹„ë°€ë²ˆí˜¸"}),e.jsx(U,{id:"newPassword",type:"password",value:g.newPassword,onChange:E=>o(v=>({...v,newPassword:E.target.value})),placeholder:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"ìµœì†Œ 6ìž ì´ìƒ ìž…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"confirmPassword",children:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸"}),e.jsx(U,{id:"confirmPassword",type:"password",value:g.confirmPassword,onChange:E=>o(v=>({...v,confirmPassword:E.target.value})),placeholder:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ìž…ë ¥í•˜ì„¸ìš”",required:!0})]}),e.jsx(nt,{}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>{p(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1",children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",disabled:T.isPending,className:"flex-1",children:T.isPending?"ë³€ê²½ ì¤‘...":"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ë ¤ë©´ ì•„ëž˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”."}),e.jsx(b,{onClick:()=>p(!0),className:"w-full",variant:"outline",children:"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½í•˜ê¸°"})]})})]})]})]}):null}const ju=Object.freeze(Object.defineProperty({__proto__:null,default:pu},Symbol.toStringTag,{value:"Module"}));function gu({config:s,orders:a,onClose:t}){const r=d.useRef(null),l=a.reduce((p,m)=>{const f=parseFloat(m.totalAmount)||0;return p+f},0),i=l/a.length,n=Object.entries(a.reduce((p,m)=>{const f=ri(m.status);return p[f]=(p[f]||0)+1,p},{})).map(([p,m])=>({name:p,value:m})),c=Object.entries(a.reduce((p,m)=>{const f=new Date(m.orderDate).toLocaleDateString("ko-KR",{year:"numeric",month:"long"});return p[f]=(p[f]||0)+1,p},{})).map(([p,m])=>({month:p,orders:m})),g=Object.entries(a.reduce((p,m)=>{const f=m.vendor?.name||"ì•Œ ìˆ˜ ì—†ìŒ";return p[f]=(p[f]||0)+1,p},{})).sort(([,p],[,m])=>m-p).slice(0,10).map(([p,m])=>({name:p,orders:m})),o=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],w=async()=>{if(r.current)try{const p=await hd(r.current,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"}),m=p.toDataURL("image/png"),f=new ud("p","mm","a4"),T=210,O=295,E=p.height*T/p.width;let v=E,F=0;for(f.addImage(m,"PNG",0,F,T,E),v-=O;v>=0;)F=v-E,f.addPage(),f.addImage(m,"PNG",0,F,T,E),v-=O;const _=`${s.title.replace(/[^a-zA-Z0-9ê°€-íž£]/g,"_")}.pdf`;f.save(_)}catch(p){console.error("PDF ìƒì„± ì‹¤íŒ¨:",p)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-[1366px] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"ë³´ê³ ì„œ ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"PDF ë‹¤ìš´ë¡œë“œ"]}),e.jsx(b,{variant:"outline",onClick:t,children:"ë‹«ê¸°"})]})]}),e.jsxs("div",{ref:r,className:"p-8 bg-white",style:{minHeight:"297mm"},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:s.title}),e.jsxs("p",{className:"text-gray-600",children:["ìƒì„±ì¼: ",new Date().toLocaleDateString("ko-KR")]}),e.jsxs("p",{className:"text-gray-600",children:["ë¶„ì„ ë°ì´í„°: ",a.length,"ê±´"]})]}),e.jsxs(L,{className:"mb-6",children:[e.jsx(H,{children:e.jsx(W,{children:"ìš”ì•½ ì •ë³´"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì´ ë°œì£¼ ê±´ìˆ˜"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚©",Math.floor(l).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì´ ë°œì£¼ ê¸ˆì•¡"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["â‚©",Math.floor(i).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"í‰ê·  ë°œì£¼ ê¸ˆì•¡"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:g.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ê±°ëž˜ì²˜ ìˆ˜"})]})]})})]}),s.summary&&e.jsxs(L,{className:"mb-6",children:[e.jsx(H,{children:e.jsx(W,{children:"ë¶„ì„ ìš”ì•½"})}),e.jsx(q,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:s.summary})})]}),e.jsxs("div",{className:"space-y-6",children:[s.includeCharts.statusDistribution&&e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"ë°œì£¼ ìƒíƒœë³„ ë¶„í¬"})}),e.jsx(q,{children:e.jsx(Ba,{width:"100%",height:300,children:s.chartTypes.statusDistribution==="pie"?e.jsxs(jd,{children:[e.jsx(gd,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:({name:p,value:m,percent:f})=>`${p}: ${m}ê±´ (${(f*100).toFixed(1)}%)`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:n.map((p,m)=>e.jsx(fd,{fill:o[m%o.length]},`cell-${m}`))}),e.jsx(ua,{})]}):e.jsxs(Qa,{data:n,children:[e.jsx(Ha,{strokeDasharray:"3 3"}),e.jsx(Wa,{dataKey:"name"}),e.jsx(Ga,{}),e.jsx(ua,{}),e.jsx(Ja,{}),e.jsx(Ya,{dataKey:"value",fill:"#8884d8"})]})})})]}),s.includeCharts.monthlyTrend&&e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"ì›”ë³„ ë°œì£¼ í˜„í™©"})}),e.jsx(q,{children:e.jsx(Ba,{width:"100%",height:300,children:e.jsxs(Qa,{data:c,children:[e.jsx(Ha,{strokeDasharray:"3 3"}),e.jsx(Wa,{dataKey:"month"}),e.jsx(Ga,{}),e.jsx(ua,{}),e.jsx(Ja,{}),e.jsx(Ya,{dataKey:"orders",fill:"#82ca9d"})]})})})]}),s.includeCharts.vendorAnalysis&&e.jsxs(L,{children:[e.jsx(H,{children:e.jsx(W,{children:"ê±°ëž˜ì²˜ë³„ ë°œì£¼ í˜„í™© (ìƒìœ„ 10ê°œ)"})}),e.jsx(q,{children:s.chartTypes.vendorAnalysis==="table"?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"ê±°ëž˜ì²˜ëª…"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"ë°œì£¼ ê±´ìˆ˜"})]})}),e.jsx("tbody",{children:g.map((p,m)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border border-gray-200 px-4 py-2",children:p.name}),e.jsxs("td",{className:"border border-gray-200 px-4 py-2 text-center",children:[p.orders,"ê±´"]})]},m))})]})}):e.jsx(Ba,{width:"100%",height:300,children:e.jsxs(Qa,{data:g,layout:s.chartTypes.vendorAnalysis==="horizontal"?"horizontal":"vertical",children:[e.jsx(Ha,{strokeDasharray:"3 3"}),e.jsx(Wa,{dataKey:s.chartTypes.vendorAnalysis==="horizontal"?"orders":"name"}),e.jsx(Ga,{dataKey:s.chartTypes.vendorAnalysis==="horizontal"?"name":void 0}),e.jsx(ua,{}),e.jsx(Ja,{}),e.jsx(Ya,{dataKey:"orders",fill:"#ffc658"})]})})})]})]}),s.insights&&e.jsxs(L,{className:"mt-6",children:[e.jsx(H,{children:e.jsx(W,{children:"ì£¼ìš” ì¸ì‚¬ì´íŠ¸"})}),e.jsx(q,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:s.insights})})]}),s.comments&&e.jsxs(L,{className:"mt-6",children:[e.jsx(H,{children:e.jsx(W,{children:"ì¶”ê°€ ì½”ë©˜íŠ¸"})}),e.jsx(q,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:s.comments})})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t text-center text-xs text-gray-500",children:[e.jsx("p",{children:"ë³¸ ë³´ê³ ì„œëŠ” ë°œì£¼ ê´€ë¦¬ ì‹œìŠ¤í…œì—ì„œ ìžë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsxs("p",{children:["ìƒì„± ì‹œê°„: ",new Date().toLocaleString("ko-KR")]})]})]})]})})}function fu(){const{user:s,isAuthenticated:a,isLoading:t}=os(),{toast:r}=Ze(),[,l]=Je(),[i,n]=d.useState("orders"),[c,g]=d.useState("major"),[o,w]=d.useState({year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"}),[p,m]=d.useState(null),[f,T]=d.useState(new Set),[O,E]=d.useState(!1),[v,F]=d.useState(!1),[_,k]=d.useState({title:"",includeCharts:{statusDistribution:!0,monthlyTrend:!0,vendorAnalysis:!0,amountAnalysis:!1},chartTypes:{statusDistribution:"pie",monthlyTrend:"bar",vendorAnalysis:"bar",amountAnalysis:"bar"},summary:"",insights:"",comments:"",outputOptions:{includePdf:!0,includeExcel:!1,sendEmail:!1}}),[A,x]=d.useState(null),D=C=>{let M="asc";A&&A.key===C&&A.direction==="asc"&&(M="desc"),x({key:C,direction:M})},u=C=>A?[...C].sort((M,te)=>{let le=M[A.key],ce=te[A.key];return A.key==="vendor"?(le=M.vendor?.name||"",ce=te.vendor?.name||""):A.key==="user"?(le=M.user?`${M.user.lastName||""} ${M.user.firstName||""}`.trim():"",ce=te.user?`${te.user.lastName||""} ${te.user.firstName||""}`.trim():""):A.key==="orderDate"?(le=new Date(le||0),ce=new Date(ce||0)):A.key==="totalAmount"&&(le=Number(le)||0,ce=Number(ce)||0),le<ce?A.direction==="asc"?-1:1:le>ce?A.direction==="asc"?1:-1:0}):C,N=C=>!A||A.key!==C?e.jsx(Gc,{className:"h-4 w-4 text-gray-400"}):A.direction==="asc"?e.jsx(Jc,{className:"h-4 w-4 text-blue-600"}):e.jsx(Yc,{className:"h-4 w-4 text-blue-600"}),j=(C,M)=>{if(C){const te=new Set(M.map(le=>le.id));T(te)}else T(new Set)},h=(C,M)=>{const te=new Set(f);M?te.add(C):te.delete(C),T(te)},I=C=>C.length>0&&C.every(M=>f.has(M.id)),S=C=>{const M=C.filter(te=>f.has(te.id)).length;return M>0&&M<C.length},z=()=>{const C=y?.orders?.filter(te=>f.has(te.id))||[],M=`ë°œì£¼ í˜„í™© ë³´ê³ ì„œ (${C.length}ê±´) - ${new Date().toLocaleDateString("ko-KR")}`;k(te=>({...te,title:M,summary:Q(C)})),E(!0)},Q=C=>{if(C.length===0)return"";const M=C.reduce((de,$e)=>{const fe=parseFloat($e.totalAmount)||0;return de+fe},0),te=M/C.length,le=C.reduce((de,$e)=>(de[$e.status]=(de[$e.status]||0)+1,de),{}),ce=Object.entries(C.reduce((de,$e)=>{const fe=$e.vendor?.name||"ì•Œ ìˆ˜ ì—†ìŒ";return de[fe]=(de[fe]||0)+1,de},{})).sort(([,de],[,$e])=>$e-de).slice(0,3),_e=de=>{switch(de){case"draft":return"ìž„ì‹œ ì €ìž¥";case"pending":return"ìŠ¹ì¸ ëŒ€ê¸°";case"approved":return"ìŠ¹ì¸ ì™„ë£Œ";case"sent":return"ë°œì†¡ë¨";case"completed":return"ë°œì£¼ ì™„ë£Œ";case"rejected":return"ë°˜ë ¤";default:return de}};return`ì´ ${C.length}ê±´ì˜ ë°œì£¼ ë°ì´í„°ë¥¼ ë¶„ì„í•œ ê²°ê³¼:
â€¢ ì´ ë°œì£¼ ê¸ˆì•¡: â‚©${Math.floor(M).toLocaleString()}
â€¢ í‰ê·  ë°œì£¼ ê¸ˆì•¡: â‚©${Math.floor(te).toLocaleString()}
â€¢ ì£¼ìš” ê±°ëž˜ì²˜: ${ce.map(([de,$e])=>`${de}(${$e}ê±´)`).join(", ")}
â€¢ ìƒíƒœ ë¶„í¬: ${Object.entries(le).map(([de,$e])=>`${_e(de)}(${$e}ê±´)`).join(", ")}`},K=async()=>{try{E(!1),F(!0)}catch{r({title:"ì˜¤ë¥˜",description:"ë³´ê³ ì„œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}};d.useEffect(()=>{if(!t&&!a){r({title:"ê¶Œí•œ ì—†ìŒ",description:"ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤...",variant:"destructive"}),setTimeout(()=>{l("/login")},500);return}},[a,t,r]);const{data:ne}=se({queryKey:["/api/vendors"],enabled:a}),{data:Se}=se({queryKey:["/api/order-templates"],enabled:a}),{data:je}=se({queryKey:["/api/users"],enabled:a}),{data:y,isLoading:$}=se({queryKey:["/api/orders",p],queryFn:async()=>{if(!p)return{orders:[],total:0};const C=new URLSearchParams;p.year&&C.append("year",p.year),p.startDate&&C.append("startDate",p.startDate),p.endDate&&C.append("endDate",p.endDate),p.vendorId&&p.vendorId!=="all"&&C.append("vendorId",p.vendorId),p.status&&p.status!=="all"&&C.append("status",p.status),p.templateId&&p.templateId!=="all"&&C.append("templateId",p.templateId),p.userId&&p.userId!=="all"&&C.append("userId",p.userId),C.append("limit","1000");const M=await fetch(`/api/orders?${C.toString()}`);if(!M.ok)throw new Error(`HTTP error! status: ${M.status}`);return M.json()},enabled:a&&!!p});se({queryKey:["/api/reports/summary",p?.startDate,p?.endDate],queryFn:async()=>{const C=new URLSearchParams;p?.startDate&&C.append("startDate",p.startDate),p?.endDate&&C.append("endDate",p.endDate);const M=await fetch(`/api/reports/summary?${C.toString()}`);if(!M.ok)throw new Error("Failed to fetch summary report");return M.json()},enabled:a&&!!p});const{data:J}=se({queryKey:["/api/reports/by-category",p?.startDate,p?.endDate,c],queryFn:async()=>{const C=new URLSearchParams;p?.startDate&&C.append("startDate",p.startDate),p?.endDate&&C.append("endDate",p.endDate),C.append("categoryType",c);const M=await fetch(`/api/reports/by-category?${C.toString()}`);if(!M.ok)throw new Error("Failed to fetch category report");return M.json()},enabled:a&&!!p&&i==="category"}),{data:ie}=se({queryKey:["/api/reports/by-project",p?.startDate,p?.endDate],queryFn:async()=>{const C=new URLSearchParams;p?.startDate&&C.append("startDate",p.startDate),p?.endDate&&C.append("endDate",p.endDate);const M=await fetch(`/api/reports/by-project?${C.toString()}`);if(!M.ok)throw new Error("Failed to fetch project report");return M.json()},enabled:a&&!!p&&i==="project"}),{data:xe}=se({queryKey:["/api/reports/by-vendor",p?.startDate,p?.endDate],queryFn:async()=>{const C=new URLSearchParams;p?.startDate&&C.append("startDate",p.startDate),p?.endDate&&C.append("endDate",p.endDate);const M=await fetch(`/api/reports/by-vendor?${C.toString()}`);if(!M.ok)throw new Error("Failed to fetch vendor report");return M.json()},enabled:a&&!!p&&i==="vendor"}),vs=async()=>{try{const C=new URLSearchParams;if(i==="orders"){const M=new URLSearchParams;p?.startDate&&M.append("startDate",p.startDate),p?.endDate&&M.append("endDate",p.endDate);const te=await fetch(`/api/reports/export-excel?type=processing&${M.toString()}`);if(!te.ok)throw new Error("Export failed");const le=await te.blob(),ce=window.URL.createObjectURL(le),_e=document.createElement("a");_e.style.display="none",_e.href=ce,_e.download=`orders_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(_e),_e.click(),window.URL.revokeObjectURL(ce)}else{C.append("type",i),p?.startDate&&C.append("startDate",p.startDate),p?.endDate&&C.append("endDate",p.endDate),i==="category"&&C.append("categoryType",c);const M=await fetch(`/api/reports/export-excel?${C.toString()}`);if(!M.ok)throw new Error("Export failed");const te=await M.blob(),le=window.URL.createObjectURL(te),ce=document.createElement("a");ce.style.display="none",ce.href=le,ce.download=`${i}_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(ce),ce.click(),window.URL.revokeObjectURL(le)}r({title:"ì„±ê³µ",description:"Excel íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤."})}catch{r({title:"ì˜¤ë¥˜",description:"Excel ë‚´ë³´ë‚´ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}};return t?e.jsx("div",{className:"p-6 space-y-6",children:e.jsx("div",{className:"animate-pulse text-lg",children:"ë¡œë”© ì¤‘..."})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ar,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ë³´ê³ ì„œ ë° ë¶„ì„"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ í˜„í™© ë° í†µê³„ë¥¼ í™•ì¸í•˜ê³  ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì„¸ìš”"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(b,{onClick:()=>E(!0),variant:"default",className:"gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"ë³´ê³ ì„œ ìƒì„±"]})})]}),e.jsx(L,{className:"shadow-sm",children:e.jsx("div",{className:"border-b",children:e.jsxs("nav",{className:"-mb-px flex",children:[e.jsx("button",{onClick:()=>n("orders"),className:`py-2 px-6 text-sm font-medium border-b-2 ${i==="orders"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ë°œì£¼ ë‚´ì—­ ê²€ìƒ‰"}),e.jsx("button",{onClick:()=>n("category"),className:`py-2 px-6 text-sm font-medium border-b-2 ${i==="category"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ë¶„ë¥˜ë³„ ë³´ê³ ì„œ"}),e.jsx("button",{onClick:()=>n("project"),className:`py-2 px-6 text-sm font-medium border-b-2 ${i==="project"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"í˜„ìž¥ë³„ ë³´ê³ ì„œ"}),e.jsx("button",{onClick:()=>n("vendor"),className:`py-2 px-6 text-sm font-medium border-b-2 ${i==="vendor"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ê±°ëž˜ì²˜ë³„ ë³´ê³ ì„œ"})]})})}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-3",children:e.jsxs(W,{className:"text-lg font-semibold flex items-center gap-2 text-gray-900",children:[e.jsx(mr,{className:"h-5 w-5 text-blue-600"}),"í•„í„° ì¡°ê±´"]})}),e.jsxs(q,{className:"pt-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4",children:[(i==="orders"||i==="category"||i==="project"||i==="vendor")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ì‹œìž‘ì¼"}),e.jsx(U,{type:"date",value:o.startDate,onChange:C=>w(M=>({...M,startDate:C.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ì¢…ë£Œì¼"}),e.jsx(U,{type:"date",value:o.endDate,onChange:C=>w(M=>({...M,endDate:C.target.value}))})]})]}),i==="category"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ë¶„ë¥˜ ìœ í˜•"}),e.jsxs(Z,{value:c,onValueChange:C=>g(C),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"major",children:"ëŒ€ë¶„ë¥˜"}),e.jsx(R,{value:"middle",children:"ì¤‘ë¶„ë¥˜"}),e.jsx(R,{value:"minor",children:"ì†Œë¶„ë¥˜"})]})]})]}),i==="orders"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ì—°ë„"}),e.jsxs(Z,{value:o.year,onValueChange:C=>w(M=>({...M,year:C})),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ ì—°ë„"}),e.jsx(R,{value:"2025",children:"2025ë…„"}),e.jsx(R,{value:"2024",children:"2024ë…„"}),e.jsx(R,{value:"2023",children:"2023ë…„"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ê±°ëž˜ì²˜"}),e.jsxs(Z,{value:o.vendorId,onValueChange:C=>w(M=>({...M,vendorId:C})),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ ê±°ëž˜ì²˜"}),Array.isArray(ne)&&ne.map(C=>e.jsx(R,{value:C.id.toString(),children:C.name},C.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ë°œì£¼ ìƒíƒœ"}),e.jsxs(Z,{value:o.status,onValueChange:C=>w(M=>({...M,status:C})),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ ìƒíƒœ"}),e.jsx(R,{value:"draft",children:"ìž„ì‹œ ì €ìž¥"}),e.jsx(R,{value:"pending",children:"ìŠ¹ì¸ ëŒ€ê¸°"}),e.jsx(R,{value:"approved",children:"ìŠ¹ì¸ ì™„ë£Œ"}),e.jsx(R,{value:"sent",children:"ë°œì†¡ë¨"}),e.jsx(R,{value:"completed",children:"ë°œì£¼ ì™„ë£Œ"}),e.jsx(R,{value:"rejected",children:"ë°˜ë ¤"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ë°œì£¼ í…œí”Œë¦¿"}),e.jsxs(Z,{value:o.templateId,onValueChange:C=>w(M=>({...M,templateId:C})),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ í…œí”Œë¦¿"}),Array.isArray(Se)&&Se.map(C=>e.jsx(R,{value:C.id.toString(),children:C.templateName},C.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ê¸ˆì•¡ ë²”ìœ„"}),e.jsxs(Z,{value:o.amountRange,onValueChange:C=>w(M=>({...M,amountRange:C})),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ ê¸ˆì•¡"}),e.jsx(R,{value:"0-100000",children:"10ë§Œì› ì´í•˜"}),e.jsx(R,{value:"100000-500000",children:"10ë§Œì› ~ 50ë§Œì›"}),e.jsx(R,{value:"500000-1000000",children:"50ë§Œì› ~ 100ë§Œì›"}),e.jsx(R,{value:"1000000-5000000",children:"100ë§Œì› ~ 500ë§Œì›"}),e.jsx(R,{value:"5000000-99999999",children:"500ë§Œì› ì´ìƒ"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ë‹´ë‹¹ìž"}),e.jsxs(Z,{value:o.userId,onValueChange:C=>w(M=>({...M,userId:C})),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ ë‹´ë‹¹ìž"}),Array.isArray(je)&&je.map(C=>e.jsxs(R,{value:C.id,children:[C.firstName," ",C.lastName]},C.id))]})]})]})]})]}),p&&Object.values(p).some(C=>C!=="all"&&C!=="")&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"ì ìš©ëœ í•„í„°: "}),p.year!==new Date().getFullYear().toString()&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["ì—°ë„: ",p.year,"ë…„"]}),p.startDate&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["ì‹œìž‘ì¼: ",p.startDate]}),p.endDate&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["ì¢…ë£Œì¼: ",p.endDate]}),p.vendorId!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"ê±°ëž˜ì²˜ í•„í„°ë§"}),p.status!=="all"&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["ìƒíƒœ: ",p.status==="pending"?"ìŠ¹ì¸ ëŒ€ê¸°":p.status==="approved"?"ìŠ¹ì¸ ì™„ë£Œ":p.status==="completed"?"ë°œì£¼ ì™„ë£Œ":"ë°˜ë ¤"]}),p.templateId!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"í…œí”Œë¦¿ í•„í„°ë§"}),p.amountRange!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"ê¸ˆì•¡ ë²”ìœ„ í•„í„°ë§"}),p.userId!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"ë‹´ë‹¹ìž í•„í„°ë§"})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{const C={year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"};w(C),m(C)},className:"text-gray-600 hover:text-gray-800",children:"í•„í„° ì´ˆê¸°í™”"})]})}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{const C={year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"};w(C)},className:"text-gray-600 hover:text-gray-800",children:"ì´ˆê¸°í™”"}),e.jsx(b,{onClick:()=>{m(o)},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"ê²€ìƒ‰"})]})]})]}),e.jsxs(L,{className:"shadow-sm",children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(W,{className:"text-lg font-semibold flex items-center gap-2 text-gray-900",children:[e.jsx(yt,{className:"h-5 w-5 text-blue-600"}),i==="orders"?"ê²€ìƒ‰ ê²°ê³¼":i==="category"?"ë¶„ë¥˜ë³„ ë³´ê³ ì„œ ê²°ê³¼":i==="project"?"í˜„ìž¥ë³„ ë³´ê³ ì„œ ê²°ê³¼":"ê±°ëž˜ì²˜ë³„ ë³´ê³ ì„œ ê²°ê³¼"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i==="orders"?$?"ë°ì´í„° ë¡œë”© ì¤‘...":y&&y.orders?`ì´ ${y.orders.length}ê±´ì˜ ë°œì£¼ ë°ì´í„°`:"ê²€ìƒ‰ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤":"í•„í„°ë¥¼ ì„¤ì •í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"flex gap-2",children:[i==="orders"&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>z(),disabled:f.size===0,className:"bg-green-600 hover:bg-green-700 text-white disabled:bg-gray-300",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"ë³´ê³ ì„œ ìƒì„± (",f.size,"ê±´)"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>vs(),className:"gap-2",children:[e.jsx(dr,{className:"h-4 w-4"}),"Excel ë‚´ë³´ë‚´ê¸°"]})]})]})}),e.jsx(q,{children:p?e.jsxs(e.Fragment,{children:[i==="orders"&&($?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):y&&Array.isArray(y.orders)&&y.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:(()=>{y.orders.reduce((te,le)=>(te[le.status]=(te[le.status]||0)+1,te),{});const C=y.orders.reduce((te,le)=>{const ce=parseFloat(le.totalAmount)||0;return te+ce},0),M=y.orders.length>0?C/y.orders.length:0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-700",children:y.orders.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì´ ë°œì£¼"})]}),e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 font-semibold",children:js(Math.floor(C))}),e.jsx("div",{className:"text-sm text-blue-600",children:"ì´ ë°œì£¼ê¸ˆì•¡"})]}),e.jsxs("div",{className:"bg-purple-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 font-semibold",children:js(Math.floor(M))}),e.jsx("div",{className:"text-sm text-purple-600",children:"í‰ê·  ë°œì£¼ê¸ˆì•¡"})]})]})})()}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:(()=>{const C=y.orders.reduce((M,te)=>(M[te.status]=(M[te.status]||0)+1,M),{});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-yellow-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:C.pending||0}),e.jsx("div",{className:"text-sm text-yellow-600",children:"ìŠ¹ì¸ ëŒ€ê¸°"})]}),e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:C.approved||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"ìŠ¹ì¸ ì™„ë£Œ"})]}),e.jsxs("div",{className:"bg-green-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:C.completed||0}),e.jsx("div",{className:"text-sm text-green-600",children:"ë°œì£¼ ì™„ë£Œ"})]}),e.jsxs("div",{className:"bg-red-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-700",children:C.rejected||0}),e.jsx("div",{className:"text-sm text-red-600",children:"ë°˜ë ¤"})]})]})})()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:I(y.orders||[]),ref:C=>{C&&(C.indeterminate=S(y.orders||[]))},onChange:C=>j(C.target.checked,y.orders||[])})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("orderNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ë°œì£¼ë²ˆí˜¸",N("orderNumber")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("vendor"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ê±°ëž˜ì²˜",N("vendor")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ì£¼ìš” í’ˆëª© ê³„ì¸µ"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("orderDate"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ë°œì£¼ì¼ìž",N("orderDate")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("totalAmount"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ì´ê¸ˆì•¡",N("totalAmount")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("templateName"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ë°œì£¼ í…œí”Œë¦¿",N("templateName")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ìƒíƒœ",N("status")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>D("user"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ìž‘ì„±ìž",N("user")]})})]})}),e.jsx("tbody",{children:u(y.orders).map(C=>e.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-200",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:f.has(C.id),onChange:M=>h(C.id,M.target.checked)})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("button",{onClick:()=>l(`/order-preview/${C.id}`),className:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer",children:C.orderNumber})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:C.vendor?e.jsx("button",{onClick:()=>l(`/vendors/${C.vendor.id}`),className:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer",children:C.vendor.name}):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:C.items&&C.items.length>0?e.jsxs("div",{className:"space-y-1",children:[C.items.slice(0,2).map((M,te)=>e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium text-blue-600",children:M.majorCategory||"ë¯¸ë¶„ë¥˜"}),M.middleCategory&&e.jsxs("span",{className:"text-gray-500",children:[" > ",M.middleCategory]}),M.minorCategory&&e.jsxs("span",{className:"text-gray-400",children:[" > ",M.minorCategory]})]},te)),C.items.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["ì™¸ ",C.items.length-2,"ê°œ í’ˆëª©"]})]}):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:C.orderDate?new Date(C.orderDate).toLocaleDateString("ko-KR"):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:C.totalAmount?js(Math.floor(C.totalAmount)):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:C.templateName||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${C.status==="draft"?"bg-gray-100 text-gray-800":C.status==="pending"?"bg-yellow-100 text-yellow-800":C.status==="approved"?"bg-blue-100 text-blue-800":C.status==="sent"?"bg-purple-100 text-purple-800":C.status==="completed"?"bg-green-100 text-green-800":C.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:C.status==="draft"?"ìž„ì‹œ ì €ìž¥":C.status==="pending"?"ìŠ¹ì¸ ëŒ€ê¸°":C.status==="approved"?"ì§„í–‰ ì¤‘":C.status==="sent"?"ë°œì†¡ë¨":C.status==="completed"?"ì™„ë£Œ":C.status==="rejected"?"ë°˜ë ¤":C.status})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:C.user?`${C.user.lastName||""} ${C.user.firstName||""}`.trim():"-"})]},C.id))}),e.jsxs("tfoot",{children:[(()=>{const C=y.orders.reduce((M,te)=>{const le=parseFloat(te.totalAmount)||0;return M+le},0);return y.orders.length>0&&C/y.orders.length,e.jsxs("tr",{className:"bg-gray-100 font-medium",children:[e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:"í•©ê³„"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx("span",{className:"font-bold text-blue-600 font-semibold",children:js(Math.floor(C))})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"})]})})(),(()=>{const C=y.orders.reduce((te,le)=>{const ce=parseFloat(le.totalAmount)||0;return te+ce},0),M=y.orders.length>0?C/y.orders.length:0;return e.jsxs("tr",{className:"bg-gray-50 font-medium",children:[e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:"í‰ê· "}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx("span",{className:"font-bold text-blue-600 font-semibold",children:js(Math.floor(M))})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"})]})})()]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500",children:"ê²€ìƒ‰ ì¡°ê±´ì— ë§žëŠ” ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"í•„í„° ì¡°ê±´ì„ ë³€ê²½í•˜ì—¬ ë‹¤ì‹œ ê²€ìƒ‰í•´ë³´ì„¸ìš”."})]})),i==="category"&&(J?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2",children:[c==="major"?"ëŒ€ë¶„ë¥˜ë³„":c==="middle"?"ì¤‘ë¶„ë¥˜ë³„":"ì†Œë¶„ë¥˜ë³„"," ë°œì£¼ ë³´ê³ ì„œ"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ë¶„ë¥˜ ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:J.summary?.totalCategories||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ë°œì£¼ ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:J.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ í’ˆëª© ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:J.summary?.totalItems||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ê¸ˆì•¡:"}),e.jsx("span",{className:"ml-2 font-medium",children:js(Math.floor(J.summary?.totalAmount||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"ë¶„ë¥˜ ê³„ì¸µ"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ë°œì£¼ ìˆ˜"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"í’ˆëª© ìˆ˜"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ì´ ìˆ˜ëŸ‰"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ì´ ê¸ˆì•¡"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"í‰ê·  ê¸ˆì•¡"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"ì£¼ìš” í’ˆëª©"})]})}),e.jsx("tbody",{children:J.data?.map((C,M)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:C.category}),C.hierarchyPath&&C.hierarchyPath!==C.category&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:C.hierarchyPath})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.itemCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.totalQuantity?.toLocaleString()}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:js(Math.floor(C.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:js(Math.floor(C.averageAmount))}),e.jsx("td",{className:"py-3 px-4",children:C.topItems&&C.topItems.length>0?e.jsxs("div",{className:"space-y-1",children:[C.topItems.slice(0,3).map((te,le)=>e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium text-blue-600",children:te.itemName}),e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",te.quantity,"ê°œ, ",js(Math.floor(te.amount)),")"]})]},le)),C.topItems.length>3&&e.jsxs("div",{className:"text-xs text-gray-400",children:["ì™¸ ",C.topItems.length-3,"ê°œ í’ˆëª©"]})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})})]},M))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500",children:"ë¶„ë¥˜ë³„ ë³´ê³ ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì´ê±°ë‚˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"í•„í„° ì¡°ê±´ì„ ë³€ê²½í•˜ì—¬ ë‹¤ì‹œ ê²€ìƒ‰í•´ë³´ì„¸ìš”."})]})),i==="project"&&ie&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"í˜„ìž¥ë³„ ë°œì£¼ ë³´ê³ ì„œ"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ í”„ë¡œì íŠ¸ ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:ie.summary?.totalProjects||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ë°œì£¼ ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:ie.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ê¸ˆì•¡:"}),e.jsx("span",{className:"ml-2 font-medium",children:js(Math.floor(ie.summary?.totalAmount||0))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"í”„ë¡œì íŠ¸ë‹¹ í‰ê· :"}),e.jsx("span",{className:"ml-2 font-medium",children:js(Math.floor(ie.summary?.averagePerProject||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"í”„ë¡œì íŠ¸ëª…"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"í”„ë¡œì íŠ¸ ì½”ë“œ"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"ìƒíƒœ"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ë°œì£¼ ìˆ˜"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ê±°ëž˜ì²˜ ìˆ˜"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ì´ ê¸ˆì•¡"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"í‰ê·  ê¸ˆì•¡"})]})}),e.jsx("tbody",{children:ie.data?.map(C=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:C.projectName}),e.jsx("td",{className:"py-3 px-4",children:C.projectCode}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${C.projectStatus==="active"?"bg-green-100 text-green-800":C.projectStatus==="completed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:C.projectStatus==="active"?"ì§„í–‰ì¤‘":C.projectStatus==="completed"?"ì™„ë£Œ":"ëŒ€ê¸°"})}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.vendorCount}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:js(Math.floor(C.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:js(Math.floor(C.averageOrderAmount))})]},C.projectId))})]})})]}),i==="vendor"&&(xe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ê±°ëž˜ì²˜ë³„ ë°œì£¼ ë³´ê³ ì„œ"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ê±°ëž˜ì²˜ ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:xe.summary?.totalVendors||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ë°œì£¼ ìˆ˜:"}),e.jsx("span",{className:"ml-2 font-medium",children:xe.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ì´ ê¸ˆì•¡:"}),e.jsx("span",{className:"ml-2 font-medium",children:js(Math.floor(xe.summary?.totalAmount||0))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ê±°ëž˜ì²˜ë‹¹ í‰ê· :"}),e.jsx("span",{className:"ml-2 font-medium",children:js(Math.floor(xe.summary?.averagePerVendor||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"ê±°ëž˜ì²˜ëª…"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"ê±°ëž˜ì²˜ ì½”ë“œ"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"ì‚¬ì—…ìžë²ˆí˜¸"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ë°œì£¼ ìˆ˜"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"í”„ë¡œì íŠ¸ ìˆ˜"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"ì´ ê¸ˆì•¡"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"í‰ê·  ê¸ˆì•¡"})]})}),e.jsx("tbody",{children:xe.data?.map(C=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:C.vendorName}),e.jsx("td",{className:"py-3 px-4",children:C.vendorCode}),e.jsx("td",{className:"py-3 px-4",children:C.businessNumber}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:C.projectCount}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:js(Math.floor(C.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:js(Math.floor(C.averageOrderAmount))})]},C.vendorId))})]})}),xe.data?.length===1&&xe.data[0].topItems?.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-semibold mb-3",children:"ì£¼ìš” ë°œì£¼ í’ˆëª©"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 text-sm",children:"í’ˆëª©ëª…"}),e.jsx("th",{className:"text-right py-2 text-sm",children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:"text-right py-2 text-sm",children:"ê¸ˆì•¡"})]})}),e.jsx("tbody",{children:xe.data[0].topItems.map((C,M)=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-2 text-sm",children:C.itemName}),e.jsx("td",{className:"py-2 text-right text-sm",children:C.quantity}),e.jsx("td",{className:"py-2 text-right text-sm font-medium",children:js(Math.floor(C.amount))})]},M))})]})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500",children:"ê±°ëž˜ì²˜ë³„ ë³´ê³ ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì´ê±°ë‚˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"í•„í„° ì¡°ê±´ì„ ë³€ê²½í•˜ì—¬ ë‹¤ì‹œ ê²€ìƒ‰í•´ë³´ì„¸ìš”."})]}))]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"ê²€ìƒ‰ ì¡°ê±´ì„ ì„¤ì •í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"íš¨ìœ¨ì ì¸ ì„±ëŠ¥ì„ ìœ„í•´ ê²€ìƒ‰ í•„í„°ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”"})]})})]}),e.jsx(ze,{open:O,onOpenChange:E,children:e.jsxs(qe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ve,{children:e.jsxs(Ke,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"ë³´ê³ ì„œ ìƒì„±"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"ê¸°ë³¸ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"reportTitle",children:"ë³´ê³ ì„œ ì œëª©"}),e.jsx(U,{id:"reportTitle",value:_.title,onChange:C=>k(M=>({...M,title:C.target.value})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(P,{children:"ì„ íƒëœ ë°ì´í„°"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ì´ ",f.size,"ê±´ì˜ ë°œì£¼ ë°ì´í„°ê°€ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤."]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(ar,{className:"h-5 w-5"}),"ì°¨íŠ¸ ì˜µì…˜"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"statusChart",checked:_.includeCharts.statusDistribution,onCheckedChange:C=>k(M=>({...M,includeCharts:{...M.includeCharts,statusDistribution:!!C}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(P,{htmlFor:"statusChart",children:"ìƒíƒœë³„ ë¶„í¬"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ë°œì£¼ ìƒíƒœë³„ í†µê³„ ì°¨íŠ¸"})]}),_.includeCharts.statusDistribution&&e.jsxs(Z,{value:_.chartTypes.statusDistribution,onValueChange:C=>k(M=>({...M,chartTypes:{...M.chartTypes,statusDistribution:C}})),children:[e.jsx(Y,{className:"w-24",children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"pie",children:"íŒŒì´"}),e.jsx(R,{value:"donut",children:"ë„ë„›"}),e.jsx(R,{value:"bar",children:"ë§‰ëŒ€"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"monthlyChart",checked:_.includeCharts.monthlyTrend,onCheckedChange:C=>k(M=>({...M,includeCharts:{...M.includeCharts,monthlyTrend:!!C}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(P,{htmlFor:"monthlyChart",children:"ì›”ë³„ í˜„í™©"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ì›”ë³„ ë°œì£¼ ì¶”ì´ ì°¨íŠ¸"})]}),_.includeCharts.monthlyTrend&&e.jsxs(Z,{value:_.chartTypes.monthlyTrend,onValueChange:C=>k(M=>({...M,chartTypes:{...M.chartTypes,monthlyTrend:C}})),children:[e.jsx(Y,{className:"w-24",children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"bar",children:"ë§‰ëŒ€"}),e.jsx(R,{value:"line",children:"ì„ í˜•"}),e.jsx(R,{value:"area",children:"ì˜ì—­"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"vendorChart",checked:_.includeCharts.vendorAnalysis,onCheckedChange:C=>k(M=>({...M,includeCharts:{...M.includeCharts,vendorAnalysis:!!C}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(P,{htmlFor:"vendorChart",children:"ê±°ëž˜ì²˜ë³„ ë¶„ì„"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ê±°ëž˜ì²˜ë³„ ë°œì£¼ í†µê³„"})]}),_.includeCharts.vendorAnalysis&&e.jsxs(Z,{value:_.chartTypes.vendorAnalysis,onValueChange:C=>k(M=>({...M,chartTypes:{...M.chartTypes,vendorAnalysis:C}})),children:[e.jsx(Y,{className:"w-24",children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"bar",children:"ë§‰ëŒ€"}),e.jsx(R,{value:"horizontal",children:"ê°€ë¡œë§‰ëŒ€"}),e.jsx(R,{value:"table",children:"í…Œì´ë¸”"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"amountChart",checked:_.includeCharts.amountAnalysis,onCheckedChange:C=>k(M=>({...M,includeCharts:{...M.includeCharts,amountAnalysis:!!C}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(P,{htmlFor:"amountChart",children:"ê¸ˆì•¡ë³„ ë¶„ì„"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ë°œì£¼ ê¸ˆì•¡ ë¶„í¬ ì°¨íŠ¸"})]}),_.includeCharts.amountAnalysis&&e.jsxs(Z,{value:_.chartTypes.amountAnalysis,onValueChange:C=>k(M=>({...M,chartTypes:{...M.chartTypes,amountAnalysis:C}})),children:[e.jsx(Y,{className:"w-24",children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"bar",children:"ë§‰ëŒ€"}),e.jsx(R,{value:"histogram",children:"ížˆìŠ¤í† ê·¸ëž¨"}),e.jsx(R,{value:"box",children:"ë°•ìŠ¤í”Œë¡¯"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"ë³´ê³ ì„œ ë‚´ìš©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"summary",children:"ìžë™ ìƒì„±ëœ ìš”ì•½"}),e.jsx(Ge,{id:"summary",value:_.summary,onChange:C=>k(M=>({...M,summary:C.target.value})),rows:4,className:"mt-1",placeholder:"ë°ì´í„° ê¸°ë°˜ ìžë™ ìš”ì•½ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤..."})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"insights",children:"ì£¼ìš” ì¸ì‚¬ì´íŠ¸"}),e.jsx(Ge,{id:"insights",value:_.insights,onChange:C=>k(M=>({...M,insights:C.target.value})),rows:3,className:"mt-1",placeholder:"ë°ì´í„°ì—ì„œ ë°œê²¬í•œ ì£¼ìš” íŒ¨í„´ì´ë‚˜ ì¸ì‚¬ì´íŠ¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”..."})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"comments",children:"ì¶”ê°€ ì½”ë©˜íŠ¸"}),e.jsx(Ge,{id:"comments",value:_.comments,onChange:C=>k(M=>({...M,comments:C.target.value})),rows:2,className:"mt-1",placeholder:"ì¶”ê°€ì ì¸ ë¶„ì„ì´ë‚˜ ê¶Œìž¥ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”..."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(Ts,{className:"h-5 w-5"}),"ì¶œë ¥ ì˜µì…˜"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"includePdf",checked:_.outputOptions.includePdf,onCheckedChange:C=>k(M=>({...M,outputOptions:{...M.outputOptions,includePdf:!!C}}))}),e.jsx(P,{htmlFor:"includePdf",children:"PDF ë‹¤ìš´ë¡œë“œ"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"includeExcel",checked:_.outputOptions.includeExcel,onCheckedChange:C=>k(M=>({...M,outputOptions:{...M.outputOptions,includeExcel:!!C}}))}),e.jsx(P,{htmlFor:"includeExcel",children:"Excel ë°ì´í„° ì²¨ë¶€"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{id:"sendEmail",checked:_.outputOptions.sendEmail,onCheckedChange:C=>k(M=>({...M,outputOptions:{...M.outputOptions,sendEmail:!!C}}))}),e.jsx(P,{htmlFor:"sendEmail",children:"ì´ë©”ì¼ ì „ì†¡"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(b,{variant:"outline",onClick:()=>E(!1),children:"ì·¨ì†Œ"}),e.jsxs(b,{onClick:K,className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"ë¯¸ë¦¬ë³´ê¸° ë° ìƒì„±"]})]})]})]})}),v&&e.jsx(gu,{config:_,orders:y?.orders?.filter(C=>f.has(C.id))||[],onClose:()=>F(!1)})]})})}const Nu=Object.freeze(Object.defineProperty({__proto__:null,default:fu},Symbol.toStringTag,{value:"Module"}));function yu(){const s=ht(),a=s.id?parseInt(s.id):void 0;return e.jsx("div",{className:"p-6",children:e.jsx(gi,{templateId:a})})}const vu=Object.freeze(Object.defineProperty({__proto__:null,default:yu},Symbol.toStringTag,{value:"Module"}));function bu(){return se({queryKey:["/api/positions"]})}function wu(){const s=us();return Ce({mutationFn:async a=>{const t=await fetch("/api/positions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to create position");return t.json()},onSuccess:()=>{s.invalidateQueries({queryKey:["/api/positions"]})}})}function Cu(){const s=us();return Ce({mutationFn:async({id:a,data:t})=>{const r=await fetch(`/api/positions/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update position");return r.json()},onSuccess:()=>{s.invalidateQueries({queryKey:["/api/positions"]})}})}function Su(){const s=us();return Ce({mutationFn:async a=>{if(!(await fetch(`/api/positions/${a}`,{method:"DELETE"})).ok)throw new Error("Failed to delete position")},onSuccess:()=>{s.invalidateQueries({queryKey:["/api/positions"]})}})}function ku(){const[s,a]=d.useState(""),[t,r]=d.useState(!1),[l,i]=d.useState(null),[n,c]=d.useState("table"),[g,o]=d.useState({positionCode:"",positionName:"",level:1,department:"",description:"",isActive:!0}),{data:w=[],isLoading:p}=bu(),m=wu(),f=Cu(),T=Su(),O=w.filter(x=>x.positionName.toLowerCase().includes(s.toLowerCase())||x.positionCode.toLowerCase().includes(s.toLowerCase())||x.department&&x.department.toLowerCase().includes(s.toLowerCase())),E=()=>{o({positionCode:"",positionName:"",level:1,department:"",description:"",isActive:!0})},v=x=>{i(x),o({positionCode:x.positionCode,positionName:x.positionName,level:x.level,department:x.department||"",description:x.description||"",isActive:x.isActive??!0}),r(!0)},F=async x=>{x.preventDefault();try{l?await f.mutateAsync({id:l.id,data:g}):await m.mutateAsync(g),r(!1),i(null),E()}catch(D){console.error("Failed to save position:",D)}},_=async x=>{try{await T.mutateAsync(x)}catch(D){console.error("Failed to delete position:",D)}},k=x=>x<=2?"bg-red-100 text-red-800 border-red-200":x<=4?"bg-orange-100 text-orange-800 border-orange-200":x<=6?"bg-yellow-100 text-yellow-800 border-yellow-200":x<=8?"bg-green-100 text-green-800 border-green-200":"bg-blue-100 text-blue-800 border-blue-200",A=x=>x<=2?"ìž„ì›ê¸‰":x<=4?"ë¶€ìž¥ê¸‰":x<=6?"ì°¨ìž¥ê¸‰":x<=8?"ê³¼ìž¥ê¸‰":"ì‚¬ì›ê¸‰";return p?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-lg text-gray-600",children:"ë¡œë”© ì¤‘..."})})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ot,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ì§ê¸‰ ê´€ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"ì¡°ì§ ë‚´ ì§ê¸‰ ì²´ê³„ë¥¼ ê´€ë¦¬í•˜ê³  ì„¤ì •í•©ë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{variant:"outline",className:"text-sm",children:["ì´ ",O.length,"ê°œ"]}),e.jsxs(ze,{open:t,onOpenChange:r,children:[e.jsx(Ls,{asChild:!0,children:e.jsxs(b,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{i(null),E()},children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"ì§ê¸‰ ì¶”ê°€"]})}),e.jsxs(qe,{className:"max-w-lg",children:[e.jsx(Ve,{children:e.jsx(Ke,{children:l?"ì§ê¸‰ íŽ¸ì§‘":"ìƒˆ ì§ê¸‰ ì¶”ê°€"})}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"positionCode",className:"text-sm font-medium",children:"ì§ê¸‰ ì½”ë“œ"}),e.jsx(U,{id:"positionCode",value:g.positionCode,onChange:x=>o(D=>({...D,positionCode:x.target.value})),placeholder:"ì˜ˆ: CEO, VP_ENG",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"positionName",className:"text-sm font-medium",children:"ì§ê¸‰ëª…"}),e.jsx(U,{id:"positionName",value:g.positionName,onChange:x=>o(D=>({...D,positionName:x.target.value})),placeholder:"ì˜ˆ: ìµœê³ ê²½ì˜ìž, ê°œë°œíŒ€ìž¥",className:"mt-1",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"level",className:"text-sm font-medium",children:"ë ˆë²¨"}),e.jsx(U,{id:"level",type:"number",min:"1",max:"10",value:g.level,onChange:x=>o(D=>({...D,level:parseInt(x.target.value)||1})),className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"department",className:"text-sm font-medium",children:"ë¶€ì„œ"}),e.jsx(U,{id:"department",value:g.department||"",onChange:x=>o(D=>({...D,department:x.target.value})),placeholder:"ì˜ˆ: ê²½ì˜ì§„, ê°œë°œíŒ€",className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"description",className:"text-sm font-medium",children:"ì„¤ëª…"}),e.jsx(U,{id:"description",value:g.description||"",onChange:x=>o(D=>({...D,description:x.target.value})),placeholder:"ì§ê¸‰ì— ëŒ€í•œ ì„¤ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gs,{id:"isActive",checked:g.isActive,onCheckedChange:x=>o(D=>({...D,isActive:x}))}),e.jsx(P,{htmlFor:"isActive",className:"text-sm",children:"í™œì„± ìƒíƒœ"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>r(!1),children:"ì·¨ì†Œ"}),e.jsx(b,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",disabled:m.isPending||f.isPending,children:l?"ìˆ˜ì •":"ì¶”ê°€"})]})]})]})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(U,{placeholder:"ì§ê¸‰ ì´ë¦„, ì½”ë“œ, ë¶€ì„œë¡œ ê²€ìƒ‰...",value:s,onChange:x=>a(x.target.value),className:"h-10"})}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx(b,{variant:n==="table"?"default":"ghost",size:"sm",onClick:()=>c("table"),className:"h-8 w-8 p-0",title:"í…Œì´ë¸” ë³´ê¸°",children:e.jsx(Xt,{className:"h-4 w-4"})}),e.jsx(b,{variant:n==="card"?"default":"ghost",size:"sm",onClick:()=>c("card"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(gt,{className:"h-4 w-4"})})]})]})}),n==="table"?e.jsx(L,{children:e.jsx(q,{className:"p-0",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx(oe,{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ì§ê¸‰ëª…"}),e.jsx(oe,{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ì½”ë“œ"}),e.jsx(oe,{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ë ˆë²¨"}),e.jsx(oe,{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ë¶€ì„œ"}),e.jsx(oe,{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ìƒíƒœ"}),e.jsx(oe,{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:"ìž‘ì—…"})]})}),e.jsx(tt,{children:O.map(x=>e.jsxs(Me,{className:"hover:bg-gray-50 border-b border-gray-200",children:[e.jsx(G,{className:"py-3 px-4 text-sm",children:e.jsx("div",{className:"font-medium text-gray-900",children:x.positionName})}),e.jsx(G,{className:"py-3 px-4 text-sm text-gray-600",children:x.positionCode}),e.jsx(G,{className:"py-3 px-4 text-sm",children:e.jsx(B,{className:k(x.level),children:A(x.level)})}),e.jsx(G,{className:"py-3 px-4 text-sm text-gray-600",children:x.department||"-"}),e.jsx(G,{className:"py-3 px-4 text-sm",children:e.jsx(B,{variant:x.isActive?"default":"secondary",children:x.isActive?"í™œì„±":"ë¹„í™œì„±"})}),e.jsx(G,{className:"py-3 px-4 text-sm",children:e.jsxs("div",{className:"flex items-center gap-1 -space-x-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>v(x),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"íŽ¸ì§‘",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsxs(Gt,{children:[e.jsx(da,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})}),e.jsxs(Ft,{children:[e.jsxs(Mt,{children:[e.jsx(Rt,{children:"ì§ê¸‰ ì‚­ì œ"}),e.jsx(Lt,{children:"ì´ ì§ê¸‰ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs($t,{children:[e.jsx(Yt,{children:"ì·¨ì†Œ"}),e.jsx(Jt,{onClick:()=>_(x.id),className:"bg-red-600 hover:bg-red-700",children:"ì‚­ì œ"})]})]})]})]})})]},x.id))})]})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:O.map(x=>e.jsx(L,{className:"p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:x.positionName})}),e.jsx(B,{variant:x.isActive?"default":"secondary",children:x.isActive?"í™œì„±":"ë¹„í™œì„±"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ì½”ë“œ:"}),e.jsx("span",{children:x.positionCode})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ë ˆë²¨:"}),e.jsx(B,{className:k(x.level),children:A(x.level)})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 gap-2",children:[e.jsx(Ws,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"ë¶€ì„œ:"}),e.jsx("span",{children:x.department||"-"})]})]}),x.description&&e.jsx("div",{className:"pt-2 border-t",children:e.jsx("p",{className:"text-sm text-gray-600",children:x.description})}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:e.jsx("span",{children:"ë“±ë¡: ì§ê¸‰ ê´€ë¦¬"})}),e.jsx("div",{className:"flex items-center justify-end pt-2 border-t",children:e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>v(x),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"íŽ¸ì§‘",children:e.jsx(ds,{className:"h-3 w-3"})}),e.jsxs(Gt,{children:[e.jsx(da,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"ì‚­ì œ",children:e.jsx(Qe,{className:"h-3 w-3"})})}),e.jsxs(Ft,{children:[e.jsxs(Mt,{children:[e.jsx(Rt,{children:"ì§ê¸‰ ì‚­ì œ"}),e.jsx(Lt,{children:"ì´ ì§ê¸‰ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs($t,{children:[e.jsx(Yt,{children:"ì·¨ì†Œ"}),e.jsx(Jt,{onClick:()=>_(x.id),className:"bg-red-600 hover:bg-red-700",children:"ì‚­ì œ"})]})]})]})]})})]})},x.id))})]})}const _u=Object.freeze(Object.defineProperty({__proto__:null,default:ku},Symbol.toStringTag,{value:"Module"})),Du=Zc,Au=Xc,Tu=ed;function Pu(){const[s,a]=d.useState(""),[t,r]=d.useState("all"),[l,i]=d.useState("table"),[n,c]=d.useState(!1),[g,o]=d.useState("orderDate"),[w,p]=d.useState("desc"),m=us(),[,f]=Je(),{data:T,isLoading:O}=se({queryKey:["/api/approvals/stats"]}),{data:E,isLoading:v}=se({queryKey:["/api/approvals/pending"]}),{data:F,isLoading:_}=se({queryKey:["/api/approvals/history"]}),k=Ce({mutationFn:K=>me("POST",`/api/approvals/${K}/approve`,{note:"ìŠ¹ì¸ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤."}),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/approvals/stats"]}),m.invalidateQueries({queryKey:["/api/approvals/pending"]}),m.invalidateQueries({queryKey:["/api/approvals/history"]})}}),A=Ce({mutationFn:K=>me("POST",`/api/approvals/${K}/reject`,{note:"ë°˜ë ¤ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤."}),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/approvals/stats"]}),m.invalidateQueries({queryKey:["/api/approvals/pending"]}),m.invalidateQueries({queryKey:["/api/approvals/history"]})}}),x=K=>{switch(K){case"pending":return e.jsx(B,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:"ìŠ¹ì¸ ëŒ€ê¸°"});case"approved":return e.jsx(B,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"ìŠ¹ì¸ ì™„ë£Œ"});case"draft":return e.jsx(B,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:"ìž‘ì„±ì¤‘"});case"sent":return e.jsx(B,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"ë°œì†¡ì™„ë£Œ"});case"completed":return e.jsx(B,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"ì™„ë£Œ"});default:return e.jsx(B,{variant:"secondary",children:K})}},D=K=>{if(!K)return 0;const ne=Math.abs(new Date().getTime()-new Date(K).getTime());return Math.ceil(ne/(1e3*60*60*24))},u=K=>{k.mutate(K)},N=K=>{A.mutate(K)},j=K=>{g===K?p(w==="asc"?"desc":"asc"):(o(K),p("asc"))},h=K=>{f(`/orders/${K}/standard`)},I=K=>[...K].sort((ne,Se)=>{let je=ne[g],y=Se[g];return je instanceof Date&&(je=je.getTime()),y instanceof Date&&(y=y.getTime()),typeof je=="string"&&(je=je.toLowerCase()),typeof y=="string"&&(y=y.toLowerCase()),w==="asc"?je>y?1:-1:je<y?1:-1}),S=({field:K,children:ne})=>e.jsx(oe,{className:"cursor-pointer hover:bg-gray-100 select-none",onClick:()=>j(K),children:e.jsxs("div",{className:"flex items-center gap-1",children:[ne,g===K&&(w==="asc"?e.jsx(zt,{className:"h-4 w-4"}):e.jsx(Zs,{className:"h-4 w-4"}))]})}),z=I(E?.filter(K=>{const ne=K.orderNumber.toLowerCase().includes(s.toLowerCase()),Se=t==="all"||K.status===t;return ne&&Se})||[]),Q=I(F?.filter(K=>{const ne=K.orderNumber.toLowerCase().includes(s.toLowerCase()),Se=t==="all"||K.status===t;return ne&&Se})||[]);return e.jsx(pt,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ìŠ¹ì¸ ê´€ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ë°œì£¼ì„œ ìŠ¹ì¸ ìš”ì²­ì„ ê²€í† í•˜ê³  ì²˜ë¦¬í•©ë‹ˆë‹¤."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"ìŠ¹ì¸ ëŒ€ê¸°"}),e.jsxs("p",{className:"text-xl font-bold",children:[T?.pendingCount||0,"ê±´"]})]})]})})}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"ê¸´ê¸‰ ìŠ¹ì¸"}),e.jsxs("p",{className:"text-xl font-bold",children:[T?.urgentCount||0,"ê±´"]})]})]})})}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"í‰ê·  ëŒ€ê¸°ì¼"}),e.jsxs("p",{className:"text-xl font-bold",children:[T?.averageWaitDays||0,"ì¼"]})]})]})})}),e.jsx(L,{className:"shadow-sm",children:e.jsx(q,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"ëŒ€ê¸° ê¸ˆì•¡"}),e.jsx("p",{className:"text-xl font-bold text-blue-600 font-semibold",children:Ee(T?.pendingAmount||0)})]})]})})})]}),e.jsx(Du,{open:n,onOpenChange:c,children:e.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx(Au,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mr,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"í•„í„° ë° ê²€ìƒ‰"})]}),e.jsx(Zs,{className:`h-4 w-4 text-gray-600 transition-transform ${n?"rotate-180":""}`})]})}),e.jsx(Tu,{children:e.jsx("div",{className:"p-4 border-t border-gray-200 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(U,{placeholder:"ë°œì£¼ë²ˆí˜¸ë¡œ ê²€ìƒ‰...",value:s,onChange:K=>a(K.target.value),className:"pl-10"})]}),e.jsxs(Z,{value:t,onValueChange:r,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"ìƒíƒœ ì„ íƒ"})}),e.jsxs(ee,{children:[e.jsx(R,{value:"all",children:"ì „ì²´ ìƒíƒœ"}),e.jsx(R,{value:"pending",children:"ìŠ¹ì¸ ëŒ€ê¸°"}),e.jsx(R,{value:"approved",children:"ìŠ¹ì¸ ì™„ë£Œ"}),e.jsx(R,{value:"draft",children:"ìž‘ì„±ì¤‘"}),e.jsx(R,{value:"sent",children:"ë°œì†¡ì™„ë£Œ"}),e.jsx(R,{value:"completed",children:"ì™„ë£Œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{a(""),r("all")},children:"ì´ˆê¸°í™”"}),e.jsxs("div",{className:"bg-gray-100 rounded p-1 flex",children:[e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:l==="table"?"default":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>i("table"),children:e.jsx(Xt,{className:"h-4 w-4"})})}),e.jsx(Fs,{children:"í…Œì´ë¸” ë³´ê¸°"})]}),e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{variant:l==="card"?"default":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>i("card"),children:e.jsx(gt,{className:"h-4 w-4"})})}),e.jsx(Fs,{children:"ì¹´ë“œ ë³´ê¸°"})]})]})]})]})})})]})}),e.jsxs(kt,{defaultValue:"pending",className:"w-full",children:[e.jsxs(vt,{children:[e.jsxs(is,{value:"pending",children:["ìŠ¹ì¸ ëŒ€ê¸° (",z.length,")"]}),e.jsxs(is,{value:"history",children:["ìŠ¹ì¸ ë‚´ì—­ (",Q.length,")"]}),e.jsx(is,{value:"guide",children:"ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ê°€ì´ë“œ"})]}),e.jsx(hs,{value:"pending",className:"space-y-4",children:v?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):z.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ë°œì£¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤."})}):l==="table"?e.jsx(L,{className:"shadow-sm",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{children:[e.jsx(S,{field:"orderNumber",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx(S,{field:"projectId",children:"í”„ë¡œì íŠ¸"}),e.jsx(S,{field:"status",children:"ìƒíƒœ"}),e.jsx(S,{field:"createdAt",children:"ì‹ ì²­ì¼"}),e.jsx(S,{field:"totalAmount",children:"ê¸ˆì•¡"}),e.jsx(S,{field:"createdAt",children:"ëŒ€ê¸°ì¼"}),e.jsx(oe,{className:"text-center",children:"ìž‘ì—…"})]})}),e.jsx(tt,{children:z.map(K=>e.jsxs(Me,{className:"hover:bg-gray-50",children:[e.jsx(G,{className:"font-medium",children:e.jsx("button",{onClick:()=>h(K.id),className:"text-blue-600 hover:text-blue-800 hover:underline",children:K.orderNumber})}),e.jsxs(G,{children:["í”„ë¡œì íŠ¸ ID: ",K.projectId]}),e.jsx(G,{children:x(K.status)}),e.jsx(G,{children:K.createdAt?new Date(K.createdAt).toLocaleDateString("ko-KR"):"-"}),e.jsx(G,{className:"text-blue-600 font-semibold",children:Ee(K.totalAmount)}),e.jsx(G,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:[D(K.createdAt),"ì¼"]}),D(K.createdAt)>3&&e.jsx(B,{variant:"destructive",className:"text-xs",children:"ì§€ì—°"})]})}),e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-center -space-x-1",children:[e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-green-50",onClick:()=>u(K.id),disabled:k.isPending,children:e.jsx(ps,{className:"h-4 w-4 text-green-600"})})}),e.jsx(Fs,{children:"ìŠ¹ì¸"})]}),e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-red-50",onClick:()=>N(K.id),disabled:A.isPending,children:e.jsx(ys,{className:"h-4 w-4 text-red-600"})})}),e.jsx(Fs,{children:"ë°˜ë ¤"})]}),e.jsxs(Bs,{children:[e.jsx(Qs,{asChild:!0,children:e.jsx(b,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-blue-50",onClick:()=>h(K.id),children:e.jsx(ls,{className:"h-4 w-4 text-blue-600"})})}),e.jsx(Fs,{children:"ìƒì„¸ë³´ê¸°"})]})]})})]},K.id))})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z.map(K=>e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:e.jsx("button",{onClick:()=>h(K.id),className:"text-blue-600 hover:text-blue-800 hover:underline",children:K.orderNumber})}),x(K.status),D(K.createdAt)>3&&e.jsx(B,{variant:"destructive",children:"ì§€ì—°"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["í”„ë¡œì íŠ¸ ID: ",K.projectId]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-3",children:[e.jsxs("span",{children:["ì‹ ì²­ì¼: ",K.createdAt?new Date(K.createdAt).toLocaleDateString("ko-KR"):"-"]}),e.jsxs("span",{children:["ëŒ€ê¸°: ",D(K.createdAt),"ì¼"]})]}),e.jsx("p",{className:"text-sm font-medium text-blue-600 mb-3",children:Ee(K.totalAmount)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>u(K.id),disabled:k.isPending,children:[e.jsx(ps,{className:"h-4 w-4 mr-1"}),"ìŠ¹ì¸"]}),e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>N(K.id),disabled:A.isPending,children:[e.jsx(ys,{className:"h-4 w-4 mr-1"}),"ë°˜ë ¤"]})]})]})},K.id))})}),e.jsx(hs,{value:"history",className:"space-y-4",children:_?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"ìŠ¹ì¸ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):Q.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"ìŠ¹ì¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤."})}):l==="table"?e.jsx(L,{className:"shadow-sm",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Me,{children:[e.jsx(S,{field:"orderNumber",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx(S,{field:"projectId",children:"í”„ë¡œì íŠ¸"}),e.jsx(S,{field:"status",children:"ìƒíƒœ"}),e.jsx(S,{field:"updatedAt",children:"ì²˜ë¦¬ì¼"}),e.jsx(S,{field:"totalAmount",children:"ê¸ˆì•¡"}),e.jsx(oe,{className:"text-center",children:"ìž‘ì—…"})]})}),e.jsx(tt,{children:Q.map(K=>e.jsxs(Me,{className:"hover:bg-gray-50",children:[e.jsx(G,{className:"font-medium",children:e.jsx("button",{onClick:()=>h(K.id),className:"text-blue-600 hover:text-blue-800 hover:underline",children:K.orderNumber})}),e.jsxs(G,{children:["í”„ë¡œì íŠ¸ ID: ",K.projectId]}),e.jsx(G,{children:x(K.status)}),e.jsx(G,{children:K.updatedAt?new Date(K.updatedAt).toLocaleDateString("ko-KR"):"-"}),e.jsx(G,{className:"text-blue-600 font-semibold",children:Ee(K.totalAmount)}),e.jsx(G,{className:"text-center",children:e.jsx(b,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>h(K.id),children:e.jsx(ls,{className:"h-4 w-4"})})})]},K.id))})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Q.map(K=>e.jsx(L,{className:"hover:shadow-md transition-shadow shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:e.jsx("button",{onClick:()=>h(K.id),className:"text-blue-600 hover:text-blue-800 hover:underline",children:K.orderNumber})}),x(K.status)]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["í”„ë¡œì íŠ¸ ID: ",K.projectId]}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-3",children:e.jsxs("span",{children:["ì²˜ë¦¬ì¼: ",K.updatedAt?new Date(K.updatedAt).toLocaleDateString("ko-KR"):"-"]})}),e.jsx("p",{className:"text-sm font-medium text-blue-600 mb-3",children:Ee(K.totalAmount)}),e.jsxs(b,{size:"sm",variant:"outline",className:"w-full",onClick:()=>h(K.id),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),"ìƒì„¸ë³´ê¸°"]})]})},K.id))})}),e.jsxs(hs,{value:"guide",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 mb-3",children:"ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"1. ì‹¤ë¬´ìž (ìž‘ì„±)"}),e.jsx("p",{className:"text-xs text-gray-600",children:"í˜„ìž¥ ì‹¤ë¬´ìžê°€ í•„ìš”í•œ ìžìž¬ ë° ìž¥ë¹„ì— ëŒ€í•œ ë°œì£¼ì„œë¥¼ ìž‘ì„±í•˜ê³  ì œì¶œí•©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"border-l-4 border-yellow-500 pl-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"2. í˜„ìž¥ ì±…ìž„ìž (ìž‘ì„± or ìŠ¹ì¸)"}),e.jsx("p",{className:"text-xs text-gray-600",children:"í˜„ìž¥ì†Œìž¥ì´ ë°œì£¼ í•„ìš”ì„±ê³¼ ì‹œê¸‰ì„±ì„ ê²€í† í•˜ê³  ìŠ¹ì¸í•˜ê±°ë‚˜ ì¶”ê°€ ìž‘ì„±ì„ ì§„í–‰í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"border-l-4 border-orange-500 pl-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"3. ë³¸ì‚¬ ê´€ë¦¬ë¶€ (ìŠ¹ì¸)"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ë³¸ì‚¬ ê´€ë¦¬ë¶€ì—ì„œ ê³„ì•½ ì¡°ê±´, ì—…ì²´ ì‹ ë¢°ì„± ë° ì˜ˆì‚°ì„ ê²€í† í•˜ê³  ìŠ¹ì¸í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"border-l-4 border-green-500 pl-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"4. ìž„ì› ë˜ëŠ” ëŒ€í‘œ (ìŠ¹ì¸)"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ì¼ì • ê¸ˆì•¡ ì´ìƒì˜ ë°œì£¼ëŠ” ìž„ì› ë˜ëŠ” ëŒ€í‘œì´ì‚¬ì˜ ìµœì¢… ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"border-l-4 border-purple-500 pl-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"5. ë°œì£¼ ì‹¤í–‰"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ìŠ¹ì¸ ì™„ë£Œ í›„ í˜‘ë ¥ì—…ì²´ì— ë°œì£¼ì„œë¥¼ ì „ì†¡í•˜ê³  ìžìž¬ ê³µê¸‰ ê³„ì•½ì„ ì²´ê²°í•©ë‹ˆë‹¤."})]})]})]})}),e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 mb-3",children:"ìŠ¹ì¸ ì •ì±…"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ê¸ˆì•¡ë³„ ìŠ¹ì¸ ê¶Œí•œ"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ 500ë§Œì› ë¯¸ë§Œ: í˜„ìž¥ ì±…ìž„ìž ìŠ¹ì¸"}),e.jsx("p",{children:"â€¢ 500ë§Œì› ~ 3,000ë§Œì›: ë³¸ì‚¬ ê´€ë¦¬ë¶€ + í˜„ìž¥ ì±…ìž„ìž ìŠ¹ì¸"}),e.jsx("p",{children:"â€¢ 3,000ë§Œì› ~ 1ì–µì›: ìž„ì› ìŠ¹ì¸ í•„ìš”"}),e.jsx("p",{children:"â€¢ 1ì–µì› ì´ìƒ: ëŒ€í‘œì´ì‚¬ ìŠ¹ì¸ í•„ìš”"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ìŠ¹ì¸ ê¸°í•œ"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ ì¼ë°˜ ìžìž¬: ì˜ì—…ì¼ ê¸°ì¤€ 3ì¼ ì´ë‚´"}),e.jsx("p",{children:"â€¢ ê¸´ê¸‰ í˜„ìž¥: ë‹¹ì¼ ë˜ëŠ” ìµì¼ ì²˜ë¦¬"}),e.jsx("p",{children:"â€¢ ê³ ì•¡ ìž¥ë¹„: ì˜ì—…ì¼ ê¸°ì¤€ 7ì¼ ì´ë‚´"}),e.jsx("p",{children:"â€¢ íŠ¹ìˆ˜ ìžìž¬: ì˜ì—…ì¼ ê¸°ì¤€ 5ì¼ ì´ë‚´"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"í•„ìˆ˜ ì²¨ë¶€ ì„œë¥˜"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ ê²¬ì ì„œ (3ì‚¬ ì´ìƒ ë¹„êµ ê¶Œìž¥)"}),e.jsx("p",{children:"â€¢ í˜‘ë ¥ì—…ì²´ ë“±ë¡ì¦ (ì‹ ê·œ ì—…ì²´)"}),e.jsx("p",{children:"â€¢ ìžìž¬/ìž¥ë¹„ ì‚¬ì–‘ì„œ ë° ì¹´íƒˆë¡œê·¸"}),e.jsx("p",{children:"â€¢ í’ˆì§ˆì‹œí—˜ì„±ì ì„œ (êµ¬ì¡° ìžìž¬)"}),e.jsx("p",{children:"â€¢ ê³„ì•½ì„œ ì´ˆì•ˆ (ê³ ì•¡ ë°œì£¼)"})]})]})]})]})}),e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 mb-3",children:"ìŠ¹ì¸ ì›ì¹™"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"íˆ¬ëª…ì„±"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ëª¨ë“  ìŠ¹ì¸ ê³¼ì •ê³¼ ê²°ì • ê·¼ê±°ë¥¼ ëª…í™•ížˆ ê¸°ë¡í•˜ê³  ê³µìœ í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ê³µì •ì„±"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ë™ì¼í•œ ê¸°ì¤€ê³¼ ì ˆì°¨ë¥¼ ëª¨ë“  ë°œì£¼ì— ì¼ê´€ë˜ê²Œ ì ìš©í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ì‹ ì†ì„±"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ì •í•´ì§„ ê¸°í•œ ë‚´ì— ì‹ ì†í•˜ê³  ì •í™•í•œ ê²€í† ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ì±…ìž„ì„±"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ê° ìŠ¹ì¸ìžëŠ” ìžì‹ ì˜ ê²°ì •ì— ëŒ€í•´ ëª…í™•í•œ ì±…ìž„ì„ ì§‘ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ê²½ì œì„±"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ìµœì ì˜ ë¹„ìš© ëŒ€ë¹„ íš¨ê³¼ë¥¼ ê³ ë ¤í•œ í•©ë¦¬ì  ìŠ¹ì¸ì„ ì¶”êµ¬í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ë¦¬ìŠ¤í¬ ê´€ë¦¬"}),e.jsx("p",{className:"text-xs text-gray-600",children:"ìž ìž¬ì  ìœ„í—˜ ìš”ì†Œë¥¼ ì‚¬ì „ì— ì‹ë³„í•˜ê³  ëŒ€ì‘ ë°©ì•ˆì„ ê²€í† í•©ë‹ˆë‹¤."})]})]})]})}),e.jsx(L,{className:"shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 mb-3",children:"ì—­í• ê³¼ ì±…ìž„"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"í˜„ìž¥ ì‹¤ë¬´ìž"}),e.jsxs("div",{className:"space-y-0.5 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ í˜„ìž¥ í•„ìš” ìžìž¬ ë° ìž¥ë¹„ íŒŒì•…"}),e.jsx("p",{children:"â€¢ ì •í™•í•œ ê·œê²© ë° ìˆ˜ëŸ‰ ì‚°ì •"}),e.jsx("p",{children:"â€¢ ë‚©ê¸° ì¼ì • ë° í˜„ìž¥ ì—¬ê±´ ê³ ë ¤"}),e.jsx("p",{children:"â€¢ ê²¬ì ì„œ ìˆ˜ì§‘ ë° ë¹„êµ ê²€í† "})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"í˜„ìž¥ ì±…ìž„ìž"}),e.jsxs("div",{className:"space-y-0.5 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ í˜„ìž¥ ë°œì£¼ í•„ìš”ì„± ë° ì‹œê¸‰ì„± ê²€í† "}),e.jsx("p",{children:"â€¢ ê³µì‚¬ ì¼ì • ëŒ€ë¹„ ìžìž¬ íˆ¬ìž… ê³„íš"}),e.jsx("p",{children:"â€¢ í˜„ìž¥ ì˜ˆì‚° ë²”ìœ„ ë‚´ ë°œì£¼ í™•ì¸"}),e.jsx("p",{children:"â€¢ í’ˆì§ˆ ë° ì•ˆì „ ê¸°ì¤€ ì í•©ì„± ê²€ì¦"})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ë³¸ì‚¬ ê´€ë¦¬ë¶€"}),e.jsxs("div",{className:"space-y-0.5 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ í˜‘ë ¥ì—…ì²´ ì‹ ìš©ë„ ë° ì´ë ¥ í™•ì¸"}),e.jsx("p",{children:"â€¢ ê³„ì•½ ì¡°ê±´ ë° ë²•ì  ê²€í† "}),e.jsx("p",{children:"â€¢ ì „ì²´ í”„ë¡œì íŠ¸ ì˜ˆì‚° ëŒ€ë¹„ ì ì •ì„±"}),e.jsx("p",{children:"â€¢ íšŒê³„ ì²˜ë¦¬ ë° ì„¸ë¬´ ê²€í† "})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-1",children:"ìž„ì› / ëŒ€í‘œì´ì‚¬"}),e.jsxs("div",{className:"space-y-0.5 text-xs text-gray-600",children:[e.jsx("p",{children:"â€¢ íšŒì‚¬ ê²½ì˜ ì „ëžµ ë¶€í•©ì„± ê²€í† "}),e.jsx("p",{children:"â€¢ ê³ ì•¡ ë°œì£¼ ìµœì¢… ìŠ¹ì¸ ê²°ì •"}),e.jsx("p",{children:"â€¢ í”„ë¡œì íŠ¸ ìˆ˜ìµì„± ë° ë¦¬ìŠ¤í¬ í‰ê°€"}),e.jsx("p",{children:"â€¢ ë°œì£¼ ì •ì±… ìˆ˜ë¦½ ë° ë³€ê²½ ê²°ì •"})]})]})]})]})})]}),e.jsx(L,{className:"bg-blue-50 border-blue-200 shadow-sm",children:e.jsxs(q,{className:"p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-blue-900 mb-3",children:"ìŠ¹ì¸ ì‹œ ì£¼ì˜ì‚¬í•­"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-blue-900 mb-1",children:"ìŠ¹ì¸ ì „ í™•ì¸ì‚¬í•­"}),e.jsxs("div",{className:"space-y-0.5 text-xs text-blue-800",children:[e.jsx("p",{children:"â€¢ ìžìž¬/ìž¥ë¹„ ê·œê²© ë° ìˆ˜ëŸ‰ì˜ ì •í™•ì„±"}),e.jsx("p",{children:"â€¢ í˜„ìž¥ ë‚©ê¸° ì¼ì •ê³¼ì˜ ë¶€í•©ì„±"}),e.jsx("p",{children:"â€¢ í”„ë¡œì íŠ¸ ì˜ˆì‚° ë²”ìœ„ ë‚´ ë°œì£¼ í™•ì¸"}),e.jsx("p",{children:"â€¢ í˜‘ë ¥ì—…ì²´ ì‹ ìš©ë„ ë° ê³µê¸‰ ëŠ¥ë ¥"}),e.jsx("p",{children:"â€¢ í’ˆì§ˆ ê¸°ì¤€ ë° ì•ˆì „ ê·œì • ì¶©ì¡±"}),e.jsx("p",{children:"â€¢ ê±´ì„¤ì—…ë²• ë° ê´€ë ¨ ë²•ê·œ ì¤€ìˆ˜"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium text-blue-900 mb-1",children:"ë°˜ë ¤ ì‚¬ìœ "}),e.jsxs("div",{className:"space-y-0.5 text-xs text-blue-800",children:[e.jsx("p",{children:"â€¢ ìžìž¬ ê·œê²© ë˜ëŠ” ìˆ˜ëŸ‰ ì •ë³´ ë¶€ì •í™•"}),e.jsx("p",{children:"â€¢ í”„ë¡œì íŠ¸ ì˜ˆì‚° ì´ˆê³¼ ë˜ëŠ” ë¯¸ìŠ¹ì¸"}),e.jsx("p",{children:"â€¢ í˜‘ë ¥ì—…ì²´ ë“±ë¡ ë¯¸ì™„ë£Œ ë˜ëŠ” ì‹ ìš©ë„ ë¯¸ë‹¬"}),e.jsx("p",{children:"â€¢ í˜„ìž¥ ë‚©ê¸°ì™€ ê³µê¸‰ ì¼ì • ë¶ˆì¼ì¹˜"}),e.jsx("p",{children:"â€¢ í’ˆì§ˆ ê¸°ì¤€ ë¯¸ë‹¬ ë˜ëŠ” ê²€ì¦ì„œë¥˜ ë¶€ì¡±"}),e.jsx("p",{children:"â€¢ ê±´ì„¤ì—…ë²• ìœ„ë°˜ ë˜ëŠ” ì•ˆì „ ê·œì • ë¯¸ì¤€ìˆ˜"})]})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-blue-100 rounded",children:e.jsxs("p",{className:"text-xs text-blue-800",children:[e.jsx("strong",{children:"íŒ:"})," ìŠ¹ì¸ ì§€ì—°ì„ ë°©ì§€í•˜ë ¤ë©´ ìžìž¬ ê·œê²©ê³¼ ìˆ˜ëŸ‰ì„ ì •í™•ížˆ ì‚°ì •í•˜ê³ , í˜„ìž¥ ì¼ì •ê³¼ ë‚©ê¸°ë¥¼ ì¶©ë¶„ížˆ ê²€í† í•˜ì„¸ìš”. ê¸´ê¸‰ í˜„ìž¥ ë°œì£¼ì˜ ê²½ìš° í˜„ìž¥ì†Œìž¥ ë° ë³¸ì‚¬ ê´€ë¦¬ë¶€ì™€ ì‚¬ì „ í˜‘ì˜í•˜ì‹œê¸° ë°”ëžë‹ˆë‹¤."]})})]})})]})]})]})})})}const Eu=Object.freeze(Object.defineProperty({__proto__:null,default:Pu},Symbol.toStringTag,{value:"Module"}));function Iu(){os();const[s,a]=d.useState("vendors"),[t,r]=d.useState("excel"),[l,i]=d.useState(null),[n,c]=d.useState(!1),[g,o]=d.useState(null),[w,p]=d.useState(null),m={vendors:"ê±°ëž˜ì²˜",items:"í’ˆëª©",projects:"í”„ë¡œì íŠ¸"},f=async()=>{try{const E=await fetch(`/api/export/${s}?format=${t}`,{method:"GET",credentials:"include"});if(!E.ok)throw new Error("Export failed");const v=await E.blob(),F=window.URL.createObjectURL(v),_=document.createElement("a");_.href=F,_.download=`${s}_${new Date().toISOString().split("T")[0]}.${t==="csv"?"csv":"xlsx"}`,document.body.appendChild(_),_.click(),window.URL.revokeObjectURL(F),document.body.removeChild(_)}catch(E){p("ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),console.error("Export error:",E)}},T=async()=>{if(!l){p("íŒŒì¼ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");return}c(!0),p(null),o(null);const E=new FormData;E.append("file",l);try{const v=await fetch(`/api/import/${s}`,{method:"POST",credentials:"include",body:E});if(!v.ok)throw new Error("Import failed");const F=await v.json();o(F),i(null)}catch(v){p("ê°€ì ¸ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),console.error("Import error:",v)}finally{c(!1)}},O=async()=>{try{const E=await fetch(`/api/template/${s}?format=${t}`,{method:"GET",credentials:"include"});if(!E.ok)throw new Error("Template download failed");const v=await E.blob(),F=window.URL.createObjectURL(v),_=document.createElement("a");_.href=F,_.download=`${s}_template.${t==="csv"?"csv":"xlsx"}`,document.body.appendChild(_),_.click(),window.URL.revokeObjectURL(F),document.body.removeChild(_)}catch(E){p("í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),console.error("Template download error:",E)}};return e.jsxs(L,{className:"w-full max-w-4xl mx-auto shadow-sm",children:[e.jsxs(H,{children:[e.jsx(W,{children:"ë°ì´í„° ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°"}),e.jsx(jt,{children:"ì—‘ì…€ ë˜ëŠ” CSV íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì¼ê´„ë¡œ ê°€ì ¸ì˜¤ê±°ë‚˜ ë‚´ë³´ë‚¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})]}),e.jsxs(q,{children:[e.jsxs(kt,{defaultValue:"export",className:"w-full",children:[e.jsxs(vt,{className:"grid w-full grid-cols-2",children:[e.jsx(is,{value:"export",children:"ë‚´ë³´ë‚´ê¸°"}),e.jsx(is,{value:"import",children:"ê°€ì ¸ì˜¤ê¸°"})]}),e.jsxs(hs,{value:"export",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ë°ì´í„° ìœ í˜•"}),e.jsxs(Z,{value:s,onValueChange:E=>a(E),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"vendors",children:"ê±°ëž˜ì²˜"}),e.jsx(R,{value:"items",children:"í’ˆëª©"}),e.jsx(R,{value:"projects",children:"í”„ë¡œì íŠ¸"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"íŒŒì¼ í˜•ì‹"}),e.jsxs(Z,{value:t,onValueChange:E=>r(E),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"excel",children:"Excel (.xlsx)"}),e.jsx(R,{value:"csv",children:"CSV (.csv)"})]})]})]})]}),e.jsxs(b,{onClick:f,className:"w-full",children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),m[s]," ë°ì´í„° ë‚´ë³´ë‚´ê¸°"]})]}),e.jsxs(hs,{value:"import",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"ë°ì´í„° ìœ í˜•"}),e.jsxs(Z,{value:s,onValueChange:E=>a(E),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"vendors",children:"ê±°ëž˜ì²˜"}),e.jsx(R,{value:"items",children:"í’ˆëª©"}),e.jsx(R,{value:"projects",children:"í”„ë¡œì íŠ¸"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"íŒŒì¼ í˜•ì‹"}),e.jsxs(Z,{value:t,onValueChange:E=>r(E),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(ee,{children:[e.jsx(R,{value:"excel",children:"Excel (.xlsx)"}),e.jsx(R,{value:"csv",children:"CSV (.csv)"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"import-file",children:"íŒŒì¼ ì„ íƒ"}),e.jsx(U,{id:"import-file",type:"file",accept:t==="excel"?".xlsx,.xls":".csv",onChange:E=>i(E.target.files?.[0]||null)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",onClick:O,className:"flex-1",children:[e.jsx(dr,{className:"mr-2 h-4 w-4"}),"í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(b,{onClick:T,disabled:!l||n,className:"flex-1",children:[e.jsx(Vs,{className:"mr-2 h-4 w-4"}),n?"ê°€ì ¸ì˜¤ëŠ” ì¤‘...":"ë°ì´í„° ê°€ì ¸ì˜¤ê¸°"]})]}),g&&e.jsxs(As,{className:g.errors.length>0?"border-yellow-500":"border-green-500",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(Ss,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:["ì „ì²´ ",g.totalRows,"ê°œ ì¤‘ ",g.imported,"ê°œ ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ"]}),g.errors.length>0&&e.jsxs("details",{children:[e.jsxs("summary",{className:"cursor-pointer text-sm text-muted-foreground",children:[g.errors.length,"ê°œ ì˜¤ë¥˜ (í´ë¦­í•˜ì—¬ ìžì„¸ížˆ ë³´ê¸°)"]}),e.jsx("div",{className:"mt-2 space-y-1 text-sm",children:g.errors.map((E,v)=>e.jsxs("div",{className:"text-red-600",children:["í–‰ ",E.row,": ",E.error]},v))})]})]})})]})]})]}),w&&e.jsxs(As,{variant:"destructive",className:"mt-4",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(Ss,{children:w})]})]})]})}function Ou(){const{user:s,loading:a}=os(),[,t]=Je();return d.useEffect(()=>{!a&&!s&&t("/login")},[s,a,t]),a?e.jsx("div",{children:"Loading..."}):s?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx(za,{title:"ë°ì´í„° ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°",description:"ì—‘ì…€ ë° CSV íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì¼ê´„ ì²˜ë¦¬í•©ë‹ˆë‹¤."}),e.jsx(Iu,{})]})}):null}const Fu=Object.freeze(Object.defineProperty({__proto__:null,default:Ou},Symbol.toStringTag,{value:"Module"}));function Va({message:s,priority:a="polite",clear:t=!0}){const r=d.useRef(null);return d.useEffect(()=>{if(r.current&&s&&(r.current.textContent=s,t)){const l=setTimeout(()=>{r.current&&(r.current.textContent="")},1e3);return()=>clearTimeout(l)}},[s,t]),e.jsx("div",{ref:r,className:"sr-only","aria-live":a,"aria-atomic":"true"})}function Mi({children:s,as:a="span",className:t}){return e.jsx(a,{className:V("sr-only",t),children:s})}function Mu({status:s,type:a="info",announce:t=!0}){const[r,l]=Re.useState("");d.useEffect(()=>{if(t&&s){const n={info:"ì •ë³´:",success:"ì„±ê³µ:",warning:"ê²½ê³ :",error:"ì˜¤ë¥˜:"}[a];l(`${n} ${s}`)}},[s,a,t]);const i=a==="error"?"assertive":"polite";return e.jsx(Va,{message:r,priority:i})}function $u({isLoading:s,loadingText:a="ë¡œë”© ì¤‘...",completeText:t="ë¡œë”© ì™„ë£Œ"}){const[r,l]=Re.useState(""),i=d.useRef(!1);return d.useEffect(()=>{s&&!i.current?(l(a),i.current=!0):!s&&i.current&&(l(t),i.current=!1)},[s,a,t]),e.jsx(Va,{message:r})}const fa=d.forwardRef(({id:s,label:a,type:t="text",value:r,onChange:l,onBlur:i,required:n,error:c,success:g,helperText:o,placeholder:w,disabled:p,autoComplete:m,className:f},T)=>{const O=!!c,E=!!g,v=!!o,F=[O&&`${s}-error`,E&&`${s}-success`,v&&`${s}-helper`].filter(Boolean).join(" ")||void 0;return e.jsxs("div",{className:V("space-y-2",f),children:[e.jsxs(P,{htmlFor:s,className:"text-sm font-medium text-gray-700",children:[a,n&&e.jsx("span",{className:"text-red-500 ml-1","aria-label":"í•„ìˆ˜ í•­ëª©",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{ref:T,id:s,type:t,value:r,onChange:_=>l(_.target.value),onBlur:i,placeholder:w,disabled:p,required:n,autoComplete:m,"aria-invalid":O,"aria-describedby":F,className:V(qn,O&&"border-red-300 text-red-900 placeholder-red-300 focus:border-red-500 focus:ring-red-500",E&&"border-green-300 text-green-900 placeholder-green-300 focus:border-green-500 focus:ring-green-500")}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:[O&&e.jsx(Be,{className:"h-5 w-5 text-red-500","aria-hidden":"true"}),E&&!O&&e.jsx(pe,{className:"h-5 w-5 text-green-500","aria-hidden":"true"})]})]}),c&&e.jsxs("div",{id:`${s}-error`,role:"alert",className:"flex items-center text-sm text-red-600",children:[e.jsx(Be,{className:"h-4 w-4 mr-1 flex-shrink-0","aria-hidden":"true"}),c]}),g&&!c&&e.jsxs("div",{id:`${s}-success`,className:"flex items-center text-sm text-green-600",children:[e.jsx(pe,{className:"h-4 w-4 mr-1 flex-shrink-0","aria-hidden":"true"}),g]}),o&&e.jsxs("div",{id:`${s}-helper`,className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ms,{className:"h-4 w-4 mr-1 flex-shrink-0","aria-hidden":"true"}),o]})]})});fa.displayName="AccessibleFormField";function cl({id:s,label:a,value:t,onChange:r,options:l,placeholder:i="ì„ íƒí•˜ì„¸ìš”",required:n,error:c,disabled:g,className:o}){const[w,p]=Re.useState(!1),[m,f]=Re.useState(-1),T=Re.useRef(null),O=Re.useRef([]),E=l.find(_=>_.value===t),v=!!c,F=_=>{switch(_.key){case"Enter":case" ":_.preventDefault(),w?m>=0&&(r(l[m].value),p(!1)):(p(!0),f(0));break;case"ArrowDown":_.preventDefault(),w?f(k=>Math.min(l.length-1,k+1)):(p(!0),f(0));break;case"ArrowUp":_.preventDefault(),w&&f(k=>Math.max(0,k-1));break;case"Escape":_.preventDefault(),p(!1),T.current?.focus();break;case"Tab":p(!1);break}};return Re.useEffect(()=>{w&&m>=0&&O.current[m]&&O.current[m]?.scrollIntoView({block:"nearest"})},[m,w]),e.jsxs("div",{className:V("space-y-2",o),children:[e.jsxs(P,{htmlFor:s,className:"text-sm font-medium text-gray-700",children:[a,n&&e.jsx("span",{className:"text-red-500 ml-1","aria-label":"í•„ìˆ˜ í•­ëª©",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{ref:T,id:s,type:"button",disabled:g,"aria-haspopup":"listbox","aria-expanded":w,"aria-labelledby":`${s}-label`,"aria-describedby":v?`${s}-error`:void 0,"aria-invalid":v,onClick:()=>p(!w),onKeyDown:F,className:V("w-full px-3 py-2 text-left bg-white border rounded-md shadow-sm","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed",v&&"border-red-300 text-red-900 focus:border-red-500 focus:ring-red-500",!v&&"border-gray-300 text-gray-900"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:E?"text-gray-900":"text-gray-500",children:E?E.label:i}),e.jsx(Zs,{className:V("h-5 w-5 text-gray-400 transition-transform",w&&"rotate-180"),"aria-hidden":"true"})]})}),w&&e.jsx("div",{role:"listbox",className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:l.map((_,k)=>e.jsx("button",{ref:A=>O.current[k]=A,role:"option",type:"button",disabled:_.disabled,"aria-selected":m===k,onClick:()=>{r(_.value),p(!1),T.current?.focus()},className:V("w-full px-3 py-2 text-left hover:bg-gray-100 focus:bg-gray-100 focus:outline-none","disabled:opacity-50 disabled:cursor-not-allowed",m===k&&"bg-primary-50 text-primary-700",t===_.value&&"bg-primary-100 text-primary-800"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:_.label}),t===_.value&&e.jsx(ps,{className:"h-4 w-4 text-primary-600","aria-hidden":"true"})]})},_.value))})]}),c&&e.jsxs("div",{id:`${s}-error`,role:"alert",className:"flex items-center text-sm text-red-600",children:[e.jsx(Be,{className:"h-4 w-4 mr-1 flex-shrink-0","aria-hidden":"true"}),c]})]})}function pa({type:s,title:a,children:t,dismissible:r=!1,onDismiss:l,className:i}){const n={info:Ms,success:pe,warning:it,error:Be},c={info:"bg-blue-50 border-blue-200 text-blue-800",success:"bg-green-50 border-green-200 text-green-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",error:"bg-red-50 border-red-200 text-red-800"},g={info:"text-blue-400",success:"text-green-400",warning:"text-yellow-400",error:"text-red-400"},o=n[s],w=s==="error"?"alert":"status",p=s==="error"?"assertive":"polite";return e.jsx("div",{role:w,"aria-live":p,className:V("p-4 border rounded-md",c[s],i),children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(o,{className:V("h-5 w-5",g[s]),"aria-hidden":"true"})}),e.jsxs("div",{className:"ml-3 flex-1",children:[a&&e.jsx("h3",{className:"text-sm font-medium mb-1",children:a}),e.jsx("div",{className:"text-sm",children:t})]}),r&&l&&e.jsx("div",{className:"ml-auto pl-3",children:e.jsx("button",{type:"button",onClick:l,className:V("inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2",s==="info"&&"text-blue-500 hover:bg-blue-100 focus:ring-blue-600",s==="success"&&"text-green-500 hover:bg-green-100 focus:ring-green-600",s==="warning"&&"text-yellow-500 hover:bg-yellow-100 focus:ring-yellow-600",s==="error"&&"text-red-500 hover:bg-red-100 focus:ring-red-600"),"aria-label":"ì•Œë¦¼ ë‹«ê¸°",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})})})})]})})}const Tt=d.forwardRef(({variant:s="primary",size:a="default",loading:t=!1,loadingText:r="ë¡œë”© ì¤‘...",disabled:l,className:i,children:n,...c},g)=>{const o={primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500"},w={sm:"px-3 py-1.5 text-sm",default:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return e.jsxs(b,{ref:g,disabled:l||t,"aria-busy":t,className:V("inline-flex items-center justify-center font-medium rounded-md transition-colors","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",o[s],w[a],i),...c,children:[t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent mr-2"}),e.jsx(Mi,{children:r})]}),n]})});Tt.displayName="AccessibleButton";function Ru({value:s,max:a=100,label:t="ì§„í–‰ë¥ ",showPercentage:r=!0,announceChanges:l=!1,className:i}){const n=Math.round(s/a*100),[c,g]=Re.useState(""),o=Re.useRef(n);return Re.useEffect(()=>{l&&n!==o.current&&(g(`${t} ${n}% ì™„ë£Œ`),o.current=n)},[n,t,l]),e.jsxs("div",{className:V("space-y-2",i),children:[l&&e.jsx(Va,{message:c}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t}),r&&e.jsxs("span",{className:"text-sm text-gray-500",children:[n,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":a,"aria-label":`${t} ${n}% ì™„ë£Œ`,className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]})}function Lu(){const[s,a]=d.useState({name:"",email:"",company:"",role:"",department:"",message:""}),[t,r]=d.useState({}),[l,i]=d.useState(!1),[n,c]=d.useState("idle"),[g,o]=d.useState(0),[w,p]=d.useState("form"),[m,f]=d.useState(!1),[T,O]=d.useState([]),{textSize:E}=Ca(),{isHighContrast:v,contrastLevel:F}=fr(),{prefersReducedMotion:_}=Nr(),k=[{value:"developer",label:"ê°œë°œìž"},{value:"designer",label:"ë””ìžì´ë„ˆ"},{value:"manager",label:"ë§¤ë‹ˆì €"},{value:"admin",label:"ê´€ë¦¬ìž"}],A=[{value:"engineering",label:"ê°œë°œíŒ€"},{value:"design",label:"ë””ìžì¸íŒ€"},{value:"marketing",label:"ë§ˆì¼€íŒ…íŒ€"},{value:"sales",label:"ì˜ì—…íŒ€"}],x=()=>{const j={};return s.name.trim()||(j.name="ì´ë¦„ì€ í•„ìˆ˜ í•­ëª©ìž…ë‹ˆë‹¤"),s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(j.email="ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤"):j.email="ì´ë©”ì¼ì€ í•„ìˆ˜ í•­ëª©ìž…ë‹ˆë‹¤",s.company.trim()||(j.company="íšŒì‚¬ëª…ì€ í•„ìˆ˜ í•­ëª©ìž…ë‹ˆë‹¤"),r(j),Object.keys(j).length===0},D=async j=>{if(j.preventDefault(),!x()){c("error");return}i(!0),o(0);const h=setInterval(()=>{o(I=>I>=100?(clearInterval(h),100):I+20)},500);setTimeout(()=>{i(!1),c("success"),o(100)},3e3)};Kn([{key:"s",ctrlKey:!0,action:j=>{j.preventDefault(),l||D(j)},description:"í¼ ì œì¶œ"},{key:"m",altKey:!0,action:()=>f(!0),description:"ëª¨ë‹¬ ì—´ê¸°"}]);const N=[{id:"form",label:"ì ‘ê·¼ì„± í¼",content:e.jsxs("div",{className:"space-y-6",children:[e.jsx(pa,{type:"info",title:"ì ‘ê·¼ì„± ì •ë³´",dismissible:!0,onDismiss:()=>{},children:"ì´ í¼ì€ WCAG 2.1 AA ê¸°ì¤€ì„ ì¤€ìˆ˜í•˜ì—¬ ì œìž‘ë˜ì—ˆìŠµë‹ˆë‹¤. í‚¤ë³´ë“œ íƒìƒ‰, ìŠ¤í¬ë¦° ë¦¬ë”, ê³ ëŒ€ë¹„ ëª¨ë“œë¥¼ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤."}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(fa,{id:"name",label:"ì´ë¦„",value:s.name,onChange:j=>a({...s,name:j}),required:!0,error:t.name,placeholder:"ì´ë¦„ì„ ìž…ë ¥í•˜ì„¸ìš”",autoComplete:"name"}),e.jsx(fa,{id:"email",label:"ì´ë©”ì¼",type:"email",value:s.email,onChange:j=>a({...s,email:j}),required:!0,error:t.email,placeholder:"email@example.com",autoComplete:"email"})]}),e.jsx(fa,{id:"company",label:"íšŒì‚¬ëª…",value:s.company,onChange:j=>a({...s,company:j}),required:!0,error:t.company,placeholder:"íšŒì‚¬ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”",autoComplete:"organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(cl,{id:"role",label:"ì—­í• ",value:s.role,onChange:j=>a({...s,role:j}),options:k,placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"}),e.jsx(cl,{id:"department",label:"ë¶€ì„œ",value:s.department,onChange:j=>a({...s,department:j}),options:A,placeholder:"ë¶€ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"ë©”ì‹œì§€"}),e.jsx("textarea",{id:"message",rows:4,value:s.message,onChange:j=>a({...s,message:j.target.value}),placeholder:"ë©”ì‹œì§€ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","aria-describedby":"message-help"}),e.jsx("p",{id:"message-help",className:"mt-1 text-sm text-gray-500",children:"ì„ íƒì‚¬í•­: ì¶”ê°€ ì •ë³´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ìž…ë ¥í•˜ì„¸ìš”."})]}),l&&e.jsx(Ru,{value:g,label:"í¼ ì œì¶œ",announceChanges:!0,showPercentage:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Tt,{type:"submit",loading:l,loadingText:"ì œì¶œ ì¤‘...",disabled:l,children:"ì œì¶œí•˜ê¸° (Ctrl+S)"}),e.jsx(Tt,{type:"button",variant:"secondary",onClick:()=>a({name:"",email:"",company:"",role:"",department:"",message:""}),disabled:l,children:"ì´ˆê¸°í™”"})]})]}),n==="success"&&e.jsx(pa,{type:"success",title:"ì œì¶œ ì™„ë£Œ",children:"í¼ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤."}),n==="error"&&e.jsx(pa,{type:"error",title:"ì œì¶œ ì‹¤íŒ¨",children:"í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”."}),e.jsx($u,{isLoading:l,loadingText:"í¼ì„ ì œì¶œí•˜ëŠ” ì¤‘ìž…ë‹ˆë‹¤...",completeText:"í¼ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"}),e.jsx(Mu,{status:n==="success"?"í¼ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤":"",type:"success",announce:n==="success"})]})},{id:"navigation",label:"í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜",content:e.jsxs("div",{className:"space-y-6",children:[e.jsx(pa,{type:"info",title:"í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸",children:"Tab, Shift+Tab, ë°©í–¥í‚¤, Enter, Space, Escape í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰í•´ë³´ì„¸ìš”."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"í¬ì»¤ìŠ¤ ê°€ëŠ¥í•œ ìš”ì†Œë“¤"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["ë²„íŠ¼ 1","ë²„íŠ¼ 2","ë²„íŠ¼ 3","ë²„íŠ¼ 4"].map((j,h)=>e.jsx(Tt,{variant:h%2===0?"primary":"secondary",onClick:()=>O([...T,`${j} í´ë¦­ë¨`]),children:j},h))})]}),e.jsx(Yd,{onNavigate:j=>{O([...T,`${j} ë°©í–¥ìœ¼ë¡œ ì´ë™`])},onSelect:()=>{O([...T,"í•­ëª© ì„ íƒë¨"])},onEscape:()=>{O([...T,"Escape í‚¤ ëˆŒë¦¼"])},className:"p-4 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("div",{className:"text-center text-gray-600",children:[e.jsx(Na,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{children:"ë°©í–¥í‚¤ë¡œ íƒìƒ‰, Enterë¡œ ì„ íƒ, Escapeë¡œ ì¢…ë£Œ"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"í‚¤ë³´ë“œ ì•¡ì…˜ ë¡œê·¸"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-md h-32 overflow-y-auto",children:T.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"í‚¤ë³´ë“œ ì•¡ì…˜ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤"}):T.map((j,h)=>e.jsx("div",{className:"text-sm py-1",children:j},h))})]})]})},{id:"status",label:"ì ‘ê·¼ì„± ìƒíƒœ",content:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(Hs,{className:"h-5 w-5 mr-2"}),"í˜„ìž¬ ì„¤ì •"]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"ê¸€ìž í¬ê¸°"}),e.jsxs(B,{variant:"outline",children:[E==="small"&&"ìž‘ê²Œ",E==="normal"&&"ë³´í†µ",E==="large"&&"í¬ê²Œ",E==="extra-large"&&"ë§¤ìš° í¬ê²Œ"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"ê³ ëŒ€ë¹„ ëª¨ë“œ"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{variant:v?"default":"outline",children:v?"ì¼œì§":"êº¼ì§"}),v&&e.jsx(B,{variant:"secondary",className:"text-xs",children:F})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"ì• ë‹ˆë©”ì´ì…˜ ê°ì†Œ"}),e.jsx(B,{variant:_?"default":"outline",children:_?"ì¼œì§":"êº¼ì§"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤"}),e.jsx(B,{variant:"default",children:"í™œì„±í™”ë¨"})]})]})]}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(pe,{className:"h-5 w-5 mr-2 text-green-500"}),"ì§€ì› ê¸°ëŠ¥"]})}),e.jsx(q,{className:"space-y-3",children:["WCAG 2.1 AA ì¤€ìˆ˜","í‚¤ë³´ë“œ íƒìƒ‰ ì§€ì›","ìŠ¤í¬ë¦° ë¦¬ë” ìµœì í™”","ê³ ëŒ€ë¹„ ëª¨ë“œ","í™•ëŒ€/ì¶•ì†Œ ê°€ëŠ¥í•œ í…ìŠ¤íŠ¸","í¬ì»¤ìŠ¤ ê´€ë¦¬","ARIA ë ˆì´ë¸”","ì‹¤ì‹œê°„ ì•Œë¦¼"].map((j,h)=>e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(pe,{className:"h-4 w-4 mr-2 text-green-500 flex-shrink-0"}),j]},h))})]})]}),e.jsxs(L,{children:[e.jsx(H,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(Na,{className:"h-5 w-5 mr-2"}),"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤"]})}),e.jsx(q,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{keys:"Ctrl + S",action:"í¼ ì œì¶œ"},{keys:"Alt + H",action:"ê³ ëŒ€ë¹„ ëª¨ë“œ í† ê¸€"},{keys:"Ctrl + +",action:"ê¸€ìž í¬ê¸° í™•ëŒ€"},{keys:"Ctrl + -",action:"ê¸€ìž í¬ê¸° ì¶•ì†Œ"},{keys:"Alt + ?",action:"ë‹¨ì¶•í‚¤ ëª©ë¡ ë³´ê¸°"},{keys:"Alt + M",action:"ëª¨ë‹¬ ì—´ê¸°"},{keys:"Tab",action:"ë‹¤ìŒ ìš”ì†Œë¡œ ì´ë™"},{keys:"Shift + Tab",action:"ì´ì „ ìš”ì†Œë¡œ ì´ë™"}].map((j,h)=>e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm",children:j.action}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:j.keys})]},h))})})]})]})}];return e.jsx(vr,{children:e.jsx(zn,{children:e.jsx(Vn,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(yr,{}),e.jsx("main",{id:"main-content",className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ì ‘ê·¼ì„± êµ¬í˜„ ì˜ˆì‹œ"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"WCAG 2.1 AA ê¸°ì¤€ì„ ì¤€ìˆ˜í•œ ì™„ì „í•œ ì ‘ê·¼ì„± êµ¬í˜„ì„ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œìž…ë‹ˆë‹¤. í‚¤ë³´ë“œ íƒìƒ‰, ìŠ¤í¬ë¦° ë¦¬ë”, ê³ ëŒ€ë¹„ ëª¨ë“œë¥¼ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤."})]}),e.jsx(L,{children:e.jsx(q,{className:"p-6",children:e.jsx(Zd,{tabs:N,activeTab:w,onTabChange:p})})}),e.jsx("div",{className:"text-center",children:e.jsx(Tt,{onClick:()=>f(!0),variant:"secondary",children:"ì ‘ê·¼ì„± ëª¨ë‹¬ ì—´ê¸° (Alt+M)"})}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsx(Wd,{enabled:m,children:e.jsxs(L,{className:"w-full max-w-md mx-4",children:[e.jsx(H,{children:e.jsx(W,{children:"ì ‘ê·¼ì„± ëª¨ë‹¬"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsx("p",{children:"ì´ ëª¨ë‹¬ì€ í¬ì»¤ìŠ¤ íŠ¸ëž©ì„ ì‚¬ìš©í•˜ì—¬ í‚¤ë³´ë“œ íƒìƒ‰ì„ ëª¨ë‹¬ ë‚´ë¶€ë¡œ ì œí•œí•©ë‹ˆë‹¤."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Tt,{onClick:()=>f(!1),variant:"primary",children:"í™•ì¸"}),e.jsx(Tt,{onClick:()=>f(!1),variant:"secondary",children:"ì·¨ì†Œ"})]})]})]})})})]})}),e.jsx(Mi,{children:e.jsx("p",{children:"ì´ íŽ˜ì´ì§€ëŠ” ì›¹ ì ‘ê·¼ì„± ì§€ì¹¨ì„ ì¤€ìˆ˜í•˜ì—¬ ì œìž‘ë˜ì—ˆìŠµë‹ˆë‹¤. í‚¤ë³´ë“œë§Œìœ¼ë¡œë„ ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."})}),T.length>0&&e.jsx(Va,{message:T[T.length-1],priority:"polite"})]})})})})}const zu=Object.freeze(Object.defineProperty({__proto__:null,AccessibilityExample:Lu},Symbol.toStringTag,{value:"Module"}));export{X as $,As as A,B,L as C,Cr as D,lp as E,jr as F,Gt as G,da as H,U as I,Ft as J,Mt as K,P as L,Rt as M,Lt as N,$t as O,Yt as P,Jt as Q,np as R,Gs as S,kt as T,js as U,ze as V,qe as W,Ve as X,Ke as Y,Z,Y as _,me as a,ee as a0,ip as a1,R as a2,qx as a3,Vx as a4,op as a5,rt as a6,$n as a7,Rn as a8,gr as a9,Et as aa,V as ab,Pa as ac,Xu as ad,rp as ae,Zt as af,nt as ag,Ge as ah,tp as ai,ap as aj,xp as ak,ri as al,ep as am,sp as an,tl as ao,Zu as ap,Yu as aq,he as ar,q as b,H as c,W as d,jt as e,vt as f,is as g,hs as h,Ss as i,Ee as j,b as k,os as l,Oe as m,De as n,Ae as o,Te as p,rs as q,Pe as r,et as s,st as t,Ze as u,Me as v,oe as w,tt as x,G as y,wr as z};
