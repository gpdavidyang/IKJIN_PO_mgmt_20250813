import{n as ye,r as h,e as Fe,q as Z,s as O,aX as _s,j as e,F as ks,a9 as x,S as he,z as pe,A as je,D as ue,G as Q,B as l,k as K,J as I,w as F,a3 as R,a4 as z,P as be,x as P,Z as Is,ab as ps,o as M,aG as Qs,T as Se,E as Vs,R as Ye,V as es,W as se,X as ae,ac as Cs,y as w,aD as ce,Y as js,m as As,g as $s,aY as Hs,aZ as Xe,v as Fs,a5 as Ts,aP as $,aI as Pe,$ as Ve,M as we,a0 as He,a1 as Be,aQ as Ee,d as Bs,u as Js,h as Ws,l as us,a_ as Je,aJ as We,aK as B,aL as J,aM as W,aN as G,aO as X,a6 as Te,a7 as De,b as gs,c as vs,t as Gs,L as Xs,a as Zs}from"./index-CzHfiPOK-1757225839885.js";import{D as oe,a as de,b as xe,c as me,d as Oe,e as Ds,f as qe}from"./dialog-DwxjfadI-1757225839885.js";import{T as Ys,a as ea,b as ys,c as Ne,d as sa,e as fe}from"./table-Cgj_9OIE-1757225839885.js";import{A as Le,a as Me,b as Re,c as Ue,d as Ke,e as ze,f as ss,g as as,h as Ps}from"./alert-dialog-D33jhted-1757225839885.js";import{T as Es}from"./triangle-alert-C_RSz7IB-1757225839885.js";import{U as ke}from"./users-Dvm6Dguv-1757225839885.js";import{T as Ze}from"./textarea-Db1Wt82n-1757225839885.js";import{f as Ce}from"./formatters-xWdIEyrP-1757225839885.js";import{R as Ae,a as aa}from"./role-display-COuMnJp1-1757225839885.js";import{D as qs}from"./dollar-sign-Byc1oflS-1757225839885.js";import{S as ve}from"./square-pen-CwgtJHdZ-1757225839885.js";import{S as ts}from"./save-BbY9F5r7-1757225839885.js";import{A as ta,a as ra}from"./arrow-up-B1bPfaWV-1757225839885.js";import{Z as ia}from"./zap-R1mLPul7-1757225839885.js";import{L as na}from"./layers-BIVeUJo_-1757225839885.js";import{L as la}from"./list-jxlYEKxg-1757225839885.js";import{G as ca}from"./grid-3x3-CgcJl7bb-1757225839885.js";import{S as oa}from"./search-BStNXxCz-1757225839885.js";import{P as Ns}from"./phone-VjYJU6tl-1757225839885.js";import{C as fs}from"./calendar-D2gwn2JB-1757225839885.js";import{H as da}from"./hash-DavqiYuT-1757225839885.js";import"./index-4v1sWQOr-1757225839885.js";import"./use-ui-terms-CULyvh3B-1757225839885.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=ye("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=ye("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=ye("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=ye("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=ye("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=ye("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=ye("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);function bs({user:m,isOpen:o,onClose:y,onSuccess:N}){const[S,k]=h.useState("checking"),[a,C]=h.useState(""),{toast:v}=Fe(),{data:p,isLoading:E}=Z({queryKey:[`/api/users/${m.id}/references`],enabled:o,retry:!1}),{data:D}=Z({queryKey:["/api/users"],enabled:S==="reassign"}),f=O({mutationFn:async j=>await K("POST",`/api/users/${m.id}/reassign`,{toUserId:j}),onSuccess:()=>{k("confirm"),v({title:"í˜„ì¥ ì¬ë°°ì • ì™„ë£Œ",description:"í˜„ì¥ ë‹´ë‹¹ìê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:j=>{v({title:"ì¬ë°°ì • ì‹¤íŒ¨",description:j.message||"í˜„ì¥ ì¬ë°°ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),A=O({mutationFn:async()=>await K("DELETE",`/api/users/${m.id}`),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/users"]}),N(),y(),v({title:"ì‚¬ìš©ì ì‚­ì œ ì™„ë£Œ",description:"ì‚¬ìš©ìê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:j=>{v({title:"ì‚­ì œ ì‹¤íŒ¨",description:j.message||"ì‚¬ìš©ì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});_s.useEffect(()=>{p&&!E&&(p.canDelete?k("confirm"):(p.references.orders.length>0,k("warning")))},[p,E]);const g=()=>{if(!a){v({title:"ë‹´ë‹¹ì ì„ íƒ í•„ìš”",description:"ìƒˆë¡œìš´ ë‹´ë‹¹ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",variant:"destructive"});return}f.mutate(a)},b=()=>{A.mutate()},_=D?.filter(j=>j.id!==m.id&&j.isActive)||[];return e.jsx(Le,{open:o,onOpenChange:y,children:e.jsxs(Me,{className:"max-w-2xl",children:[e.jsxs(Re,{children:[e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5 text-amber-500"}),"ì‚¬ìš©ì ì‚­ì œ"]}),e.jsx(Ke,{asChild:!0,children:e.jsxs("div",{className:"space-y-4",children:[S==="checking"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"ì‚¬ìš©ì ì°¸ì¡° ê´€ê³„ë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤..."})]}),S==="warning"&&p&&e.jsx("div",{className:"space-y-4",children:p.references.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[m.name||m.email," ì‚¬ìš©ìëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ks,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"font-medium text-red-800",children:["ìƒì„±í•œ ë°œì£¼ì„œ (",p.references.orders.length,"ê°œ)"]})]}),e.jsx("p",{className:"text-sm text-red-700 mb-2",children:"ë°œì£¼ì„œ ê¸°ë¡ì€ íšŒê³„ ë° ê°ì‚¬ë¥¼ ìœ„í•´ ìƒì„±ì ì •ë³´ë¥¼ ë³´ì¡´í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsxs("div",{className:"bg-red-100 p-2 rounded text-xs text-red-800",children:[e.jsx("strong",{children:"ëŒ€ì•ˆ:"})," ì‚¬ìš©ì ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì—­í• ì„ ë³€ê²½í•˜ì—¬ ì‹œìŠ¤í…œ ì ‘ê·¼ì„ ì œí•œí•˜ì„¸ìš”."]})]}),p.references.projects.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ke,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["ì—°ê²°ëœ í˜„ì¥ (",p.references.projects.length,"ê°œ)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:p.references.projects.map(j=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:j.name}),e.jsx("span",{className:"text-blue-500",children:j.type==="project_manager"?"í˜„ì¥ ê´€ë¦¬ì":"í˜„ì¥ ë©¤ë²„"})]},j.id))})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-amber-600 font-medium",children:[m.name||m.email," ì‚¬ìš©ìëŠ” ë‹¤ìŒ í˜„ì¥ê³¼ ì—°ê²°ë˜ì–´ ìˆì–´ ë°”ë¡œ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:"]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ke,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["ì—°ê²°ëœ í˜„ì¥ (",p.references.projects.length,"ê°œ)"]})]}),e.jsx("ul",{className:"space-y-1 text-sm text-blue-700",children:p.references.projects.map(j=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:j.name}),e.jsx("span",{className:"text-blue-500",children:j.type==="project_manager"?"í˜„ì¥ ê´€ë¦¬ì":"í˜„ì¥ ë©¤ë²„"})]},j.id))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ê³„ì† ì§„í–‰í•˜ë ¤ë©´ ë¨¼ì € í˜„ì¥ ë‹´ë‹¹ìë¥¼ ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ì¬ë°°ì •í•´ì•¼ í•©ë‹ˆë‹¤."})]})}),S==="reassign"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"í˜„ì¥ ë‹´ë‹¹ìë¥¼ ì¬ë°°ì •í•  ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"replacement-user",children:"ìƒˆë¡œìš´ ë‹´ë‹¹ì"}),e.jsxs(he,{value:a,onValueChange:C,children:[e.jsx(pe,{children:e.jsx(je,{placeholder:"ë‹´ë‹¹ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"})}),e.jsx(ue,{children:_.map(j=>e.jsxs(Q,{value:j.id,children:[j.name," (",j.email,") - ",j.role==="admin"?"ê´€ë¦¬ì":j.role==="order_manager"?"ë°œì£¼ ë‹´ë‹¹ì":"ì‚¬ìš©ì"]},j.id))})]})]})]}),S==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-red-600 font-medium",children:[m.name||m.email," ì‚¬ìš©ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‚¬ìš©ìì˜ ëª¨ë“  ì •ë³´ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤."})]})]})})]}),e.jsxs(ze,{children:[S==="warning"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:y,children:"ì·¨ì†Œ"}),p&&p.references.orders.length===0&&e.jsx(l,{onClick:()=>k("reassign"),children:"ì¬ë°°ì • ì§„í–‰"})]}),S==="reassign"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:y,children:"ì·¨ì†Œ"}),e.jsx(l,{onClick:g,disabled:!a||f.isPending,children:f.isPending?"ì¬ë°°ì • ì¤‘...":"ì¬ë°°ì • í›„ ì‚­ì œ"})]}),S==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",onClick:y,children:"ì·¨ì†Œ"}),e.jsx(l,{variant:"destructive",onClick:b,disabled:A.isPending,children:A.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})})}function ga(){const{toast:m}=Fe(),[o,y]=h.useState(null),[N,S]=h.useState(!1),[k,a]=h.useState(!1),[C,v]=h.useState(!1),[p,E]=h.useState(null),[D,f]=h.useState(!1),[A,g]=h.useState({name:"",description:"",isActive:!0,isDefault:!1,steps:[]}),{data:b=[],isLoading:_}=Z({queryKey:["/api/approval-workflow-templates"],queryFn:async()=>{const t=await fetch("/api/approval-workflow-templates",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch templates");return t.json()}});Z({queryKey:["/api/categories/list"],queryFn:async()=>{const t=await fetch("/api/categories/list",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch categories");return t.json()}});const j=O({mutationFn:t=>K("POST","/api/approval-workflow-templates",t),onSuccess:()=>{m({title:"ì„±ê³µ",description:"ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/approval-workflow-templates"]}),S(!1),te()},onError:()=>{m({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),i=O({mutationFn:({id:t,data:c})=>K("PUT",`/api/approval-workflow-templates/${t}`,c),onSuccess:()=>{m({title:"ì„±ê³µ",description:"ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/approval-workflow-templates"]}),a(!1),y(null),te()},onError:()=>{m({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),d=O({mutationFn:t=>K("DELETE",`/api/approval-workflow-templates/${t}`),onSuccess:()=>{m({title:"ì„±ê³µ",description:"ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/approval-workflow-templates"]}),v(!1),E(null),o?.id===p?.id&&y(null)},onError:()=>{m({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),T=O({mutationFn:t=>K("POST",`/api/approval-workflow-templates/${t}/duplicate`),onSuccess:()=>{m({title:"ì„±ê³µ",description:"ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ì´ ë³µì œë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/approval-workflow-templates"]})},onError:()=>{m({title:"ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ë³µì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),te=()=>{g({name:"",description:"",isActive:!0,isDefault:!1,steps:[]})},ge=()=>{g(t=>({...t,steps:[...t.steps,{stepOrder:t.steps.length+1,requiredRole:"project_manager",notificationSettings:{onPending:!0,onApproved:!0,onRejected:!0}}]}))},V=(t,c)=>{g(q=>({...q,steps:q.steps.map((H,re)=>re===t?{...H,...c}:H)}))},Y=t=>{g(c=>({...c,steps:c.steps.filter((q,H)=>H!==t).map((q,H)=>({...q,stepOrder:H+1}))}))},r=(t,c)=>{const q=c==="up"?t-1:t+1;q<0||q>=A.steps.length||g(H=>{const re=[...H.steps];return[re[t],re[q]]=[re[q],re[t]],{...H,steps:re.map((_e,rs)=>({..._e,stepOrder:rs+1}))}})},n=()=>{if(!A.name||A.steps.length===0){m({title:"ì…ë ¥ ì˜¤ë¥˜",description:"í…œí”Œë¦¿ ì´ë¦„ê³¼ ìµœì†Œ 1ê°œì˜ ìŠ¹ì¸ ë‹¨ê³„ê°€ í•„ìš”í•©ë‹ˆë‹¤.",variant:"destructive"});return}k&&o?i.mutate({id:o.id,data:A}):j.mutate(A)},u=t=>{y(t),g({name:t.name,description:t.description,isActive:t.isActive,isDefault:t.isDefault,minAmount:t.minAmount,maxAmount:t.maxAmount,categoryFilter:t.categoryFilter,steps:t.steps}),a(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-primary"}),e.jsx("span",{children:"ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ ê´€ë¦¬"})]}),e.jsxs(l,{onClick:()=>S(!0),size:"sm",className:"gap-1",children:[e.jsx(be,{className:"h-4 w-4"}),"ìƒˆ í…œí”Œë¦¿"]})]})}),e.jsx(P,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"ë°œì£¼ì„œ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ìœ„í•œ ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤. ê° í…œí”Œë¦¿ì€ ê¸ˆì•¡, ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë‹¤ë¥¸ ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(F,{className:"h-full",children:[e.jsx(R,{children:e.jsx(z,{className:"text-sm",children:"í…œí”Œë¦¿ ëª©ë¡"})}),e.jsx(P,{className:"p-0",children:e.jsx(Is,{className:"h-[600px]",children:_?e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"ë¡œë”© ì¤‘..."}):b.length===0?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx($e,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground/50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤"})]}):e.jsx("div",{className:"divide-y",children:b.map(t=>e.jsxs("div",{className:ps("p-4 cursor-pointer hover:bg-accent transition-colors",o?.id===t.id&&"bg-accent"),onClick:()=>y(t),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[t.isDefault&&e.jsx(M,{variant:"default",className:"text-xs",children:"ê¸°ë³¸"}),e.jsx(M,{variant:t.isActive?"outline":"secondary",className:"text-xs",children:t.isActive?"í™œì„±":"ë¹„í™œì„±"})]})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ke,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.steps.length,"ê°œ ìŠ¹ì¸ ë‹¨ê³„"]})]}),(t.minAmount||t.maxAmount)&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(qs,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.minAmount&&`${Ce(t.minAmount)} ì´ìƒ`,t.minAmount&&t.maxAmount&&" ~ ",t.maxAmount&&`${Ce(t.maxAmount)} ì´í•˜`]})]}),t.categoryFilter&&t.categoryFilter.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ks,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.categoryFilter.length,"ê°œ ì¹´í…Œê³ ë¦¬"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-3",children:[e.jsxs(l,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:c=>{c.stopPropagation(),u(t)},children:[e.jsx(ve,{className:"h-3 w-3 mr-1"}),"í¸ì§‘"]}),e.jsxs(l,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:c=>{c.stopPropagation(),T.mutate(t.id)},children:[e.jsx(Qs,{className:"h-3 w-3 mr-1"}),"ë³µì œ"]}),e.jsxs(l,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs text-destructive hover:text-destructive",onClick:c=>{c.stopPropagation(),E(t),v(!0)},children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"ì‚­ì œ"]})]})]},t.id))})})})]})}),e.jsx("div",{className:"lg:col-span-2",children:o&&!k&&!N?e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-base",children:o.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>f(!0),children:[e.jsx(Vs,{className:"h-4 w-4 mr-1"}),"ë¯¸ë¦¬ë³´ê¸°"]}),e.jsxs(l,{size:"sm",onClick:()=>u(o),children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),"í¸ì§‘"]})]})]})}),e.jsx(P,{children:e.jsxs(Ye,{defaultValue:"overview",className:"w-full",children:[e.jsxs(es,{className:"grid w-full grid-cols-3",children:[e.jsx(se,{value:"overview",children:"ê°œìš”"}),e.jsx(se,{value:"steps",children:"ìŠ¹ì¸ ë‹¨ê³„"}),e.jsx(se,{value:"conditions",children:"ì¡°ê±´"})]}),e.jsxs(ae,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ì„¤ëª…"}),e.jsx("p",{className:"text-sm mt-1",children:o.description||"ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ìƒíƒœ"}),e.jsx("div",{className:"mt-1",children:e.jsx(M,{variant:o.isActive?"default":"secondary",children:o.isActive?"í™œì„±":"ë¹„í™œì„±"})})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ê¸°ë³¸ í…œí”Œë¦¿"}),e.jsx("div",{className:"mt-1",children:e.jsx(M,{variant:o.isDefault?"default":"outline",children:o.isDefault?"ì˜ˆ":"ì•„ë‹ˆì˜¤"})})]})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ìƒì„±ì¼"}),e.jsx("p",{className:"text-sm mt-1",children:new Date(o.createdAt).toLocaleString("ko-KR")})]})]}),e.jsx(ae,{value:"steps",className:"space-y-4",children:o.steps.map((t,c)=>e.jsxs(F,{children:[e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(M,{variant:"outline",className:"text-xs",children:[t.stepOrder,"ë‹¨ê³„"]}),e.jsx(Ae,{role:t.requiredRole})]}),t.autoApprove&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"ìë™ ìŠ¹ì¸"})]})}),e.jsxs(P,{className:"pt-0",children:[t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:t.description}),t.skipCondition&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Es,{className:"h-3 w-3"}),e.jsxs("span",{children:["ê±´ë„ˆë›°ê¸° ì¡°ê±´: ",t.skipCondition==="amount_below"?`${Ce(t.skipThreshold||0)} ë¯¸ë§Œ`:t.skipCondition==="category_match"?"íŠ¹ì • ì¹´í…Œê³ ë¦¬":"í•­ìƒ"]})]}),t.notificationSettings&&e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[t.notificationSettings.onPending&&e.jsx(M,{variant:"outline",className:"text-xs",children:"ëŒ€ê¸° ì•Œë¦¼"}),t.notificationSettings.onApproved&&e.jsx(M,{variant:"outline",className:"text-xs",children:"ìŠ¹ì¸ ì•Œë¦¼"}),t.notificationSettings.onRejected&&e.jsx(M,{variant:"outline",className:"text-xs",children:"ë°˜ë ¤ ì•Œë¦¼"})]})]})]},c))}),e.jsxs(ae,{value:"conditions",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ê¸ˆì•¡ ë²”ìœ„"}),e.jsx("p",{className:"text-sm mt-1",children:o.minAmount||o.maxAmount?e.jsxs(e.Fragment,{children:[o.minAmount&&`${Ce(o.minAmount)} ì´ìƒ`,o.minAmount&&o.maxAmount&&" ~ ",o.maxAmount&&`${Ce(o.maxAmount)} ì´í•˜`]}):"ì œí•œ ì—†ìŒ"})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ì¹´í…Œê³ ë¦¬ í•„í„°"}),e.jsx("div",{className:"mt-2",children:o.categoryFilter&&o.categoryFilter.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:o.categoryFilter.map(t=>e.jsx(M,{variant:"outline",className:"text-xs",children:t},t))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"ëª¨ë“  ì¹´í…Œê³ ë¦¬"})})]})]})]})})]}):N||k?e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:k?"í…œí”Œë¦¿ í¸ì§‘":"ìƒˆ í…œí”Œë¦¿ ìƒì„±"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{S(!1),a(!1),te()},children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),"ì·¨ì†Œ"]}),e.jsxs(l,{size:"sm",onClick:n,disabled:j.isPending||i.isPending,children:[e.jsx(ts,{className:"h-4 w-4 mr-1"}),"ì €ì¥"]})]})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",children:"í…œí”Œë¦¿ ì´ë¦„ *"}),e.jsx(w,{id:"name",value:A.name,onChange:t=>g(c=>({...c,name:t.target.value})),placeholder:"ì˜ˆ: í‘œì¤€ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"description",children:"ì„¤ëª…"}),e.jsx(w,{id:"description",value:A.description,onChange:t=>g(c=>({...c,description:t.target.value})),placeholder:"í…œí”Œë¦¿ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”",className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{htmlFor:"isActive",children:"í™œì„±í™”"}),e.jsx(ce,{id:"isActive",checked:A.isActive,onCheckedChange:t=>g(c=>({...c,isActive:t}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{htmlFor:"isDefault",children:"ê¸°ë³¸ í…œí”Œë¦¿"}),e.jsx(ce,{id:"isDefault",checked:A.isDefault,onCheckedChange:t=>g(c=>({...c,isDefault:t}))})]})]})]}),e.jsx(js,{}),e.jsxs("div",{children:[e.jsx(x,{children:"ê¸ˆì•¡ ë²”ìœ„ (ì„ íƒì‚¬í•­)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"minAmount",className:"text-xs text-muted-foreground",children:"ìµœì†Œ ê¸ˆì•¡"}),e.jsx(w,{id:"minAmount",type:"number",value:A.minAmount||"",onChange:t=>g(c=>({...c,minAmount:t.target.value?parseInt(t.target.value):void 0})),placeholder:"0",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"maxAmount",className:"text-xs text-muted-foreground",children:"ìµœëŒ€ ê¸ˆì•¡"}),e.jsx(w,{id:"maxAmount",type:"number",value:A.maxAmount||"",onChange:t=>g(c=>({...c,maxAmount:t.target.value?parseInt(t.target.value):void 0})),placeholder:"ì œí•œ ì—†ìŒ",className:"mt-1"})]})]})]}),e.jsx(js,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(x,{children:"ìŠ¹ì¸ ë‹¨ê³„ *"}),e.jsxs(l,{variant:"outline",size:"sm",onClick:ge,children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"ë‹¨ê³„ ì¶”ê°€"]})]}),A.steps.length===0?e.jsx(F,{className:"border-dashed",children:e.jsxs(P,{className:"py-8 text-center",children:[e.jsx(xa,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground/50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ìŠ¹ì¸ ë‹¨ê³„ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(l,{variant:"outline",size:"sm",className:"mt-3",onClick:ge,children:"ì²« ë‹¨ê³„ ì¶”ê°€"})]})}):e.jsx("div",{className:"space-y-3",children:A.steps.map((t,c)=>e.jsxs(F,{children:[e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(M,{variant:"outline",className:"text-xs",children:[t.stepOrder,"ë‹¨ê³„"]}),e.jsxs(he,{value:t.requiredRole,onValueChange:q=>V(c,{requiredRole:q}),children:[e.jsx(pe,{className:"w-[150px] h-8",children:e.jsx(je,{})}),e.jsxs(ue,{children:[e.jsx(Q,{value:"field_worker",children:"í˜„ì¥ ì‹¤ë¬´ì"}),e.jsx(Q,{value:"project_manager",children:"í˜„ì¥ ê´€ë¦¬ì"}),e.jsx(Q,{value:"hq_management",children:"ë³¸ì‚¬ ê´€ë¦¬ë¶€"}),e.jsx(Q,{value:"executive",children:"ì„ì›/ëŒ€í‘œ"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>r(c,"up"),disabled:c===0,children:e.jsx(ta,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>r(c,"down"),disabled:c===A.steps.length-1,children:e.jsx(ra,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-destructive hover:text-destructive",onClick:()=>Y(c),children:e.jsx(Se,{className:"h-4 w-4"})})]})]})}),e.jsxs(P,{className:"pt-0 space-y-3",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:`step-desc-${c}`,className:"text-xs",children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(w,{id:`step-desc-${c}`,value:t.description||"",onChange:q=>V(c,{description:q.target.value}),placeholder:"ì´ ìŠ¹ì¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…",className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{id:`auto-approve-${c}`,checked:t.autoApprove||!1,onCheckedChange:q=>V(c,{autoApprove:q})}),e.jsx(x,{htmlFor:`auto-approve-${c}`,className:"text-xs cursor-pointer",children:"ìë™ ìŠ¹ì¸"})]}),t.autoApprove&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"text-xs text-muted-foreground",children:"ì§€ì—° ì‹œê°„ (ì‹œê°„)"}),e.jsx(w,{type:"number",value:t.autoApproveDelay||24,onChange:q=>V(c,{autoApproveDelay:parseInt(q.target.value)||24}),className:"w-20 h-7"})]})]})]})]},c))})]})]})})]}):e.jsx(F,{children:e.jsxs(P,{className:"py-12 text-center",children:[e.jsx($e,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"í…œí”Œë¦¿ ì„ íƒ"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"ì™¼ìª½ ëª©ë¡ì—ì„œ í…œí”Œë¦¿ì„ ì„ íƒí•˜ê±°ë‚˜ ìƒˆ í…œí”Œë¦¿ì„ ìƒì„±í•˜ì„¸ìš”"}),e.jsxs(l,{onClick:()=>S(!0),children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"ìƒˆ í…œí”Œë¦¿ ìƒì„±"]})]})})})]}),e.jsx(Le,{open:C,onOpenChange:v,children:e.jsxs(Me,{children:[e.jsxs(Re,{children:[e.jsx(Ue,{children:"í…œí”Œë¦¿ ì‚­ì œ"}),e.jsxs(Ke,{children:['"',p?.name,'" í…œí”Œë¦¿ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.']})]}),e.jsxs(ze,{children:[e.jsx(ss,{children:"ì·¨ì†Œ"}),e.jsx(as,{onClick:()=>{p&&d.mutate(p.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"ì‚­ì œ"})]})]})}),o&&e.jsx(oe,{open:D,onOpenChange:f,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(xe,{children:[e.jsxs(me,{children:["ì›Œí¬í”Œë¡œìš° ë¯¸ë¦¬ë³´ê¸°: ",o.name]}),e.jsx(Oe,{children:"ì´ í…œí”Œë¦¿ì´ ì ìš©ë  ë•Œì˜ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ íë¦„ì…ë‹ˆë‹¤"})]}),e.jsx("div",{className:"space-y-4",children:o.steps.map((t,c)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:ps("w-10 h-10 rounded-full flex items-center justify-center font-bold text-white",c===0?"bg-blue-500":"bg-gray-400"),children:t.stepOrder})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{role:t.requiredRole}),t.autoApprove&&e.jsxs(M,{variant:"secondary",className:"text-xs",children:["ìë™ ìŠ¹ì¸ (",t.autoApproveDelay,"ì‹œê°„ í›„)"]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description})]}),c<o.steps.length-1&&e.jsx(As,{className:"h-5 w-5 text-muted-foreground"})]},c))}),e.jsx(Ds,{children:e.jsx(l,{variant:"outline",onClick:()=>f(!1),children:"ë‹«ê¸°"})})]})})]})}const va={admin:"ê´€ë¦¬ì",executive:"ì„ì›",hq_management:"ë³¸ì‚¬ ê´€ë¦¬ì",project_manager:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €",field_worker:"í˜„ì¥ ì‘ì—…ì"},ws=[{value:"admin",label:"ê´€ë¦¬ì"},{value:"executive",label:"ì„ì›"},{value:"hq_management",label:"ë³¸ì‚¬ ê´€ë¦¬ì"},{value:"project_manager",label:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €"},{value:"field_worker",label:"í˜„ì¥ ì‘ì—…ì"}];function ya(){const{toast:m}=Fe(),o=$s(),[y]=h.useState(1),[N,S]=h.useState(!1),[k,a]=h.useState(null),[C,v]=h.useState([]),[p,E]=h.useState({approvalMode:"direct",directApprovalRoles:[],skipLowerStages:!1}),[D,f]=h.useState({templateName:"",stepOrder:"",requiredRole:"",minAmount:"",maxAmount:"",canSkip:!1,isOptional:!1,description:""}),{data:A,isLoading:g}=Z({queryKey:["workflow-settings",y],queryFn:async()=>{const r=await fetch(`/api/approval-settings/workflow-settings/${y}`,{credentials:"include"});if(!r.ok)throw new Error("Failed to fetch workflow settings");return(await r.json()).data}}),{data:b=[],isLoading:_}=Z({queryKey:["step-templates",y],queryFn:async()=>{const r=await fetch(`/api/approval-settings/step-templates/${y}`,{credentials:"include"});if(!r.ok)throw new Error("Failed to fetch step templates");return(await r.json()).data}}),j=O({mutationFn:async r=>{const n=await fetch("/api/approval-settings/workflow-settings",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});if(!n.ok){const u=await n.json();throw new Error(u.error||"Failed to update workflow settings")}return n.json()},onSuccess:()=>{o.invalidateQueries({queryKey:["workflow-settings"]}),m({title:"ì„±ê³µ",description:"ì›Œí¬í”Œë¡œ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{m({title:"ì˜¤ë¥˜",description:r.message,variant:"destructive"})}}),i=O({mutationFn:async r=>{const n=r.id?`/api/approval-settings/step-templates/${r.id}`:"/api/approval-settings/step-templates",u=r.id?"PUT":"POST",t=await fetch(n,{method:u,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...r,stepOrder:parseInt(r.stepOrder),minAmount:r.minAmount,maxAmount:r.maxAmount||null})});if(!t.ok){const c=await t.json();throw new Error(c.error||"Failed to save template")}return t.json()},onSuccess:()=>{o.invalidateQueries({queryKey:["step-templates"]}),S(!1),a(null),T(),m({title:"ì„±ê³µ",description:k?"í…œí”Œë¦¿ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"í…œí”Œë¦¿ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{m({title:"ì˜¤ë¥˜",description:r.message,variant:"destructive"})}}),d=O({mutationFn:async r=>{const n=await fetch(`/api/approval-settings/step-templates/${r}`,{method:"DELETE",credentials:"include"});if(!n.ok){const u=await n.json();throw new Error(u.error||"Failed to delete template")}return n.json()},onSuccess:()=>{o.invalidateQueries({queryKey:["step-templates"]}),m({title:"ì„±ê³µ",description:"í…œí”Œë¦¿ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:r=>{m({title:"ì˜¤ë¥˜",description:r.message,variant:"destructive"})}}),T=()=>{f({templateName:"",stepOrder:"",requiredRole:"",minAmount:"",maxAmount:"",canSkip:!1,isOptional:!1,description:""})},te=r=>{a(r),f({templateName:r.templateName,stepOrder:r.stepOrder.toString(),requiredRole:r.requiredRole,minAmount:r.minAmount,maxAmount:r.maxAmount||"",canSkip:r.canSkip,isOptional:r.isOptional,description:r.description||""}),S(!0)},ge=r=>{E(n=>({...n,directApprovalRoles:n.directApprovalRoles.includes(r)?n.directApprovalRoles.filter(u=>u!==r):[...n.directApprovalRoles,r]}))},V=r=>{v(n=>n.includes(r)?n.filter(u=>u!==r):[...n,r])},Y=b.reduce((r,n)=>(r[n.templateName]||(r[n.templateName]=[]),r[n.templateName].push(n),r),{});return Object.keys(Y).forEach(r=>{Y[r].sort((n,u)=>n.stepOrder-u.stepOrder)}),g||_?e.jsx(F,{children:e.jsx(P,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(F,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:[e.jsx(R,{children:e.jsxs(z,{className:"flex items-center space-x-2 text-blue-800",children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{children:"ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬"})]})}),e.jsxs(P,{className:"text-sm text-blue-700 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"ğŸš€ ìƒˆë¡œìš´ í…œí”Œë¦¿ ë¹Œë”:"})}),e.jsxs("ul",{className:"ml-4 space-y-1",children:[e.jsx("li",{children:"- ì‹œê°ì  ì¸í„°í˜ì´ìŠ¤ë¡œ ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ì„ ì‰½ê²Œ ìƒì„±í•˜ê³  ê´€ë¦¬"}),e.jsx("li",{children:"- ê¸ˆì•¡ë³„, ì¹´í…Œê³ ë¦¬ë³„ ì¡°ê±´ë¶€ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì„¤ì •"}),e.jsx("li",{children:"- ìë™ ìŠ¹ì¸, ì•Œë¦¼ ì„¤ì •, ë‹¨ê³„ ê±´ë„ˆë›°ê¸° ë“± ê³ ê¸‰ ê¸°ëŠ¥"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"ğŸ“‹ ë ˆê±°ì‹œ ì„¤ì •:"})}),e.jsxs("ul",{className:"ml-4 space-y-1",children:[e.jsx("li",{children:"- ê¸°ì¡´ ì›Œí¬í”Œë¡œìš° ì„¤ì •ê³¼ì˜ í˜¸í™˜ì„± ìœ ì§€"}),e.jsx("li",{children:"- ë‹¨ìˆœí•œ ìŠ¹ì¸ ëª¨ë“œ ì„¤ì • (ì§ì ‘/ë‹¨ê³„ë³„)"}),e.jsx("li",{children:"- ê¸°ë³¸ ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿ ê´€ë¦¬"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-100 to-indigo-100 p-3 rounded-lg",children:e.jsxs("p",{children:[e.jsx("strong",{children:"ğŸ’¡ ê¶Œì¥ì‚¬í•­:"})," ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ëŠ” ",e.jsx("strong",{children:"í…œí”Œë¦¿ ë¹Œë”"}),"ë¥¼ ì‚¬ìš©í•˜ì‹œê³ , ê¸°ì¡´ ì„¤ì •ì´ ìˆëŠ” ê²½ìš° ",e.jsx("strong",{children:"ë ˆê±°ì‹œ ì„¤ì •"}),"ì—ì„œ ê´€ë¦¬í•˜ì„¸ìš”."]})})]})]}),e.jsxs(Ye,{defaultValue:"builder",className:"w-full",children:[e.jsxs(es,{className:"grid w-full grid-cols-2",children:[e.jsxs(se,{value:"builder",className:"flex items-center gap-2",children:[e.jsx(ia,{className:"h-4 w-4"}),"í…œí”Œë¦¿ ë¹Œë” (ì‹ ê·œ)"]}),e.jsxs(se,{value:"legacy",className:"flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),"ë ˆê±°ì‹œ ì„¤ì •"]})]}),e.jsx(ae,{value:"builder",className:"mt-6",children:e.jsx(ga,{})}),e.jsxs(ae,{value:"legacy",className:"mt-6 space-y-6",children:[e.jsxs(F,{children:[e.jsxs(R,{children:[e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Hs,{className:"w-5 h-5"}),e.jsx("span",{children:"ê¸°ë³¸ ì›Œí¬í”Œë¡œìš° ì„¤ì •"})]}),e.jsx(Xe,{children:"íšŒì‚¬ì˜ ê¸°ë³¸ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° ë°©ì‹ì„ ì„¤ì •í•©ë‹ˆë‹¤."})]}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{className:"text-base font-semibold",children:"ìŠ¹ì¸ ëª¨ë“œ"}),e.jsxs(he,{value:p.approvalMode,onValueChange:r=>E(n=>({...n,approvalMode:r})),children:[e.jsx(pe,{children:e.jsx(je,{})}),e.jsxs(ue,{children:[e.jsx(Q,{value:"direct",children:"ì§ì ‘ ìŠ¹ì¸"}),e.jsx(Q,{value:"staged",children:"ë‹¨ê³„ë³„ ìŠ¹ì¸"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:p.approvalMode==="direct"?"ì§ì ‘ìŠ¹ì¸ ëª¨ë“œëŠ” ë°œì£¼ì„œ ìƒì„± ì‹œ, ìŠ¹ì¸ì ˆì°¨ ì—†ì´ ë°”ë¡œ ë°œì£¼ì„œê°€ ìƒì„±ì´ ë©ë‹ˆë‹¤.":"ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì³ ìˆœì°¨ì ìœ¼ë¡œ ìŠ¹ì¸í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤."})]}),p.approvalMode==="direct"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{className:"text-base font-semibold",children:"ì§ì ‘ ìŠ¹ì¸ ê°€ëŠ¥ ì—­í• "}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:ws.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:r.value,checked:p.directApprovalRoles.includes(r.value),onChange:()=>ge(r.value),className:"rounded border-gray-300"}),e.jsx(x,{htmlFor:r.value,className:"text-sm",children:r.label})]},r.value))})]}),p.approvalMode==="staged"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-base font-semibold",children:"í•˜ìœ„ ë‹¨ê³„ ê±´ë„ˆë›°ê¸° í—ˆìš©"}),e.jsx(ce,{checked:p.skipLowerStages,onCheckedChange:r=>E(n=>({...n,skipLowerStages:r}))})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"ìƒìœ„ ê¶Œí•œìê°€ í•˜ìœ„ ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›¸ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤."})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(l,{onClick:()=>j.mutate({...p,companyId:y}),disabled:j.isPending,children:j.isPending?"ì €ì¥ ì¤‘...":"ì„¤ì • ì €ì¥"})})]})]}),e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(z,{children:"ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿"}),e.jsx(Xe,{children:"ë‹¨ê³„ë³„ ìŠ¹ì¸ì„ ìœ„í•œ í…œí”Œë¦¿ì„ ê´€ë¦¬í•©ë‹ˆë‹¤."})]}),e.jsxs(oe,{open:N,onOpenChange:S,children:[e.jsx(qe,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>{T(),a(null)},children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"ìƒˆ í…œí”Œë¦¿ ë‹¨ê³„ ì¶”ê°€"]})}),e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(xe,{children:[e.jsx(me,{children:k?"ìŠ¹ì¸ ë‹¨ê³„ ìˆ˜ì •":"ìƒˆ ìŠ¹ì¸ ë‹¨ê³„ ì¶”ê°€"}),e.jsx(Oe,{children:"ìŠ¹ì¸ ë‹¨ê³„ì˜ ìƒì„¸ ì •ë³´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤."})]}),e.jsxs("form",{onSubmit:r=>{r.preventDefault(),i.mutate({...D,companyId:y,id:k?.id})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"templateName",children:"í…œí”Œë¦¿ ì´ë¦„"}),e.jsx(w,{id:"templateName",value:D.templateName,onChange:r=>f(n=>({...n,templateName:r.target.value})),placeholder:"ì˜ˆ: ì¼ë°˜ë°œì£¼, ê³ ì•¡ë°œì£¼"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"stepOrder",children:"ë‹¨ê³„ ìˆœì„œ"}),e.jsx(w,{id:"stepOrder",type:"number",value:D.stepOrder,onChange:r=>f(n=>({...n,stepOrder:r.target.value})),placeholder:"1, 2, 3..."})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"requiredRole",children:"í•„ìš” ì—­í• "}),e.jsxs(he,{value:D.requiredRole,onValueChange:r=>f(n=>({...n,requiredRole:r})),children:[e.jsx(pe,{children:e.jsx(je,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ue,{children:ws.map(r=>e.jsx(Q,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"minAmount",children:"ìµœì†Œ ê¸ˆì•¡ (ì›)"}),e.jsx(w,{id:"minAmount",type:"number",value:D.minAmount,onChange:r=>f(n=>({...n,minAmount:r.target.value})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"maxAmount",children:"ìµœëŒ€ ê¸ˆì•¡ (ì›, ì„ íƒì‚¬í•­)"}),e.jsx(w,{id:"maxAmount",type:"number",value:D.maxAmount,onChange:r=>f(n=>({...n,maxAmount:r.target.value})),placeholder:"ì œí•œ ì—†ìŒ"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{checked:D.canSkip,onCheckedChange:r=>f(n=>({...n,canSkip:r}))}),e.jsx(x,{children:"ê±´ë„ˆë›°ê¸° í—ˆìš©"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{checked:D.isOptional,onCheckedChange:r=>f(n=>({...n,isOptional:r}))}),e.jsx(x,{children:"ì„ íƒì  ë‹¨ê³„"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"description",children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(Ze,{id:"description",value:D.description,onChange:r=>f(n=>({...n,description:r.target.value})),placeholder:"ì´ ìŠ¹ì¸ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>S(!1),children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:i.isPending,children:i.isPending?k?"ìˆ˜ì • ì¤‘...":"ìƒì„± ì¤‘...":k?"ìˆ˜ì •":"ìƒì„±"})]})]})]})]})]})}),e.jsx(P,{children:Object.keys(Y).length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"ì„¤ì •ëœ ìŠ¹ì¸ ë‹¨ê³„ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ í…œí”Œë¦¿ì„ ì¶”ê°€í•´ë³´ì„¸ìš”."}):e.jsx("div",{className:"space-y-4",children:Object.entries(Y).map(([r,n])=>e.jsxs(F,{children:[e.jsx(R,{className:"cursor-pointer pb-3",onClick:()=>V(r),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center space-x-2 text-base",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsx("span",{children:r}),e.jsxs(M,{variant:"secondary",className:"text-xs",children:[n.length,"ë‹¨ê³„"]})]}),C.includes(r)?e.jsx(Fs,{className:"w-4 h-4"}):e.jsx(As,{className:"w-4 h-4"})]})}),C.includes(r)&&e.jsx(P,{className:"pt-0",children:e.jsx("div",{className:"space-y-3",children:n.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(M,{variant:"outline",className:"text-xs",children:["ë‹¨ê³„ ",u.stepOrder]}),e.jsx("span",{className:"font-medium text-sm",children:va[u.requiredRole]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[parseFloat(u.minAmount).toLocaleString(),"ì›",u.maxAmount&&` ~ ${parseFloat(u.maxAmount).toLocaleString()}ì›`]}),u.canSkip&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"ê±´ë„ˆë›°ê¸° ê°€ëŠ¥"}),u.isOptional&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"ì„ íƒì "})]}),u.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:u.description})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>te(u),children:e.jsx(ve,{className:"w-3 h-3"})}),e.jsxs(Le,{children:[e.jsx(Ps,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(Se,{className:"w-3 h-3"})})}),e.jsxs(Me,{children:[e.jsxs(Re,{children:[e.jsx(Ue,{children:"í…œí”Œë¦¿ ë‹¨ê³„ ì‚­ì œ"}),e.jsx(Ke,{children:"ì´ ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs(ze,{children:[e.jsx(ss,{children:"ì·¨ì†Œ"}),e.jsx(as,{onClick:()=>d.mutate(u.id),disabled:d.isPending,className:"bg-red-600 hover:bg-red-700",children:d.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})]})]},u.id))})})]},r))})})]})]})]})]})}const Ge={admin:"ê´€ë¦¬ì",executive:"ì„ì›",hq_management:"ë³¸ì‚¬ ê´€ë¦¬ì",project_manager:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €",field_worker:"í˜„ì¥ ì‘ì—…ì"},Ss=[{value:"admin",label:"ê´€ë¦¬ì"},{value:"executive",label:"ì„ì›"},{value:"hq_management",label:"ë³¸ì‚¬ ê´€ë¦¬ì"},{value:"project_manager",label:"í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €"},{value:"field_worker",label:"í˜„ì¥ ì‘ì—…ì"}];function Na({companyId:m}){const{toast:o}=Fe(),y=$s(),[N,S]=h.useState(!1),[k,a]=h.useState(null),[C,v]=h.useState({role:"",maxAmount:"",description:""}),{data:p=[],isLoading:E,error:D}=Z({queryKey:["approval-authorities"],queryFn:async()=>{const i=await fetch("/api/approval-authorities",{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch approval authorities");return i.json()}}),f=O({mutationFn:async i=>{const d=await fetch("/api/approval-authorities",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({role:i.role,maxAmount:i.maxAmount,description:i.description,isActive:!0})});if(!d.ok){const T=await d.json();throw new Error(T.message||"Failed to create approval authority")}return d.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["approval-authorities"]}),S(!1),b(),o({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:i=>{o({title:"ì˜¤ë¥˜",description:i.message,variant:"destructive"})}}),A=O({mutationFn:async i=>{const d=await fetch(`/api/approval-authorities/${i.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({role:i.role,maxAmount:i.maxAmount,description:i.description,isActive:!0})});if(!d.ok){const T=await d.json();throw new Error(T.message||"Failed to update approval authority")}return d.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["approval-authorities"]}),a(null),b(),o({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:i=>{o({title:"ì˜¤ë¥˜",description:i.message,variant:"destructive"})}}),g=O({mutationFn:async i=>{const d=await fetch(`/api/approval-authorities/${i}`,{method:"DELETE",credentials:"include"});if(!d.ok){const T=await d.json();throw new Error(T.message||"Failed to delete approval authority")}return d.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["approval-authorities"]}),o({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},onError:i=>{o({title:"ì˜¤ë¥˜",description:i.message,variant:"destructive"})}}),b=()=>{v({role:"",maxAmount:"",description:""})},_=i=>{a(i),v({role:i.role,maxAmount:i.maxAmount.toString(),description:i.description||""})},j=i=>{if(i.preventDefault(),!C.role||!C.maxAmount){o({title:"ì˜¤ë¥˜",description:"ì—­í• ê³¼ ìŠ¹ì¸ í•œë„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.",variant:"destructive"});return}k?A.mutate({id:k.id,...C}):f.mutate(C)};return E?e.jsx(F,{children:e.jsx(P,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})}):D?e.jsx(F,{children:e.jsx(P,{className:"pt-6",children:e.jsx("div",{className:"text-center text-red-600",children:"ìŠ¹ì¸ ê¶Œí•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ìŠ¹ì¸ ê¶Œí•œ ê´€ë¦¬"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì‚¬ìš©ì ì—­í• ë³„ ìŠ¹ì¸ ê¶Œí•œê³¼ í•œë„ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤"})]}),e.jsxs(oe,{open:N,onOpenChange:S,children:[e.jsx(qe,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>{b(),a(null)},children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"ìƒˆ ê¶Œí•œ ì¶”ê°€"]})}),e.jsxs(de,{children:[e.jsxs(xe,{children:[e.jsx(me,{children:"ìŠ¹ì¸ ê¶Œí•œ ì¶”ê°€"}),e.jsx(Oe,{children:"ìƒˆë¡œìš´ ì—­í• ì˜ ìŠ¹ì¸ ê¶Œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤."})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"role",children:"ì—­í• "}),e.jsxs(he,{value:C.role,onValueChange:i=>v(d=>({...d,role:i})),children:[e.jsx(pe,{children:e.jsx(je,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(ue,{children:Ss.map(i=>e.jsx(Q,{value:i.value,children:i.label},i.value))})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"maxAmount",children:"ìŠ¹ì¸ í•œë„ (ì›)"}),e.jsx(w,{id:"maxAmount",type:"number",value:C.maxAmount,onChange:i=>v(d=>({...d,maxAmount:i.target.value})),placeholder:"ìŠ¹ì¸ ê°€ëŠ¥í•œ ìµœëŒ€ ê¸ˆì•¡"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"description",children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(Ze,{id:"description",value:C.description,onChange:i=>v(d=>({...d,description:i.target.value})),placeholder:"ìŠ¹ì¸ ê¶Œí•œì— ëŒ€í•œ ì„¤ëª…",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>S(!1),children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:f.isPending,children:f.isPending?"ìƒì„± ì¤‘...":"ìƒì„±"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(F,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"ì´ ê¶Œí•œ ìˆ˜"}),e.jsx(Ts,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.length})})]}),e.jsxs(F,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"í™œì„± ê¶Œí•œ"}),e.jsx(ke,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.filter(i=>i.isActive).length})})]}),e.jsxs(F,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"ìµœê³  í•œë„"}),e.jsx(qs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.length>0?`${Math.max(...p.map(i=>i.maxAmount)).toLocaleString()}ì›`:"0ì›"})})]})]}),e.jsxs(F,{children:[e.jsxs(R,{children:[e.jsx(z,{className:"text-base",children:"ìŠ¹ì¸ ê¶Œí•œ ëª©ë¡"}),e.jsx(Xe,{className:"text-sm",children:"ê° ì—­í• ë³„ë¡œ ì„¤ì •ëœ ìŠ¹ì¸ ê¶Œí•œê³¼ í•œë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]}),e.jsx(P,{children:p.length>0?e.jsx("div",{className:"space-y-3",children:p.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(M,{variant:i.isActive?"default":"secondary",children:Ge[i.role]||i.role}),e.jsxs("div",{className:"font-semibold",children:[i.maxAmount.toLocaleString(),"ì›"]}),!i.isActive&&e.jsx(M,{variant:"outline",children:"ë¹„í™œì„±"})]}),i.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ìƒì„±ì¼: ",new Date(i.createdAt).toLocaleDateString("ko-KR")]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(oe,{children:[e.jsx(qe,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",onClick:()=>_(i),children:e.jsx(ve,{className:"w-4 h-4"})})}),e.jsxs(de,{children:[e.jsxs(xe,{children:[e.jsx(me,{children:"ìŠ¹ì¸ ê¶Œí•œ ìˆ˜ì •"}),e.jsxs(Oe,{children:[Ge[i.role]," ì—­í• ì˜ ìŠ¹ì¸ ê¶Œí•œì„ ìˆ˜ì •í•©ë‹ˆë‹¤."]})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"edit-role",children:"ì—­í• "}),e.jsxs(he,{value:C.role,onValueChange:d=>v(T=>({...T,role:d})),children:[e.jsx(pe,{children:e.jsx(je,{})}),e.jsx(ue,{children:Ss.map(d=>e.jsx(Q,{value:d.value,children:d.label},d.value))})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"edit-maxAmount",children:"ìŠ¹ì¸ í•œë„ (ì›)"}),e.jsx(w,{id:"edit-maxAmount",type:"number",value:C.maxAmount,onChange:d=>v(T=>({...T,maxAmount:d.target.value}))})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"edit-description",children:"ì„¤ëª…"}),e.jsx(Ze,{id:"edit-description",value:C.description,onChange:d=>v(T=>({...T,description:d.target.value})),rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(qe,{asChild:!0,children:e.jsx(l,{type:"button",variant:"outline",children:"ì·¨ì†Œ"})}),e.jsx(l,{type:"submit",disabled:A.isPending,children:A.isPending?"ìˆ˜ì • ì¤‘...":"ìˆ˜ì •"})]})]})]})]}),e.jsxs(Le,{children:[e.jsx(Ps,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(Se,{className:"w-4 h-4"})})}),e.jsxs(Me,{children:[e.jsxs(Re,{children:[e.jsx(Ue,{children:"ìŠ¹ì¸ ê¶Œí•œ ì‚­ì œ"}),e.jsxs(Ke,{children:[Ge[i.role]," ì—­í• ì˜ ìŠ¹ì¸ ê¶Œí•œì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs(ze,{children:[e.jsx(ss,{children:"ì·¨ì†Œ"}),e.jsx(as,{onClick:()=>g.mutate(i.id),disabled:g.isPending,className:"bg-red-600 hover:bg-red-700",children:g.isPending?"ì‚­ì œ ì¤‘...":"ì‚­ì œ"})]})]})]})]})]},i.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"ì„¤ì •ëœ ìŠ¹ì¸ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ê¶Œí•œì„ ì¶”ê°€í•´ë³´ì„¸ìš”."})})]})]})}const fa=$.object({smtpHost:$.string().min(1,"SMTP í˜¸ìŠ¤íŠ¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤"),smtpPort:$.string().regex(/^\d+$/,"í¬íŠ¸ëŠ” ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤"),smtpUser:$.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤"),smtpPass:$.string().min(1,"ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤")});function ba(){const[m,o]=h.useState(!1),[y,N]=h.useState(""),[S,k]=h.useState(""),[a,C]=h.useState(""),{register:v,handleSubmit:p,formState:{errors:E},reset:D}=Pe({resolver:Ee(fa)}),{data:f,isLoading:A}=Z({queryKey:["emailSettings"],queryFn:async()=>{const i=await fetch("/api/email-settings",{credentials:"include"});if(!i.ok)throw new Error("ì„¤ì •ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤");return(await i.json()).data}}),g=O({mutationFn:async i=>{const d=await fetch("/api/email-settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)});if(!d.ok){const T=await d.json();throw new Error(T.message||"ì„¤ì • ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}return d.json()},onSuccess:i=>{k(i.message||"ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤"),C(""),setTimeout(()=>k(""),5e3)},onError:i=>{C(i.message),k("")}}),b=O({mutationFn:async i=>{const d=await fetch("/api/email-settings/test",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({testEmail:i})});if(!d.ok){const T=await d.json();throw new Error(T.message||"í…ŒìŠ¤íŠ¸ ì´ë©”ì¼ ë°œì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}return d.json()},onSuccess:()=>{o(!1),k("í…ŒìŠ¤íŠ¸ ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"),N(""),setTimeout(()=>k(""),5e3)},onError:i=>{C(i.message)}});h.useEffect(()=>{f&&D(f)},[f,D]);const _=i=>{g.mutate(i)},j=()=>{if(!y||!$.string().email().safeParse(y).success){C("ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");return}b.mutate(y)};return A?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Ve,{className:"h-8 w-8 animate-spin"})}):e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"ì´ë©”ì¼ ë°œì†¡ ì„¤ì •"]})}),e.jsxs(P,{children:[e.jsxs("form",{onSubmit:p(_),className:"space-y-4",children:[S&&e.jsx(He,{className:"bg-green-50 border-green-200",children:e.jsx(Be,{className:"text-green-800",children:S})}),a&&e.jsx(He,{className:"bg-red-50 border-red-200",children:e.jsx(Be,{className:"text-red-800",children:a})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"smtpHost",children:[e.jsx(ha,{className:"inline h-4 w-4 mr-1"}),"SMTP ì„œë²„"]}),e.jsx(w,{id:"smtpHost",...v("smtpHost"),placeholder:"smtp.naver.com"}),E.smtpHost&&e.jsx("span",{className:"text-red-500 text-sm",children:E.smtpHost.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"smtpPort",children:"í¬íŠ¸"}),e.jsx(w,{id:"smtpPort",...v("smtpPort"),placeholder:"587"}),E.smtpPort&&e.jsx("span",{className:"text-red-500 text-sm",children:E.smtpPort.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"smtpUser",children:[e.jsx(we,{className:"inline h-4 w-4 mr-1"}),"ë°œì†¡ì ì´ë©”ì¼"]}),e.jsx(w,{id:"smtpUser",type:"email",...v("smtpUser"),placeholder:"example@naver.com"}),E.smtpUser&&e.jsx("span",{className:"text-red-500 text-sm",children:E.smtpUser.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"smtpPass",children:[e.jsx(ma,{className:"inline h-4 w-4 mr-1"}),"ì•± ë¹„ë°€ë²ˆí˜¸"]}),e.jsx(w,{id:"smtpPass",type:"password",...v("smtpPass"),placeholder:"ì•± ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"}),E.smtpPass&&e.jsx("span",{className:"text-red-500 text-sm",children:E.smtpPass.message})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"ì„¤ì • ì•ˆë‚´"}),e.jsxs("ul",{className:"space-y-1 text-sm text-blue-800",children:[e.jsx("li",{children:"â€¢ Naver ë©”ì¼: smtp.naver.com (í¬íŠ¸ 587)"}),e.jsx("li",{children:"â€¢ Gmail: smtp.gmail.com (í¬íŠ¸ 587)"}),e.jsx("li",{children:"â€¢ ì•± ë¹„ë°€ë²ˆí˜¸ëŠ” 2ë‹¨ê³„ ì¸ì¦ í›„ ìƒì„± í•„ìš”"}),e.jsx("li",{children:"â€¢ Naver: ë©”ì¼ ì„¤ì •ì—ì„œ POP3/SMTP ì‚¬ìš© í™œì„±í™” í•„ìš”"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(l,{type:"button",variant:"outline",onClick:()=>o(!0),disabled:g.isPending,children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),"í…ŒìŠ¤íŠ¸"]}),e.jsxs(l,{type:"submit",disabled:g.isPending,children:[g.isPending?e.jsx(Ve,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ts,{className:"h-4 w-4 mr-2"}),"ì €ì¥"]})]})]}),e.jsx(oe,{open:m,onOpenChange:o,children:e.jsxs(de,{children:[e.jsx(xe,{children:e.jsx(me,{children:"ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"testEmail",children:"í…ŒìŠ¤íŠ¸ ìˆ˜ì‹  ì´ë©”ì¼"}),e.jsx(w,{id:"testEmail",type:"email",value:y,onChange:i=>N(i.target.value),placeholder:"test@example.com"})]}),a&&e.jsx(He,{className:"bg-red-50 border-red-200",children:e.jsx(Be,{className:"text-red-800",children:a})})]}),e.jsxs(Ds,{children:[e.jsx(l,{variant:"outline",onClick:()=>o(!1),disabled:b.isPending,children:"ì·¨ì†Œ"}),e.jsxs(l,{onClick:j,disabled:b.isPending,children:[b.isPending?e.jsx(Ve,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(we,{className:"h-4 w-4 mr-2"}),"ë°œì†¡"]})]})]})})]})]})}const wa=$.object({companyName:$.string().min(1,"íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"),businessNumber:$.string().min(1,"ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),address:$.string().min(1,"ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),phone:$.string().min(1,"ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),fax:$.string().optional(),email:$.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”").optional().or($.literal("")),website:$.string().optional(),representative:$.string().min(1,"ëŒ€í‘œìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”")}),Sa=$.object({name:$.string().min(1,"ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"),email:$.string().email("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"),phoneNumber:$.string().min(1,"ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),role:$.enum(["field_worker","project_manager","hq_management","executive","admin"])}),ka=$.object({role:$.enum(["field_worker","project_manager","hq_management","executive"]),maxAmount:$.number().min(0,"ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤"),description:$.string().optional()});function Wa(){const{user:m,isAuthenticated:o,isLoading:y}=Bs(),{toast:N}=Fe(),[,S]=Js(),{theme:k}=Ws(),a=k==="dark",[C,v]=h.useState(!1);h.useState(null);const[p,E]=h.useState("company"),[D,f]=h.useState(""),[A,g]=h.useState(!1),[b,_]=h.useState(null),[j,i]=h.useState(!1),[d,T]=h.useState(null);h.useState(null);const[te,ge]=h.useState("list"),[V,Y]=h.useState(null),[r,n]=h.useState(""),[u,t]=h.useState(null),[c,q]=h.useState("asc"),{data:H=[],isLoading:re}=Z({queryKey:["/api/users"],enabled:!!m&&m.role==="admin"}),{data:_e=[],isLoading:rs}=Z({queryKey:["/api/companies"],enabled:!!m&&m.role==="admin"});Z({queryKey:["/api/approval-authorities"],enabled:!!m&&m.role==="admin"});const{data:Ie=[],isLoading:Os}=Z({queryKey:["/api/admin/pending-registrations"],enabled:!!m&&m.role==="admin"}),L=_e[0],ie=Pe({resolver:Ee(wa),defaultValues:{companyName:"",businessNumber:"",address:"",phone:"",fax:"",email:"",website:"",representative:""}}),ee=Pe({resolver:Ee(Sa),defaultValues:{name:"",email:"",phoneNumber:"",role:"field_worker"}}),ne=Pe({resolver:Ee(ka),defaultValues:{role:"field_worker",maxAmount:0,description:""}});if(h.useEffect(()=>{L&&!C&&(console.log("ğŸ”„ Resetting company form with data:",L),ie.reset({companyName:L.companyName||"",businessNumber:L.businessNumber||"",address:L.address||"",phone:L.phone||"",fax:L.fax||"",email:L.email||"",website:L.website||"",representative:L.representative||""}))},[L,ie,C]),h.useEffect(()=>{b&&ee.reset({name:b.name||"",email:b.email||"",phoneNumber:b.phoneNumber||"",role:b.role||"field_worker"})},[b,ee]),y)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:"ë¡œë”© ì¤‘..."});if(!o||!m||m.role!=="admin")return S("/login"),null;const is=H.filter(s=>(s.name?.toLowerCase()||"").includes(D.toLowerCase())||(s.email?.toLowerCase()||"").includes(D.toLowerCase())||(s.phoneNumber?.toLowerCase()||"").includes(D.toLowerCase())).sort((s,U)=>{if(!u)return 0;const le=s[u]??"",hs=U[u]??"";return c==="asc"?String(le).localeCompare(String(hs)):String(hs).localeCompare(String(le))}),ns=O({mutationFn:s=>(console.log("ğŸš€ Saving company data:",s),L?(console.log("ğŸ“ Updating existing company ID:",L.id),K("PUT",`/api/companies/${L.id}`,s)):(console.log("â• Creating new company"),K("POST","/api/companies",s))),onSuccess:s=>{console.log("âœ… Company save successful:",s),N({title:"ì„±ê³µ",description:"íšŒì‚¬ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."}),v(!1),setTimeout(()=>{I.invalidateQueries({queryKey:["/api/companies"]})},100)},onError:s=>{console.error("âŒ Company save failed:",s),N({title:"ì˜¤ë¥˜",description:"íšŒì‚¬ ì •ë³´ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),ls=O({mutationFn:s=>b?K("PUT",`/api/users/${b.id}`,s):K("POST","/api/users",s),onSuccess:()=>{N({title:"ì„±ê³µ",description:b?"ì‚¬ìš©ìê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"ì‚¬ìš©ìê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/users"]}),g(!1),_(null),ee.reset()},onError:()=>{N({title:"ì˜¤ë¥˜",description:"ì‚¬ìš©ì ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),cs=O({mutationFn:({userId:s,isActive:U})=>K("PATCH",`/api/users/${s}/toggle-active`,{isActive:U}),onSuccess:()=>{N({title:"ì„±ê³µ",description:"ì‚¬ìš©ì ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/users"]})},onError:()=>{N({title:"ì˜¤ë¥˜",description:"ì‚¬ìš©ì ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),os=O({mutationFn:s=>s.id?K("PUT",`/api/approval-authorities/${s.id}`,s):K("POST","/api/approval-authorities",s),onSuccess:()=>{N({title:"ì„±ê³µ",description:d?"ìŠ¹ì¸ ê¶Œí•œì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"ìŠ¹ì¸ ê¶Œí•œì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/approval-authorities"]}),i(!1),T(null),ne.reset()},onError:()=>{N({title:"ì˜¤ë¥˜",description:"ìŠ¹ì¸ ê¶Œí•œ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});O({mutationFn:s=>K("DELETE",`/api/approval-authorities/${s}`),onSuccess:()=>{N({title:"ì„±ê³µ",description:"ìŠ¹ì¸ ê¶Œí•œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/approval-authorities"]})},onError:()=>{N({title:"ì˜¤ë¥˜",description:"ìŠ¹ì¸ ê¶Œí•œ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}});const ds=O({mutationFn:s=>K("POST",`/api/admin/approve-registration/${s}`),onSuccess:()=>{N({title:"ì„±ê³µ",description:"ê°€ì… ì‹ ì²­ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/admin/pending-registrations"]}),I.invalidateQueries({queryKey:["/api/users"]})},onError:()=>{N({title:"ì˜¤ë¥˜",description:"ê°€ì… ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Qe=O({mutationFn:({id:s,reason:U})=>K("POST",`/api/admin/reject-registration/${s}`,{reason:U}),onSuccess:()=>{N({title:"ì„±ê³µ",description:"ê°€ì… ì‹ ì²­ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤."}),I.invalidateQueries({queryKey:["/api/admin/pending-registrations"]}),Y(null),n("")},onError:()=>{N({title:"ì˜¤ë¥˜",description:"ê°€ì… ê±°ë¶€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",variant:"destructive"})}}),Ls=s=>{ns.mutate(s)},Ms=s=>{ls.mutate(s)},Rs=s=>{const U=d?{...s,id:d.id}:s;os.mutate(U)},xs=s=>{u===s?q(c==="asc"?"desc":"asc"):(t(s),q("asc"))},ms=(s,U,le)=>U!==s?null:le==="asc"?e.jsx(Gs,{className:"h-3 w-3"}):e.jsx(Fs,{className:"h-3 w-3"}),Us=s=>{switch(s){case"pending":return e.jsx(Zs,{className:"h-4 w-4 text-yellow-600"});case"approved":return e.jsx(gs,{className:"h-4 w-4 text-green-600"});case"rejected":return e.jsx(vs,{className:"h-4 w-4 text-red-600"});default:return e.jsx(Xs,{className:"h-4 w-4 text-gray-600"})}},Ks=s=>{switch(s){case"pending":return"ëŒ€ê¸° ì¤‘";case"approved":return"ìŠ¹ì¸ë¨";case"rejected":return"ê±°ë¶€ë¨";default:return"ì•Œ ìˆ˜ ì—†ìŒ"}},zs=s=>{switch(s){case"pending":return"default";case"approved":return"secondary";case"rejected":return"destructive";default:return"default"}};return e.jsx("div",{className:"min-h-screen",style:{backgroundColor:a?"#111827":"#f9fafb"},children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${a?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(Ts,{className:`h-6 w-6 transition-colors ${a?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${a?"text-white":"text-gray-900"}`,children:"ì‹œìŠ¤í…œ ê´€ë¦¬"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì‚¬ìš©ì ë° ì‹œìŠ¤í…œ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”"})]})]})})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs(Ye,{value:p,onValueChange:E,className:"w-full",children:[e.jsxs(es,{className:`grid w-full grid-cols-7 transition-colors ${a?"bg-gray-700":"bg-gray-100"}`,children:[e.jsxs(se,{value:"company",className:"flex items-center gap-2 text-sm",children:[e.jsx(us,{className:"h-4 w-4"}),"íšŒì‚¬ ì •ë³´"]}),e.jsxs(se,{value:"users",className:"flex items-center gap-2 text-sm",children:[e.jsx(ke,{className:"h-4 w-4"}),"ì‚¬ìš©ì ê´€ë¦¬"]}),e.jsxs(se,{value:"registrations",className:"flex items-center gap-2 text-sm",children:[e.jsx(Je,{className:"h-4 w-4"}),"ê°€ì… ì‹ ì²­"]}),e.jsxs(se,{value:"approval",className:"flex items-center gap-2 text-sm",children:[e.jsx(ua,{className:"h-4 w-4"}),"ìŠ¹ì¸ ê¶Œí•œ"]}),e.jsxs(se,{value:"workflow",className:"flex items-center gap-2 text-sm",children:[e.jsx(pa,{className:"h-4 w-4"}),"ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°"]}),e.jsxs(se,{value:"email",className:"flex items-center gap-2 text-sm",children:[e.jsx(we,{className:"h-4 w-4"}),"ì´ë©”ì¼ ì„¤ì •"]})]}),e.jsx(ae,{value:"company",className:"mt-2",children:e.jsxs(F,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(R,{className:"pb-1",children:e.jsxs(z,{className:`flex items-center justify-between text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(us,{className:`h-4 w-4 transition-colors ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"íšŒì‚¬ ì •ë³´"})]}),!C&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{console.log("âœï¸ Starting company edit mode"),v(!0)},className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(ve,{className:"h-3 w-3"}),"ìˆ˜ì •"]})]})}),e.jsx(P,{className:"pt-1",children:C?e.jsx(We,{...ie,children:e.jsxs("form",{onSubmit:ie.handleSubmit(Ls),className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(B,{control:ie.control,name:"companyName",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"íšŒì‚¬ëª…"}),e.jsx(G,{children:e.jsx(w,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(X,{className:"text-xs"})]})}),e.jsx(B,{control:ie.control,name:"businessNumber",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸"}),e.jsx(G,{children:e.jsx(w,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(X,{className:"text-xs"})]})}),e.jsx(B,{control:ie.control,name:"representative",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ëŒ€í‘œì"}),e.jsx(G,{children:e.jsx(w,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(X,{className:"text-xs"})]})}),e.jsx(B,{control:ie.control,name:"phone",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì „í™”ë²ˆí˜¸"}),e.jsx(G,{children:e.jsx(w,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(X,{className:"text-xs"})]})}),e.jsx(B,{control:ie.control,name:"address",render:({field:s})=>e.jsxs(J,{className:"col-span-2",children:[e.jsx(W,{className:`text-xs transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ì£¼ì†Œ"}),e.jsx(G,{children:e.jsx(w,{...s,className:`h-7 text-xs transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})}),e.jsx(X,{className:"text-xs"})]})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(l,{type:"submit",size:"sm",disabled:ns.isPending,className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(ts,{className:"h-3 w-3"}),"ì €ì¥"]}),e.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:()=>v(!1),className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(Cs,{className:"h-3 w-3"}),"ì·¨ì†Œ"]})]})]})}):e.jsx("div",{className:"space-y-3",children:L?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"íšŒì‚¬ëª…:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:L.companyName})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[80px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ì‚¬ì—…ìë²ˆí˜¸:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:L.businessNumber})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ëŒ€í‘œì:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:L.representative})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[60px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ì „í™”ë²ˆí˜¸:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:L.phone})]}),e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded col-span-2 transition-colors ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-medium min-w-[40px] transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"ì£¼ì†Œ:"}),e.jsx("span",{className:`transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:L.address})]})]}):e.jsx("div",{className:`text-xs text-center py-4 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:"íšŒì‚¬ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì¶”ê°€í•´ì£¼ì„¸ìš”."})})})]})}),e.jsx(ae,{value:"users",className:"mt-2",children:e.jsxs(F,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(R,{className:"pb-1",children:e.jsxs(z,{className:`flex items-center justify-between text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ke,{className:`h-4 w-4 transition-colors ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"ì‚¬ìš©ì ê´€ë¦¬"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center rounded p-1 transition-colors ${a?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx(l,{variant:te==="list"?"default":"ghost",size:"sm",onClick:()=>ge("list"),className:"h-8 w-8 p-0",title:"ë¦¬ìŠ¤íŠ¸ ë³´ê¸°",children:e.jsx(la,{className:"h-4 w-4"})}),e.jsx(l,{variant:te==="card"?"default":"ghost",size:"sm",onClick:()=>ge("card"),className:"h-8 w-8 p-0",title:"ì¹´ë“œ ë³´ê¸°",children:e.jsx(ca,{className:"h-4 w-4"})})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"gap-1 h-6 px-2 text-xs",children:[e.jsx(be,{className:"h-3 w-3"}),"ì‚¬ìš©ì ì¶”ê°€"]})]})]})}),e.jsx(P,{className:"pt-1",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(oa,{className:`absolute left-2 top-1/2 transform -translate-y-1/2 h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx(w,{placeholder:"ì‚¬ìš©ì ê²€ìƒ‰...",value:D,onChange:s=>f(s.target.value),className:`h-7 text-xs pl-7 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`})]})}),re?e.jsx("div",{className:`text-xs text-center py-4 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."}):te==="list"?e.jsxs(Ys,{children:[e.jsx(ea,{children:e.jsxs(ys,{children:[e.jsx(Ne,{className:`px-3 py-3 text-xs cursor-pointer transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>xs("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ì´ë¦„",ms("name",u,c)]})}),e.jsx(Ne,{className:`px-3 py-3 text-xs cursor-pointer transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>xs("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ì´ë©”ì¼",ms("email",u,c)]})}),e.jsx(Ne,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì—­í• "}),e.jsx(Ne,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì—°ë½ì²˜"}),e.jsx(Ne,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ìƒíƒœ"}),e.jsx(Ne,{className:`px-3 py-3 text-xs text-center transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ì‘ì—…"})]})}),e.jsx(sa,{children:is.map(s=>e.jsxs(ys,{className:`transition-colors ${a?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsx(fe,{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6",children:e.jsx(De,{className:"text-xs",children:s.name?.[0]||"U"})}),e.jsx("div",{className:`font-medium text-xs transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:s.name})]})}),e.jsx(fe,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-300":"text-gray-900"}`,children:s.email}),e.jsx(fe,{className:"px-3 py-3",children:e.jsx(Ae,{role:s.role})}),e.jsx(fe,{className:`px-3 py-3 text-xs transition-colors ${a?"text-gray-300":"text-gray-900"}`,children:s.phoneNumber}),e.jsx(fe,{className:"px-3 py-3",children:e.jsx(ce,{checked:s.isActive??!0,onCheckedChange:U=>cs.mutate({userId:s.id,isActive:U}),className:"h-4 w-7"})}),e.jsx(fe,{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>_(s),className:`h-6 w-6 p-0 transition-colors ${a?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,title:"ìˆ˜ì •",children:e.jsx(ve,{className:"h-3 w-3"})}),e.jsx(bs,{user:s,onDeleteSuccess:()=>{I.invalidateQueries({queryKey:["/api/users"]}),N({title:"ì„±ê³µ",description:"ì‚¬ìš©ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},trigger:e.jsx(l,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 transition-colors ${a?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"ì‚­ì œ",children:e.jsx(Se,{className:"h-3 w-3"})})})]})})]},s.id))})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:is.map(s=>e.jsxs(F,{className:`p-3 shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Te,{className:"h-8 w-8",children:e.jsx(De,{className:"text-sm",children:s.name?.[0]||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:s.name}),e.jsx(Ae,{role:s.role})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.phoneNumber})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:new Date(s.createdAt).toLocaleDateString("ko-KR")})]})]}),e.jsxs("div",{className:`flex items-center justify-between mt-3 pt-3 border-t transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[e.jsx(ce,{checked:s.isActive??!0,onCheckedChange:U=>cs.mutate({userId:s.id,isActive:U}),className:"h-4 w-7"}),e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>_(s),className:`h-8 w-8 p-0 transition-colors ${a?"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:"ìˆ˜ì •",children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsx(bs,{user:s,onDeleteSuccess:()=>{I.invalidateQueries({queryKey:["/api/users"]}),N({title:"ì„±ê³µ",description:"ì‚¬ìš©ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})},trigger:e.jsx(l,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 transition-colors ${a?"hover:bg-red-900/20":"hover:bg-red-50"}`,title:"ì‚­ì œ",children:e.jsx(Se,{className:`h-4 w-4 transition-colors ${a?"text-red-400":"text-red-600"}`})})})]})]})]},s.id))}),e.jsxs("div",{className:`text-xs pt-1 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:["ì´ ",H.length,"ëª…ì˜ ì‚¬ìš©ìê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤."]})]})})]})}),e.jsx(ae,{value:"registrations",className:"mt-2",children:e.jsxs(F,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx(R,{className:"pb-1",children:e.jsxs(z,{className:`flex items-center justify-between text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Je,{className:`h-4 w-4 transition-colors ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("span",{children:"ê°€ì… ì‹ ì²­ ê´€ë¦¬"})]}),e.jsxs(M,{variant:"outline",className:"text-xs",children:[Ie.filter(s=>s.status==="pending").length,"ê°œ ëŒ€ê¸° ì¤‘"]})]})}),e.jsx(P,{className:"pt-1",children:Os?e.jsx("div",{className:`text-xs text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"ê°€ì… ì‹ ì²­ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."}):Ie.length===0?e.jsxs("div",{className:`text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Je,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"ê°€ì… ì‹ ì²­ì´ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-xs mt-1",children:"ìƒˆë¡œìš´ ì‚¬ìš©ì ê°€ì… ì‹ ì²­ì´ ìˆìœ¼ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."})]}):e.jsx("div",{className:"space-y-3",children:Ie.map(s=>e.jsx(F,{className:`p-4 border transition-colors ${a?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Te,{className:"h-10 w-10",children:e.jsx(De,{className:"text-sm",children:s.name[0]})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-medium text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:s.name}),e.jsx(Ae,{role:s.role})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:s.phoneNumber})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(da,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsxs("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:["ID: ",s.userId]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:`h-3 w-3 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:new Date(s.submittedAt).toLocaleString("ko-KR")})]})]}),s.rejectionReason&&e.jsxs("div",{className:`mt-2 p-2 rounded text-xs transition-colors ${a?"bg-red-900/20 border border-red-800 text-red-200":"bg-red-50 border border-red-200 text-red-700"}`,children:[e.jsx("strong",{children:"ê±°ë¶€ ì‚¬ìœ :"})," ",s.rejectionReason]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(M,{variant:zs(s.status),className:"text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",children:[Us(s.status),Ks(s.status)]})}),s.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(l,{size:"sm",onClick:()=>ds.mutate(s.id),disabled:ds.isPending,className:"h-7 px-2 text-xs gap-1",children:[e.jsx(gs,{className:"h-3 w-3"}),"ìŠ¹ì¸"]}),e.jsxs(l,{variant:"destructive",size:"sm",onClick:()=>Y(s),className:"h-7 px-2 text-xs gap-1",children:[e.jsx(vs,{className:"h-3 w-3"}),"ê±°ë¶€"]})]})]})]})},s.id))})})]})}),e.jsx(ae,{value:"approval",className:"mt-2",children:e.jsx(Na,{companyId:1})}),e.jsx(ae,{value:"workflow",className:"mt-2",children:e.jsx(ya,{})}),e.jsx(ae,{value:"email",className:"mt-2",children:e.jsx(ba,{})})]})}),(A||b)&&e.jsx(oe,{open:!0,onOpenChange:()=>{g(!1),_(null),ee.reset()},children:e.jsxs(de,{children:[e.jsx(xe,{children:e.jsx(me,{children:b?"ì‚¬ìš©ì ìˆ˜ì •":"ì‚¬ìš©ì ì¶”ê°€"})}),e.jsx(We,{...ee,children:e.jsxs("form",{onSubmit:ee.handleSubmit(Ms),className:"space-y-4",children:[e.jsx(B,{control:ee.control,name:"name",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ì´ë¦„"}),e.jsx(G,{children:e.jsx(w,{...s})}),e.jsx(X,{})]})}),e.jsx(B,{control:ee.control,name:"email",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ì´ë©”ì¼"}),e.jsx(G,{children:e.jsx(w,{...s,type:"email"})}),e.jsx(X,{})]})}),e.jsx(B,{control:ee.control,name:"phoneNumber",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ì „í™”ë²ˆí˜¸"}),e.jsx(G,{children:e.jsx(w,{...s})}),e.jsx(X,{})]})}),e.jsx(B,{control:ee.control,name:"role",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ì—­í• "}),e.jsxs(he,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(G,{children:e.jsx(pe,{children:e.jsx(je,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsx(ue,{children:e.jsx(aa,{children:U=>U.map(le=>e.jsx(Q,{value:le.value,children:le.label},le.value))})})]}),e.jsx(X,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{g(!1),_(null),ee.reset()},children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:ls.isPending,children:b?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})}),(j||d)&&e.jsx(oe,{open:!0,onOpenChange:()=>{i(!1),T(null),ne.reset()},children:e.jsxs(de,{children:[e.jsx(xe,{children:e.jsx(me,{children:d?"ìŠ¹ì¸ ê¶Œí•œ ìˆ˜ì •":"ìŠ¹ì¸ ê¶Œí•œ ì¶”ê°€"})}),e.jsx(We,{...ne,children:e.jsxs("form",{onSubmit:ne.handleSubmit(Rs),className:"space-y-4",children:[e.jsx(B,{control:ne.control,name:"role",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ì—­í• "}),e.jsxs(he,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(G,{children:e.jsx(pe,{children:e.jsx(je,{placeholder:"ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”"})})}),e.jsxs(ue,{children:[e.jsx(Q,{value:"field_worker",children:"í˜„ì¥ ì‹¤ë¬´ì"}),e.jsx(Q,{value:"project_manager",children:"í˜„ì¥ ê´€ë¦¬ì"}),e.jsx(Q,{value:"hq_management",children:"ë³¸ì‚¬ ê´€ë¦¬ë¶€"}),e.jsx(Q,{value:"executive",children:"ì„ì›/ëŒ€í‘œ"})]})]}),e.jsx(X,{})]})}),e.jsx(B,{control:ne.control,name:"maxAmount",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ìµœëŒ€ ìŠ¹ì¸ í•œë„ (ì›)"}),e.jsx(G,{children:e.jsx(w,{...s,type:"number",placeholder:"0",onChange:U=>s.onChange(parseInt(U.target.value)||0)})}),e.jsx(X,{})]})}),e.jsx(B,{control:ne.control,name:"description",render:({field:s})=>e.jsxs(J,{children:[e.jsx(W,{children:"ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(G,{children:e.jsx(w,{...s,placeholder:"ê¶Œí•œì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"})}),e.jsx(X,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{i(!1),T(null),ne.reset()},children:"ì·¨ì†Œ"}),e.jsx(l,{type:"submit",disabled:os.isPending,children:d?"ìˆ˜ì •":"ì¶”ê°€"})]})]})})]})}),V&&e.jsx(oe,{open:!0,onOpenChange:()=>{Y(null),n("")},children:e.jsxs(de,{children:[e.jsx(xe,{children:e.jsx(me,{children:"ê°€ì… ì‹ ì²­ ê±°ë¶€"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded border transition-colors ${a?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Te,{className:"h-8 w-8",children:e.jsx(De,{className:"text-sm",children:V.name[0]})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-medium text-sm transition-colors ${a?"text-gray-100":"text-gray-900"}`,children:V.name}),e.jsx("p",{className:`text-xs transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:V.email})]})]})}),e.jsxs("div",{children:[e.jsx(x,{className:`text-sm transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"ê±°ë¶€ ì‚¬ìœ  *"}),e.jsx("textarea",{value:r,onChange:s=>n(s.target.value),placeholder:"ê°€ì… ì‹ ì²­ì„ ê±°ë¶€í•˜ëŠ” ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”...",className:`w-full mt-1 p-2 text-sm rounded border transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300 placeholder:text-gray-500"}`,rows:4})]}),e.jsx("div",{className:`p-3 rounded border transition-colors ${a?"bg-yellow-900/20 border-yellow-800":"bg-yellow-50 border-yellow-200"}`,children:e.jsxs("p",{className:`text-xs transition-colors ${a?"text-yellow-200":"text-yellow-800"}`,children:[e.jsx("strong",{children:"ì£¼ì˜:"})," ê±°ë¶€ëœ ê°€ì… ì‹ ì²­ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©°, ì‹ ì²­ìì—ê²Œ ê±°ë¶€ ì‚¬ìœ ê°€ í¬í•¨ëœ ì´ë©”ì¼ì´ ë°œì†¡ë©ë‹ˆë‹¤."]})})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(l,{variant:"outline",onClick:()=>{Y(null),n("")},children:"ì·¨ì†Œ"}),e.jsx(l,{variant:"destructive",onClick:()=>{V&&r.trim()&&Qe.mutate({id:V.id,reason:r.trim()})},disabled:!r.trim()||Qe.isPending,children:Qe.isPending?"ì²˜ë¦¬ ì¤‘...":"ê±°ë¶€"})]})]})})]})})}export{Wa as default};
